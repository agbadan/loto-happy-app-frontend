# üß™ GUIDE DE TEST FINAL COMPLET

## ‚úÖ **TOUS LES FICHIERS ONT √âT√â MIS √Ä JOUR**

### Fichiers Cr√©√©s
1. ‚úÖ `/utils/games.ts` - Configuration compl√®te des jeux
2. ‚úÖ `/components/BetHistory.tsx` - Historique d√©taill√© des paris

### Fichiers Compl√®tement Refaits
1. ‚úÖ `/utils/draws.ts` - Syst√®me de tirages et paris
2. ‚úÖ `/components/GameScreen.tsx` - Enregistrement des paris
3. ‚úÖ `/components/Dashboard.tsx` - Jeux par pays
4. ‚úÖ `/components/GameCard.tsx` - Carte de jeu am√©lior√©e
5. ‚úÖ `/components/admin/AdminGames.tsx` - Gestion des jeux (admin)
6. ‚úÖ `/components/admin/AdminFinance.tsx` - Gestion financi√®re (admin)

### Fichiers Modifi√©s
1. ‚úÖ `/components/ProfileScreen.tsx` - Ajout onglet "Paris"

---

## üéØ **WORKFLOW COMPLET √Ä TESTER**

### PHASE 1 : Cr√©er un Tirage (Admin) üîß

**Objectif:** Cr√©er un nouveau tirage pour tester le syst√®me

#### √âtapes :
1. **Connexion Admin**
   - Num√©ro : `000000000000`
   - Mot de passe : `adminlotto`

2. **Acc√©der √† la Gestion des Jeux**
   - Panneau Admin ‚Üí Gestion des Jeux
   - Onglet "√Ä Venir"

3. **Cr√©er un Nouveau Tirage**
   - Clic sur "Nouveau Tirage"
   - **S√©lectionner un jeu :** Par exemple `üé≤ Togo - Loto Kadoo 5naps`
   - **Date :** Demain (ex: 2025-10-29)
   - **Heure :** Une heure dans le futur (ex: 18:00)
   - Clic sur "Cr√©er le tirage"

#### ‚úÖ V√©rifications :
- [ ] Toast "Nouveau tirage cr√©√© avec succ√®s"
- [ ] Le tirage appara√Æt dans l'onglet "√Ä Venir"
- [ ] Le jeu affiche : nom, pays, type (5naps), date, heure
- [ ] Badge "√Ä venir" affich√©
- [ ] Nombre de participants = 0

---

### PHASE 2 : Parier comme Joueur üéÆ

**Objectif:** Placer plusieurs paris sur le tirage cr√©√©

#### √âtapes :

**2.1 - Cr√©er un Compte Joueur (si n√©cessaire)**
1. Se d√©connecter de l'admin
2. Inscription avec :
   - Nom d'utilisateur : `JoueurTest228`
   - Num√©ro : `+22890123456` (Togo)
   - Email : `test@test.com`
   - Mot de passe : `test123`

**2.2 - Placer un Pari**
1. **Dashboard**
   - V√©rifier que seuls les jeux du Togo s'affichent
   - V√©rifier la section "Jeu Vedette" (Loto Kadoo 5naps)
   - V√©rifier les infos de prochain tirage (date, heure, countdown)

2. **Cliquer sur "Loto Kadoo 5naps"**
   - V√©rifier que GameScreen s'ouvre
   - V√©rifier les infos du prochain tirage
   - V√©rifier la grid de num√©ros (1 √† 50)

3. **S√©lectionner 5 Num√©ros**
   - Exemple : 5, 12, 23, 34, 45
   - V√©rifier le compteur : 5/5
   - V√©rifier que les num√©ros s'affichent en or

4. **Valider le Pari**
   - Clic sur "Valider le Pari"
   - V√©rifier le montant : 500 F

#### ‚úÖ V√©rifications :
- [ ] Toast "Pari enregistr√© ! Num√©ros : 5, 12, 23, 34, 45"
- [ ] Solde diminu√© de 500 F
- [ ] Num√©ros r√©initialis√©s

**2.3 - V√©rifier l'Historique du Joueur**
1. **Profil ‚Üí Onglet "Paris"**
   - Le pari doit appara√Ætre
   - V√©rifier : Nom du jeu, num√©ros, montant, date du tirage
   - Statut : "√Ä venir" (badge bleu)

#### ‚úÖ V√©rifications :
- [ ] Le pari appara√Æt dans l'historique
- [ ] Tous les d√©tails sont corrects
- [ ] Badge "√Ä venir" affich√©
- [ ] Stats : Total Paris = 1, Total Mis√© = 500 F

**2.4 - Placer d'Autres Paris (Optionnel)**
- Cr√©er 2-3 autres comptes joueurs
- Placer des paris avec diff√©rents num√©ros
- Exemple :
  - Joueur 2 : 5, 12, 23, 34, 40
  - Joueur 3 : 10, 20, 30, 40, 50

---

### PHASE 3 : V√©rifier l'Admin üë®‚Äçüíº

**Objectif:** V√©rifier que l'admin voit les paris

#### √âtapes :
1. **Reconnexion Admin**
2. **Gestion des Jeux ‚Üí √Ä Venir**
   - Trouver le tirage cr√©√©
   - V√©rifier : Nombre de participants > 0

3. **Gestion Financi√®re ‚Üí Historique Global**
   - V√©rifier que les paris apparaissent
   - Type : "Mise"
   - Joueur : Nom du joueur
   - Description : "Pari sur Loto Kadoo 5naps"
   - Montant : -500 F
   - Num√©ros affich√©s en dessous

#### ‚úÖ V√©rifications :
- [ ] Les participants sont compt√©s
- [ ] Les paris apparaissent dans l'historique
- [ ] Les num√©ros sont affich√©s
- [ ] Stats : Total Mises > 0

---

### PHASE 4 : Faire Passer le Tirage en "Pending" ‚è∞

**Objectif:** Tester la transition upcoming ‚Üí pending

#### M√©thode 1 : Attendre (si la date/heure est proche)
- Attendre que la date/heure du tirage soit pass√©e
- Recharger la page
- Le tirage devrait automatiquement passer en "Saisie R√©sultats"

#### M√©thode 2 : Modifier la Date (plus rapide)
1. **Console du navigateur (F12)**
2. **Ex√©cuter :**
```javascript
const draws = JSON.parse(localStorage.getItem('loto_happy_draws'));
const targetDraw = draws.find(d => d.gameName.includes('Loto Kadoo 5naps') && d.status === 'upcoming');
if (targetDraw) {
  targetDraw.date = '2025-10-27'; // Hier
  targetDraw.time = '10:00';
  localStorage.setItem('loto_happy_draws', JSON.stringify(draws));
  window.location.reload();
}
```

3. **Admin ‚Üí Gestion des Jeux**
   - Le tirage devrait maintenant √™tre dans "Saisie R√©sultats"

#### ‚úÖ V√©rifications :
- [ ] Le tirage a disparu de "√Ä Venir"
- [ ] Le tirage appara√Æt dans "Saisie R√©sultats"
- [ ] Badge "En attente" affich√©
- [ ] Bouton "Saisir R√©sultats" visible

---

### PHASE 5 : Saisir les R√©sultats (Admin) üèÜ

**Objectif:** Distribuer les gains automatiquement

#### √âtapes :
1. **Admin ‚Üí Gestion des Jeux ‚Üí Saisie R√©sultats**
2. **Trouver le tirage** Loto Kadoo 5naps
3. **Clic sur "Saisir R√©sultats"**
4. **Entrer les num√©ros gagnants**
   - Pour tester UN GAGNANT : `5, 12, 23, 34, 45` (= num√©ros du Joueur 1)
   - Pour tester AUCUN GAGNANT : `1, 2, 3, 4, 6`
   - Pour tester GAINS PARTIELS : `5, 12, 23, 34, 40` (4/5 = gain)

5. **Clic sur "Enregistrer et distribuer les gains"**

#### ‚úÖ V√©rifications :
- [ ] Toast "R√©sultats enregistr√©s avec succ√®s ! Les gains ont √©t√© distribu√©s."
- [ ] Le tirage a disparu de "Saisie R√©sultats"
- [ ] Le tirage appara√Æt dans "Archives"

**6. V√©rifier l'Archive**
1. **Admin ‚Üí Gestion des Jeux ‚Üí Archives**
2. **Trouver le tirage**
   - Num√©ros gagnants affich√©s
   - Nombre de gagnants
   - Total mises
   - B√©n√©fice

3. **Clic sur "Voir le rapport"**
   - Liste des gagnants (si applicable)
   - Liste de tous les participants
   - Statut "Gagnant" ou "Perdant"

#### ‚úÖ V√©rifications :
- [ ] Num√©ros gagnants corrects
- [ ] Stats correctes
- [ ] Gagnants identifi√©s correctement
- [ ] Montants de gain corrects

---

### PHASE 6 : V√©rifier les Gains du Joueur üí∞

**Objectif:** Confirmer que le joueur a re√ßu ses gains

#### √âtapes :
1. **Se d√©connecter de l'admin**
2. **Reconnexion Joueur** (celui qui a gagn√©)
3. **Dashboard**
   - **Si le joueur a gagn√© :**
     - Un panneau de notification devrait appara√Ætre automatiquement
     - Confettis anim√©s
     - Troph√©e
     - Montant gagn√© en GROS
     - Comparaison des num√©ros
     - Bouton "Fermer"

#### ‚úÖ V√©rifications Notification :
- [ ] Panneau de notification s'affiche
- [ ] Confettis visibles
- [ ] Montant correct (ex: 500,000 F pour 5/5)
- [ ] Num√©ros compar√©s visuellement
- [ ] Bouton "Fermer" fonctionne

**4. V√©rifier le Solde**
- **Header** : V√©rifier que "Solde des Gains" a augment√©
- Si 5/5 num√©ros : +500,000 F
- Si 4/5 num√©ros : +50,000 F
- Si 3/5 num√©ros : +5,000 F

#### ‚úÖ V√©rifications Solde :
- [ ] Solde des Gains > 0
- [ ] Montant correct selon le nombre de num√©ros

**5. V√©rifier l'Historique**
1. **Profil ‚Üí Onglet "Paris"**
2. **Trouver le pari**
   - Statut devrait √™tre "Gagn√©" (badge vert) ou "Perdu"
   - Num√©ros gagnants affich√©s
   - Comparaison visuelle (num√©ros gagnants encercl√©s)
   - Montant gagn√© affich√©

#### ‚úÖ V√©rifications Historique :
- [ ] Statut correct (Gagn√©/Perdu)
- [ ] Num√©ros gagnants affich√©s
- [ ] Num√©ros correspondants mis en √©vidence
- [ ] Montant gagn√© affich√© (si gagn√©)

**6. V√©rifier les Transactions**
1. **Profil ‚Üí Onglet "Transactions"**
2. **V√©rifier qu'il y a 2 transactions :**
   - Transaction 1 : "Pari sur Loto Kadoo 5naps" (-500 F)
   - Transaction 2 : "Gain au Loto Kadoo 5naps" (+montant gagn√©)

#### ‚úÖ V√©rifications Transactions :
- [ ] Transaction de pari pr√©sente
- [ ] Transaction de gain pr√©sente (si gagn√©)
- [ ] Montants corrects
- [ ] Soldes apr√®s transaction corrects

---

### PHASE 7 : V√©rifier Admin Finance üíµ

**Objectif:** Confirmer que les stats admin sont √† jour

#### √âtapes :
1. **Reconnexion Admin**
2. **Gestion Financi√®re**
3. **V√©rifier les Stats en Haut**
   - Total Mises = Somme de tous les paris
   - Total Gains Distribu√©s = Somme des gains
   - B√©n√©fice Net = Mises - Gains
   - Joueurs Actifs = Nombre de joueurs uniques

4. **Historique Global**
   - Filtre "Gain" : Voir les transactions de gain
   - V√©rifier que les gains apparaissent
   - Montants corrects

#### ‚úÖ V√©rifications :
- [ ] Stats globales correctes
- [ ] Total Mises = Somme des paris
- [ ] Total Gains = Somme des gains distribu√©s
- [ ] B√©n√©fice = Mises - Gains
- [ ] Historique complet (paris + gains)

---

## üìä **R√âSULTATS ATTENDUS**

### Exemple avec 3 Joueurs et 5/5 Gagnant

**Paris :**
- Joueur 1 : 5, 12, 23, 34, 45 (500 F)
- Joueur 2 : 5, 12, 23, 34, 40 (500 F)
- Joueur 3 : 10, 20, 30, 40, 50 (500 F)
- **Total Mises :** 1,500 F

**R√©sultats Saisis :** 5, 12, 23, 34, 45

**Gains Distribu√©s :**
- Joueur 1 : 5/5 = 500,000 F
- Joueur 2 : 4/5 = 50,000 F
- Joueur 3 : 0/5 = 0 F
- **Total Gains :** 550,000 F

**B√©n√©fice :** 1,500 - 550,000 = **-548,500 F** (perte)

### Stats Admin Finance :
- Total Mises : 1,500 F
- Total Gains Distribu√©s : 550,000 F
- B√©n√©fice Net : -548,500 F (rouge)
- Joueurs Actifs : 3

---

## üéâ **CHECKLIST FINALE**

### Syst√®me de Jeux ‚úÖ
- [ ] 15 jeux configur√©s (5 pays √ó 3 types)
- [ ] Dashboard affiche les jeux du pays du joueur
- [ ] Infos de tirage affich√©es (date, heure, countdown)
- [ ] GameCard avec couleurs dynamiques

### Enregistrement des Paris ‚úÖ
- [ ] GameScreen enregistre les paris
- [ ] localStorage `loto_happy_tickets` contient les tickets
- [ ] Solde d√©duit correctement
- [ ] Transaction ajout√©e √† l'historique

### Historique D√©taill√© ‚úÖ
- [ ] Onglet "Paris" dans le profil
- [ ] Tous les paris affich√©s
- [ ] D√©tails complets (num√©ros, montant, date, statut)
- [ ] Stats globales (total paris, mis√©, gagn√©)
- [ ] Filtres fonctionnels

### Gestion Admin ‚úÖ
- [ ] AdminGames utilise le nouveau syst√®me
- [ ] Cr√©ation de tirage avec s√©lection de jeu
- [ ] Transition upcoming ‚Üí pending automatique
- [ ] Saisie des r√©sultats avec validation
- [ ] Vue du rapport d√©taill√©

### Distribution des Gains ‚úÖ
- [ ] submitDrawResults() distribue les gains
- [ ] Solde des Gains cr√©dit√©
- [ ] Transaction de gain cr√©√©e
- [ ] Notification de gain cr√©√©e
- [ ] Ticket mis √† jour (won/lost)

### Notifications ‚úÖ
- [ ] WinNotificationPanel s'affiche automatiquement
- [ ] Confettis et animations
- [ ] Montant gagn√© affich√©
- [ ] Num√©ros compar√©s visuellement
- [ ] Bouton "Fermer" fonctionne

### Admin Finance ‚úÖ
- [ ] Stats r√©elles (pas de donn√©es fictives)
- [ ] Total Mises calcul√©
- [ ] Total Gains calcul√©
- [ ] B√©n√©fice calcul√©
- [ ] Historique global affiche les vrais paris
- [ ] Filtres fonctionnels

---

## üêõ **TROUBLESHOOTING**

### Probl√®me : Le tirage ne passe pas en "pending"
**Solution :** 
1. Ouvrir la console (F12)
2. Ex√©cuter : `updateDrawStatuses()` (import√© depuis draws.ts)
3. Ou recharger la page

### Probl√®me : Le pari ne s'enregistre pas
**Solution :**
1. V√©rifier le solde du joueur (> mise)
2. V√©rifier qu'il y a bien un tirage "upcoming" pour ce jeu
3. Console : `localStorage.getItem('loto_happy_tickets')`

### Probl√®me : Les gains ne sont pas distribu√©s
**Solution :**
1. Console : `localStorage.getItem('loto_happy_users')`
2. V√©rifier le `balanceWinnings` du joueur
3. V√©rifier `localStorage.getItem('loto_happy_win_notifications')`

### Probl√®me : La notification ne s'affiche pas
**Solution :**
1. V√©rifier que le joueur a bien gagn√©
2. Console : `localStorage.getItem('loto_happy_win_notifications')`
3. V√©rifier que `read: false`
4. Recharger la page Dashboard

---

## üéØ **CONCLUSION**

Si tous les tests passent, le syst√®me est **100% fonctionnel** ! 

Le joueur peut :
- ‚úÖ Voir les jeux de son pays
- ‚úÖ Parier sur les jeux
- ‚úÖ Voir son historique d√©taill√©
- ‚úÖ Recevoir des notifications de gain
- ‚úÖ Voir ses gains cr√©dit√©s

L'admin peut :
- ‚úÖ Cr√©er des tirages
- ‚úÖ Saisir les r√©sultats
- ‚úÖ Voir les rapports d√©taill√©s
- ‚úÖ Voir les vraies stats financi√®res
- ‚úÖ Voir tous les paris en temps r√©el

**F√©licitations ! Le syst√®me Loto Happy est op√©rationnel ! üéâüèÜ**
