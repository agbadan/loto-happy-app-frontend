# Dump du code source du projet LOTO-HAPPY-FRONTEND

================================================================================
--- FICHIER : ./index.html ---
================================================================================


  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Application Lotto_Happy</title>
    </head>

    <body>
      <div id="root"></div>
      <script type="module" src="/src/main.tsx"></script>
    </body>
  </html>
  

================================================================================
--- FICHIER : ./package.json ---
================================================================================


  {
      "name": "loto-happy-app-frontend",
      "version": "0.1.0",
      "private": true,
      "dependencies": {
          "@radix-ui/react-accordion": "^1.2.3",
          "@radix-ui/react-alert-dialog": "^1.1.6",
          "@radix-ui/react-aspect-ratio": "^1.1.2",
          "@radix-ui/react-avatar": "^1.1.3",
          "@radix-ui/react-checkbox": "^1.1.4",
          "@radix-ui/react-collapsible": "^1.1.3",
          "@radix-ui/react-context-menu": "^2.2.6",
          "@radix-ui/react-dialog": "^1.1.6",
          "@radix-ui/react-dropdown-menu": "^2.1.6",
          "@radix-ui/react-hover-card": "^1.1.6",
          "@radix-ui/react-label": "^2.1.2",
          "@radix-ui/react-menubar": "^1.1.6",
          "@radix-ui/react-navigation-menu": "^1.2.5",
          "@radix-ui/react-popover": "^1.1.6",
          "@radix-ui/react-progress": "^1.1.2",
          "@radix-ui/react-radio-group": "^1.2.3",
          "@radix-ui/react-scroll-area": "^1.2.3",
          "@radix-ui/react-select": "^2.1.6",
          "@radix-ui/react-separator": "^1.1.2",
          "@radix-ui/react-slider": "^1.2.3",
          "@radix-ui/react-slot": "^1.1.2",
          "@radix-ui/react-switch": "^1.1.3",
          "@radix-ui/react-tabs": "^1.1.3",
          "@radix-ui/react-toggle": "^1.1.2",
          "@radix-ui/react-toggle-group": "^1.1.2",
          "@radix-ui/react-tooltip": "^1.1.8",
          "class-variance-authority": "^0.7.1",
          "clsx": "*",
          "cmdk": "^1.1.1",
          "date-fns": "*",
          "embla-carousel-react": "^8.6.0",
          "input-otp": "^1.4.2",
          "lucide-react": "^0.487.0",
          "motion": "*",
          "next-themes": "^0.4.6",
          "react": "^18.3.1",
          "react-day-picker": "^8.10.1",
          "react-dom": "^18.3.1",
          "react-hook-form": "^7.55.0",
          "react-resizable-panels": "^2.1.7",
          "recharts": "^2.15.2",
          "sonner": "^2.0.3",
          "tailwind-merge": "*",
          "vaul": "^1.1.2",
          "axios": "^1.7.2"
      },
      "devDependencies": {
          "@types/node": "^20.10.0",
          "@vitejs/plugin-react-swc": "^3.10.2",
          "vite": "6.3.5"
      },
      "scripts": {
          "dev": "vite",
          "build": "vite build",
          "start": "vite preview --host 0.0.0.0"
      }
  }

================================================================================
--- FICHIER : ./vite.config.ts ---
================================================================================

import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react-swc';
import path from 'path';

export default defineConfig({
  // Définit le chemin de base public lorsque l'application est servie.
  // '/' garantit que les chemins vers les assets (JS, CSS) sont absolus
  // par rapport à la racine du domaine, ce qui est crucial pour le déploiement.
  base: '/',

  plugins: [react()],
  resolve: {
    extensions: ['.js', '.jsx', '.ts', '.tsx', '.json'],
    alias: {
      'vaul@1.1.2': 'vaul',
      'sonner@2.0.3': 'sonner',
      'recharts@2.15.2': 'recharts',
      'react-resizable-panels@2.1.7': 'react-resizable-panels',
      'react-hook-form@7.55.0': 'react-hook-form',
      'react-day-picker@8.10.1': 'react-day-picker',
      'next-themes@0.4.6': 'next-themes',
      'lucide-react@0.487.0': 'lucide-react',
      'input-otp@1.4.2': 'input-otp',
      'embla-carousel-react@8.6.0': 'embla-carousel-react',
      'cmdk@1.1.1': 'cmdk',
      'class-variance-authority@0.7.1': 'class-variance-authority',
      '@radix-ui/react-tooltip@1.1.8': '@radix-ui/react-tooltip',
      '@radix-ui/react-toggle@1.1.2': '@radix-ui/react-toggle',
      '@radix-ui/react-toggle-group@1.1.2': '@radix-ui/react-toggle-group',
      '@radix-ui/react-tabs@1.1.3': '@radix-ui/react-tabs',
      '@radix-ui/react-switch@1.1.3': '@radix-ui/react-switch',
      '@radix-ui/react-slot@1.1.2': '@radix-ui/react-slot',
      '@radix-ui/react-slider@1.2.3': '@radix-ui/react-slider',
      '@radix-ui/react-separator@1.1.2': '@radix-ui/react-separator',
      '@radix-ui/react-select@2.1.6': '@radix-ui/react-select',
      '@radix-ui/react-scroll-area@1.2.3': '@radix-ui/react-scroll-area',
      '@radix-ui/react-radio-group@1.2.3': '@radix-ui/react-radio-group',
      '@radix-ui/react-progress@1.1.2': '@radix-ui/react-progress',
      '@radix-ui/react-popover@1.1.6': '@radix-ui/react-popover',
      '@radix-ui/react-navigation-menu@1.2.5': '@radix-ui/react-navigation-menu',
      '@radix-ui/react-menubar@1.1.6': '@radix-ui/react-menubar',
      '@radix-ui/react-label@2.1.2': '@radix-ui/react-label',
      '@radix-ui/react-hover-card@1.1.6': '@radix-ui/react-hover-card',
      '@radix-ui/react-dropdown-menu@2.1.6': '@radix-ui/react-dropdown-menu',
      '@radix-ui/react-dialog@1.1.6': '@radix-ui/react-dialog',
      '@radix-ui/react-context-menu@2.2.6': '@radix-ui/react-context-menu',
      '@radix-ui/react-collapsible@1.1.3': '@radix-ui/react-collapsible',
      '@radix-ui/react-checkbox@1.1.4': '@radix-ui/react-checkbox',
      '@radix-ui/react-avatar@1.1.3': '@radix-ui/react-avatar',
      '@radix-ui/react-aspect-ratio@1.1.2': '@radix-ui/react-aspect-ratio',
      '@radix-ui/react-alert-dialog@1.1.6': '@radix-ui/react-alert-dialog',
      '@radix-ui/react-accordion@1.2.3': '@radix-ui/react-accordion',
      '@': path.resolve(__dirname, './src'),
    },
  },
  build: {
    target: 'esnext',
    outDir: 'build',
  },
  server: {
    port: 3000,
    open: true,
    host: true,
  },
  preview: {
    port: 8080,
    host: true,
    allowedHosts: [
      'loto-happy-app-frontend.onrender.com'
    ]
  }
});

================================================================================
--- FICHIER : ./src/App.tsx ---
================================================================================

// src/App.tsx

import { useState, useEffect } from "react";
import { ThemeProvider } from "./components/ThemeProvider";
import { Toaster } from "./components/ui/sonner";
import { useAuth, User } from "./contexts/AuthContext";

// Import de tous vos écrans
import { Dashboard } from "./components/Dashboard";
import { GameScreen } from "./components/GameScreen";
import { ProfileScreen } from "./components/ProfileScreen";
import { LoginScreen } from "./components/LoginScreen";
import { PasswordLoginScreen } from "./components/PasswordLoginScreen";
import { RegistrationScreen } from "./components/RegistrationScreen";
import { ResellersScreen } from "./components/ResellersScreen";
import { ResultsScreen } from "./components/ResultsScreen";
import { ResellerDashboard } from "./components/ResellerDashboard";
import { AdminPanel } from "./components/AdminPanel";

type Screen = 'login' | 'password' | 'registration' | 'dashboard' | 'reseller-dashboard' | 'admin-panel' | 'game' | 'profile' | 'resellers' | 'results';

// CORRECTION #1 : On définit la liste officielle des rôles d'administrateur.
// C'est la source de vérité pour la redirection.
const ADMIN_ROLES = [
  'Super Admin',
  'Admin du Jeu',
  'Admin Financier',
  'Support Client'
];

// CORRECTION #2 : La fonction de redirection est rendue robuste et précise.
const getHomeScreenForUser = (user: User): Screen => {
  const role = user.role;
  // Log amélioré pour voir les espaces potentiels (ex: " Support Client ")
  console.log(`[AUTH] Rôle détecté pour redirection: "${role}"`);

  // On utilise .trim() pour enlever les espaces au début/fin avant de comparer.
  // C'est la correction la plus importante pour résoudre le bug.
  if (ADMIN_ROLES.includes(role.trim())) {
    console.log('[AUTH] Rôle admin identifié. Redirection vers admin-panel.');
    return 'admin-panel';
  }
  
  if (role.trim().toLowerCase() === 'reseller') {
    console.log('[AUTH] Rôle revendeur identifié. Redirection vers reseller-dashboard.');
    return 'reseller-dashboard';
  }

  // Si aucune des conditions ci-dessus n'est remplie, l'utilisateur est un joueur.
  console.log('[AUTH] Rôle par défaut (Joueur). Redirection vers dashboard.');
  return 'dashboard';
};

export default function App() {
  const { user, isLoading, logout } = useAuth();

  const [currentScreen, setCurrentScreen] = useState<Screen>('login');
  const [authIdentifier, setAuthIdentifier] = useState<string>('');
  const [selectedGame, setSelectedGame] = useState<string>('');

  const playBalance = user?.balanceGame ?? 0;
  const winningsBalance = user?.balanceWinnings ?? 0;

  useEffect(() => {
    if (!isLoading) {
      if (user) {
        const homeScreen = getHomeScreenForUser(user);
        setCurrentScreen(homeScreen);
      } else {
        setCurrentScreen('login');
      }
    }
  }, [user, isLoading]);

  const handleLogout = () => { logout(); };
  const handleNavigateToPassword = (identifier: string) => { setAuthIdentifier(identifier); setCurrentScreen('password'); };
  const handleNavigateToRegistration = (identifier: string) => { setAuthIdentifier(identifier); setCurrentScreen('registration'); };
  const handleBackToLogin = () => { setAuthIdentifier(''); setCurrentScreen('login'); };
  
  // CORRECTION #3 : Le bouton "Retour" est maintenant intelligent.
  // Un admin dans son profil reviendra au panel admin, pas au dashboard joueur.
  const handleBackToDashboard = () => {
    const homeScreen = user ? getHomeScreenForUser(user) : 'login';
    setCurrentScreen(homeScreen);
  };

  const handleNavigateToGame = (drawId: string) => { setSelectedGame(drawId); setCurrentScreen('game'); };
  const handleNavigateToProfile = () => { setCurrentScreen('profile'); };

  if (isLoading) {
    return (
      <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh', backgroundColor: '#121212', color: 'white' }}>
        Chargement de votre session...
      </div>
    );
  }

  return (
    <ThemeProvider>
      {currentScreen === 'login' && <LoginScreen onNavigateToPassword={handleNavigateToPassword} />}
      {currentScreen === 'password' && <PasswordLoginScreen identifier={authIdentifier} onBack={handleBackToLogin} onNavigateToRegistration={handleNavigateToRegistration} />}
      {currentScreen === 'registration' && <RegistrationScreen prefilledIdentifier={authIdentifier} onBack={handleBackToLogin} />}
      {currentScreen === 'dashboard' && user && <Dashboard onNavigateToGame={handleNavigateToGame} onNavigateToProfile={handleNavigateToProfile} onNavigateToResellers={() => setCurrentScreen('resellers')} onNavigateToResults={() => setCurrentScreen('results')} playBalance={playBalance} winningsBalance={winningsBalance} onRecharge={() => {}} onLogout={handleLogout} />}
      {currentScreen === 'game' && user && <GameScreen drawId={selectedGame} onBack={handleBackToDashboard} onNavigateToProfile={handleNavigateToProfile} playBalance={playBalance} onPlaceBet={() => {}} />}
      {currentScreen === 'profile' && user && <ProfileScreen onBack={handleBackToDashboard} playBalance={playBalance} winningsBalance={winningsBalance} onRecharge={() => {}} onConvertWinnings={() => {}} onLogout={handleLogout} />}
      {currentScreen === 'resellers' && user && <ResellersScreen onBack={handleBackToDashboard} userPhoneNumber={user.phoneNumber} playBalance={playBalance} onProfile={handleNavigateToProfile} />}
      {currentScreen === 'results' && <ResultsScreen onBack={handleBackToDashboard} />}
      {currentScreen === 'reseller-dashboard' && user && <ResellerDashboard onLogout={handleLogout} />}
      {currentScreen === 'admin-panel' && user && <AdminPanel onLogout={handleLogout} />}
      <Toaster position="top-center" />
    </ThemeProvider>
  );
}

================================================================================
--- FICHIER : ./src/index.css ---
================================================================================

@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");
/*! tailwindcss v4.1.3 | MIT License | https://tailwindcss.com */
@layer properties {
  @supports (((-webkit-hyphens: none)) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color: rgb(from red r g b)))) {
    *, :before, :after, ::backdrop {
      --tw-translate-x: 0;
      --tw-translate-y: 0;
      --tw-translate-z: 0;
      --tw-rotate-x: rotateX(0);
      --tw-rotate-y: rotateY(0);
      --tw-rotate-z: rotateZ(0);
      --tw-skew-x: skewX(0);
      --tw-skew-y: skewY(0);
      --tw-space-y-reverse: 0;
      --tw-space-x-reverse: 0;
      --tw-divide-y-reverse: 0;
      --tw-border-style: solid;
      --tw-gradient-position: initial;
      --tw-gradient-from: #0000;
      --tw-gradient-via: #0000;
      --tw-gradient-to: #0000;
      --tw-gradient-stops: initial;
      --tw-gradient-via-stops: initial;
      --tw-gradient-from-position: 0%;
      --tw-gradient-via-position: 50%;
      --tw-gradient-to-position: 100%;
      --tw-leading: initial;
      --tw-font-weight: initial;
      --tw-tracking: initial;
      --tw-shadow: 0 0 #0000;
      --tw-shadow-color: initial;
      --tw-shadow-alpha: 100%;
      --tw-inset-shadow: 0 0 #0000;
      --tw-inset-shadow-color: initial;
      --tw-inset-shadow-alpha: 100%;
      --tw-ring-color: initial;
      --tw-ring-shadow: 0 0 #0000;
      --tw-inset-ring-color: initial;
      --tw-inset-ring-shadow: 0 0 #0000;
      --tw-ring-inset: initial;
      --tw-ring-offset-width: 0px;
      --tw-ring-offset-color: #fff;
      --tw-ring-offset-shadow: 0 0 #0000;
      --tw-outline-style: solid;
      --tw-blur: initial;
      --tw-brightness: initial;
      --tw-contrast: initial;
      --tw-grayscale: initial;
      --tw-hue-rotate: initial;
      --tw-invert: initial;
      --tw-opacity: initial;
      --tw-saturate: initial;
      --tw-sepia: initial;
      --tw-drop-shadow: initial;
      --tw-drop-shadow-color: initial;
      --tw-drop-shadow-alpha: 100%;
      --tw-drop-shadow-size: initial;
      --tw-backdrop-blur: initial;
      --tw-backdrop-brightness: initial;
      --tw-backdrop-contrast: initial;
      --tw-backdrop-grayscale: initial;
      --tw-backdrop-hue-rotate: initial;
      --tw-backdrop-invert: initial;
      --tw-backdrop-opacity: initial;
      --tw-backdrop-saturate: initial;
      --tw-backdrop-sepia: initial;
      --tw-duration: initial;
      --tw-ease: initial;
    }
  }
}

@layer theme {
  :root, :host {
    --font-sans: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    --color-red-400: oklch(.704 .191 22.216);
    --color-red-500: oklch(.637 .237 25.331);
    --color-red-600: oklch(.577 .245 27.325);
    --color-orange-400: oklch(.75 .183 55.934);
    --color-orange-500: oklch(.705 .213 47.604);
    --color-yellow-400: oklch(.852 .199 91.936);
    --color-yellow-500: oklch(.795 .184 86.047);
    --color-green-400: oklch(.792 .209 151.711);
    --color-green-500: oklch(.723 .219 149.579);
    --color-green-600: oklch(.627 .194 149.214);
    --color-green-700: oklch(.527 .154 150.069);
    --color-blue-400: oklch(.707 .165 254.624);
    --color-blue-500: oklch(.623 .214 259.815);
    --color-blue-600: oklch(.546 .245 262.881);
    --color-purple-500: oklch(.627 .265 303.9);
    --color-purple-600: oklch(.558 .288 302.321);
    --color-gray-500: oklch(.551 .027 264.364);
    --color-gray-600: oklch(.446 .03 256.802);
    --color-black: #000;
    --color-white: #fff;
    --spacing: .25rem;
    --container-md: 28rem;
    --container-lg: 32rem;
    --container-2xl: 42rem;
    --container-3xl: 48rem;
    --text-xs: .75rem;
    --text-xs--line-height: calc(1 / .75);
    --text-sm: .875rem;
    --text-sm--line-height: calc(1.25 / .875);
    --text-base: 1rem;
    --text-base--line-height: calc(1.5 / 1);
    --text-lg: 1.125rem;
    --text-lg--line-height: calc(1.75 / 1.125);
    --text-xl: 1.25rem;
    --text-xl--line-height: calc(1.75 / 1.25);
    --text-2xl: 1.5rem;
    --text-2xl--line-height: calc(2 / 1.5);
    --text-3xl: 1.875rem;
    --text-3xl--line-height: calc(2.25 / 1.875);
    --text-4xl: 2.25rem;
    --text-4xl--line-height: calc(2.5 / 2.25);
    --text-5xl: 3rem;
    --text-5xl--line-height: 1;
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    --tracking-tight: -.025em;
    --tracking-wider: .05em;
    --tracking-widest: .1em;
    --leading-tight: 1.25;
    --leading-relaxed: 1.625;
    --radius-xs: .125rem;
    --radius-2xl: 1rem;
    --radius-3xl: 1.5rem;
    --ease-in-out: cubic-bezier(.4, 0, .2, 1);
    --animate-spin: spin 1s linear infinite;
    --blur-sm: 8px;
    --default-transition-duration: .15s;
    --default-transition-timing-function: cubic-bezier(.4, 0, .2, 1);
    --default-font-family: var(--font-sans);
    --default-font-feature-settings: var(--font-sans--font-feature-settings);
    --default-font-variation-settings: var(--font-sans--font-variation-settings);
    --default-mono-font-family: var(--font-mono);
    --default-mono-font-feature-settings: var(--font-mono--font-feature-settings);
    --default-mono-font-variation-settings: var(--font-mono--font-variation-settings);
  }
}

@layer base {
  *, :after, :before, ::backdrop {
    box-sizing: border-box;
    border: 0 solid;
    margin: 0;
    padding: 0;
  }

  ::file-selector-button {
    box-sizing: border-box;
    border: 0 solid;
    margin: 0;
    padding: 0;
  }

  html, :host {
    -webkit-text-size-adjust: 100%;
    tab-size: 4;
    line-height: 1.5;
    font-family: var(--default-font-family, ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji");
    font-feature-settings: var(--default-font-feature-settings, normal);
    font-variation-settings: var(--default-font-variation-settings, normal);
    -webkit-tap-highlight-color: transparent;
  }

  body {
    line-height: inherit;
  }

  hr {
    height: 0;
    color: inherit;
    border-top-width: 1px;
  }

  abbr:where([title]) {
    -webkit-text-decoration: underline dotted;
    text-decoration: underline dotted;
  }

  h1, h2, h3, h4, h5, h6 {
    font-size: inherit;
    font-weight: inherit;
  }

  a {
    color: inherit;
    -webkit-text-decoration: inherit;
    -webkit-text-decoration: inherit;
    text-decoration: inherit;
  }

  b, strong {
    font-weight: bolder;
  }

  code, kbd, samp, pre {
    font-family: var(--default-mono-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace);
    font-feature-settings: var(--default-mono-font-feature-settings, normal);
    font-variation-settings: var(--default-mono-font-variation-settings, normal);
    font-size: 1em;
  }

  small {
    font-size: 80%;
  }

  sub, sup {
    vertical-align: baseline;
    font-size: 75%;
    line-height: 0;
    position: relative;
  }

  sub {
    bottom: -.25em;
  }

  sup {
    top: -.5em;
  }

  table {
    text-indent: 0;
    border-color: inherit;
    border-collapse: collapse;
  }

  :-moz-focusring {
    outline: auto;
  }

  progress {
    vertical-align: baseline;
  }

  summary {
    display: list-item;
  }

  ol, ul, menu {
    list-style: none;
  }

  img, svg, video, canvas, audio, iframe, embed, object {
    vertical-align: middle;
    display: block;
  }

  img, video {
    max-width: 100%;
    height: auto;
  }

  button, input, select, optgroup, textarea {
    font: inherit;
    font-feature-settings: inherit;
    font-variation-settings: inherit;
    letter-spacing: inherit;
    color: inherit;
    opacity: 1;
    background-color: #0000;
    border-radius: 0;
  }

  ::file-selector-button {
    font: inherit;
    font-feature-settings: inherit;
    font-variation-settings: inherit;
    letter-spacing: inherit;
    color: inherit;
    opacity: 1;
    background-color: #0000;
    border-radius: 0;
  }

  :where(select:is([multiple], [size])) optgroup {
    font-weight: bolder;
  }

  :where(select:is([multiple], [size])) optgroup option {
    padding-inline-start: 20px;
  }

  ::file-selector-button {
    margin-inline-end: 4px;
  }

  ::placeholder {
    opacity: 1;
    color: currentColor;
  }

  @supports (color: color-mix(in lab, red, red)) {
    ::placeholder {
      color: color-mix(in oklab, currentColor 50%, transparent);
    }
  }

  textarea {
    resize: vertical;
  }

  ::-webkit-search-decoration {
    -webkit-appearance: none;
  }

  ::-webkit-date-and-time-value {
    min-height: 1lh;
    text-align: inherit;
  }

  ::-webkit-datetime-edit {
    display: inline-flex;
  }

  ::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
  }

  ::-webkit-datetime-edit {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-year-field {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-month-field {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-day-field {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-hour-field {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-minute-field {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-second-field {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-millisecond-field {
    padding-block: 0;
  }

  ::-webkit-datetime-edit-meridiem-field {
    padding-block: 0;
  }

  :-moz-ui-invalid {
    box-shadow: none;
  }

  button, input:where([type="button"], [type="reset"], [type="submit"]) {
    appearance: button;
  }

  ::file-selector-button {
    appearance: button;
  }

  ::-webkit-inner-spin-button {
    height: auto;
  }

  ::-webkit-outer-spin-button {
    height: auto;
  }

  [hidden]:where(:not([hidden="until-found"])) {
    display: none !important;
  }

  * {
    border-color: var(--border);
    outline-color: var(--ring);
  }

  @supports (color: color-mix(in lab, red, red)) {
    * {
      outline-color: color-mix(in oklab, var(--ring) 50%, transparent);
    }
  }

  body {
    background-color: var(--background);
    color: var(--foreground);
  }

  * {
    border-color: var(--border);
    outline-color: var(--ring);
    transition: background-color .3s ease-in-out, color .3s ease-in-out, border-color .3s ease-in-out, box-shadow .3s ease-in-out;
  }

  @supports (color: color-mix(in lab, red, red)) {
    * {
      outline-color: color-mix(in oklab, var(--ring) 50%, transparent);
    }
  }

  body {
    background-color: var(--background);
    color: var(--foreground);
    font-family: Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif;
  }

  html, body, #root {
    width: 100%;
    overflow-x: hidden;
  }

  * {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  ::-webkit-scrollbar {
    display: none;
  }

  :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) h1 {
    font-size: var(--text-2xl);
    font-weight: 700;
    line-height: 1.3;
  }

  :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) h2 {
    font-size: var(--text-xl);
    font-weight: 600;
    line-height: 1.4;
  }

  :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) h3 {
    font-size: var(--text-lg);
    font-weight: 600;
    line-height: 1.4;
  }

  :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) h4 {
    font-size: var(--text-base);
    font-weight: 600;
    line-height: 1.5;
  }

  :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) p {
    font-size: var(--text-base);
    font-weight: var(--font-weight-normal);
    line-height: 1.6;
  }

  :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) label, :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) button {
    font-size: var(--text-base);
    font-weight: 500;
    line-height: 1.5;
  }

  :where(:not(:has([class*=" text-"]), :not(:has([class^="text-"])))) input {
    font-size: var(--text-base);
    font-weight: var(--font-weight-normal);
    line-height: 1.5;
  }

  .overflow-x-auto {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .overflow-x-auto::-webkit-scrollbar {
    display: none;
  }

  .overflow-x-auto {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
  }

  @media (width <= 640px) {
    .overflow-x-auto:after {
      content: "";
      background: linear-gradient(to left, var(--background), transparent);
      pointer-events: none;
      opacity: .8;
      width: 20px;
      position: absolute;
      top: 0;
      bottom: 0;
      right: 0;
    }
  }

  [role="tab"] {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  .overflow-x-auto {
    scroll-snap-type: x proximity;
  }

  [role="tab"] {
    scroll-snap-align: start;
  }
}

@layer utilities {
  .\@container\/card-header {
    container: card-header / inline-size;
  }

  .pointer-events-none {
    pointer-events: none;
  }

  .invisible {
    visibility: hidden;
  }

  .visible {
    visibility: visible;
  }

  .sr-only {
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    position: absolute;
    overflow: hidden;
  }

  .absolute {
    position: absolute;
  }

  .fixed {
    position: fixed;
  }

  .relative {
    position: relative;
  }

  .sticky {
    position: sticky;
  }

  .inset-0 {
    inset: calc(var(--spacing) * 0);
  }

  .inset-y-0 {
    inset-block: calc(var(--spacing) * 0);
  }

  .-top-1 {
    top: calc(var(--spacing) * -1);
  }

  .top-0 {
    top: calc(var(--spacing) * 0);
  }

  .top-1\/2 {
    top: 50%;
  }

  .top-3 {
    top: calc(var(--spacing) * 3);
  }

  .top-4 {
    top: calc(var(--spacing) * 4);
  }

  .top-\[50\%\] {
    top: 50%;
  }

  .-right-1 {
    right: calc(var(--spacing) * -1);
  }

  .right-1 {
    right: calc(var(--spacing) * 1);
  }

  .right-2 {
    right: calc(var(--spacing) * 2);
  }

  .right-3 {
    right: calc(var(--spacing) * 3);
  }

  .right-4 {
    right: calc(var(--spacing) * 4);
  }

  .left-0 {
    left: calc(var(--spacing) * 0);
  }

  .left-1 {
    left: calc(var(--spacing) * 1);
  }

  .left-3 {
    left: calc(var(--spacing) * 3);
  }

  .left-\[50\%\] {
    left: 50%;
  }

  .z-10 {
    z-index: 10;
  }

  .z-30 {
    z-index: 30;
  }

  .z-40 {
    z-index: 40;
  }

  .z-50 {
    z-index: 50;
  }

  .col-start-2 {
    grid-column-start: 2;
  }

  .row-span-2 {
    grid-row: span 2 / span 2;
  }

  .row-start-1 {
    grid-row-start: 1;
  }

  .container {
    width: 100%;
  }

  @media (width >= 40rem) {
    .container {
      max-width: 40rem;
    }
  }

  @media (width >= 48rem) {
    .container {
      max-width: 48rem;
    }
  }

  @media (width >= 64rem) {
    .container {
      max-width: 64rem;
    }
  }

  @media (width >= 80rem) {
    .container {
      max-width: 80rem;
    }
  }

  @media (width >= 96rem) {
    .container {
      max-width: 96rem;
    }
  }

  .-mx-1 {
    margin-inline: calc(var(--spacing) * -1);
  }

  .-mx-3 {
    margin-inline: calc(var(--spacing) * -3);
  }

  .mx-auto {
    margin-inline: auto;
  }

  .my-1 {
    margin-block: calc(var(--spacing) * 1);
  }

  .my-4 {
    margin-block: calc(var(--spacing) * 4);
  }

  .my-8 {
    margin-block: calc(var(--spacing) * 8);
  }

  .mt-0\.5 {
    margin-top: calc(var(--spacing) * .5);
  }

  .mt-1 {
    margin-top: calc(var(--spacing) * 1);
  }

  .mt-2 {
    margin-top: calc(var(--spacing) * 2);
  }

  .mt-3 {
    margin-top: calc(var(--spacing) * 3);
  }

  .mt-4 {
    margin-top: calc(var(--spacing) * 4);
  }

  .mt-6 {
    margin-top: calc(var(--spacing) * 6);
  }

  .mt-8 {
    margin-top: calc(var(--spacing) * 8);
  }

  .mt-16 {
    margin-top: calc(var(--spacing) * 16);
  }

  .mr-1 {
    margin-right: calc(var(--spacing) * 1);
  }

  .mr-1\.5 {
    margin-right: calc(var(--spacing) * 1.5);
  }

  .mr-2 {
    margin-right: calc(var(--spacing) * 2);
  }

  .mr-3 {
    margin-right: calc(var(--spacing) * 3);
  }

  .mb-0\.5 {
    margin-bottom: calc(var(--spacing) * .5);
  }

  .mb-1 {
    margin-bottom: calc(var(--spacing) * 1);
  }

  .mb-2 {
    margin-bottom: calc(var(--spacing) * 2);
  }

  .mb-3 {
    margin-bottom: calc(var(--spacing) * 3);
  }

  .mb-4 {
    margin-bottom: calc(var(--spacing) * 4);
  }

  .mb-6 {
    margin-bottom: calc(var(--spacing) * 6);
  }

  .mb-8 {
    margin-bottom: calc(var(--spacing) * 8);
  }

  .mb-12 {
    margin-bottom: calc(var(--spacing) * 12);
  }

  .ml-1 {
    margin-left: calc(var(--spacing) * 1);
  }

  .ml-2 {
    margin-left: calc(var(--spacing) * 2);
  }

  .ml-auto {
    margin-left: auto;
  }

  .block {
    display: block;
  }

  .flex {
    display: flex;
  }

  .grid {
    display: grid;
  }

  .hidden {
    display: none;
  }

  .inline {
    display: inline;
  }

  .inline-flex {
    display: inline-flex;
  }

  .table {
    display: table;
  }

  .table-caption {
    display: table-caption;
  }

  .table-cell {
    display: table-cell;
  }

  .table-row {
    display: table-row;
  }

  .aspect-square {
    aspect-ratio: 1;
  }

  .size-3\.5 {
    width: calc(var(--spacing) * 3.5);
    height: calc(var(--spacing) * 3.5);
  }

  .size-4 {
    width: calc(var(--spacing) * 4);
    height: calc(var(--spacing) * 4);
  }

  .size-7 {
    width: calc(var(--spacing) * 7);
    height: calc(var(--spacing) * 7);
  }

  .size-8 {
    width: calc(var(--spacing) * 8);
    height: calc(var(--spacing) * 8);
  }

  .size-9 {
    width: calc(var(--spacing) * 9);
    height: calc(var(--spacing) * 9);
  }

  .size-10 {
    width: calc(var(--spacing) * 10);
    height: calc(var(--spacing) * 10);
  }

  .size-full {
    width: 100%;
    height: 100%;
  }

  .h-1 {
    height: calc(var(--spacing) * 1);
  }

  .h-2 {
    height: calc(var(--spacing) * 2);
  }

  .h-3 {
    height: calc(var(--spacing) * 3);
  }

  .h-4 {
    height: calc(var(--spacing) * 4);
  }

  .h-5 {
    height: calc(var(--spacing) * 5);
  }

  .h-6 {
    height: calc(var(--spacing) * 6);
  }

  .h-7 {
    height: calc(var(--spacing) * 7);
  }

  .h-8 {
    height: calc(var(--spacing) * 8);
  }

  .h-9 {
    height: calc(var(--spacing) * 9);
  }

  .h-10 {
    height: calc(var(--spacing) * 10);
  }

  .h-12 {
    height: calc(var(--spacing) * 12);
  }

  .h-14 {
    height: calc(var(--spacing) * 14);
  }

  .h-16 {
    height: calc(var(--spacing) * 16);
  }

  .h-20 {
    height: calc(var(--spacing) * 20);
  }

  .h-24 {
    height: calc(var(--spacing) * 24);
  }

  .h-32 {
    height: calc(var(--spacing) * 32);
  }

  .h-\[1\.15rem\] {
    height: 1.15rem;
  }

  .h-\[calc\(100\%-1px\)\] {
    height: calc(100% - 1px);
  }

  .h-\[var\(--radix-select-trigger-height\)\] {
    height: var(--radix-select-trigger-height);
  }

  .h-auto {
    height: auto;
  }

  .h-full {
    height: 100%;
  }

  .h-px {
    height: 1px;
  }

  .h-screen {
    height: 100vh;
  }

  .max-h-\(--radix-select-content-available-height\) {
    max-height: var(--radix-select-content-available-height);
  }

  .max-h-40 {
    max-height: calc(var(--spacing) * 40);
  }

  .max-h-\[90vh\] {
    max-height: 90vh;
  }

  .min-h-4 {
    min-height: calc(var(--spacing) * 4);
  }

  .min-h-\[40px\] {
    min-height: 40px;
  }

  .min-h-screen {
    min-height: 100vh;
  }

  .w-2 {
    width: calc(var(--spacing) * 2);
  }

  .w-3 {
    width: calc(var(--spacing) * 3);
  }

  .w-4 {
    width: calc(var(--spacing) * 4);
  }

  .w-5 {
    width: calc(var(--spacing) * 5);
  }

  .w-6 {
    width: calc(var(--spacing) * 6);
  }

  .w-7 {
    width: calc(var(--spacing) * 7);
  }

  .w-8 {
    width: calc(var(--spacing) * 8);
  }

  .w-10 {
    width: calc(var(--spacing) * 10);
  }

  .w-12 {
    width: calc(var(--spacing) * 12);
  }

  .w-14 {
    width: calc(var(--spacing) * 14);
  }

  .w-16 {
    width: calc(var(--spacing) * 16);
  }

  .w-20 {
    width: calc(var(--spacing) * 20);
  }

  .w-24 {
    width: calc(var(--spacing) * 24);
  }

  .w-32 {
    width: calc(var(--spacing) * 32);
  }

  .w-64 {
    width: calc(var(--spacing) * 64);
  }

  .w-72 {
    width: calc(var(--spacing) * 72);
  }

  .w-\[140px\] {
    width: 140px;
  }

  .w-auto {
    width: auto;
  }

  .w-fit {
    width: fit-content;
  }

  .w-full {
    width: 100%;
  }

  .max-w-2xl {
    max-width: var(--container-2xl);
  }

  .max-w-3xl {
    max-width: var(--container-3xl);
  }

  .max-w-\[95vw\] {
    max-width: 95vw;
  }

  .max-w-\[calc\(100\%-2rem\)\] {
    max-width: calc(100% - 2rem);
  }

  .max-w-lg {
    max-width: var(--container-lg);
  }

  .max-w-md {
    max-width: var(--container-md);
  }

  .min-w-0 {
    min-width: calc(var(--spacing) * 0);
  }

  .min-w-\[8rem\] {
    min-width: 8rem;
  }

  .min-w-\[var\(--radix-select-trigger-width\)\] {
    min-width: var(--radix-select-trigger-width);
  }

  .min-w-full {
    min-width: 100%;
  }

  .min-w-max {
    min-width: max-content;
  }

  .flex-1 {
    flex: 1;
  }

  .flex-shrink-0, .shrink-0 {
    flex-shrink: 0;
  }

  .caption-bottom {
    caption-side: bottom;
  }

  .border-collapse {
    border-collapse: collapse;
  }

  .origin-\(--radix-popover-content-transform-origin\) {
    transform-origin: var(--radix-popover-content-transform-origin);
  }

  .origin-\(--radix-select-content-transform-origin\) {
    transform-origin: var(--radix-select-content-transform-origin);
  }

  .-translate-x-full {
    --tw-translate-x: -100%;
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .translate-x-0 {
    --tw-translate-x: calc(var(--spacing) * 0);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .translate-x-\[-50\%\] {
    --tw-translate-x: -50%;
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .-translate-y-1\/2 {
    --tw-translate-y: calc(calc(1 / 2 * 100%) * -1);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .translate-y-\[-50\%\] {
    --tw-translate-y: -50%;
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .transform {
    transform: var(--tw-rotate-x) var(--tw-rotate-y) var(--tw-rotate-z) var(--tw-skew-x) var(--tw-skew-y);
  }

  .animate-spin {
    animation: var(--animate-spin);
  }

  .cursor-default {
    cursor: default;
  }

  .cursor-pointer {
    cursor: pointer;
  }

  .scroll-my-1 {
    scroll-margin-block: calc(var(--spacing) * 1);
  }

  .auto-rows-min {
    grid-auto-rows: min-content;
  }

  .grid-cols-1 {
    grid-template-columns: repeat(1, minmax(0, 1fr));
  }

  .grid-cols-2 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .grid-cols-3 {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }

  .grid-cols-9 {
    grid-template-columns: repeat(9, minmax(0, 1fr));
  }

  .grid-cols-\[0_1fr\] {
    grid-template-columns: 0 1fr;
  }

  .grid-rows-\[auto_auto\] {
    grid-template-rows: auto auto;
  }

  .flex-col {
    flex-direction: column;
  }

  .flex-col-reverse {
    flex-direction: column-reverse;
  }

  .flex-wrap {
    flex-wrap: wrap;
  }

  .items-center {
    align-items: center;
  }

  .items-start {
    align-items: flex-start;
  }

  .items-stretch {
    align-items: stretch;
  }

  .justify-between {
    justify-content: space-between;
  }

  .justify-center {
    justify-content: center;
  }

  .justify-end {
    justify-content: flex-end;
  }

  .justify-start {
    justify-content: flex-start;
  }

  .justify-items-start {
    justify-items: start;
  }

  .gap-0\.5 {
    gap: calc(var(--spacing) * .5);
  }

  .gap-1 {
    gap: calc(var(--spacing) * 1);
  }

  .gap-1\.5 {
    gap: calc(var(--spacing) * 1.5);
  }

  .gap-2 {
    gap: calc(var(--spacing) * 2);
  }

  .gap-3 {
    gap: calc(var(--spacing) * 3);
  }

  .gap-4 {
    gap: calc(var(--spacing) * 4);
  }

  .gap-6 {
    gap: calc(var(--spacing) * 6);
  }

  .gap-8 {
    gap: calc(var(--spacing) * 8);
  }

  :where(.space-y-0\.5 > :not(:last-child)) {
    --tw-space-y-reverse: 0;
    margin-block-start: calc(calc(var(--spacing) * .5) * var(--tw-space-y-reverse));
    margin-block-end: calc(calc(var(--spacing) * .5) * calc(1 - var(--tw-space-y-reverse)));
  }

  :where(.space-y-1 > :not(:last-child)) {
    --tw-space-y-reverse: 0;
    margin-block-start: calc(calc(var(--spacing) * 1) * var(--tw-space-y-reverse));
    margin-block-end: calc(calc(var(--spacing) * 1) * calc(1 - var(--tw-space-y-reverse)));
  }

  :where(.space-y-2 > :not(:last-child)) {
    --tw-space-y-reverse: 0;
    margin-block-start: calc(calc(var(--spacing) * 2) * var(--tw-space-y-reverse));
    margin-block-end: calc(calc(var(--spacing) * 2) * calc(1 - var(--tw-space-y-reverse)));
  }

  :where(.space-y-3 > :not(:last-child)) {
    --tw-space-y-reverse: 0;
    margin-block-start: calc(calc(var(--spacing) * 3) * var(--tw-space-y-reverse));
    margin-block-end: calc(calc(var(--spacing) * 3) * calc(1 - var(--tw-space-y-reverse)));
  }

  :where(.space-y-4 > :not(:last-child)) {
    --tw-space-y-reverse: 0;
    margin-block-start: calc(calc(var(--spacing) * 4) * var(--tw-space-y-reverse));
    margin-block-end: calc(calc(var(--spacing) * 4) * calc(1 - var(--tw-space-y-reverse)));
  }

  :where(.space-y-6 > :not(:last-child)) {
    --tw-space-y-reverse: 0;
    margin-block-start: calc(calc(var(--spacing) * 6) * var(--tw-space-y-reverse));
    margin-block-end: calc(calc(var(--spacing) * 6) * calc(1 - var(--tw-space-y-reverse)));
  }

  :where(.space-x-1 > :not(:last-child)) {
    --tw-space-x-reverse: 0;
    margin-inline-start: calc(calc(var(--spacing) * 1) * var(--tw-space-x-reverse));
    margin-inline-end: calc(calc(var(--spacing) * 1) * calc(1 - var(--tw-space-x-reverse)));
  }

  .gap-y-0\.5 {
    row-gap: calc(var(--spacing) * .5);
  }

  :where(.divide-y > :not(:last-child)) {
    --tw-divide-y-reverse: 0;
    border-bottom-style: var(--tw-border-style);
    border-top-style: var(--tw-border-style);
    border-top-width: calc(1px * var(--tw-divide-y-reverse));
    border-bottom-width: calc(1px * calc(1 - var(--tw-divide-y-reverse)));
  }

  :where(.divide-border > :not(:last-child)) {
    border-color: var(--border);
  }

  .self-start {
    align-self: flex-start;
  }

  .justify-self-end {
    justify-self: flex-end;
  }

  .truncate {
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }

  .overflow-auto {
    overflow: auto;
  }

  .overflow-hidden {
    overflow: hidden;
  }

  .overflow-x-auto {
    overflow-x: auto;
  }

  .overflow-x-hidden {
    overflow-x: hidden;
  }

  .overflow-y-auto {
    overflow-y: auto;
  }

  .rounded {
    border-radius: .25rem;
  }

  .rounded-2xl {
    border-radius: var(--radius-2xl);
  }

  .rounded-3xl {
    border-radius: var(--radius-3xl);
  }

  .rounded-full {
    border-radius: 3.40282e38px;
  }

  .rounded-lg {
    border-radius: var(--radius);
  }

  .rounded-md {
    border-radius: calc(var(--radius)  - 2px);
  }

  .rounded-sm {
    border-radius: calc(var(--radius)  - 4px);
  }

  .rounded-xl {
    border-radius: calc(var(--radius)  + 4px);
  }

  .rounded-xs {
    border-radius: var(--radius-xs);
  }

  .border {
    border-style: var(--tw-border-style);
    border-width: 1px;
  }

  .border-0 {
    border-style: var(--tw-border-style);
    border-width: 0;
  }

  .border-2 {
    border-style: var(--tw-border-style);
    border-width: 2px;
  }

  .border-4 {
    border-style: var(--tw-border-style);
    border-width: 4px;
  }

  .border-t {
    border-top-style: var(--tw-border-style);
    border-top-width: 1px;
  }

  .border-r {
    border-right-style: var(--tw-border-style);
    border-right-width: 1px;
  }

  .border-b {
    border-bottom-style: var(--tw-border-style);
    border-bottom-width: 1px;
  }

  .border-l-4 {
    border-left-style: var(--tw-border-style);
    border-left-width: 4px;
  }

  .border-dashed {
    --tw-border-style: dashed;
    border-style: dashed;
  }

  .border-none {
    --tw-border-style: none;
    border-style: none;
  }

  .border-\[\#00A651\]\/30 {
    border-color: oklab(63.4564% -.148962 .0819561 / .3);
  }

  .border-\[\#4F00BC\]\/30 {
    border-color: oklab(40.6684% .0718633 -.221738 / .3);
  }

  .border-\[\#009DD9\]\/30 {
    border-color: oklab(65.6716% -.0801208 -.1134 / .3);
  }

  .border-\[\#25D366\] {
    border-color: #25d366;
  }

  .border-\[\#34C759\] {
    border-color: #34c759;
  }

  .border-\[\#4285F4\] {
    border-color: #4285f4;
  }

  .border-\[\#4285F4\]\/30 {
    border-color: oklab(63.0386% -.0313976 -.177268 / .3);
  }

  .border-\[\#FF3B30\] {
    border-color: #ff3b30;
  }

  .border-\[\#FF6B00\]\/20 {
    border-color: oklab(70.2233% .141495 .14197 / .2);
  }

  .border-\[\#FF6B00\]\/30 {
    border-color: oklab(70.2233% .141495 .14197 / .3);
  }

  .border-\[\#FFD700\] {
    border-color: gold;
  }

  .border-\[\#FFD700\]\/20 {
    border-color: oklab(88.6771% -.0169252 .181398 / .2);
  }

  .border-\[\#FFD700\]\/30 {
    border-color: oklab(88.6771% -.0169252 .181398 / .3);
  }

  .border-border {
    border-color: var(--border);
  }

  .border-border\/50 {
    border-color: var(--border);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .border-border\/50 {
      border-color: color-mix(in oklab, var(--border) 50%, transparent);
    }
  }

  .border-destructive\/50 {
    border-color: var(--destructive);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .border-destructive\/50 {
      border-color: color-mix(in oklab, var(--destructive) 50%, transparent);
    }
  }

  .border-green-500\/30 {
    border-color: color-mix(in srgb, oklch(.723 .219 149.579) 30%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .border-green-500\/30 {
      border-color: color-mix(in oklab, var(--color-green-500) 30%, transparent);
    }
  }

  .border-input {
    border-color: var(--input);
  }

  .border-orange-500\/30 {
    border-color: color-mix(in srgb, oklch(.705 .213 47.604) 30%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .border-orange-500\/30 {
      border-color: color-mix(in oklab, var(--color-orange-500) 30%, transparent);
    }
  }

  .border-red-500 {
    border-color: var(--color-red-500);
  }

  .border-red-500\/30 {
    border-color: color-mix(in srgb, oklch(.637 .237 25.331) 30%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .border-red-500\/30 {
      border-color: color-mix(in oklab, var(--color-red-500) 30%, transparent);
    }
  }

  .border-transparent {
    border-color: #0000;
  }

  .border-yellow-500\/30 {
    border-color: color-mix(in srgb, oklch(.795 .184 86.047) 30%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .border-yellow-500\/30 {
      border-color: color-mix(in oklab, var(--color-yellow-500) 30%, transparent);
    }
  }

  .border-t-transparent {
    border-top-color: #0000;
  }

  .border-l-\[\#FF6B00\] {
    border-left-color: #ff6b00;
  }

  .border-l-green-500 {
    border-left-color: var(--color-green-500);
  }

  .border-l-red-500 {
    border-left-color: var(--color-red-500);
  }

  .bg-\[\#00A651\]\/10 {
    background-color: oklab(63.4564% -.148962 .0819561 / .1);
  }

  .bg-\[\#00A651\]\/20 {
    background-color: oklab(63.4564% -.148962 .0819561 / .2);
  }

  .bg-\[\#3A3A3C\] {
    background-color: #3a3a3c;
  }

  .bg-\[\#4CAF50\] {
    background-color: #4caf50;
  }

  .bg-\[\#4F00BC\] {
    background-color: #4f00bc;
  }

  .bg-\[\#4F00BC\]\/10 {
    background-color: oklab(40.6684% .0718633 -.221738 / .1);
  }

  .bg-\[\#4F00BC\]\/20 {
    background-color: oklab(40.6684% .0718633 -.221738 / .2);
  }

  .bg-\[\#009DD9\]\/20 {
    background-color: oklab(65.6716% -.0801208 -.1134 / .2);
  }

  .bg-\[\#25D366\] {
    background-color: #25d366;
  }

  .bg-\[\#34C759\] {
    background-color: #34c759;
  }

  .bg-\[\#34C759\]\/10 {
    background-color: oklab(73.0324% -.163837 .104601 / .1);
  }

  .bg-\[\#4285F4\]\/5 {
    background-color: oklab(63.0386% -.0313976 -.177268 / .05);
  }

  .bg-\[\#4285F4\]\/10 {
    background-color: oklab(63.0386% -.0313976 -.177268 / .1);
  }

  .bg-\[\#FF3B30\] {
    background-color: #ff3b30;
  }

  .bg-\[\#FF3B30\]\/10 {
    background-color: oklab(65.4215% .203696 .111332 / .1);
  }

  .bg-\[\#FF6B00\] {
    background-color: #ff6b00;
  }

  .bg-\[\#FF6B00\]\/10 {
    background-color: oklab(70.2233% .141495 .14197 / .1);
  }

  .bg-\[\#FF6B00\]\/20 {
    background-color: oklab(70.2233% .141495 .14197 / .2);
  }

  .bg-\[\#FFD700\] {
    background-color: gold;
  }

  .bg-\[\#FFD700\]\/10 {
    background-color: oklab(88.6771% -.0169252 .181398 / .1);
  }

  .bg-\[\#FFD700\]\/20 {
    background-color: oklab(88.6771% -.0169252 .181398 / .2);
  }

  .bg-\[\#d1d1d6\] {
    background-color: #d1d1d6;
  }

  .bg-accent {
    background-color: var(--accent);
  }

  .bg-background {
    background-color: var(--background);
  }

  .bg-background\/50 {
    background-color: var(--background);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-background\/50 {
      background-color: color-mix(in oklab, var(--background) 50%, transparent);
    }
  }

  .bg-black\/50 {
    background-color: #00000080;
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-black\/50 {
      background-color: color-mix(in oklab, var(--color-black) 50%, transparent);
    }
  }

  .bg-blue-500 {
    background-color: var(--color-blue-500);
  }

  .bg-blue-500\/20 {
    background-color: color-mix(in srgb, oklch(.623 .214 259.815) 20%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-blue-500\/20 {
      background-color: color-mix(in oklab, var(--color-blue-500) 20%, transparent);
    }
  }

  .bg-border {
    background-color: var(--border);
  }

  .bg-card {
    background-color: var(--card);
  }

  .bg-card\/50 {
    background-color: var(--card);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-card\/50 {
      background-color: color-mix(in oklab, var(--card) 50%, transparent);
    }
  }

  .bg-card\/80 {
    background-color: var(--card);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-card\/80 {
      background-color: color-mix(in oklab, var(--card) 80%, transparent);
    }
  }

  .bg-card\/95 {
    background-color: var(--card);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-card\/95 {
      background-color: color-mix(in oklab, var(--card) 95%, transparent);
    }
  }

  .bg-destructive {
    background-color: var(--destructive);
  }

  .bg-gray-500 {
    background-color: var(--color-gray-500);
  }

  .bg-green-500 {
    background-color: var(--color-green-500);
  }

  .bg-green-500\/10 {
    background-color: color-mix(in srgb, oklch(.723 .219 149.579) 10%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-green-500\/10 {
      background-color: color-mix(in oklab, var(--color-green-500) 10%, transparent);
    }
  }

  .bg-green-500\/20 {
    background-color: color-mix(in srgb, oklch(.723 .219 149.579) 20%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-green-500\/20 {
      background-color: color-mix(in oklab, var(--color-green-500) 20%, transparent);
    }
  }

  .bg-green-600 {
    background-color: var(--color-green-600);
  }

  .bg-input-background {
    background-color: var(--input-background);
  }

  .bg-muted {
    background-color: var(--muted);
  }

  .bg-muted\/30 {
    background-color: var(--muted);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-muted\/30 {
      background-color: color-mix(in oklab, var(--muted) 30%, transparent);
    }
  }

  .bg-muted\/50 {
    background-color: var(--muted);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-muted\/50 {
      background-color: color-mix(in oklab, var(--muted) 50%, transparent);
    }
  }

  .bg-orange-500\/10 {
    background-color: color-mix(in srgb, oklch(.705 .213 47.604) 10%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-orange-500\/10 {
      background-color: color-mix(in oklab, var(--color-orange-500) 10%, transparent);
    }
  }

  .bg-orange-500\/20 {
    background-color: color-mix(in srgb, oklch(.705 .213 47.604) 20%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-orange-500\/20 {
      background-color: color-mix(in oklab, var(--color-orange-500) 20%, transparent);
    }
  }

  .bg-popover {
    background-color: var(--popover);
  }

  .bg-primary {
    background-color: var(--primary);
  }

  .bg-purple-500 {
    background-color: var(--color-purple-500);
  }

  .bg-red-500 {
    background-color: var(--color-red-500);
  }

  .bg-red-500\/10 {
    background-color: color-mix(in srgb, oklch(.637 .237 25.331) 10%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-red-500\/10 {
      background-color: color-mix(in oklab, var(--color-red-500) 10%, transparent);
    }
  }

  .bg-red-500\/20 {
    background-color: color-mix(in srgb, oklch(.637 .237 25.331) 20%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-red-500\/20 {
      background-color: color-mix(in oklab, var(--color-red-500) 20%, transparent);
    }
  }

  .bg-secondary {
    background-color: var(--secondary);
  }

  .bg-transparent {
    background-color: #0000;
  }

  .bg-white {
    background-color: var(--color-white);
  }

  .bg-white\/10 {
    background-color: #ffffff1a;
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-white\/10 {
      background-color: color-mix(in oklab, var(--color-white) 10%, transparent);
    }
  }

  .bg-yellow-500\/10 {
    background-color: color-mix(in srgb, oklch(.795 .184 86.047) 10%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-yellow-500\/10 {
      background-color: color-mix(in oklab, var(--color-yellow-500) 10%, transparent);
    }
  }

  .bg-yellow-500\/20 {
    background-color: color-mix(in srgb, oklch(.795 .184 86.047) 20%, transparent);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .bg-yellow-500\/20 {
      background-color: color-mix(in oklab, var(--color-yellow-500) 20%, transparent);
    }
  }

  .bg-gradient-to-br {
    --tw-gradient-position: to bottom right in oklab;
    background-image: linear-gradient(var(--tw-gradient-stops));
  }

  .bg-gradient-to-r {
    --tw-gradient-position: to right in oklab;
    background-image: linear-gradient(var(--tw-gradient-stops));
  }

  .from-\[\#4F00BC\] {
    --tw-gradient-from: #4f00bc;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .from-\[\#4285F4\] {
    --tw-gradient-from: #4285f4;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .from-\[\#FF6B00\] {
    --tw-gradient-from: #ff6b00;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .from-\[\#FFD700\] {
    --tw-gradient-from: gold;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .from-\[\#FFD700\]\/10 {
    --tw-gradient-from: oklab(88.6771% -.0169252 .181398 / .1);
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .from-\[\#FFD700\]\/20 {
    --tw-gradient-from: oklab(88.6771% -.0169252 .181398 / .2);
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .to-\[\#2D006B\] {
    --tw-gradient-to: #2d006b;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .to-\[\#34A853\] {
    --tw-gradient-to: #34a853;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .to-\[\#FF6B00\] {
    --tw-gradient-to: #ff6b00;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .to-\[\#FF6B00\]\/10 {
    --tw-gradient-to: oklab(70.2233% .141495 .14197 / .1);
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .to-\[\#FF6B00\]\/20 {
    --tw-gradient-to: oklab(70.2233% .141495 .14197 / .2);
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .to-\[\#FF8800\] {
    --tw-gradient-to: #f80;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .to-\[\#FFA500\] {
    --tw-gradient-to: orange;
    --tw-gradient-stops: var(--tw-gradient-via-stops, var(--tw-gradient-position), var(--tw-gradient-from) var(--tw-gradient-from-position), var(--tw-gradient-to) var(--tw-gradient-to-position));
  }

  .fill-\[\#FFD700\] {
    fill: gold;
  }

  .fill-\[\#FFD700\]\/50 {
    fill: oklab(88.6771% -.0169252 .181398 / .5);
  }

  .object-cover {
    object-fit: cover;
  }

  .p-0 {
    padding: calc(var(--spacing) * 0);
  }

  .p-1 {
    padding: calc(var(--spacing) * 1);
  }

  .p-1\.5 {
    padding: calc(var(--spacing) * 1.5);
  }

  .p-2 {
    padding: calc(var(--spacing) * 2);
  }

  .p-3 {
    padding: calc(var(--spacing) * 3);
  }

  .p-4 {
    padding: calc(var(--spacing) * 4);
  }

  .p-5 {
    padding: calc(var(--spacing) * 5);
  }

  .p-6 {
    padding: calc(var(--spacing) * 6);
  }

  .p-8 {
    padding: calc(var(--spacing) * 8);
  }

  .p-12 {
    padding: calc(var(--spacing) * 12);
  }

  .p-\[3px\] {
    padding: 3px;
  }

  .px-1\.5 {
    padding-inline: calc(var(--spacing) * 1.5);
  }

  .px-2 {
    padding-inline: calc(var(--spacing) * 2);
  }

  .px-3 {
    padding-inline: calc(var(--spacing) * 3);
  }

  .px-4 {
    padding-inline: calc(var(--spacing) * 4);
  }

  .px-6 {
    padding-inline: calc(var(--spacing) * 6);
  }

  .px-8 {
    padding-inline: calc(var(--spacing) * 8);
  }

  .py-0\.5 {
    padding-block: calc(var(--spacing) * .5);
  }

  .py-1 {
    padding-block: calc(var(--spacing) * 1);
  }

  .py-1\.5 {
    padding-block: calc(var(--spacing) * 1.5);
  }

  .py-2 {
    padding-block: calc(var(--spacing) * 2);
  }

  .py-3 {
    padding-block: calc(var(--spacing) * 3);
  }

  .py-4 {
    padding-block: calc(var(--spacing) * 4);
  }

  .py-6 {
    padding-block: calc(var(--spacing) * 6);
  }

  .py-8 {
    padding-block: calc(var(--spacing) * 8);
  }

  .py-12 {
    padding-block: calc(var(--spacing) * 12);
  }

  .py-16 {
    padding-block: calc(var(--spacing) * 16);
  }

  .pt-1 {
    padding-top: calc(var(--spacing) * 1);
  }

  .pt-2 {
    padding-top: calc(var(--spacing) * 2);
  }

  .pt-4 {
    padding-top: calc(var(--spacing) * 4);
  }

  .pt-6 {
    padding-top: calc(var(--spacing) * 6);
  }

  .pr-8 {
    padding-right: calc(var(--spacing) * 8);
  }

  .pr-10 {
    padding-right: calc(var(--spacing) * 10);
  }

  .pr-12 {
    padding-right: calc(var(--spacing) * 12);
  }

  .pb-2 {
    padding-bottom: calc(var(--spacing) * 2);
  }

  .pb-6 {
    padding-bottom: calc(var(--spacing) * 6);
  }

  .pl-2 {
    padding-left: calc(var(--spacing) * 2);
  }

  .pl-10 {
    padding-left: calc(var(--spacing) * 10);
  }

  .text-center {
    text-align: center;
  }

  .text-left {
    text-align: left;
  }

  .text-right {
    text-align: right;
  }

  .align-middle {
    vertical-align: middle;
  }

  .text-2xl {
    font-size: var(--text-2xl);
    line-height: var(--tw-leading, var(--text-2xl--line-height));
  }

  .text-3xl {
    font-size: var(--text-3xl);
    line-height: var(--tw-leading, var(--text-3xl--line-height));
  }

  .text-4xl {
    font-size: var(--text-4xl);
    line-height: var(--tw-leading, var(--text-4xl--line-height));
  }

  .text-5xl {
    font-size: var(--text-5xl);
    line-height: var(--tw-leading, var(--text-5xl--line-height));
  }

  .text-base {
    font-size: var(--text-base);
    line-height: var(--tw-leading, var(--text-base--line-height));
  }

  .text-lg {
    font-size: var(--text-lg);
    line-height: var(--tw-leading, var(--text-lg--line-height));
  }

  .text-sm {
    font-size: var(--text-sm);
    line-height: var(--tw-leading, var(--text-sm--line-height));
  }

  .text-xl {
    font-size: var(--text-xl);
    line-height: var(--tw-leading, var(--text-xl--line-height));
  }

  .text-xs {
    font-size: var(--text-xs);
    line-height: var(--tw-leading, var(--text-xs--line-height));
  }

  .text-\[0\.8rem\] {
    font-size: .8rem;
  }

  .text-\[10px\] {
    font-size: 10px;
  }

  .leading-none {
    --tw-leading: 1;
    line-height: 1;
  }

  .leading-tight {
    --tw-leading: var(--leading-tight);
    line-height: var(--leading-tight);
  }

  .font-bold {
    --tw-font-weight: var(--font-weight-bold);
    font-weight: var(--font-weight-bold);
  }

  .font-medium {
    --tw-font-weight: var(--font-weight-medium);
    font-weight: var(--font-weight-medium);
  }

  .font-normal {
    --tw-font-weight: var(--font-weight-normal);
    font-weight: var(--font-weight-normal);
  }

  .font-semibold {
    --tw-font-weight: var(--font-weight-semibold);
    font-weight: var(--font-weight-semibold);
  }

  .tracking-tight {
    --tw-tracking: var(--tracking-tight);
    letter-spacing: var(--tracking-tight);
  }

  .tracking-wider {
    --tw-tracking: var(--tracking-wider);
    letter-spacing: var(--tracking-wider);
  }

  .tracking-widest {
    --tw-tracking: var(--tracking-widest);
    letter-spacing: var(--tracking-widest);
  }

  .break-words {
    overflow-wrap: break-word;
  }

  .break-all {
    word-break: break-all;
  }

  .whitespace-normal {
    white-space: normal;
  }

  .whitespace-nowrap {
    white-space: nowrap;
  }

  .text-\[\#00A651\] {
    color: #00a651;
  }

  .text-\[\#4F00BC\] {
    color: #4f00bc;
  }

  .text-\[\#009DD9\] {
    color: #009dd9;
  }

  .text-\[\#25D366\] {
    color: #25d366;
  }

  .text-\[\#34C759\] {
    color: #34c759;
  }

  .text-\[\#121212\] {
    color: #121212;
  }

  .text-\[\#121221\] {
    color: #121221;
  }

  .text-\[\#FF3B30\] {
    color: #ff3b30;
  }

  .text-\[\#FF6B00\] {
    color: #ff6b00;
  }

  .text-\[\#FFD700\] {
    color: gold;
  }

  .text-accent-foreground {
    color: var(--accent-foreground);
  }

  .text-black {
    color: var(--color-black);
  }

  .text-blue-400 {
    color: var(--color-blue-400);
  }

  .text-card-foreground {
    color: var(--card-foreground);
  }

  .text-destructive {
    color: var(--destructive);
  }

  .text-foreground {
    color: var(--foreground);
  }

  .text-green-500 {
    color: var(--color-green-500);
  }

  .text-green-600 {
    color: var(--color-green-600);
  }

  .text-muted {
    color: var(--muted);
  }

  .text-muted-foreground {
    color: var(--muted-foreground);
  }

  .text-orange-400 {
    color: var(--color-orange-400);
  }

  .text-orange-500 {
    color: var(--color-orange-500);
  }

  .text-popover-foreground {
    color: var(--popover-foreground);
  }

  .text-primary {
    color: var(--primary);
  }

  .text-primary-foreground {
    color: var(--primary-foreground);
  }

  .text-red-400 {
    color: var(--color-red-400);
  }

  .text-red-500 {
    color: var(--color-red-500);
  }

  .text-secondary-foreground {
    color: var(--secondary-foreground);
  }

  .text-white {
    color: var(--color-white);
  }

  .text-white\/80 {
    color: #fffc;
  }

  @supports (color: color-mix(in lab, red, red)) {
    .text-white\/80 {
      color: color-mix(in oklab, var(--color-white) 80%, transparent);
    }
  }

  .text-white\/90 {
    color: #ffffffe6;
  }

  @supports (color: color-mix(in lab, red, red)) {
    .text-white\/90 {
      color: color-mix(in oklab, var(--color-white) 90%, transparent);
    }
  }

  .text-yellow-400 {
    color: var(--color-yellow-400);
  }

  .text-yellow-500 {
    color: var(--color-yellow-500);
  }

  .capitalize {
    text-transform: capitalize;
  }

  .uppercase {
    text-transform: uppercase;
  }

  .underline-offset-4 {
    text-underline-offset: 4px;
  }

  .opacity-10 {
    opacity: .1;
  }

  .opacity-50 {
    opacity: .5;
  }

  .opacity-70 {
    opacity: .7;
  }

  .shadow-2xl {
    --tw-shadow: 0 25px 50px -12px var(--tw-shadow-color, #00000040);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .shadow-lg {
    --tw-shadow: 0 10px 15px -3px var(--tw-shadow-color, #0000001a), 0 4px 6px -4px var(--tw-shadow-color, #0000001a);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .shadow-md {
    --tw-shadow: 0 4px 6px -1px var(--tw-shadow-color, #0000001a), 0 2px 4px -2px var(--tw-shadow-color, #0000001a);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .shadow-sm {
    --tw-shadow: 0 1px 3px 0 var(--tw-shadow-color, #0000001a), 0 1px 2px -1px var(--tw-shadow-color, #0000001a);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .ring-0 {
    --tw-ring-shadow: var(--tw-ring-inset, ) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .ring-2 {
    --tw-ring-shadow: var(--tw-ring-inset, ) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .ring-4 {
    --tw-ring-shadow: var(--tw-ring-inset, ) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .ring-\[\#FFD700\]\/20 {
    --tw-ring-color: oklab(88.6771% -.0169252 .181398 / .2);
  }

  .ring-offset-2 {
    --tw-ring-offset-width: 2px;
    --tw-ring-offset-shadow: var(--tw-ring-inset, ) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  }

  .ring-offset-background {
    --tw-ring-offset-color: var(--background);
  }

  .outline-hidden {
    --tw-outline-style: none;
    outline-style: none;
  }

  @media (forced-colors: active) {
    .outline-hidden {
      outline-offset: 2px;
      outline: 2px solid #0000;
    }
  }

  .outline {
    outline-style: var(--tw-outline-style);
    outline-width: 1px;
  }

  .blur {
    --tw-blur: blur(8px);
    filter: var(--tw-blur, ) var(--tw-brightness, ) var(--tw-contrast, ) var(--tw-grayscale, ) var(--tw-hue-rotate, ) var(--tw-invert, ) var(--tw-saturate, ) var(--tw-sepia, ) var(--tw-drop-shadow, );
  }

  .filter {
    filter: var(--tw-blur, ) var(--tw-brightness, ) var(--tw-contrast, ) var(--tw-grayscale, ) var(--tw-hue-rotate, ) var(--tw-invert, ) var(--tw-saturate, ) var(--tw-sepia, ) var(--tw-drop-shadow, );
  }

  .backdrop-blur {
    --tw-backdrop-blur: blur(8px);
    -webkit-backdrop-filter: var(--tw-backdrop-blur, ) var(--tw-backdrop-brightness, ) var(--tw-backdrop-contrast, ) var(--tw-backdrop-grayscale, ) var(--tw-backdrop-hue-rotate, ) var(--tw-backdrop-invert, ) var(--tw-backdrop-opacity, ) var(--tw-backdrop-saturate, ) var(--tw-backdrop-sepia, );
    backdrop-filter: var(--tw-backdrop-blur, ) var(--tw-backdrop-brightness, ) var(--tw-backdrop-contrast, ) var(--tw-backdrop-grayscale, ) var(--tw-backdrop-hue-rotate, ) var(--tw-backdrop-invert, ) var(--tw-backdrop-opacity, ) var(--tw-backdrop-saturate, ) var(--tw-backdrop-sepia, );
  }

  .backdrop-blur-sm {
    --tw-backdrop-blur: blur(var(--blur-sm));
    -webkit-backdrop-filter: var(--tw-backdrop-blur, ) var(--tw-backdrop-brightness, ) var(--tw-backdrop-contrast, ) var(--tw-backdrop-grayscale, ) var(--tw-backdrop-hue-rotate, ) var(--tw-backdrop-invert, ) var(--tw-backdrop-opacity, ) var(--tw-backdrop-saturate, ) var(--tw-backdrop-sepia, );
    backdrop-filter: var(--tw-backdrop-blur, ) var(--tw-backdrop-brightness, ) var(--tw-backdrop-contrast, ) var(--tw-backdrop-grayscale, ) var(--tw-backdrop-hue-rotate, ) var(--tw-backdrop-invert, ) var(--tw-backdrop-opacity, ) var(--tw-backdrop-saturate, ) var(--tw-backdrop-sepia, );
  }

  .backdrop-filter {
    -webkit-backdrop-filter: var(--tw-backdrop-blur, ) var(--tw-backdrop-brightness, ) var(--tw-backdrop-contrast, ) var(--tw-backdrop-grayscale, ) var(--tw-backdrop-hue-rotate, ) var(--tw-backdrop-invert, ) var(--tw-backdrop-opacity, ) var(--tw-backdrop-saturate, ) var(--tw-backdrop-sepia, );
    backdrop-filter: var(--tw-backdrop-blur, ) var(--tw-backdrop-brightness, ) var(--tw-backdrop-contrast, ) var(--tw-backdrop-grayscale, ) var(--tw-backdrop-hue-rotate, ) var(--tw-backdrop-invert, ) var(--tw-backdrop-opacity, ) var(--tw-backdrop-saturate, ) var(--tw-backdrop-sepia, );
  }

  .transition {
    transition-property: color, background-color, border-color, outline-color, text-decoration-color, fill, stroke, --tw-gradient-from, --tw-gradient-via, --tw-gradient-to, opacity, box-shadow, transform, translate, scale, rotate, filter, -webkit-backdrop-filter, backdrop-filter;
    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
    transition-duration: var(--tw-duration, var(--default-transition-duration));
  }

  .transition-\[color\,box-shadow\] {
    transition-property: color, box-shadow;
    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
    transition-duration: var(--tw-duration, var(--default-transition-duration));
  }

  .transition-all {
    transition-property: all;
    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
    transition-duration: var(--tw-duration, var(--default-transition-duration));
  }

  .transition-colors {
    transition-property: color, background-color, border-color, outline-color, text-decoration-color, fill, stroke, --tw-gradient-from, --tw-gradient-via, --tw-gradient-to;
    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
    transition-duration: var(--tw-duration, var(--default-transition-duration));
  }

  .transition-opacity {
    transition-property: opacity;
    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
    transition-duration: var(--tw-duration, var(--default-transition-duration));
  }

  .transition-shadow {
    transition-property: box-shadow;
    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
    transition-duration: var(--tw-duration, var(--default-transition-duration));
  }

  .transition-transform {
    transition-property: transform, translate, scale, rotate;
    transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
    transition-duration: var(--tw-duration, var(--default-transition-duration));
  }

  .duration-200 {
    --tw-duration: .2s;
    transition-duration: .2s;
  }

  .duration-300 {
    --tw-duration: .3s;
    transition-duration: .3s;
  }

  .ease-in-out {
    --tw-ease: var(--ease-in-out);
    transition-timing-function: var(--ease-in-out);
  }

  .outline-none {
    --tw-outline-style: none;
    outline-style: none;
  }

  .select-none {
    -webkit-user-select: none;
    user-select: none;
  }

  @media (hover: hover) {
    .group-hover\:opacity-20:is(:where(.group):hover *) {
      opacity: .2;
    }
  }

  @media (hover: hover) {
    .group-hover\:shadow-lg:is(:where(.group):hover *) {
      --tw-shadow: 0 10px 15px -3px var(--tw-shadow-color, #0000001a), 0 4px 6px -4px var(--tw-shadow-color, #0000001a);
      box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
    }
  }

  .group-data-\[disabled\=true\]\:pointer-events-none:is(:where(.group)[data-disabled="true"] *) {
    pointer-events: none;
  }

  .group-data-\[disabled\=true\]\:opacity-50:is(:where(.group)[data-disabled="true"] *) {
    opacity: .5;
  }

  .peer-disabled\:cursor-not-allowed:is(:where(.peer):disabled ~ *) {
    cursor: not-allowed;
  }

  .peer-disabled\:opacity-50:is(:where(.peer):disabled ~ *) {
    opacity: .5;
  }

  .selection\:bg-primary ::selection, .selection\:bg-primary::selection {
    background-color: var(--primary);
  }

  .selection\:text-primary-foreground ::selection, .selection\:text-primary-foreground::selection {
    color: var(--primary-foreground);
  }

  .file\:inline-flex::file-selector-button {
    display: inline-flex;
  }

  .file\:h-7::file-selector-button {
    height: calc(var(--spacing) * 7);
  }

  .file\:border-0::file-selector-button {
    border-style: var(--tw-border-style);
    border-width: 0;
  }

  .file\:bg-transparent::file-selector-button {
    background-color: #0000;
  }

  .file\:text-sm::file-selector-button {
    font-size: var(--text-sm);
    line-height: var(--tw-leading, var(--text-sm--line-height));
  }

  .file\:font-medium::file-selector-button {
    --tw-font-weight: var(--font-weight-medium);
    font-weight: var(--font-weight-medium);
  }

  .file\:text-foreground::file-selector-button {
    color: var(--foreground);
  }

  .placeholder\:text-muted-foreground::placeholder {
    color: var(--muted-foreground);
  }

  .last\:border-0:last-child {
    border-style: var(--tw-border-style);
    border-width: 0;
  }

  .focus-within\:relative:focus-within {
    position: relative;
  }

  .focus-within\:z-20:focus-within {
    z-index: 20;
  }

  @media (hover: hover) {
    .hover\:border-\[\#4285F4\]\/50:hover {
      border-color: oklab(63.0386% -.0313976 -.177268 / .5);
    }
  }

  @media (hover: hover) {
    .hover\:border-\[\#FFD700\]:hover {
      border-color: gold;
    }
  }

  @media (hover: hover) {
    .hover\:border-\[\#FFD700\]\/50:hover {
      border-color: oklab(88.6771% -.0169252 .181398 / .5);
    }
  }

  @media (hover: hover) {
    .hover\:border-green-500:hover {
      border-color: var(--color-green-500);
    }
  }

  @media (hover: hover) {
    .hover\:border-red-500:hover {
      border-color: var(--color-red-500);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#25D366\]\/10:hover {
      background-color: oklab(76.0953% -.174012 .10152 / .1);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#25D366\]\/90:hover {
      background-color: oklab(76.0953% -.174012 .10152 / .9);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#34C759\]\/10:hover {
      background-color: oklab(73.0324% -.163837 .104601 / .1);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#34C759\]\/90:hover {
      background-color: oklab(73.0324% -.163837 .104601 / .9);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#FF3B30\]:hover {
      background-color: #ff3b30;
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#FF3B30\]\/10:hover {
      background-color: oklab(65.4215% .203696 .111332 / .1);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#FF3B30\]\/90:hover {
      background-color: oklab(65.4215% .203696 .111332 / .9);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#FF6B00\]\/90:hover {
      background-color: oklab(70.2233% .141495 .14197 / .9);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#FFD700\]\/5:hover {
      background-color: oklab(88.6771% -.0169252 .181398 / .05);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#FFD700\]\/10:hover {
      background-color: oklab(88.6771% -.0169252 .181398 / .1);
    }
  }

  @media (hover: hover) {
    .hover\:bg-\[\#FFD700\]\/90:hover {
      background-color: oklab(88.6771% -.0169252 .181398 / .9);
    }
  }

  @media (hover: hover) {
    .hover\:bg-accent:hover {
      background-color: var(--accent);
    }
  }

  @media (hover: hover) {
    .hover\:bg-accent\/10:hover {
      background-color: var(--accent);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-accent\/10:hover {
        background-color: color-mix(in oklab, var(--accent) 10%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-accent\/30:hover {
      background-color: var(--accent);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-accent\/30:hover {
        background-color: color-mix(in oklab, var(--accent) 30%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-accent\/50:hover {
      background-color: var(--accent);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-accent\/50:hover {
        background-color: color-mix(in oklab, var(--accent) 50%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-blue-600:hover {
      background-color: var(--color-blue-600);
    }
  }

  @media (hover: hover) {
    .hover\:bg-destructive\/10:hover {
      background-color: var(--destructive);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-destructive\/10:hover {
        background-color: color-mix(in oklab, var(--destructive) 10%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-destructive\/90:hover {
      background-color: var(--destructive);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-destructive\/90:hover {
        background-color: color-mix(in oklab, var(--destructive) 90%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-gray-600:hover {
      background-color: var(--color-gray-600);
    }
  }

  @media (hover: hover) {
    .hover\:bg-green-500\/10:hover {
      background-color: color-mix(in srgb, oklch(.723 .219 149.579) 10%, transparent);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-green-500\/10:hover {
        background-color: color-mix(in oklab, var(--color-green-500) 10%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-green-600:hover {
      background-color: var(--color-green-600);
    }
  }

  @media (hover: hover) {
    .hover\:bg-green-700:hover {
      background-color: var(--color-green-700);
    }
  }

  @media (hover: hover) {
    .hover\:bg-muted-foreground\/20:hover {
      background-color: var(--muted-foreground);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-muted-foreground\/20:hover {
        background-color: color-mix(in oklab, var(--muted-foreground) 20%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-muted\/30:hover {
      background-color: var(--muted);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-muted\/30:hover {
        background-color: color-mix(in oklab, var(--muted) 30%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-muted\/50:hover {
      background-color: var(--muted);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-muted\/50:hover {
        background-color: color-mix(in oklab, var(--muted) 50%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-muted\/80:hover {
      background-color: var(--muted);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-muted\/80:hover {
        background-color: color-mix(in oklab, var(--muted) 80%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-primary:hover {
      background-color: var(--primary);
    }
  }

  @media (hover: hover) {
    .hover\:bg-primary\/90:hover {
      background-color: var(--primary);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-primary\/90:hover {
        background-color: color-mix(in oklab, var(--primary) 90%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-purple-600:hover {
      background-color: var(--color-purple-600);
    }
  }

  @media (hover: hover) {
    .hover\:bg-red-500\/10:hover {
      background-color: color-mix(in srgb, oklch(.637 .237 25.331) 10%, transparent);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-red-500\/10:hover {
        background-color: color-mix(in oklab, var(--color-red-500) 10%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:bg-red-600:hover {
      background-color: var(--color-red-600);
    }
  }

  @media (hover: hover) {
    .hover\:bg-secondary\/80:hover {
      background-color: var(--secondary);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:bg-secondary\/80:hover {
        background-color: color-mix(in oklab, var(--secondary) 80%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:text-\[\#FFD700\]:hover {
      color: gold;
    }
  }

  @media (hover: hover) {
    .hover\:text-accent-foreground:hover {
      color: var(--accent-foreground);
    }
  }

  @media (hover: hover) {
    .hover\:text-destructive:hover {
      color: var(--destructive);
    }
  }

  @media (hover: hover) {
    .hover\:text-foreground:hover {
      color: var(--foreground);
    }
  }

  @media (hover: hover) {
    .hover\:text-primary-foreground:hover {
      color: var(--primary-foreground);
    }
  }

  @media (hover: hover) {
    .hover\:text-white:hover {
      color: var(--color-white);
    }
  }

  @media (hover: hover) {
    .hover\:underline:hover {
      text-decoration-line: underline;
    }
  }

  @media (hover: hover) {
    .hover\:opacity-80:hover {
      opacity: .8;
    }
  }

  @media (hover: hover) {
    .hover\:opacity-100:hover {
      opacity: 1;
    }
  }

  @media (hover: hover) {
    .hover\:shadow-lg:hover {
      --tw-shadow: 0 10px 15px -3px var(--tw-shadow-color, #0000001a), 0 4px 6px -4px var(--tw-shadow-color, #0000001a);
      box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
    }
  }

  @media (hover: hover) {
    .hover\:shadow-xl:hover {
      --tw-shadow: 0 20px 25px -5px var(--tw-shadow-color, #0000001a), 0 8px 10px -6px var(--tw-shadow-color, #0000001a);
      box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
    }
  }

  @media (hover: hover) {
    .hover\:shadow-\[\#4285F4\]\/40:hover {
      --tw-shadow-color: #4285f466;
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:shadow-\[\#4285F4\]\/40:hover {
        --tw-shadow-color: color-mix(in oklab, oklab(63.0386% -.0313976 -.177268 / .4) var(--tw-shadow-alpha), transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:shadow-\[\#FFD700\]\/30:hover {
      --tw-shadow-color: #ffd7004d;
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:shadow-\[\#FFD700\]\/30:hover {
        --tw-shadow-color: color-mix(in oklab, oklab(88.6771% -.0169252 .181398 / .3) var(--tw-shadow-alpha), transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:shadow-\[\#FFD700\]\/40:hover {
      --tw-shadow-color: #ffd70066;
    }

    @supports (color: color-mix(in lab, red, red)) {
      .hover\:shadow-\[\#FFD700\]\/40:hover {
        --tw-shadow-color: color-mix(in oklab, oklab(88.6771% -.0169252 .181398 / .4) var(--tw-shadow-alpha), transparent);
      }
    }
  }

  @media (hover: hover) {
    .hover\:ring-\[\#FFD700\]\/40:hover {
      --tw-ring-color: oklab(88.6771% -.0169252 .181398 / .4);
    }
  }

  .focus\:border-\[\#FFD700\]:focus {
    border-color: gold;
  }

  .focus\:bg-accent:focus {
    background-color: var(--accent);
  }

  .focus\:bg-primary:focus {
    background-color: var(--primary);
  }

  .focus\:text-accent-foreground:focus {
    color: var(--accent-foreground);
  }

  .focus\:text-primary-foreground:focus {
    color: var(--primary-foreground);
  }

  .focus\:ring-2:focus {
    --tw-ring-shadow: var(--tw-ring-inset, ) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .focus\:ring-\[\#FFD700\]\/20:focus {
    --tw-ring-color: oklab(88.6771% -.0169252 .181398 / .2);
  }

  .focus\:ring-ring:focus {
    --tw-ring-color: var(--ring);
  }

  .focus\:ring-offset-2:focus {
    --tw-ring-offset-width: 2px;
    --tw-ring-offset-shadow: var(--tw-ring-inset, ) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  }

  .focus\:outline-hidden:focus {
    --tw-outline-style: none;
    outline-style: none;
  }

  @media (forced-colors: active) {
    .focus\:outline-hidden:focus {
      outline-offset: 2px;
      outline: 2px solid #0000;
    }
  }

  .focus-visible\:border-ring:focus-visible {
    border-color: var(--ring);
  }

  .focus-visible\:ring-\[3px\]:focus-visible {
    --tw-ring-shadow: var(--tw-ring-inset, ) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);
    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  }

  .focus-visible\:ring-destructive\/20:focus-visible {
    --tw-ring-color: var(--destructive);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .focus-visible\:ring-destructive\/20:focus-visible {
      --tw-ring-color: color-mix(in oklab, var(--destructive) 20%, transparent);
    }
  }

  .focus-visible\:ring-ring\/50:focus-visible {
    --tw-ring-color: var(--ring);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .focus-visible\:ring-ring\/50:focus-visible {
      --tw-ring-color: color-mix(in oklab, var(--ring) 50%, transparent);
    }
  }

  .focus-visible\:outline-1:focus-visible {
    outline-style: var(--tw-outline-style);
    outline-width: 1px;
  }

  .focus-visible\:outline-ring:focus-visible {
    outline-color: var(--ring);
  }

  .disabled\:pointer-events-none:disabled {
    pointer-events: none;
  }

  .disabled\:cursor-not-allowed:disabled {
    cursor: not-allowed;
  }

  .disabled\:opacity-50:disabled {
    opacity: .5;
  }

  .has-data-\[slot\=card-action\]\:grid-cols-\[1fr_auto\]:has([data-slot="card-action"]) {
    grid-template-columns: 1fr auto;
  }

  .has-\[\>svg\]\:grid-cols-\[calc\(var\(--spacing\)\*4\)_1fr\]:has( > svg) {
    grid-template-columns: calc(var(--spacing) * 4) 1fr;
  }

  .has-\[\>svg\]\:gap-x-3:has( > svg) {
    column-gap: calc(var(--spacing) * 3);
  }

  .has-\[\>svg\]\:px-2\.5:has( > svg) {
    padding-inline: calc(var(--spacing) * 2.5);
  }

  .has-\[\>svg\]\:px-3:has( > svg) {
    padding-inline: calc(var(--spacing) * 3);
  }

  .has-\[\>svg\]\:px-4:has( > svg) {
    padding-inline: calc(var(--spacing) * 4);
  }

  .aria-invalid\:border-destructive[aria-invalid="true"] {
    border-color: var(--destructive);
  }

  .aria-invalid\:ring-destructive\/20[aria-invalid="true"] {
    --tw-ring-color: var(--destructive);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .aria-invalid\:ring-destructive\/20[aria-invalid="true"] {
      --tw-ring-color: color-mix(in oklab, var(--destructive) 20%, transparent);
    }
  }

  .aria-selected\:bg-accent[aria-selected="true"] {
    background-color: var(--accent);
  }

  .aria-selected\:bg-primary[aria-selected="true"] {
    background-color: var(--primary);
  }

  .aria-selected\:text-accent-foreground[aria-selected="true"] {
    color: var(--accent-foreground);
  }

  .aria-selected\:text-muted-foreground[aria-selected="true"] {
    color: var(--muted-foreground);
  }

  .aria-selected\:text-primary-foreground[aria-selected="true"] {
    color: var(--primary-foreground);
  }

  .aria-selected\:opacity-100[aria-selected="true"] {
    opacity: 1;
  }

  .data-\[disabled\]\:pointer-events-none[data-disabled] {
    pointer-events: none;
  }

  .data-\[disabled\]\:opacity-50[data-disabled] {
    opacity: .5;
  }

  .data-\[orientation\=horizontal\]\:h-px[data-orientation="horizontal"] {
    height: 1px;
  }

  .data-\[orientation\=horizontal\]\:w-full[data-orientation="horizontal"] {
    width: 100%;
  }

  .data-\[orientation\=vertical\]\:h-full[data-orientation="vertical"] {
    height: 100%;
  }

  .data-\[orientation\=vertical\]\:w-px[data-orientation="vertical"] {
    width: 1px;
  }

  .data-\[placeholder\]\:text-muted-foreground[data-placeholder] {
    color: var(--muted-foreground);
  }

  .data-\[side\=bottom\]\:translate-y-1[data-side="bottom"] {
    --tw-translate-y: calc(var(--spacing) * 1);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .data-\[side\=bottom\]\:slide-in-from-top-2[data-side="bottom"] {
    --tw-enter-translate-y: calc(2 * var(--spacing) * -1);
  }

  .data-\[side\=left\]\:-translate-x-1[data-side="left"] {
    --tw-translate-x: calc(var(--spacing) * -1);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .data-\[side\=left\]\:slide-in-from-right-2[data-side="left"] {
    --tw-enter-translate-x: calc(2 * var(--spacing));
  }

  .data-\[side\=right\]\:translate-x-1[data-side="right"] {
    --tw-translate-x: calc(var(--spacing) * 1);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .data-\[side\=right\]\:slide-in-from-left-2[data-side="right"] {
    --tw-enter-translate-x: calc(2 * var(--spacing) * -1);
  }

  .data-\[side\=top\]\:-translate-y-1[data-side="top"] {
    --tw-translate-y: calc(var(--spacing) * -1);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .data-\[side\=top\]\:slide-in-from-bottom-2[data-side="top"] {
    --tw-enter-translate-y: calc(2 * var(--spacing));
  }

  .data-\[size\=default\]\:h-9[data-size="default"] {
    height: calc(var(--spacing) * 9);
  }

  .data-\[size\=sm\]\:h-8[data-size="sm"] {
    height: calc(var(--spacing) * 8);
  }

  :is(.\*\:data-\[slot\=alert-description\]\:text-destructive\/90 > *)[data-slot="alert-description"] {
    color: var(--destructive);
  }

  @supports (color: color-mix(in lab, red, red)) {
    :is(.\*\:data-\[slot\=alert-description\]\:text-destructive\/90 > *)[data-slot="alert-description"] {
      color: color-mix(in oklab, var(--destructive) 90%, transparent);
    }
  }

  :is(.\*\:data-\[slot\=select-value\]\:line-clamp-1 > *)[data-slot="select-value"] {
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    display: -webkit-box;
    overflow: hidden;
  }

  :is(.\*\:data-\[slot\=select-value\]\:flex > *)[data-slot="select-value"] {
    display: flex;
  }

  :is(.\*\:data-\[slot\=select-value\]\:items-center > *)[data-slot="select-value"] {
    align-items: center;
  }

  :is(.\*\:data-\[slot\=select-value\]\:gap-2 > *)[data-slot="select-value"] {
    gap: calc(var(--spacing) * 2);
  }

  .data-\[state\=active\]\:bg-card[data-state="active"] {
    background-color: var(--card);
  }

  .data-\[state\=checked\]\:translate-x-\[calc\(100\%-2px\)\][data-state="checked"] {
    --tw-translate-x: calc(100% - 2px);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .data-\[state\=checked\]\:bg-primary[data-state="checked"] {
    background-color: var(--primary);
  }

  .data-\[state\=closed\]\:animate-out[data-state="closed"] {
    animation: exit var(--tw-duration, .15s) var(--tw-ease, ease);
  }

  .data-\[state\=closed\]\:fade-out-0[data-state="closed"] {
    --tw-exit-opacity: 0;
  }

  .data-\[state\=closed\]\:zoom-out-95[data-state="closed"] {
    --tw-exit-scale: .95;
  }

  .data-\[state\=open\]\:animate-in[data-state="open"] {
    animation: enter var(--tw-duration, .15s) var(--tw-ease, ease);
  }

  .data-\[state\=open\]\:bg-accent[data-state="open"] {
    background-color: var(--accent);
  }

  .data-\[state\=open\]\:text-muted-foreground[data-state="open"] {
    color: var(--muted-foreground);
  }

  .data-\[state\=open\]\:fade-in-0[data-state="open"] {
    --tw-enter-opacity: 0;
  }

  .data-\[state\=open\]\:zoom-in-95[data-state="open"] {
    --tw-enter-scale: .95;
  }

  .data-\[state\=selected\]\:bg-muted[data-state="selected"] {
    background-color: var(--muted);
  }

  .data-\[state\=unchecked\]\:translate-x-0[data-state="unchecked"] {
    --tw-translate-x: calc(var(--spacing) * 0);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .data-\[state\=unchecked\]\:bg-switch-background[data-state="unchecked"] {
    background-color: var(--switch-background);
  }

  @supports ((-webkit-backdrop-filter: var(--tw)) or (backdrop-filter: var(--tw))) {
    .supports-\[backdrop-filter\]\:bg-card\/80 {
      background-color: var(--card);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .supports-\[backdrop-filter\]\:bg-card\/80 {
        background-color: color-mix(in oklab, var(--card) 80%, transparent);
      }
    }
  }

  @media (width >= 40rem) {
    .sm\:col-span-2 {
      grid-column: span 2 / span 2;
    }
  }

  @media (width >= 40rem) {
    .sm\:mx-0 {
      margin-inline: calc(var(--spacing) * 0);
    }
  }

  @media (width >= 40rem) {
    .sm\:mt-2 {
      margin-top: calc(var(--spacing) * 2);
    }
  }

  @media (width >= 40rem) {
    .sm\:mt-4 {
      margin-top: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 40rem) {
    .sm\:mt-6 {
      margin-top: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 40rem) {
    .sm\:mt-8 {
      margin-top: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 40rem) {
    .sm\:mr-2 {
      margin-right: calc(var(--spacing) * 2);
    }
  }

  @media (width >= 40rem) {
    .sm\:mb-1 {
      margin-bottom: calc(var(--spacing) * 1);
    }
  }

  @media (width >= 40rem) {
    .sm\:mb-3 {
      margin-bottom: calc(var(--spacing) * 3);
    }
  }

  @media (width >= 40rem) {
    .sm\:mb-4 {
      margin-bottom: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 40rem) {
    .sm\:mb-6 {
      margin-bottom: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 40rem) {
    .sm\:mb-8 {
      margin-bottom: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 40rem) {
    .sm\:mb-12 {
      margin-bottom: calc(var(--spacing) * 12);
    }
  }

  @media (width >= 40rem) {
    .sm\:grid {
      display: grid;
    }
  }

  @media (width >= 40rem) {
    .sm\:hidden {
      display: none;
    }
  }

  @media (width >= 40rem) {
    .sm\:inline {
      display: inline;
    }
  }

  @media (width >= 40rem) {
    .sm\:h-4 {
      height: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 40rem) {
    .sm\:h-5 {
      height: calc(var(--spacing) * 5);
    }
  }

  @media (width >= 40rem) {
    .sm\:h-6 {
      height: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 40rem) {
    .sm\:h-9 {
      height: calc(var(--spacing) * 9);
    }
  }

  @media (width >= 40rem) {
    .sm\:h-10 {
      height: calc(var(--spacing) * 10);
    }
  }

  @media (width >= 40rem) {
    .sm\:h-12 {
      height: calc(var(--spacing) * 12);
    }
  }

  @media (width >= 40rem) {
    .sm\:h-14 {
      height: calc(var(--spacing) * 14);
    }
  }

  @media (width >= 40rem) {
    .sm\:h-16 {
      height: calc(var(--spacing) * 16);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-4 {
      width: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-5 {
      width: calc(var(--spacing) * 5);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-6 {
      width: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-9 {
      width: calc(var(--spacing) * 9);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-10 {
      width: calc(var(--spacing) * 10);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-12 {
      width: calc(var(--spacing) * 12);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-16 {
      width: calc(var(--spacing) * 16);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-60 {
      width: calc(var(--spacing) * 60);
    }
  }

  @media (width >= 40rem) {
    .sm\:w-\[240px\] {
      width: 240px;
    }
  }

  @media (width >= 40rem) {
    .sm\:w-auto {
      width: auto;
    }
  }

  @media (width >= 40rem) {
    .sm\:w-full {
      width: 100%;
    }
  }

  @media (width >= 40rem) {
    .sm\:max-w-2xl {
      max-width: var(--container-2xl);
    }
  }

  @media (width >= 40rem) {
    .sm\:max-w-\[425px\] {
      max-width: 425px;
    }
  }

  @media (width >= 40rem) {
    .sm\:max-w-\[500px\] {
      max-width: 500px;
    }
  }

  @media (width >= 40rem) {
    .sm\:max-w-lg {
      max-width: var(--container-lg);
    }
  }

  @media (width >= 40rem) {
    .sm\:max-w-md {
      max-width: var(--container-md);
    }
  }

  @media (width >= 40rem) {
    .sm\:min-w-0 {
      min-width: calc(var(--spacing) * 0);
    }
  }

  @media (width >= 40rem) {
    .sm\:flex-none {
      flex: none;
    }
  }

  @media (width >= 40rem) {
    .sm\:grid-cols-2 {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  @media (width >= 40rem) {
    .sm\:grid-cols-3 {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }

  @media (width >= 40rem) {
    .sm\:grid-cols-4 {
      grid-template-columns: repeat(4, minmax(0, 1fr));
    }
  }

  @media (width >= 40rem) {
    .sm\:grid-cols-10 {
      grid-template-columns: repeat(10, minmax(0, 1fr));
    }
  }

  @media (width >= 40rem) {
    .sm\:flex-row {
      flex-direction: row;
    }
  }

  @media (width >= 40rem) {
    .sm\:flex-wrap {
      flex-wrap: wrap;
    }
  }

  @media (width >= 40rem) {
    .sm\:items-center {
      align-items: center;
    }
  }

  @media (width >= 40rem) {
    .sm\:justify-between {
      justify-content: space-between;
    }
  }

  @media (width >= 40rem) {
    .sm\:justify-end {
      justify-content: flex-end;
    }
  }

  @media (width >= 40rem) {
    .sm\:justify-start {
      justify-content: flex-start;
    }
  }

  @media (width >= 40rem) {
    .sm\:gap-1 {
      gap: calc(var(--spacing) * 1);
    }
  }

  @media (width >= 40rem) {
    .sm\:gap-2 {
      gap: calc(var(--spacing) * 2);
    }
  }

  @media (width >= 40rem) {
    .sm\:gap-3 {
      gap: calc(var(--spacing) * 3);
    }
  }

  @media (width >= 40rem) {
    .sm\:gap-4 {
      gap: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 40rem) {
    .sm\:gap-6 {
      gap: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 40rem) {
    :where(.sm\:space-y-6 > :not(:last-child)) {
      --tw-space-y-reverse: 0;
      margin-block-start: calc(calc(var(--spacing) * 6) * var(--tw-space-y-reverse));
      margin-block-end: calc(calc(var(--spacing) * 6) * calc(1 - var(--tw-space-y-reverse)));
    }
  }

  @media (width >= 40rem) {
    .sm\:p-2 {
      padding: calc(var(--spacing) * 2);
    }
  }

  @media (width >= 40rem) {
    .sm\:p-3 {
      padding: calc(var(--spacing) * 3);
    }
  }

  @media (width >= 40rem) {
    .sm\:p-4 {
      padding: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 40rem) {
    .sm\:p-6 {
      padding: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 40rem) {
    .sm\:p-8 {
      padding: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 40rem) {
    .sm\:px-0 {
      padding-inline: calc(var(--spacing) * 0);
    }
  }

  @media (width >= 40rem) {
    .sm\:px-3 {
      padding-inline: calc(var(--spacing) * 3);
    }
  }

  @media (width >= 40rem) {
    .sm\:px-4 {
      padding-inline: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 40rem) {
    .sm\:px-8 {
      padding-inline: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 40rem) {
    .sm\:py-1\.5 {
      padding-block: calc(var(--spacing) * 1.5);
    }
  }

  @media (width >= 40rem) {
    .sm\:py-2 {
      padding-block: calc(var(--spacing) * 2);
    }
  }

  @media (width >= 40rem) {
    .sm\:py-8 {
      padding-block: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 40rem) {
    .sm\:text-left {
      text-align: left;
    }
  }

  @media (width >= 40rem) {
    .sm\:text-2xl {
      font-size: var(--text-2xl);
      line-height: var(--tw-leading, var(--text-2xl--line-height));
    }
  }

  @media (width >= 40rem) {
    .sm\:text-3xl {
      font-size: var(--text-3xl);
      line-height: var(--tw-leading, var(--text-3xl--line-height));
    }
  }

  @media (width >= 40rem) {
    .sm\:text-4xl {
      font-size: var(--text-4xl);
      line-height: var(--tw-leading, var(--text-4xl--line-height));
    }
  }

  @media (width >= 40rem) {
    .sm\:text-base {
      font-size: var(--text-base);
      line-height: var(--tw-leading, var(--text-base--line-height));
    }
  }

  @media (width >= 40rem) {
    .sm\:text-lg {
      font-size: var(--text-lg);
      line-height: var(--tw-leading, var(--text-lg--line-height));
    }
  }

  @media (width >= 40rem) {
    .sm\:text-sm {
      font-size: var(--text-sm);
      line-height: var(--tw-leading, var(--text-sm--line-height));
    }
  }

  @media (width >= 40rem) {
    .sm\:text-xl {
      font-size: var(--text-xl);
      line-height: var(--tw-leading, var(--text-xl--line-height));
    }
  }

  @media (width >= 40rem) {
    .sm\:text-xs {
      font-size: var(--text-xs);
      line-height: var(--tw-leading, var(--text-xs--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:mb-8 {
      margin-bottom: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 48rem) {
    .md\:mb-16 {
      margin-bottom: calc(var(--spacing) * 16);
    }
  }

  @media (width >= 48rem) {
    .md\:block {
      display: block;
    }
  }

  @media (width >= 48rem) {
    .md\:hidden {
      display: none;
    }
  }

  @media (width >= 48rem) {
    .md\:table-cell {
      display: table-cell;
    }
  }

  @media (width >= 48rem) {
    .md\:h-6 {
      height: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 48rem) {
    .md\:h-\[300px\] {
      height: 300px;
    }
  }

  @media (width >= 48rem) {
    .md\:w-6 {
      width: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 48rem) {
    .md\:w-80 {
      width: calc(var(--spacing) * 80);
    }
  }

  @media (width >= 48rem) {
    .md\:grid-cols-2 {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  @media (width >= 48rem) {
    .md\:grid-cols-3 {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }

  @media (width >= 48rem) {
    .md\:grid-cols-4 {
      grid-template-columns: repeat(4, minmax(0, 1fr));
    }
  }

  @media (width >= 48rem) {
    .md\:flex-row {
      flex-direction: row;
    }
  }

  @media (width >= 48rem) {
    .md\:items-center {
      align-items: center;
    }
  }

  @media (width >= 48rem) {
    .md\:justify-between {
      justify-content: space-between;
    }
  }

  @media (width >= 48rem) {
    .md\:gap-4 {
      gap: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 48rem) {
    .md\:gap-6 {
      gap: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 48rem) {
    :where(.md\:space-y-4 > :not(:last-child)) {
      --tw-space-y-reverse: 0;
      margin-block-start: calc(calc(var(--spacing) * 4) * var(--tw-space-y-reverse));
      margin-block-end: calc(calc(var(--spacing) * 4) * calc(1 - var(--tw-space-y-reverse)));
    }
  }

  @media (width >= 48rem) {
    :where(.md\:space-y-6 > :not(:last-child)) {
      --tw-space-y-reverse: 0;
      margin-block-start: calc(calc(var(--spacing) * 6) * var(--tw-space-y-reverse));
      margin-block-end: calc(calc(var(--spacing) * 6) * calc(1 - var(--tw-space-y-reverse)));
    }
  }

  @media (width >= 48rem) {
    :where(.md\:space-y-8 > :not(:last-child)) {
      --tw-space-y-reverse: 0;
      margin-block-start: calc(calc(var(--spacing) * 8) * var(--tw-space-y-reverse));
      margin-block-end: calc(calc(var(--spacing) * 8) * calc(1 - var(--tw-space-y-reverse)));
    }
  }

  @media (width >= 48rem) {
    .md\:p-3 {
      padding: calc(var(--spacing) * 3);
    }
  }

  @media (width >= 48rem) {
    .md\:p-4 {
      padding: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 48rem) {
    .md\:p-6 {
      padding: calc(var(--spacing) * 6);
    }
  }

  @media (width >= 48rem) {
    .md\:p-8 {
      padding: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 48rem) {
    .md\:px-4 {
      padding-inline: calc(var(--spacing) * 4);
    }
  }

  @media (width >= 48rem) {
    .md\:text-2xl {
      font-size: var(--text-2xl);
      line-height: var(--tw-leading, var(--text-2xl--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:text-3xl {
      font-size: var(--text-3xl);
      line-height: var(--tw-leading, var(--text-3xl--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:text-4xl {
      font-size: var(--text-4xl);
      line-height: var(--tw-leading, var(--text-4xl--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:text-5xl {
      font-size: var(--text-5xl);
      line-height: var(--tw-leading, var(--text-5xl--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:text-base {
      font-size: var(--text-base);
      line-height: var(--tw-leading, var(--text-base--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:text-lg {
      font-size: var(--text-lg);
      line-height: var(--tw-leading, var(--text-lg--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:text-sm {
      font-size: var(--text-sm);
      line-height: var(--tw-leading, var(--text-sm--line-height));
    }
  }

  @media (width >= 48rem) {
    .md\:text-xl {
      font-size: var(--text-xl);
      line-height: var(--tw-leading, var(--text-xl--line-height));
    }
  }

  @media (width >= 64rem) {
    .lg\:static {
      position: static;
    }
  }

  @media (width >= 64rem) {
    .lg\:col-span-1 {
      grid-column: span 1 / span 1;
    }
  }

  @media (width >= 64rem) {
    .lg\:col-span-2 {
      grid-column: span 2 / span 2;
    }
  }

  @media (width >= 64rem) {
    .lg\:hidden {
      display: none;
    }
  }

  @media (width >= 64rem) {
    .lg\:table-cell {
      display: table-cell;
    }
  }

  @media (width >= 64rem) {
    .lg\:translate-x-0 {
      --tw-translate-x: calc(var(--spacing) * 0);
      translate: var(--tw-translate-x) var(--tw-translate-y);
    }
  }

  @media (width >= 64rem) {
    .lg\:grid-cols-2 {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  @media (width >= 64rem) {
    .lg\:grid-cols-3 {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }

  @media (width >= 64rem) {
    .lg\:grid-cols-4 {
      grid-template-columns: repeat(4, minmax(0, 1fr));
    }
  }

  @media (width >= 64rem) {
    .lg\:grid-cols-6 {
      grid-template-columns: repeat(6, minmax(0, 1fr));
    }
  }

  @media (width >= 64rem) {
    .lg\:p-8 {
      padding: calc(var(--spacing) * 8);
    }
  }

  @media (width >= 64rem) {
    .lg\:text-2xl {
      font-size: var(--text-2xl);
      line-height: var(--tw-leading, var(--text-2xl--line-height));
    }
  }

  @media (width >= 64rem) {
    .lg\:text-5xl {
      font-size: var(--text-5xl);
      line-height: var(--tw-leading, var(--text-5xl--line-height));
    }
  }

  @media (width >= 80rem) {
    .xl\:table-cell {
      display: table-cell;
    }
  }

  .dark\:border-input:is(.dark *) {
    border-color: var(--input);
  }

  .dark\:bg-destructive\/60:is(.dark *) {
    background-color: var(--destructive);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .dark\:bg-destructive\/60:is(.dark *) {
      background-color: color-mix(in oklab, var(--destructive) 60%, transparent);
    }
  }

  .dark\:bg-input\/30:is(.dark *) {
    background-color: var(--input);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .dark\:bg-input\/30:is(.dark *) {
      background-color: color-mix(in oklab, var(--input) 30%, transparent);
    }
  }

  .dark\:text-green-400:is(.dark *) {
    color: var(--color-green-400);
  }

  .dark\:text-muted-foreground:is(.dark *) {
    color: var(--muted-foreground);
  }

  @media (hover: hover) {
    .dark\:hover\:bg-accent\/50:is(.dark *):hover {
      background-color: var(--accent);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .dark\:hover\:bg-accent\/50:is(.dark *):hover {
        background-color: color-mix(in oklab, var(--accent) 50%, transparent);
      }
    }
  }

  @media (hover: hover) {
    .dark\:hover\:bg-input\/50:is(.dark *):hover {
      background-color: var(--input);
    }

    @supports (color: color-mix(in lab, red, red)) {
      .dark\:hover\:bg-input\/50:is(.dark *):hover {
        background-color: color-mix(in oklab, var(--input) 50%, transparent);
      }
    }
  }

  .dark\:focus-visible\:ring-destructive\/40:is(.dark *):focus-visible {
    --tw-ring-color: var(--destructive);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .dark\:focus-visible\:ring-destructive\/40:is(.dark *):focus-visible {
      --tw-ring-color: color-mix(in oklab, var(--destructive) 40%, transparent);
    }
  }

  .dark\:aria-invalid\:ring-destructive\/40:is(.dark *)[aria-invalid="true"] {
    --tw-ring-color: var(--destructive);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .dark\:aria-invalid\:ring-destructive\/40:is(.dark *)[aria-invalid="true"] {
      --tw-ring-color: color-mix(in oklab, var(--destructive) 40%, transparent);
    }
  }

  .dark\:data-\[state\=active\]\:border-input:is(.dark *)[data-state="active"] {
    border-color: var(--input);
  }

  .dark\:data-\[state\=active\]\:bg-input\/30:is(.dark *)[data-state="active"] {
    background-color: var(--input);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .dark\:data-\[state\=active\]\:bg-input\/30:is(.dark *)[data-state="active"] {
      background-color: color-mix(in oklab, var(--input) 30%, transparent);
    }
  }

  .dark\:data-\[state\=active\]\:text-foreground:is(.dark *)[data-state="active"] {
    color: var(--foreground);
  }

  .dark\:data-\[state\=checked\]\:bg-primary-foreground:is(.dark *)[data-state="checked"] {
    background-color: var(--primary-foreground);
  }

  .dark\:data-\[state\=unchecked\]\:bg-card-foreground:is(.dark *)[data-state="unchecked"] {
    background-color: var(--card-foreground);
  }

  .dark\:data-\[state\=unchecked\]\:bg-input\/80:is(.dark *)[data-state="unchecked"] {
    background-color: var(--input);
  }

  @supports (color: color-mix(in lab, red, red)) {
    .dark\:data-\[state\=unchecked\]\:bg-input\/80:is(.dark *)[data-state="unchecked"] {
      background-color: color-mix(in oklab, var(--input) 80%, transparent);
    }
  }

  .\[\&_p\]\:leading-relaxed p {
    --tw-leading: var(--leading-relaxed);
    line-height: var(--leading-relaxed);
  }

  .\[\&_svg\]\:pointer-events-none svg {
    pointer-events: none;
  }

  .\[\&_svg\]\:shrink-0 svg {
    flex-shrink: 0;
  }

  .\[\&_svg\:not\(\[class\*\=\'size-\'\]\)\]\:size-4 svg:not([class*="size-"]) {
    width: calc(var(--spacing) * 4);
    height: calc(var(--spacing) * 4);
  }

  .\[\&_svg\:not\(\[class\*\=\'text-\'\]\)\]\:text-muted-foreground svg:not([class*="text-"]) {
    color: var(--muted-foreground);
  }

  .\[\&_tr\]\:border-b tr {
    border-bottom-style: var(--tw-border-style);
    border-bottom-width: 1px;
  }

  .\[\&_tr\:last-child\]\:border-0 tr:last-child {
    border-style: var(--tw-border-style);
    border-width: 0;
  }

  .\[\&\:has\(\>\.day-range-end\)\]\:rounded-r-md:has( > .day-range-end) {
    border-top-right-radius: calc(var(--radius)  - 2px);
    border-bottom-right-radius: calc(var(--radius)  - 2px);
  }

  .\[\&\:has\(\>\.day-range-start\)\]\:rounded-l-md:has( > .day-range-start) {
    border-top-left-radius: calc(var(--radius)  - 2px);
    border-bottom-left-radius: calc(var(--radius)  - 2px);
  }

  .\[\&\:has\(\[aria-selected\]\)\]\:rounded-md:has([aria-selected]) {
    border-radius: calc(var(--radius)  - 2px);
  }

  .\[\&\:has\(\[aria-selected\]\)\]\:bg-accent:has([aria-selected]) {
    background-color: var(--accent);
  }

  .first\:\[\&\:has\(\[aria-selected\]\)\]\:rounded-l-md:first-child:has([aria-selected]) {
    border-top-left-radius: calc(var(--radius)  - 2px);
    border-bottom-left-radius: calc(var(--radius)  - 2px);
  }

  .last\:\[\&\:has\(\[aria-selected\]\)\]\:rounded-r-md:last-child:has([aria-selected]) {
    border-top-right-radius: calc(var(--radius)  - 2px);
    border-bottom-right-radius: calc(var(--radius)  - 2px);
  }

  .\[\&\:has\(\[aria-selected\]\.day-range-end\)\]\:rounded-r-md:has([aria-selected].day-range-end) {
    border-top-right-radius: calc(var(--radius)  - 2px);
    border-bottom-right-radius: calc(var(--radius)  - 2px);
  }

  .\[\&\:has\(\[role\=checkbox\]\)\]\:pr-0:has([role="checkbox"]) {
    padding-right: calc(var(--spacing) * 0);
  }

  .\[\.border-b\]\:pb-6.border-b {
    padding-bottom: calc(var(--spacing) * 6);
  }

  .\[\.border-t\]\:pt-6.border-t {
    padding-top: calc(var(--spacing) * 6);
  }

  :is(.\*\:\[span\]\:last\:flex > *):is(span):last-child {
    display: flex;
  }

  :is(.\*\:\[span\]\:last\:items-center > *):is(span):last-child {
    align-items: center;
  }

  :is(.\*\:\[span\]\:last\:gap-2 > *):is(span):last-child {
    gap: calc(var(--spacing) * 2);
  }

  .\[\&\:last-child\]\:pb-6:last-child {
    padding-bottom: calc(var(--spacing) * 6);
  }

  .\[\&\>\[role\=checkbox\]\]\:translate-y-\[2px\] > [role="checkbox"] {
    --tw-translate-y: 2px;
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .\[\&\>svg\]\:pointer-events-none > svg {
    pointer-events: none;
  }

  .\[\&\>svg\]\:size-3 > svg {
    width: calc(var(--spacing) * 3);
    height: calc(var(--spacing) * 3);
  }

  .\[\&\>svg\]\:size-4 > svg {
    width: calc(var(--spacing) * 4);
    height: calc(var(--spacing) * 4);
  }

  .\[\&\>svg\]\:translate-y-0\.5 > svg {
    --tw-translate-y: calc(var(--spacing) * .5);
    translate: var(--tw-translate-x) var(--tw-translate-y);
  }

  .\[\&\>svg\]\:text-current > svg {
    color: currentColor;
  }

  .\[\&\>tr\]\:last\:border-b-0 > tr:last-child {
    border-bottom-style: var(--tw-border-style);
    border-bottom-width: 0;
  }

  @media (hover: hover) {
    a.\[a\&\]\:hover\:bg-accent:hover {
      background-color: var(--accent);
    }
  }

  @media (hover: hover) {
    a.\[a\&\]\:hover\:bg-destructive\/90:hover {
      background-color: var(--destructive);
    }

    @supports (color: color-mix(in lab, red, red)) {
      a.\[a\&\]\:hover\:bg-destructive\/90:hover {
        background-color: color-mix(in oklab, var(--destructive) 90%, transparent);
      }
    }
  }

  @media (hover: hover) {
    a.\[a\&\]\:hover\:bg-primary\/90:hover {
      background-color: var(--primary);
    }

    @supports (color: color-mix(in lab, red, red)) {
      a.\[a\&\]\:hover\:bg-primary\/90:hover {
        background-color: color-mix(in oklab, var(--primary) 90%, transparent);
      }
    }
  }

  @media (hover: hover) {
    a.\[a\&\]\:hover\:bg-secondary\/90:hover {
      background-color: var(--secondary);
    }

    @supports (color: color-mix(in lab, red, red)) {
      a.\[a\&\]\:hover\:bg-secondary\/90:hover {
        background-color: color-mix(in oklab, var(--secondary) 90%, transparent);
      }
    }
  }

  @media (hover: hover) {
    a.\[a\&\]\:hover\:text-accent-foreground:hover {
      color: var(--accent-foreground);
    }
  }

  @media (width >= 480px) {
    .xs\:inline {
      display: inline;
    }

    .xs\:flex {
      display: flex;
    }

    .xs\:flex-row {
      flex-direction: row;
    }

    .xs\:items-center {
      align-items: center;
    }

    .xs\:gap-2 {
      gap: .5rem;
    }

    .xs\:gap-4 {
      gap: 1rem;
    }

    .xs\:grid-cols-2 {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .xs\:hidden {
      display: none;
    }
  }

  .line-clamp-1 {
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    display: -webkit-box;
    overflow: hidden;
  }

  .line-clamp-2 {
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    display: -webkit-box;
    overflow: hidden;
  }

  .scrollbar-visible {
    scrollbar-width: thin;
    scrollbar-color: gold transparent;
  }

  .scrollbar-visible::-webkit-scrollbar {
    width: 10px;
    display: block;
  }

  .scrollbar-visible::-webkit-scrollbar-track {
    background: #ffffff0d;
    border-radius: 10px;
    margin: 4px 0;
  }

  .scrollbar-visible::-webkit-scrollbar-thumb {
    background: linear-gradient(gold 0%, orange 100%) padding-box padding-box;
    border: 2px solid #0000;
    border-radius: 10px;
    transition: background .3s;
  }

  .scrollbar-visible::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(orange 0%, gold 100%);
    border: 1px solid #ffd7004d;
  }

  .scrollbar-visible::-webkit-scrollbar-thumb:active {
    background: gold;
  }

  .theme-light .scrollbar-visible {
    scrollbar-color: gold #00000014;
  }

  .theme-light .scrollbar-visible::-webkit-scrollbar-track {
    background: #0000000d;
  }

  .theme-light .scrollbar-visible::-webkit-scrollbar-thumb {
    background: linear-gradient(gold 0%, orange 100%);
    border: 2px solid #fffc;
  }

  .theme-light .scrollbar-visible::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(orange 0%, gold 100%);
    border: 1px solid #ffd70080;
  }
}


:root {
  --font-size: 16px;
  --am-bg-main: #121212;
  --am-bg-card: #1c1c1e;
  --am-accent-gold: gold;
  --am-accent-orange: #ff6b00;
  --am-accent-violet: #4f00bc;
  --am-text-primary: #eaeaea;
  --am-text-secondary: #8e8e93;
  --am-success: #34c759;
  --am-error: #ff3b30;
  --am-border: #ffffff14;
  --background: #121212;
  --foreground: #eaeaea;
  --card: #1c1c1e;
  --card-foreground: #eaeaea;
  --popover: #1c1c1e;
  --popover-foreground: #eaeaea;
  --primary: gold;
  --primary-foreground: #121212;
  --secondary: #ff6b00;
  --secondary-foreground: #eaeaea;
  --muted: #1c1c1e;
  --muted-foreground: #8e8e93;
  --accent: gold;
  --accent-foreground: #121212;
  --destructive: #ff3b30;
  --destructive-foreground: #eaeaea;
  --border: #ffffff14;
  --input: #ffffff14;
  --input-background: #1c1c1e;
  --switch-background: #8e8e93;
  --font-weight-medium: 500;
  --font-weight-normal: 400;
  --ring: gold;
  --chart-1: gold;
  --chart-2: #ff6b00;
  --chart-3: #4f00bc;
  --chart-4: #34c759;
  --chart-5: #ff3b30;
  --radius: .75rem;
  --sidebar: #1c1c1e;
  --sidebar-foreground: #eaeaea;
  --sidebar-primary: gold;
  --sidebar-primary-foreground: #121212;
  --sidebar-accent: #1c1c1e;
  --sidebar-accent-foreground: #eaeaea;
  --sidebar-border: #ffffff14;
  --sidebar-ring: gold;
}

.theme-light {
  --am-bg-main: #f4f4f7;
  --am-bg-card: #fff;
  --am-accent-gold: gold;
  --am-accent-orange: #f97316;
  --am-accent-violet: #4f00bc;
  --am-text-primary: #1a202c;
  --am-text-secondary: #718096;
  --am-success: #34c759;
  --am-error: #ff3b30;
  --am-border: #0000001a;
  --background: #f4f4f7;
  --foreground: #1a202c;
  --card: #fff;
  --card-foreground: #1a202c;
  --popover: #fff;
  --popover-foreground: #1a202c;
  --primary: gold;
  --primary-foreground: #121212;
  --secondary: #f97316;
  --secondary-foreground: #fff;
  --muted: #f0f0f3;
  --muted-foreground: #718096;
  --accent: gold;
  --accent-foreground: #121212;
  --destructive: #ff3b30;
  --destructive-foreground: #fff;
  --border: #0000001a;
  --input: #0000001a;
  --input-background: #fff;
  --switch-background: #d1d1d6;
  --ring: gold;
  --sidebar: #fff;
  --sidebar-foreground: #1a202c;
  --sidebar-primary: gold;
  --sidebar-primary-foreground: #121212;
  --sidebar-accent: #f0f0f3;
  --sidebar-accent-foreground: #1a202c;
  --sidebar-border: #0000001a;
  --sidebar-ring: gold;
}

.theme-light .bg-card {
  box-shadow: 0 1px 3px #00000014;
}

.dark {
  --background: #121212;
  --foreground: #eaeaea;
  --card: #1c1c1e;
  --card-foreground: #eaeaea;
  --popover: #1c1c1e;
  --popover-foreground: #eaeaea;
  --primary: gold;
  --primary-foreground: #121212;
  --secondary: #ff6b00;
  --secondary-foreground: #eaeaea;
  --muted: #1c1c1e;
  --muted-foreground: #8e8e93;
  --accent: gold;
  --accent-foreground: #121212;
  --destructive: #ff3b30;
  --destructive-foreground: #eaeaea;
  --border: #ffffff14;
  --input: #ffffff14;
  --ring: gold;
  --font-weight-medium: 500;
  --font-weight-normal: 400;
  --chart-1: gold;
  --chart-2: #ff6b00;
  --chart-3: #4f00bc;
  --chart-4: #34c759;
  --chart-5: #ff3b30;
  --sidebar: #1c1c1e;
  --sidebar-foreground: #eaeaea;
  --sidebar-primary: gold;
  --sidebar-primary-foreground: #121212;
  --sidebar-accent: #1c1c1e;
  --sidebar-accent-foreground: #eaeaea;
  --sidebar-border: #ffffff14;
  --sidebar-ring: gold;
}

html {
  font-size: var(--font-size);
}

@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }

  100% {
    background-position: 1000px 0;
  }
}

.animate-shimmer {
  background: linear-gradient(90deg, #0000 0%, #ffd7001a 50%, #0000 100%) 0 0 / 1000px 100%;
  animation: 3s linear infinite shimmer;
}

.gradient-orange-violet {
  background: linear-gradient(135deg, #ff6b00 0%, #4f00bc 100%);
}

.theme-light .gradient-orange-violet {
  background: linear-gradient(135deg, #e65100 0%, #3d0094 100%);
}

.gradient-gold {
  background: linear-gradient(135deg, gold 0%, orange 100%);
}

.confetti-bg {
  background-image: radial-gradient(circle at 20%, #ffd70026 1px, #0000 1px), radial-gradient(circle at 60% 80%, #ffd70026 1px, #0000 1px), radial-gradient(circle at 80% 20%, #ffd70026 1px, #0000 1px), radial-gradient(circle at 40% 90%, #ffd70026 1px, #0000 1px);
  background-size: 100px 100px;
}

@keyframes pulse-border {
  0%, 100% {
    border-color: #ffd70099;
    box-shadow: 0 0 15px #ffd7004d;
  }

  50% {
    border-color: gold;
    box-shadow: 0 0 25px #ffd70080;
  }
}

.animate-pulse-border {
  animation: 1s ease-in-out 2 pulse-border;
}

[data-slot="tabs-trigger"][data-state="active"] {
  position: relative;
  color: gold !important;
}

[data-slot="tabs-trigger"][data-state="active"]:after {
  content: "";
  background-color: gold;
  border-radius: 2px 2px 0 0;
  height: 2px;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
}

@property --tw-translate-x {
  syntax: "*";
  inherits: false;
  initial-value: 0;
}

@property --tw-translate-y {
  syntax: "*";
  inherits: false;
  initial-value: 0;
}

@property --tw-translate-z {
  syntax: "*";
  inherits: false;
  initial-value: 0;
}

@property --tw-rotate-x {
  syntax: "*";
  inherits: false;
  initial-value: rotateX(0);
}

@property --tw-rotate-y {
  syntax: "*";
  inherits: false;
  initial-value: rotateY(0);
}

@property --tw-rotate-z {
  syntax: "*";
  inherits: false;
  initial-value: rotateZ(0);
}

@property --tw-skew-x {
  syntax: "*";
  inherits: false;
  initial-value: skewX(0);
}

@property --tw-skew-y {
  syntax: "*";
  inherits: false;
  initial-value: skewY(0);
}

@property --tw-space-y-reverse {
  syntax: "*";
  inherits: false;
  initial-value: 0;
}

@property --tw-space-x-reverse {
  syntax: "*";
  inherits: false;
  initial-value: 0;
}

@property --tw-divide-y-reverse {
  syntax: "*";
  inherits: false;
  initial-value: 0;
}

@property --tw-border-style {
  syntax: "*";
  inherits: false;
  initial-value: solid;
}

@property --tw-gradient-position {
  syntax: "*";
  inherits: false
}

@property --tw-gradient-from {
  syntax: "<color>";
  inherits: false;
  initial-value: #0000;
}

@property --tw-gradient-via {
  syntax: "<color>";
  inherits: false;
  initial-value: #0000;
}

@property --tw-gradient-to {
  syntax: "<color>";
  inherits: false;
  initial-value: #0000;
}

@property --tw-gradient-stops {
  syntax: "*";
  inherits: false
}

@property --tw-gradient-via-stops {
  syntax: "*";
  inherits: false
}

@property --tw-gradient-from-position {
  syntax: "<length-percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --tw-gradient-via-position {
  syntax: "<length-percentage>";
  inherits: false;
  initial-value: 50%;
}

@property --tw-gradient-to-position {
  syntax: "<length-percentage>";
  inherits: false;
  initial-value: 100%;
}

@property --tw-leading {
  syntax: "*";
  inherits: false
}

@property --tw-font-weight {
  syntax: "*";
  inherits: false
}

@property --tw-tracking {
  syntax: "*";
  inherits: false
}

@property --tw-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}

@property --tw-shadow-color {
  syntax: "*";
  inherits: false
}

@property --tw-shadow-alpha {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 100%;
}

@property --tw-inset-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}

@property --tw-inset-shadow-color {
  syntax: "*";
  inherits: false
}

@property --tw-inset-shadow-alpha {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 100%;
}

@property --tw-ring-color {
  syntax: "*";
  inherits: false
}

@property --tw-ring-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}

@property --tw-inset-ring-color {
  syntax: "*";
  inherits: false
}

@property --tw-inset-ring-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}

@property --tw-ring-inset {
  syntax: "*";
  inherits: false
}

@property --tw-ring-offset-width {
  syntax: "<length>";
  inherits: false;
  initial-value: 0;
}

@property --tw-ring-offset-color {
  syntax: "*";
  inherits: false;
  initial-value: #fff;
}

@property --tw-ring-offset-shadow {
  syntax: "*";
  inherits: false;
  initial-value: 0 0 #0000;
}

@property --tw-outline-style {
  syntax: "*";
  inherits: false;
  initial-value: solid;
}

@property --tw-blur {
  syntax: "*";
  inherits: false
}

@property --tw-brightness {
  syntax: "*";
  inherits: false
}

@property --tw-contrast {
  syntax: "*";
  inherits: false
}

@property --tw-grayscale {
  syntax: "*";
  inherits: false
}

@property --tw-hue-rotate {
  syntax: "*";
  inherits: false
}

@property --tw-invert {
  syntax: "*";
  inherits: false
}

@property --tw-opacity {
  syntax: "*";
  inherits: false
}

@property --tw-saturate {
  syntax: "*";
  inherits: false
}

@property --tw-sepia {
  syntax: "*";
  inherits: false
}

@property --tw-drop-shadow {
  syntax: "*";
  inherits: false
}

@property --tw-drop-shadow-color {
  syntax: "*";
  inherits: false
}

@property --tw-drop-shadow-alpha {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 100%;
}

@property --tw-drop-shadow-size {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-blur {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-brightness {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-contrast {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-grayscale {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-hue-rotate {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-invert {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-opacity {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-saturate {
  syntax: "*";
  inherits: false
}

@property --tw-backdrop-sepia {
  syntax: "*";
  inherits: false
}

@property --tw-duration {
  syntax: "*";
  inherits: false
}

@property --tw-ease {
  syntax: "*";
  inherits: false
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@keyframes enter {
  from {
    opacity: var(--tw-enter-opacity, 1);
    transform: translate3d(var(--tw-enter-translate-x, 0), var(--tw-enter-translate-y, 0), 0) scale3d(var(--tw-enter-scale, 1), var(--tw-enter-scale, 1), var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0));
  }
}

@keyframes exit {
  to {
    opacity: var(--tw-exit-opacity, 1);
    transform: translate3d(var(--tw-exit-translate-x, 0), var(--tw-exit-translate-y, 0), 0) scale3d(var(--tw-exit-scale, 1), var(--tw-exit-scale, 1), var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0));
  }
}


================================================================================
--- FICHIER : ./src/main.tsx ---
================================================================================


  import { createRoot } from "react-dom/client";
  import App from "./App.tsx";
  import "./index.css";
  import { AuthProvider } from "./contexts/AuthContext.tsx";
  
  createRoot(document.getElementById("root")!).render(
    <AuthProvider>
      <App />
    </AuthProvider>
  );  

================================================================================
--- FICHIER : ./src/components/AdminPanel.tsx ---
================================================================================

// src/components/AdminPanel.tsx

import { useState, useEffect } from "react";
import { useAuth } from "../contexts/AuthContext"; 
import { AdminDashboard } from "./admin/AdminDashboard";
import { AdminPlayers } from "./admin/AdminPlayers";
import { AdminResellers } from "./admin/AdminResellers";
import { AdminGames } from "./admin/AdminGames";
import { AdminFinance } from "./admin/AdminFinance";
import { AdminAdministrators } from "./admin/AdminAdministrators"; // Renommé pour correspondre à votre import
import { LayoutDashboard, Users, UsersRound, Dices, Wallet, Shield, LogOut, Menu, X } from "lucide-react";
import { Button } from "./ui/button";

interface AdminPanelProps {
  onLogout: () => void;
}

type AdminSection = 'dashboard' | 'players' | 'resellers' | 'games' | 'finance' | 'administrators';

// --- NOUVEAU: Moteur de permissions centralisé et officiel ---
const rolePermissions = {
  'Support Client': ['dashboard', 'players'],
  'Admin Financier': ['dashboard',  'resellers', 'finance'],
  'Admin du Jeu': ['dashboard', 'games'],
  'Super Admin': ['dashboard', 'players', 'resellers', 'games', 'finance', 'administrators'],
};

// --- NOUVEAU: Définition de l'écran de démarrage par rôle ---
const defaultScreenForRole = {
  'Support Client': 'players',
  'Admin Financier': 'finance',
  'Admin du Jeu': 'games',
  'Super Admin': 'dashboard',
};


export function AdminPanel({ onLogout }: AdminPanelProps) {
  const [sidebarOpen, setSidebarOpen] = useState(false);
  const [currentScreen, setCurrentScreen] = useState<AdminSection | 'loading'>('loading');
  const { user } = useAuth();
  
  const userRole = user?.role as keyof typeof rolePermissions | undefined;

  useEffect(() => {
    if (userRole) {
      // Vérifie si le rôle est un rôle admin valide
      if (rolePermissions[userRole]) {
        // Définit l'écran par défaut pour ce rôle
        const defaultScreen = defaultScreenForRole[userRole as keyof typeof defaultScreenForRole] || 'dashboard';
        setCurrentScreen(defaultScreen as AdminSection);
      } else {
        // Si le rôle n'est pas dans la liste des permissions, bloque l'accès
        setCurrentScreen('loading'); // On peut afficher l'écran 'accès refusé' ici aussi
        onLogout(); // Déconnexion forcée pour sécurité
      }
    }
  }, [userRole, onLogout]);

  // --- Logique d'affichage simplifiée ---
  const menuItems: { id: AdminSection; label: string; icon: React.ElementType }[] = [
    { id: 'dashboard', label: 'Tableau de bord', icon: LayoutDashboard },
    { id: 'players', label: 'Gestion des Joueurs', icon: Users },
    { id: 'resellers', label: 'Gestion des Revendeurs', icon: UsersRound },
    { id: 'games', label: 'Gestion des Jeux', icon: Dices },
    { id: 'finance', label: 'Gestion Financière', icon: Wallet },
    { id: 'administrators', label: 'Gestion des Admins', icon: Shield },
  ];

  // Filtre les menus auxquels l'utilisateur a accès
  const accessibleMenuItems = userRole ? menuItems.filter(item => rolePermissions[userRole]?.includes(item.id)) : [];

  const handleMenuClick = (screenId: AdminSection) => {
    setCurrentScreen(screenId);
    setSidebarOpen(false);
  };

  const renderCurrentScreen = () => {
    // Vérifie si l'utilisateur a le droit de voir l'écran actuellement sélectionné
    if (!userRole || !rolePermissions[userRole]?.includes(currentScreen as AdminSection)) {
      // Si l'accès est invalide, on affiche un message d'erreur ou on redirige.
      // Le useEffect gère déjà la redirection initiale, ceci est une sécurité supplémentaire.
      return <div className="p-8">Accès non autorisé à cette section.</div>;
    }

    switch (currentScreen) {
      case 'dashboard': return <AdminDashboard />;
      case 'players': return <AdminPlayers />;
      case 'resellers': return <AdminResellers />;
      case 'games': return <AdminGames />;
      case 'finance': return <AdminFinance />;
      case 'administrators': return <AdminAdministrators />;
      default: return <AdminDashboard />;
    }
  };

  if (currentScreen === 'loading' || !userRole) {
    return (
      <div className="flex items-center justify-center h-screen p-8 bg-background">
        <div className="text-center space-y-4">
          <Shield className="h-16 w-16 text-muted-foreground mx-auto" />
          <h2 className="text-2xl font-bold">Accès non autorisé</h2>
          <p className="text-muted-foreground">Vous n'avez pas les permissions nécessaires. Redirection en cours...</p>
        </div>
      </div>
    );
  }
  
  return (
    <div className="flex h-screen bg-background overflow-hidden">
      {sidebarOpen && <div className="fixed inset-0 bg-black/50 z-40 lg:hidden" onClick={() => setSidebarOpen(false)} />}
      <aside className={`fixed lg:static inset-y-0 left-0 z-50 w-64 bg-card border-r border-border flex flex-col transform transition-transform duration-300 ease-in-out ${sidebarOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'}`}>
        <div className="p-6 border-b border-border flex items-center justify-between">
          <div>
            <h1 className="text-2xl font-bold text-[#FFD700]">Lotto Happy</h1>
            <p className="text-sm text-muted-foreground">Panel Admin</p>
            {userRole && <p className="text-xs text-[#FFD700] mt-1 font-medium">{userRole}</p>}
          </div>
          <button onClick={() => setSidebarOpen(false)} className="lg:hidden p-2 hover:bg-accent rounded-lg"><X className="h-5 w-5" /></button>
        </div>
        <nav className="flex-1 p-4 space-y-2 overflow-y-auto scrollbar-visible">
          {accessibleMenuItems.map((item) => {
            const Icon = item.icon;
            const isActive = currentScreen === item.id;
            return (
              <button key={item.id} onClick={() => handleMenuClick(item.id)} className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${isActive ? 'bg-[#FFD700]/10 text-[#FFD700] border border-[#FFD700]/20' : 'text-muted-foreground hover:bg-accent/50 hover:text-foreground'}`}>
                <Icon className="h-5 w-5 flex-shrink-0" />
                <span className="font-medium">{item.label}</span>
              </button>
            );
          })}
        </nav>
        <div className="p-4 border-t border-border">
          <Button variant="ghost" className="w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10" onClick={onLogout}>
            <LogOut className="mr-3 h-5 w-5" />
            Déconnexion
          </Button>
        </div>
      </aside>
      <main className="flex-1 flex flex-col overflow-hidden">
        <div className="lg:hidden sticky top-0 z-30 bg-card border-b border-border p-4 flex items-center justify-between">
          <button onClick={() => setSidebarOpen(true)} className="p-2 hover:bg-accent rounded-lg"><Menu className="h-6 w-6" /></button>
          <h2 className="font-bold text-[#FFD700]">Lotto Happy Admin</h2>
          <div className="w-10" />
        </div>
        <div className="flex-1 overflow-y-auto scrollbar-visible">
          {renderCurrentScreen()}
        </div>
      </main>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/BetHistory.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { Card } from "./ui/card";
import { Badge } from "./ui/badge";
import { Separator } from "./ui/separator";
import { Calendar, Clock, TrendingUp, TrendingDown, Timer, Trophy, X, Loader2 } from "lucide-react";
import { toast } from "sonner";
import apiClient from "../services/apiClient"; // Assurez-vous que ce chemin est correct

// Interface décrivant la structure d'un ticket retourné par l'API GET /api/tickets/me
export interface BetHistoryItem {
  id: string;
  userId: string;
  username: string;
  drawId: string;
  betType: string;
  numbers: string;
  betAmount: number;
  purchaseDate: string;
  status: 'pending' | 'won' | 'lost';
  winAmount?: number | null;
  operatorName: string;
  drawDate: string;
  drawTime: string;
  winningNumbers?: number[] | null;
}

// Le composant n'a plus besoin de props, il récupère l'utilisateur via le token
export function BetHistory() {
  const [bets, setBets] = useState<BetHistoryItem[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [filter, setFilter] = useState<'all' | 'pending' | 'won' | 'lost'>('all');

  useEffect(() => {
    const fetchHistory = async () => {
      setLoading(true);
      setError(null);
      try {
        const response = await apiClient.get<BetHistoryItem[]>('/api/tickets/me');
        // Le backend trie déjà les tickets du plus récent au plus ancien
        setBets(response.data);
      } catch (err) {
        setError("Impossible de charger l'historique des paris.");
        toast.error("Impossible de charger l'historique. Veuillez essayer de vous reconnecter.");
      } finally {
        setLoading(false);
      }
    };
    fetchHistory();
  }, []); // Se déclenche une seule fois au montage du composant

  const filteredBets = filter === 'all' 
    ? bets 
    : bets.filter(bet => bet.status === filter);

  const getStatusBadge = (status: BetHistoryItem['status']) => {
    switch (status) {
      case 'pending':
        return <Badge className="bg-[#FF6B00]/20 text-[#FF6B00] border-[#FF6B00]/30"><Clock className="h-3 w-3 mr-1" />En attente</Badge>;
      case 'won':
        return <Badge className="bg-[#00A651]/20 text-[#00A651] border-[#00A651]/30"><Trophy className="h-3 w-3 mr-1" />Gagné</Badge>;
      case 'lost':
        return <Badge className="bg-muted text-muted-foreground border-border"><X className="h-3 w-3 mr-1" />Perdu</Badge>;
      default:
        return null;
    }
  };

  const formatDate = (dateString: string) => {
    const date = new Date(dateString);
    return date.toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' });
  };

  if (loading) {
    return <div className="flex justify-center items-center p-8"><Loader2 className="h-8 w-8 animate-spin" /></div>;
  }

  if (error) {
    return <div className="text-red-500 p-8 text-center">{error}</div>;
  }

  if (bets.length === 0) {
    return (
      <Card className="border-border bg-card p-8 text-center">
        <div className="mx-auto max-w-md">
          <div className="rounded-full bg-muted p-6 w-fit mx-auto mb-4">
            <TrendingDown className="h-12 w-12 text-muted-foreground" />
          </div>
          <h3 className="font-bold text-foreground mb-2">Aucun pari pour le moment</h3>
          <p className="text-muted-foreground text-sm">
            Vos paris apparaîtront ici une fois que vous aurez joué à un jeu.
          </p>
        </div>
      </Card>
    );
  }

  return (
    <div className="space-y-4 sm:space-y-6">
      {/* Filtres */}
      <div className="w-full overflow-x-auto scrollbar-visible -mx-3 px-3 sm:mx-0 sm:px-0">
        <div className="flex gap-2 min-w-max sm:flex-wrap sm:min-w-0">
          {[
            { value: 'all', label: 'Tous' },
            { value: 'pending', label: 'En attente' },
            { value: 'won', label: 'Gagnés' },
            { value: 'lost', label: 'Perdus' },
          ].map(({ value, label }) => (
            <button
              key={value}
              onClick={() => setFilter(value as any)}
              className={`px-3 sm:px-4 py-1.5 sm:py-2 rounded-full text-xs sm:text-sm font-medium transition-all whitespace-nowrap flex-shrink-0 ${
                filter === value
                  ? 'bg-[#FFD700] text-[#121212]'
                  : 'bg-muted text-muted-foreground hover:bg-muted/80'
              }`}
            >
              {label}
            </button>
          ))}
        </div>
      </div>

      {/* Stats Rapides */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4">
        <Card className="border-border bg-card p-2 sm:p-3 md:p-4">
          <p className="text-[10px] sm:text-xs text-muted-foreground mb-0.5 sm:mb-1">Total Paris</p>
          <p className="text-lg sm:text-xl md:text-2xl font-bold text-foreground">{bets.length}</p>
        </Card>
        <Card className="border-border bg-card p-2 sm:p-3 md:p-4">
          <p className="text-[10px] sm:text-xs text-muted-foreground mb-0.5 sm:mb-1">Total Misé</p>
          <p className="text-lg sm:text-xl md:text-2xl font-bold text-foreground break-words">
            {bets.reduce((sum, bet) => sum + bet.betAmount, 0).toLocaleString('fr-FR')} F
          </p>
        </Card>
        <Card className="border-border bg-card p-2 sm:p-3 md:p-4">
          <p className="text-[10px] sm:text-xs text-muted-foreground mb-0.5 sm:mb-1">Total Gagné</p>
          <p className="text-lg sm:text-xl md:text-2xl font-bold text-[#00A651] break-words">
            {bets.reduce((sum, bet) => sum + (bet.winAmount || 0), 0).toLocaleString('fr-FR')} F
          </p>
        </Card>
        <Card className="border-border bg-card p-2 sm:p-3 md:p-4">
          <p className="text-[10px] sm:text-xs text-muted-foreground mb-0.5 sm:mb-1">Paris Gagnants</p>
          <p className="text-lg sm:text-xl md:text-2xl font-bold text-[#FFD700]">
            {bets.filter(bet => bet.status === 'won').length}
          </p>
        </Card>
      </div>

      {/* Liste des Paris */}
      <div className="space-y-4">
        {filteredBets.length === 0 ? (
          <Card className="border-border bg-card p-6 text-center">
            <p className="text-muted-foreground">Aucun pari dans cette catégorie</p>
          </Card>
        ) : (
          filteredBets.map((bet) => {
            const gameColor = '#FFD700'; // Logique de couleur à améliorer
            return (
              <Card key={bet.id} className="border-border bg-card overflow-hidden">
                <div className="p-4 text-white" style={{ background: `linear-gradient(135deg, ${gameColor} 0%, ${gameColor}dd 100%)` }}>
                  <div className="flex items-start justify-between mb-2">
                    <div>
                      <h3 className="font-bold text-lg">{bet.operatorName}</h3>
                      <p className="text-sm text-white/80">Pari du {formatDate(bet.purchaseDate)}</p>
                    </div>
                    {getStatusBadge(bet.status)}
                  </div>
                </div>

                <div className="p-4 space-y-4">
                  <div>
                    <p className="text-xs text-muted-foreground mb-2">Vos numéros :</p>
                    <div className="flex flex-wrap gap-2">
                      {bet.numbers.split(',').map((num, index) => (
                        <div key={index} className="px-3 py-1 rounded-lg font-bold text-[#121212]" style={{ backgroundColor: gameColor }}>
                          {num.trim()}
                        </div>
                      ))}
                    </div>
                  </div>

                  {bet.winningNumbers && bet.winningNumbers.length > 0 && (
                    <>
                      <Separator />
                      <div>
                        <p className="text-xs text-muted-foreground mb-2">Numéros gagnants :</p>
                        <div className="flex flex-wrap gap-2">
                          {bet.winningNumbers.map((num, index) => {
                            const numStr = num.toString().trim();
                            const isMatch = bet.numbers.split(',').map(n => n.trim()).includes(numStr);
                            return (
                              <div
                                key={index}
                                className={`px-3 py-1 rounded-lg font-bold ${isMatch ? 'text-[#121212] ring-2 ring-offset-2' : 'bg-muted text-muted-foreground'}`}
                                style={isMatch ? { backgroundColor: gameColor, ringColor: gameColor } : {}}
                              >
                                {numStr}
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    </>
                  )}

                  <Separator />

                  <div className="grid grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <div className="flex items-center gap-2 text-sm">
                        <Calendar className="h-4 w-4 text-muted-foreground" />
                        <div>
                          <p className="text-xs text-muted-foreground">Date du tirage</p>
                          <p className="font-semibold text-foreground">{new Date(bet.drawDate).toLocaleDateString('fr-FR')}</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2 text-sm">
                        <Clock className="h-4 w-4 text-muted-foreground" />
                        <div>
                          <p className="text-xs text-muted-foreground">Heure</p>
                          <p className="font-semibold text-foreground">{bet.drawTime}</p>
                        </div>
                      </div>
                    </div>
                    <div className="space-y-2">
                      <div className="flex items-center gap-2 text-sm">
                        <TrendingDown className="h-4 w-4 text-muted-foreground" />
                        <div>
                          <p className="text-xs text-muted-foreground">Mise</p>
                          <p className="font-semibold text-foreground">{bet.betAmount.toLocaleString('fr-FR')} F</p>
                        </div>
                      </div>
                      {bet.winAmount && bet.winAmount > 0 && (
                        <div className="flex items-center gap-2 text-sm">
                          <TrendingUp className="h-4 w-4 text-[#00A651]" />
                          <div>
                            <p className="text-xs text-muted-foreground">Gain</p>
                            <p className="font-semibold text-[#00A651]">+ {bet.winAmount.toLocaleString('fr-FR')} F</p>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                </div>
              </Card>
            );
          })
        )}
      </div>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/ConvertModal.tsx ---
================================================================================

import { useState } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "./ui/dialog";
import { Button } from "./ui/button";
import { Input } from "./ui/input";
import { Label } from "./ui/label";
import { toast } from "sonner@2.0.3";
import { ArrowRightLeft } from "lucide-react";

interface ConvertModalProps {
  open: boolean;
  onClose: () => void;
  winningsBalance: number;
  onConvert: (amount: number) => boolean;
}

const QUICK_AMOUNTS = [1000, 5000, 10000, 25000, 50000];

export function ConvertModal({ open, onClose, winningsBalance = 0, onConvert }: ConvertModalProps) {
  const [amount, setAmount] = useState("");

  const handleConvert = () => {
    const convertAmount = parseInt(amount);
    
    if (!amount || convertAmount <= 0) {
      toast.error("Veuillez entrer un montant valide");
      return;
    }
    
    if (convertAmount > winningsBalance) {
      toast.error("Montant supérieur à votre solde des gains");
      return;
    }

    const success = onConvert(convertAmount);
    
    if (success) {
      toast.success(`${convertAmount.toLocaleString('fr-FR')} F CFA transférés vers votre solde de jeu !`);
      onClose();
      setAmount("");
    } else {
      toast.error("Erreur lors de la conversion");
    }
  };

  return (
    <Dialog open={open} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <ArrowRightLeft className="h-5 w-5 text-[#FFD700]" />
            Convertir mes gains
          </DialogTitle>
          <DialogDescription>
            Transférez vos gains vers votre solde de jeu pour continuer à jouer
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-6">
          {/* Affichage du solde des gains */}
          <div className="rounded-lg border border-[#34C759] bg-[#34C759]/10 p-4 text-center">
            <p className="text-sm text-muted-foreground mb-1">Solde des Gains disponible</p>
            <p className="text-2xl font-bold text-[#34C759]">
              {winningsBalance.toLocaleString('fr-FR')} F CFA
            </p>
          </div>

          {/* Amount Input */}
          <div className="space-y-2">
            <Label htmlFor="convert-amount">Montant à convertir (F CFA)</Label>
            <Input
              id="convert-amount"
              type="number"
              placeholder="Entrez le montant"
              value={amount}
              onChange={(e) => setAmount(e.target.value)}
              className="bg-input-background border-input focus:border-[#FFD700]"
            />
          </div>

          {/* Quick Amounts */}
          <div className="space-y-2">
            <Label>Montants rapides</Label>
            <div className="grid grid-cols-3 gap-2">
              {QUICK_AMOUNTS.map((amt) => (
                <Button
                  key={amt}
                  variant="outline"
                  disabled={amt > winningsBalance}
                  className="border-border hover:border-[#FFD700] hover:bg-[#FFD700]/10 disabled:opacity-50"
                  onClick={() => setAmount(amt.toString())}
                >
                  {amt.toLocaleString('fr-FR')}
                </Button>
              ))}
              <Button
                variant="outline"
                disabled={winningsBalance === 0}
                className="border-border hover:border-[#FFD700] hover:bg-[#FFD700]/10"
                onClick={() => setAmount(winningsBalance.toString())}
              >
                Tout
              </Button>
            </div>
          </div>

          {/* Information */}
          <div className="rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground">
            💡 Les gains convertis seront ajoutés à votre solde de jeu et pourront être utilisés pour vos prochains paris.
          </div>

          {/* Submit Button */}
          <Button
            className="w-full bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90"
            onClick={handleConvert}
          >
            <ArrowRightLeft className="mr-2 h-4 w-4" />
            Convertir en solde de jeu
          </Button>
        </div>
      </DialogContent>
    </Dialog>
  );
}


================================================================================
--- FICHIER : ./src/components/Dashboard.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { Header } from "./Header";
import { Footer } from "./Footer";
import { RechargeModal } from "./RechargeModal";
import { WinnerFeed } from "./WinnerFeed";
import { WinNotificationPanel } from "./WinNotification";
import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Badge } from "./ui/badge";
import { Clock, Calendar, TrendingUp, Trophy, Loader2 } from "lucide-react";
import { toast } from "sonner@2.0.3";
import { useAuth } from "../contexts/AuthContext";
import { getUpcomingDraws, Draw } from "../utils/drawsAPI";

interface DashboardProps {
  onNavigateToGame: (drawId: string) => void;
  onNavigateToProfile: () => void;
  onNavigateToResellers: (amount?: number) => void;
  onNavigateToResults: () => void;
  playBalance?: number;
  winningsBalance?: number;
  onRecharge: (amount: number) => void;
}

export function Dashboard({
  onNavigateToGame,
  onNavigateToProfile,
  onNavigateToResellers,
  onNavigateToResults,
  playBalance = 0,
  winningsBalance = 0,
  onRecharge,
}: DashboardProps) {
  const { user } = useAuth();
  const [rechargeOpen, setRechargeOpen] = useState(false);
  const [availableDraws, setAvailableDraws] = useState<Draw[]>([]);
  const [featuredDraw, setFeaturedDraw] = useState<Draw | null>(null);
  const [countdownTime, setCountdownTime] = useState({ hours: 0, minutes: 0, seconds: 0 });
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const loadDraws = async () => {
      setLoading(true);
      setError(null);
      
      try {
        const draws = await getUpcomingDraws();
        
        const now = new Date();
        const validDraws = draws
          .filter(draw => {
            const drawDateTime = new Date(`${draw.date}T${draw.time}`);
            return drawDateTime.getTime() > now.getTime();
          })
          .sort((a, b) => {
            const dateA = new Date(`${a.date}T${a.time}`);
            const dateB = new Date(`${b.date}T${b.time}`);
            return dateA.getTime() - dateB.getTime();
          });
        
        setAvailableDraws(validDraws);
        setFeaturedDraw(validDraws[0] || null);
        
      } catch (err) {
        console.error('Erreur chargement tirages:', err);
        setError('Impossible de charger les tirages');
        toast.error('Erreur lors du chargement des tirages');
      } finally {
        setLoading(false);
      }
    };
    
    loadDraws();
    
    const interval = setInterval(loadDraws, 30000);
    return () => clearInterval(interval);
  }, []);

  // Countdown pour le tirage vedette
  useEffect(() => {
    if (!featuredDraw) return;

    let hasExpired = false;

    const updateCountdown = () => {
      const now = new Date();
      const drawDateTime = new Date(`${featuredDraw.date}T${featuredDraw.time}`);
      const diff = drawDateTime.getTime() - now.getTime();
      
      if (diff <= 0 && !hasExpired) {
        hasExpired = true;
        setCountdownTime({ hours: 0, minutes: 0, seconds: 0 });
        
        setTimeout(() => {
          const validDraws = getValidDraws();
          setAvailableDraws(validDraws);
          setFeaturedDraw(validDraws[0] || null);
        }, 500);
        return;
      }
      
      if (diff > 0) {
        const totalSeconds = Math.floor(diff / 1000);
        const h = Math.floor(totalSeconds / 3600);
        const m = Math.floor((totalSeconds % 3600) / 60);
        const s = totalSeconds % 60;
        
        setCountdownTime({ hours: h, minutes: m, seconds: s });
      }
    };

    updateCountdown();
    const timer = setInterval(updateCountdown, 1000);
    return () => clearInterval(timer);
  }, [featuredDraw]);

  // État de chargement
  if (loading) {
    return (
      <div className="min-h-screen bg-background">
        <Header
          balance={playBalance}
          onRecharge={() => setRechargeOpen(true)}
          onProfile={onNavigateToProfile}
        />
        <main className="container px-3 sm:px-4 py-6 sm:py-8 flex-1 flex flex-col items-center justify-center">
          <div className="flex flex-col items-center gap-4">
            <Loader2 className="h-12 w-12 animate-spin text-primary" />
            <p className="text-muted-foreground">Chargement des tirages...</p>
          </div>
        </main>
        <Footer 
          onNavigateToResults={onNavigateToResults}
        />
      </div>
    );
  }

  // État d'erreur
  if (error) {
    return (
      <div className="min-h-screen bg-background">
        <Header
          balance={playBalance}
          onRecharge={() => setRechargeOpen(true)}
          onProfile={onNavigateToProfile}
        />
        <main className="container px-3 sm:px-4 py-6 sm:py-8 flex-1 flex flex-col items-center justify-center">
          <Card className="border-destructive/50 bg-card p-6 sm:p-8 text-center max-w-md w-full">
            <p className="text-destructive mb-4">{error}</p>
            <Button onClick={() => window.location.reload()}>
              Réessayer
            </Button>
          </Card>
        </main>
        <Footer 
          onNavigateToResults={onNavigateToResults}
        />
      </div>
    );
  }

  // Aucun tirage disponible
  if (availableDraws.length === 0) {
    return (
      <div className="min-h-screen bg-background">
        <Header
          balance={playBalance}
          onRecharge={() => setRechargeOpen(true)}
          onProfile={onNavigateToProfile}
        />

{user && <WinNotificationPanel userId={user.id} />}

        <main className="container px-3 sm:px-4 py-6 sm:py-8 flex-1 flex flex-col items-center justify-center">
          <Card className="border-border bg-card p-6 sm:p-8 text-center max-w-md w-full">
            <Calendar className="h-12 w-12 sm:h-16 sm:w-16 mx-auto mb-3 sm:mb-4 text-muted-foreground" />
            <h2 className="text-lg sm:text-xl font-bold text-foreground mb-2">
              Aucun tirage disponible
            </h2>
            <p className="text-sm sm:text-base text-muted-foreground mb-4">
              Il n'y a actuellement aucun tirage programmé.
              Revenez bientôt !
            </p>
          </Card>
        </main>

        <Footer />

        <RechargeModal 
          open={rechargeOpen} 
          onClose={() => setRechargeOpen(false)} 
          balance={playBalance}
          onNavigateToResellers={onNavigateToResellers}
        />
      </div>
    );
  }

  const featuredOperator = featuredDraw ? getOperatorById(featuredDraw.operatorId) : null;
  const featuredDrawInfo = featuredDraw ? formatDrawDisplay(featuredDraw) : null;

  return (
    <div className="min-h-screen bg-background">
      <Header
        balance={playBalance}
        onRecharge={() => setRechargeOpen(true)}
        onProfile={onNavigateToProfile}
      />

      {userId && <WinNotificationPanel userId={userId} />}

      <main className="container px-3 sm:px-4 py-6 sm:py-8 flex-1 flex flex-col">
        {/* SECTION 1 : Tirage Vedette */}
        {featuredDraw && featuredOperator && featuredDrawInfo && (
          <section className="mb-8 sm:mb-12 md:mb-16">
            <Card className="relative overflow-hidden border-none gradient-orange-violet confetti-bg">
              <div className="relative z-10 p-4 sm:p-6 md:p-8 text-center">
                <div className="mx-auto max-w-3xl space-y-4 sm:space-y-6">
                  {/* Titre */}
                  <div className="flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-3">
                    <span className="text-3xl sm:text-4xl md:text-5xl">{featuredOperator.icon}</span>
                    <h1 className="text-xl sm:text-2xl md:text-3xl lg:text-5xl font-bold text-white break-words text-center">
                      {featuredOperator.name}
                    </h1>
                  </div>
                  
                  {/* Info Prix */}
                  <div className="text-base sm:text-lg md:text-xl lg:text-2xl text-white/90 text-center">
                    <div className="text-sm sm:text-base md:text-xl">{featuredOperator.country}</div>
                    <div className="font-bold text-[#FFD700] text-lg sm:text-xl md:text-2xl break-words mt-2">
                      <Trophy className="inline h-5 w-5 sm:h-6 sm:w-6 mr-2" />
                      Tentez de gagner jusqu'à 100,000× votre mise !
                    </div>
                  </div>

                  {/* Info Prochain Tirage */}
                  <div className="bg-white/10 backdrop-blur-sm rounded-xl p-3 sm:p-4 max-w-md mx-auto">
                    <div className="flex flex-col xs:flex-row items-center justify-center gap-1 xs:gap-2 text-white/90 mb-2">
                      <div className="flex items-center gap-2">
                        <Calendar className="h-3 w-3 sm:h-4 sm:w-4" />
                        <span className="text-xs sm:text-sm">
                          {new Date(featuredDraw.date).toLocaleDateString('fr-FR', { 
                            weekday: 'long', 
                            day: 'numeric', 
                            month: 'long' 
                          })}
                        </span>
                      </div>
                    </div>
                    <div className="flex items-center justify-center gap-1 xs:gap-2 text-white mb-2 sm:mb-3">
                      <Clock className="h-3 w-3 sm:h-4 sm:w-4" />
                      <span className="text-xs sm:text-sm">Tirage à {featuredDraw.time}</span>
                    </div>
                    
                    {/* Countdown */}
                    <div className="flex justify-center gap-2 sm:gap-3">
                      {[
                        { label: "Heures", value: countdownTime.hours },
                        { label: "Min", value: countdownTime.minutes },
                        { label: "Sec", value: countdownTime.seconds },
                      ].map((item) => (
                        <div key={item.label} className="flex flex-col items-center gap-0.5 sm:gap-1">
                          <div className="flex h-10 w-10 sm:h-12 sm:w-12 items-center justify-center rounded-lg bg-white/10">
                            <span className="text-base sm:text-lg md:text-xl font-bold text-white">
                              {String(item.value).padStart(2, "0")}
                            </span>
                          </div>
                          <span className="text-[10px] sm:text-xs text-white/80">{item.label}</span>
                        </div>
                      ))}
                    </div>
                  </div>

                  <Button
                    size="lg"
                    className="h-12 sm:h-14 bg-[#FFD700] px-6 sm:px-8 hover:bg-[#FFD700]/90 text-[#121212] shadow-lg hover:shadow-xl transition-all text-sm sm:text-base w-full sm:w-auto"
                    onClick={() => onNavigateToGame(featuredDraw.id)}
                  >
                    Jouer Maintenant
                  </Button>

                  {/* Carte des Soldes */}
                  <div className="mt-6 sm:mt-8 grid grid-cols-1 xs:grid-cols-2 gap-3 sm:gap-4 max-w-2xl mx-auto">
                    <Card className="border-border bg-card/80 backdrop-blur-sm p-3 sm:p-4">
                      <div className="flex items-center justify-between gap-2">
                        <div className="flex-1 min-w-0">
                          <p className="text-xs sm:text-sm text-muted-foreground">Solde de Jeu</p>
                          <p className="text-base sm:text-xl md:text-2xl font-bold text-foreground break-words">
                            {playBalance.toLocaleString('fr-FR')} F
                          </p>
                        </div>
                        <div className="rounded-full bg-[#FFD700]/10 p-2 sm:p-3 flex-shrink-0">
                          <TrendingUp className="h-4 w-4 sm:h-5 sm:w-5 md:h-6 md:w-6 text-[#FFD700]" />
                        </div>
                      </div>
                    </Card>

                    <Card className="border-border bg-card/80 backdrop-blur-sm p-3 sm:p-4">
                      <div className="flex items-center justify-between gap-2">
                        <div className="flex-1 min-w-0">
                          <p className="text-xs sm:text-sm text-muted-foreground">Solde des Gains</p>
                          <p className="text-base sm:text-xl md:text-2xl font-bold text-foreground break-words">
                            {winningsBalance.toLocaleString('fr-FR')} F
                          </p>
                        </div>
                        <div className="rounded-full bg-[#00A651]/10 p-2 sm:p-3 flex-shrink-0">
                          <TrendingUp className="h-6 w-6 text-[#00A651]" />
                        </div>
                      </div>
                    </Card>
                  </div>
                </div>
              </div>
            </Card>
          </section>
        )}

        {/* SECTION 2 : Tous les Tirages Disponibles */}
        {availableDraws.length > 0 && (
          <section className="mb-12">
            <div className="mb-6">
              <h2 className="text-2xl font-bold text-foreground mb-2">
                Tirages Disponibles
              </h2>
              <p className="text-muted-foreground">
                Choisissez votre tirage et tentez votre chance
              </p>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {availableDraws.map(draw => {
                const operator = getOperatorById(draw.operatorId);
                if (!operator) return null;
                
                const drawDate = new Date(`${draw.date}T${draw.time}`);
                const now = new Date();
                const diff = drawDate.getTime() - now.getTime();
                
                let countdown = "Bientôt";
                if (diff > 0) {
                  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                  const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                  
                  if (days > 0) {
                    countdown = `Dans ${days}j ${hours}h`;
                  } else if (hours > 0) {
                    countdown = `Dans ${hours}h ${minutes}min`;
                  } else {
                    countdown = `Dans ${minutes}min`;
                  }
                }
                
                return (
                  <Card 
                    key={draw.id} 
                    className="group relative overflow-hidden border-2 border-border hover:border-[#FFD700] transition-all duration-300 cursor-pointer"
                    onClick={() => onNavigateToGame(draw.id)}
                  >
                    <div 
                      className="absolute inset-0 opacity-10 group-hover:opacity-20 transition-opacity" 
                      style={{ backgroundColor: operator.color }}
                    />
                    
                    <div className="relative p-6">
                      {/* Header */}
                      <div className="flex items-start justify-between mb-4">
                        <div className="flex items-center gap-3">
                          <span className="text-4xl">{operator.icon}</span>
                          <div>
                            <h3 className="font-bold text-lg text-foreground">
                              {operator.name}
                            </h3>
                            <p className="text-sm text-muted-foreground">
                              {operator.country}
                            </p>
                          </div>
                        </div>
                      </div>

                      {/* Date et Heure */}
                      <div className="space-y-2 mb-4">
                        <div className="flex items-center gap-2 text-sm text-muted-foreground">
                          <Calendar className="h-4 w-4" />
                          <span>
                            {drawDate.toLocaleDateString('fr-FR', { 
                              weekday: 'short', 
                              day: 'numeric', 
                              month: 'short' 
                            })}
                          </span>
                        </div>
                        <div className="flex items-center gap-2 text-sm text-muted-foreground">
                          <Clock className="h-4 w-4" />
                          <span>{draw.time}</span>
                        </div>
                      </div>

                      {/* Countdown */}
                      <Badge className="mb-4 bg-[#FFD700]/20 text-[#FFD700] border-[#FFD700]/30">
                        {countdown}
                      </Badge>

                      {/* Participants */}
                      {draw.participants !== undefined && draw.participants > 0 && (
                        <p className="text-xs text-muted-foreground mb-4">
                          {draw.participants} participant{draw.participants > 1 ? 's' : ''}
                        </p>
                      )}

                      {/* Button */}
                      <Button 
                        className="w-full bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90"
                        onClick={(e) => {
                          e.stopPropagation();
                          onNavigateToGame(draw.id);
                        }}
                      >
                        Jouer
                      </Button>
                    </div>
                  </Card>
                );
              })}
            </div>
          </section>
        )}

        {/* SECTION 3 : Fil des Gagnants */}
        <WinnerFeed onNavigateToResults={onNavigateToResults} />
      </main>

      <Footer />

      <RechargeModal 
        open={rechargeOpen} 
        onClose={() => setRechargeOpen(false)} 
        balance={playBalance}
        onNavigateToResellers={onNavigateToResellers}
      />
    </div>
  );
}


================================================================================
--- FICHIER : ./src/components/Footer.tsx ---
================================================================================

import { AlertTriangle, Shield } from "lucide-react";
import { Alert, AlertDescription } from "./ui/alert";
import { Separator } from "./ui/separator";

export function Footer() {
  return (
    <footer className="mt-16 border-t border-border bg-card/50">
      <div className="container px-4 py-12">
        {/* --- CORRECTION PRINCIPALE ICI --- */}
        <div className="grid grid-cols-1 gap-8 md:grid-cols-3">
          {/* Liens Utiles */}
          <div>
            <h4 className="mb-4 font-semibold text-foreground">
              Liens Utiles
            </h4>
            <ul className="space-y-2">
              <li>
                <a
                  href="#"
                  className="text-sm text-muted-foreground hover:text-[#FFD700] transition-colors"
                >
                  Comment jouer
                </a>
              </li>
              <li>
                <a
                  href="#"
                  className="text-sm text-muted-foreground hover:text-[#FFD700] transition-colors"
                >
                  Résultats des tirages
                </a>
              </li>
              <li>
                <a
                  href="#"
                  className="text-sm text-muted-foreground hover:text-[#FFD700] transition-colors"
                >
                  FAQ
                </a>
              </li>
              <li>
                <a
                  href="#"
                  className="text-sm text-muted-foreground hover:text-[#FFD700] transition-colors"
                >
                  Support client
                </a>
              </li>
            </ul>
          </div>

          {/* Paiements Sécurisés */}
          <div>
            <h4 className="mb-4 font-semibold text-foreground">
              Paiements Sécurisés
            </h4>
            {/* --- AMÉLIORATION (PLUS ROBUSTE) ICI --- */}
            <div className="flex flex-wrap items-center gap-3">
              <div className="flex h-12 items-center rounded-lg border border-border bg-background px-3">
                <span className="text-xs font-semibold text-[#FFD700]">
                  T-Money
                </span>
              </div>
              <div className="flex h-12 items-center rounded-lg border border-border bg-background px-3">
                <span className="text-xs font-semibold text-[#FF6B00]">
                  Flooz
                </span>
              </div>
              <div className="flex h-12 items-center rounded-lg border border-border bg-background px-3">
                <span className="text-xs font-semibold text-[#FF6B00]">
                  Orange
                </span>
              </div>
            </div>
            <div className="mt-4 flex items-center gap-2 text-sm text-muted-foreground">
              <Shield className="h-4 w-4 text-[#34C759]" />
              <span>Transactions 100% sécurisées</span>
            </div>
          </div>

          {/* Informations Légales */}
          <div>
            <h4 className="mb-4 font-semibold text-foreground">
              Informations Légales
            </h4>
            <ul className="space-y-2">
              <li>
                <a
                  href="#"
                  className="text-sm text-muted-foreground hover:text-[#FFD700] transition-colors"
                >
                  Conditions d'utilisation
                </a>
              </li>
              <li>
                <a
                  href="#"
                  className="text-sm text-muted-foreground hover:text-[#FFD700] transition-colors"
                >
                  Politique de confidentialité
                </a>
              </li>
              <li>
                <a
                  href="#"
                  className="text-sm text-muted-foreground hover:text-[#FFD700] transition-colors"
                >
                  Jeu responsable
                </a>
              </li>
            </ul>
          </div>
        </div>

        <Separator className="my-8" />

        {/* Age Warning */}
        <Alert className="border-[#FF3B30] bg-[#FF3B30]/10">
          <AlertTriangle className="h-4 w-4 text-[#FF3B30]" />
          <AlertDescription className="text-sm text-foreground">
            <strong>Jeu interdit aux moins de 18 ans.</strong>{" "}
            Jouer comporte des risques : endettement, isolement,
            dépendance. Pour être aidé, appelez le
            09-74-75-13-13 (appel non surtaxé).
          </AlertDescription>
        </Alert>

        <div className="mt-8 text-center text-sm text-muted-foreground">
          <p>© 2025 Africa Millions. Tous droits réservés.</p>
        </div>
      </div>
    </footer>
  );
}

================================================================================
--- FICHIER : ./src/components/GameCard.tsx ---
================================================================================

import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Calendar, Clock, Sparkles } from "lucide-react";
import { GameConfig } from "../utils/games";

interface GameCardProps {
  game: GameConfig;
  nextDrawDate: string;
  nextDrawTime: string;
  countdown: string;
  onClick: () => void;
}

export function GameCard({ game, nextDrawDate, nextDrawTime, countdown, onClick }: GameCardProps) {
  return (
    <Card 
      className="group overflow-hidden border border-border bg-card transition-all hover:shadow-lg cursor-pointer"
      style={{ 
        borderColor: `${game.color}20`,
      }}
      onClick={onClick}
    >
      {/* Header avec icône et type */}
      <div 
        className="relative p-6 text-white"
        style={{ 
          background: `linear-gradient(135deg, ${game.color} 0%, ${game.color}dd 100%)` 
        }}
      >
        <div className="flex items-start justify-between mb-3">
          <div className="flex items-center gap-3">
            <span className="text-4xl">{game.icon}</span>
            <div>
              <h3 className="font-bold text-xl">{game.name}</h3>
              <p className="text-sm text-white/80">{game.country}</p>
            </div>
          </div>
          <div className="bg-white/20 backdrop-blur-sm px-3 py-1 rounded-full">
            <span className="text-xs font-semibold uppercase">{game.type}</span>
          </div>
        </div>

        {/* Info du jeu */}
        <div className="bg-white/10 backdrop-blur-sm rounded-lg p-3 mt-4">
          <div className="flex items-center justify-between text-sm">
            <span className="text-white/80">Sélectionner</span>
            <span className="font-bold">{game.numbersCount} numéros</span>
          </div>
          <div className="flex items-center justify-between text-sm mt-1">
            <span className="text-white/80">Pool</span>
            <span className="font-bold">1 - {game.numbersMax}</span>
          </div>
        </div>
      </div>

      {/* Content Area */}
      <div className="space-y-4 p-6">
        {/* Prochain Tirage */}
        <div className="space-y-2">
          <div className="flex items-center gap-2 text-muted-foreground">
            <Calendar className="h-4 w-4" />
            <span className="text-sm">{nextDrawDate}</span>
          </div>
          <div className="flex items-center gap-2 text-muted-foreground">
            <Clock className="h-4 w-4" />
            <span className="text-sm">Tirage à {nextDrawTime}</span>
          </div>
          <div 
            className="flex items-center gap-2 font-semibold"
            style={{ color: game.color }}
          >
            <Sparkles className="h-4 w-4" />
            <span className="text-sm">{countdown}</span>
          </div>
        </div>

        {/* Prix et Gains */}
        <div className="bg-muted rounded-lg p-3 space-y-2">
          <div className="flex items-center justify-between">
            <span className="text-xs text-muted-foreground">Mise minimale</span>
            <span className="font-bold text-foreground">{game.minBet.toLocaleString('fr-FR')} F</span>
          </div>
          <div className="flex items-center justify-between">
            <span className="text-xs text-muted-foreground">Gain max ({game.numbersCount}/{game.numbersCount})</span>
            <span 
              className="font-bold"
              style={{ color: game.color }}
            >
              {game.prizes[game.numbersCount]?.toLocaleString('fr-FR')} F
            </span>
          </div>
        </div>

        {/* Bouton Jouer */}
        <Button
          className="w-full rounded-full text-[#121212] hover:opacity-90 transition-all shadow-md"
          style={{ backgroundColor: game.color }}
          onClick={(e) => {
            e.stopPropagation();
            onClick();
          }}
        >
          Jouer Maintenant
        </Button>
      </div>
    </Card>
  );
}


================================================================================
--- FICHIER : ./src/components/GameScreen.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { Header } from "./Header";
import { Footer } from "./Footer";
import { RechargeModal } from "./RechargeModal";
import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Badge } from "./ui/badge";
import { ArrowLeft, Calendar, Clock, Info, Loader2 } from "lucide-react";
import { toast } from "sonner@2.0.3";
import { getOperatorById, BET_TYPES_CONFIG, BetType } from "../utils/games";
import { getDrawById, Draw } from "../utils/drawsAPI";
import { GameScreenAdvanced } from "./GameScreenAdvanced";

interface GameScreenProps {
  drawId: string;
  onBack: () => void;
  onNavigateToProfile: () => void;
  playBalance?: number;
  onPlaceBet?: (amount: number) => boolean;
}

export function GameScreen({ drawId, onBack, onNavigateToProfile, playBalance = 0, onPlaceBet }: GameScreenProps) {
  const [rechargeOpen, setRechargeOpen] = useState(false);
  const [draw, setDraw] = useState<Draw | null>(null);
  const [selectedBetType, setSelectedBetType] = useState<BetType | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const loadDraw = async () => {
      setLoading(true);
      try {
        const loadedDraw = await getDrawById(drawId);
        setDraw(loadedDraw);
      } catch (error) {
        toast.error("Impossible de charger les informations du tirage.");
        console.error(error);
      } finally {
        setLoading(false);
      }
    };
    loadDraw();
  }, [drawId]);

  if (loading) {
    return (
        <div className="min-h-screen bg-background flex items-center justify-center">
            <Loader2 className="h-12 w-12 animate-spin text-primary" />
        </div>
    )
  }

  if (!draw) {
    return (
      <div className="min-h-screen bg-background flex items-center justify-center">
        <Card className="p-8">
          <p className="text-foreground">Tirage introuvable</p>
          <Button onClick={onBack} className="mt-4">Retour</Button>
        </Card>
      </div>
    );
  }

  const operator = getOperatorById(draw.operatorId);
  
  if (!operator) {
    return (
      <div className="min-h-screen bg-background flex items-center justify-center">
        <Card className="p-8">
          <p className="text-foreground">Opérateur introuvable</p>
          <Button onClick={onBack} className="mt-4">Retour</Button>
        </Card>
      </div>
    );
  }

  if (selectedBetType) {
    return (
      <GameScreenAdvanced
        drawId={drawId}
        betType={selectedBetType}
        onBack={() => setSelectedBetType(null)}
        onNavigateToProfile={onNavigateToProfile}
        playBalance={playBalance}
        onPlaceBet={onPlaceBet}
      />
    );
  }

  const drawDate = new Date(`${draw.date}T${draw.time}`);
  const now = new Date();
  const diff = drawDate.getTime() - now.getTime();
  
  let countdown = "Terminé";
  if (diff > 0) {
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    
    if (days > 0) {
      countdown = `${days}j ${hours}h ${minutes}min`;
    } else if (hours > 0) {
      countdown = `${hours}h ${minutes}min`;
    } else {
      countdown = `${minutes}min`;
    }
  }

  return (
    <div className="min-h-screen bg-background">
      <Header
        balance={playBalance}
        onRecharge={() => setRechargeOpen(true)}
        onProfile={onNavigateToProfile}
      />

      <main className="container px-3 sm:px-4 py-6 sm:py-8">
        <div className="mb-6">
          <Button
            variant="ghost"
            onClick={onBack}
            className="mb-4"
          >
            <ArrowLeft className="mr-2 h-4 w-4" />
            Retour
          </Button>

          <div className="flex items-center gap-4">
            <span className="text-5xl">{operator.icon}</span>
            <div>
              <h1 className="text-3xl font-bold text-foreground">
                {operator.name}
              </h1>
              <p className="text-muted-foreground">{operator.country}</p>
            </div>
          </div>
        </div>

        <Card className="mb-8 p-6 border-border">
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="flex items-center gap-3">
              <Calendar className="h-5 w-5 text-[#FFD700]" />
              <div>
                <p className="text-xs text-muted-foreground">Date</p>
                <p className="font-semibold">
                  {drawDate.toLocaleDateString('fr-FR', {
                    weekday: 'long',
                    day: 'numeric',
                    month: 'long'
                  })}
                </p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <Clock className="h-5 w-5 text-[#FF6B00]" />
              <div>
                <p className="text-xs text-muted-foreground">Heure</p>
                <p className="font-semibold">{draw.time}</p>
              </div>
            </div>
            <div>
              <p className="text-xs text-muted-foreground">Temps restant</p>
              <Badge className="bg-[#4F00BC]/20 text-[#4F00BC] border-[#4F00BC]/30">
                {countdown}
              </Badge>
            </div>
          </div>
        </Card>

        <Card className="mb-8 p-4 bg-[#FFD700]/10 border-[#FFD700]/30">
          <div className="flex items-start gap-3">
            <Info className="h-5 w-5 text-[#FFD700] mt-0.5" />
            <div>
              <p className="font-semibold text-foreground mb-1">Comment jouer ?</p>
              <p className="text-sm text-muted-foreground">
                Choisissez votre type de pari ci-dessous. Chaque type offre des gains différents
                et nécessite un nombre de numéros spécifique. Les gains sont calculés en multipliant
                votre mise par le multiplicateur du type de pari.
              </p>
            </div>
          </div>
        </Card>

        <div className="mb-8">
          <h2 className="text-2xl font-bold text-foreground mb-4">
            Choisissez Votre Type de Pari
          </h2>
          <p className="text-muted-foreground mb-6">
            Sélectionnez le type de pari qui vous convient le mieux
          </p>

          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {Object.values(BET_TYPES_CONFIG).map((betConfig) => {
              const multiplier = draw.multipliers?.[betConfig.id] ?? betConfig.defaultMultiplier;

              return (
                <Card
                  key={betConfig.id}
                  className="p-6 border-2 border-border hover:border-[#FFD700] transition-all cursor-pointer group"
                  onClick={() => setSelectedBetType(betConfig.id)}
                >
                  <div className="flex items-start justify-between mb-3">
                    <span className="text-3xl">{betConfig.icon}</span>
                    <Badge className="bg-[#FFD700]/20 text-[#FFD700] border-[#FFD700]/30">
                      ×{multiplier.toLocaleString()}
                    </Badge>
                  </div>

                  <h3 className="font-bold text-lg text-foreground mb-2">
                    {betConfig.name}
                  </h3>

                  <p className="text-sm text-muted-foreground mb-3">
                    {betConfig.description}
                  </p>

                  <div className="flex items-center justify-between text-xs text-muted-foreground">
                    <span>
                      {betConfig.minNumbers === betConfig.maxNumbers
                        ? `${betConfig.minNumbers} numéro${betConfig.minNumbers > 1 ? 's' : ''}`
                        : `${betConfig.minNumbers}-${betConfig.maxNumbers} numéros`
                      }
                    </span>
                  </div>

                  <Button
                    className="w-full mt-4 bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90 group-hover:shadow-lg transition-all"
                    onClick={(e) => {
                      e.stopPropagation();
                      setSelectedBetType(betConfig.id);
                    }}
                  >
                    Choisir
                  </Button>
                </Card>
              );
            })}
          </div>
        </div>

        <Card className="p-6 border-border">
          <h3 className="text-xl font-bold text-foreground mb-4">
            Exemples de Gains
          </h3>
          <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
            {[
              { type: 'NAP1', mise: 100 },
              { type: 'NAP2', mise: 500 },
              { type: 'NAP5', mise: 1000 },
            ].map(({ type, mise }) => {
              const betType = type as BetType;
              const multiplier = draw.multipliers?.[betType] ?? BET_TYPES_CONFIG[betType].defaultMultiplier;
              const gain = mise * multiplier;

              return (
                <div key={type} className="p-4 bg-muted rounded-lg">
                  <p className="text-sm text-muted-foreground mb-1">{BET_TYPES_CONFIG[betType].name}</p>
                  <p className="text-xs text-muted-foreground mb-2">Mise : {mise.toLocaleString()} F</p>
                  <p className="text-lg font-bold text-[#FFD700]">
                    Gain : {gain.toLocaleString()} F
                  </p>
                </div>
              );
            })}
          </div>
        </Card>
      </main>

      <Footer />

      <RechargeModal
        open={rechargeOpen}
        onClose={() => setRechargeOpen(false)}
        balance={playBalance}
        onNavigateToResellers={() => {}}
      />
    </div>
  );
}


================================================================================
--- FICHIER : ./src/components/GameScreenAdvanced.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { Header } from "./Header";
import { Footer } from "./Footer";
import { RechargeModal } from "./RechargeModal";
import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Label } from "./ui/label";
import { Input } from "./ui/input";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "./ui/select";
import { Badge } from "./ui/badge";
import { Separator } from "./ui/separator";
import { ArrowLeft, Sparkles, Calendar, Clock, Info, Calculator, Loader2 } from "lucide-react";
import { toast } from "sonner@2.0.3";
import { motion } from "motion/react";
import { useAuth } from "../contexts/AuthContext";
import { createTicket as createTicketAPI, getDrawById, Draw } from "../utils/drawsAPI";
import { 
  getOperatorById,
  BetType, 
  BET_TYPES_CONFIG,
  calculatePermutationCombinations,
  generateNAP2Combinations,
  invertNumber,
} from "../utils/games";

interface GameScreenAdvancedProps {
  drawId: string;
  betType: BetType;
  onBack: () => void;
  onNavigateToProfile: () => void;
  playBalance?: number;
}

export function GameScreenAdvanced({ 
  drawId,
  betType,
  onBack, 
  onNavigateToProfile, 
  playBalance = 0, 
}: GameScreenAdvancedProps) {
  const { user, refreshUser } = useAuth();
  const [rechargeOpen, setRechargeOpen] = useState(false);
  const [draw, setDraw] = useState<Draw | null>(null);
  const [submitting, setSubmitting] = useState(false);
  const [loading, setLoading] = useState(true);
  
  const [selectedNumbers, setSelectedNumbers] = useState<number[]>([]);
  const [baseNumber, setBaseNumber] = useState<number | null>(null);
  const [associatedNumbers, setAssociatedNumbers] = useState<number[]>([]);
  const [position, setPosition] = useState<'first' | 'last'>('first');
  
  const [betAmount, setBetAmount] = useState<number>(100);
  const [customBetInput, setCustomBetInput] = useState<string>('');

  const betTypeConfig = BET_TYPES_CONFIG[betType];

  useEffect(() => {
    const loadDraw = async () => {
        setLoading(true);
        try {
            const loadedDraw = await getDrawById(drawId);
            setDraw(loadedDraw);
        } catch (error) {
            toast.error("Impossible de charger les informations du tirage.");
            console.error(error);
        } finally {
            setLoading(false);
        }
    };
    loadDraw();
  }, [drawId]);

  if (loading) {
    return (
        <div className="min-h-screen bg-background flex items-center justify-center">
            <Loader2 className="h-12 w-12 animate-spin text-primary" />
        </div>
    )
  }

  if (!draw) {
    return (
      <div className="min-h-screen bg-background flex items-center justify-center">
        <Card className="p-8">
          <p className="text-foreground">Tirage introuvable</p>
          <Button onClick={onBack} className="mt-4">Retour</Button>
        </Card>
      </div>
    );
  }

  const operator = getOperatorById(draw.operatorId);
  if (!operator) {
    return (
      <div className="min-h-screen bg-background flex items-center justify-center">
        <Card className="p-8">
          <p className="text-foreground">Opérateur introuvable</p>
          <Button onClick={onBack} className="mt-4">Retour</Button>
        </Card>
      </div>
    );
  }

  const multiplier = draw.multipliers?.[betType] ?? betTypeConfig.defaultMultiplier;
  const numbers = Array.from({ length: operator.numbersPool }, (_, i) => i + 1);

  const toggleNumber = (num: number) => {
    if (betType === 'BANKA') {
      if (baseNumber === num) {
        setBaseNumber(null);
      } else if (associatedNumbers.includes(num)) {
        setAssociatedNumbers(associatedNumbers.filter(n => n !== num));
      } else if (!baseNumber) {
        setBaseNumber(num);
      } else if (associatedNumbers.length < betTypeConfig.maxNumbers - 1) {
        setAssociatedNumbers([...associatedNumbers, num].sort((a, b) => a - b));
      } else {
        toast.error(`Maximum ${betTypeConfig.maxNumbers - 1} numéros associés`);
      }
    } else {
      if (selectedNumbers.includes(num)) {
        setSelectedNumbers(selectedNumbers.filter(n => n !== num));
      } else if (selectedNumbers.length < betTypeConfig.maxNumbers) {
        setSelectedNumbers([...selectedNumbers, num].sort((a, b) => a - b));
      } else {
        toast.error(`Vous ne pouvez sélectionner que ${betTypeConfig.maxNumbers} numéro${betTypeConfig.maxNumbers > 1 ? 's' : ''}`);
      }
    }
  };

  const quickPick = () => {
    if (betType === 'BANKA') {
      const randomNumbers: number[] = [];
      while (randomNumbers.length < 3) {
        const num = Math.floor(Math.random() * operator.numbersPool) + 1;
        if (!randomNumbers.includes(num)) {
          randomNumbers.push(num);
        }
      }
      setBaseNumber(randomNumbers[0]);
      setAssociatedNumbers(randomNumbers.slice(1).sort((a, b) => a - b));
    } else {
      const randomNumbers: number[] = [];
      const count = betType === 'PERMUTATION' ? 4 : betTypeConfig.maxNumbers;
      while (randomNumbers.length < count) {
        const num = Math.floor(Math.random() * operator.numbersPool) + 1;
        if (!randomNumbers.includes(num)) {
          randomNumbers.push(num);
        }
      }
      setSelectedNumbers(randomNumbers.sort((a, b) => a - b));
    }
    toast.success('Sélection rapide effectuée !');
  };

  const getTotalCost = () => {
    if (betType === 'PERMUTATION') {
      const combinations = calculatePermutationCombinations(selectedNumbers.length);
      return combinations * betAmount;
    }
    return betAmount;
  };

  const getPotentialWin = () => {
    return betAmount * multiplier;
  };

  const quickBetAmounts = [100, 500, 1000, 5000, 10000];

  const handleBetAmountChange = (amount: number) => {
    setBetAmount(amount);
    setCustomBetInput(amount.toString());
  };

  const handleCustomBetChange = (value: string) => {
    setCustomBetInput(value);
    const num = parseInt(value);
    if (!isNaN(num) && num >= 0) {
      setBetAmount(num);
    }
  };

  const handlePlaceBet = async () => {
    if (!user) {
      toast.error("Vous devez être connecté");
      return;
    }

    if (betType === 'BANKA') {
      if (!baseNumber || associatedNumbers.length === 0) {
        toast.error("Sélectionnez un numéro de base et au moins un numéro associé");
        return;
      }
    } else if (betType === 'CHANCE_PLUS' || betType === 'ANAGRAMME') {
      if (selectedNumbers.length !== 1) {
        toast.error("Sélectionnez exactement 1 numéro");
        return;
      }
    } else {
      if (selectedNumbers.length < betTypeConfig.minNumbers || selectedNumbers.length > betTypeConfig.maxNumbers) {
        toast.error(`Sélectionnez entre ${betTypeConfig.minNumbers} et ${betTypeConfig.maxNumbers} numéros`);
        return;
      }
    }

    const totalCost = getTotalCost();
    if (totalCost > playBalance) {
      toast.error("Solde insuffisant");
      setRechargeOpen(true);
      return;
    }

    setSubmitting(true);

    try {
      let numbers = "";
      let combinations: number[][] | undefined;
      
      if (betType === 'BANKA') {
        numbers = `${baseNumber}, ${associatedNumbers.join(', ')}`;
      } else if (betType === 'PERMUTATION') {
        numbers = selectedNumbers.join(', ');
        combinations = generateNAP2Combinations(selectedNumbers);
      } else if (betType === 'CHANCE_PLUS') {
        numbers = selectedNumbers[0].toString();
      } else {
        numbers = selectedNumbers.join(', ');
      }

      const result = await createTicketAPI({
        drawId,
        betType,
        numbers,
        betAmount: totalCost,
        baseNumber: baseNumber ?? undefined,
        associatedNumbers: associatedNumbers.length > 0 ? associatedNumbers : undefined,
        position: betType === 'CHANCE_PLUS' ? position : undefined,
        combinations,
      });

      const operator = getOperatorById(draw.operatorId);
      toast.success(
        `Pari enregistré ! ${betTypeConfig.name} - ${operator?.name}`,
        {
          description: `Nouveau solde : ${result.newBalance.toLocaleString('fr-FR')} F`,
          duration: 4000,
        }
      );

      await refreshUser();

      setTimeout(() => {
        onNavigateToProfile();
      }, 1500);

    } catch (error: any) {
      console.error('Erreur création ticket:', error);
      toast.error(error.message || 'Erreur lors de la création du pari');
    } finally {
      setSubmitting(false);
    }
  };

  const drawDate = new Date(`${draw.date}T${draw.time}`);

  return (
    <div className="min-h-screen bg-background">
      <Header
        balance={playBalance}
        onRecharge={() => setRechargeOpen(true)}
        onProfile={onNavigateToProfile}
      />

      <main className="container px-3 sm:px-4 py-6 sm:py-8">
        <div className="mb-6">
          <Button variant="ghost" onClick={onBack} className="mb-4">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Retour
          </Button>

          <div className="flex items-center gap-4">
            <span className="text-5xl">{operator.icon}</span>
            <div>
              <h1 className="text-3xl font-bold text-foreground">
                {operator.name}
              </h1>
              <Badge className="bg-[#4F00BC]/20 text-[#4F00BC] border-[#4F00BC]/30">
                {betTypeConfig.name}
              </Badge>
            </div>
          </div>
        </div>

        <Card className="mb-6 p-4 border-border">
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
            <div className="flex items-center gap-2">
              <Calendar className="h-4 w-4 text-muted-foreground" />
              <span>{drawDate.toLocaleDateString('fr-FR')}</span>
            </div>
            <div className="flex items-center gap-2">
              <Clock className="h-4 w-4 text-muted-foreground" />
              <span>{draw.time}</span>
            </div>
            <div className="flex items-center gap-2">
              <Calculator className="h-4 w-4 text-muted-foreground" />
              <span>Multiplicateur: ×{multiplier.toLocaleString()}</span>
            </div>
          </div>
        </Card>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div className="lg:col-span-2">
            <Card className="p-6">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-xl font-bold text-foreground">
                  Sélectionnez Vos Numéros
                </h2>
                <Button variant="outline" size="sm" onClick={quickPick}>
                  <Sparkles className="mr-2 h-4 w-4" />
                  Sélection Rapide
                </Button>
              </div>

              {betType === 'BANKA' && (
                <Card className="p-4 mb-4 bg-[#FFD700]/10 border-[#FFD700]/30">
                  <div className="flex items-start gap-2">
                    <Info className="h-4 w-4 text-[#FFD700] mt-0.5" />
                    <div className="text-sm text-foreground">
                      <p className="font-semibold mb-1">Mode BANKA :</p>
                      <p>1. Sélectionnez d'abord votre numéro de base (surligné en or)</p>
                      <p>2. Ensuite, sélectionnez vos numéros associés</p>
                    </div>
                  </div>
                </Card>
              )}

              {betType === 'CHANCE_PLUS' && (
                <div className="mb-4">
                  <Label>Position</Label>
                  <Select value={position} onValueChange={(v: 'first' | 'last') => setPosition(v)}>
                    <SelectTrigger>
                      <SelectValue />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="first">Premier numéro tiré</SelectItem>
                      <SelectItem value="last">Dernier numéro tiré</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              )}

              <div className="grid grid-cols-9 sm:grid-cols-10 gap-2">
                {numbers.map(num => {
                  let isSelected = false;
                  let isBase = false;
                  
                  if (betType === 'BANKA') {
                    isBase = baseNumber === num;
                    isSelected = associatedNumbers.includes(num);
                  } else {
                    isSelected = selectedNumbers.includes(num);
                  }

                  const inverted = betType === 'ANAGRAMME' ? invertNumber(num) : null;
                  const showInverted = betType === 'ANAGRAMME' && inverted && inverted <= operator.numbersPool;

                  return (
                    <motion.button
                      key={num}
                      whileHover={{ scale: 1.1 }}
                      whileTap={{ scale: 0.95 }}
                      onClick={() => toggleNumber(num)}
                      className={`
                        aspect-square flex items-center justify-center rounded-lg
                        transition-all duration-200 font-semibold text-sm
                        ${isBase 
                          ? 'bg-[#FFD700] text-[#121212] shadow-lg' 
                          : isSelected
                          ? 'bg-[#4F00BC] text-white shadow-lg'
                          : 'bg-muted text-foreground hover:bg-muted-foreground/20'
                        }
                      `}
                    >
                      <div className="text-center">
                        <div>{num}</div>
                        {showInverted && (
                          <div className="text-[10px] opacity-70">({inverted})</div>
                        )}
                      </div>
                    </motion.button>
                  );
                })}
              </div>
            </Card>
          </div>

          <div className="lg:col-span-1">
            <Card className="p-6 sticky top-4">
              <h3 className="font-bold text-lg mb-4">Récapitulatif</h3>

              <div className="mb-4">
                <Label className="text-sm text-muted-foreground">Numéros sélectionnés</Label>
                {betType === 'BANKA' ? (
                  <div className="mt-2">
                    {baseNumber && (
                      <Badge className="bg-[#FFD700]/20 text-[#FFD700] border-[#FFD700]/30 mr-2">
                        Base: {baseNumber}
                      </Badge>
                    )}
                    {associatedNumbers.length > 0 && (
                      <Badge className="bg-[#4F00BC]/20 text-[#4F00BC] border-[#4F00BC]/30">
                        {associatedNumbers.join(', ')}
                      </Badge>
                    )}
                  </div>
                ) : (
                  <p className="text-lg font-semibold text-[#FFD700] mt-2">
                    {selectedNumbers.length > 0 ? selectedNumbers.join(', ') : 'Aucun'}
                  </p>
                )}
              </div>

              <Separator className="my-4" />

              <div className="mb-4">
                <Label>Mise par {betType === 'PERMUTATION' ? 'combinaison' : 'pari'}</Label>
                <div className="grid grid-cols-3 gap-2 mt-2">
                  {quickBetAmounts.map(amount => (
                    <Button
                      key={amount}
                      variant={betAmount === amount ? "default" : "outline"}
                      size="sm"
                      onClick={() => handleBetAmountChange(amount)}
                      className={betAmount === amount ? "bg-[#FFD700] text-[#121212]" : ""}
                    >
                      {amount >= 1000 ? `${amount / 1000}K` : amount}
                    </Button>
                  ))}
                </div>
                <Input
                  type="number"
                  placeholder="Mise personnalisée"
                  value={customBetInput}
                  onChange={(e) => handleCustomBetChange(e.target.value)}
                  className="mt-2"
                />
              </div>

              <Separator className="my-4" />

              {betType === 'PERMUTATION' && selectedNumbers.length >= 2 && (
                <div className="mb-4 p-3 bg-muted rounded-lg">
                  <p className="text-sm text-muted-foreground">Combinaisons générées</p>
                  <p className="text-lg font-bold text-foreground">
                    {calculatePermutationCombinations(selectedNumbers.length)}
                  </p>
                </div>
              )}

              <div className="mb-4">
                <p className="text-sm text-muted-foreground">Coût Total</p>
                <p className="text-2xl font-bold text-foreground">
                  {getTotalCost().toLocaleString()} F
                </p>
              </div>

              <div className="mb-6 p-4 bg-gradient-to-r from-[#FFD700]/20 to-[#FF6B00]/20 rounded-lg">
                <p className="text-sm text-muted-foreground mb-1">Gain Potentiel</p>
                <p className="text-2xl font-bold text-[#FFD700]">
                  {getPotentialWin().toLocaleString()} F
                </p>
              </div>

              <Button
                className="w-full bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90"
                size="lg"
                onClick={handlePlaceBet}
                disabled={
                  submitting ||
                  (betType === 'BANKA' 
                    ? !baseNumber || associatedNumbers.length === 0
                    : selectedNumbers.length < betTypeConfig.minNumbers)
                }
              >
                {submitting ? (
                  <>
                    <Loader2 className="mr-2 h-5 w-5 animate-spin" />
                    Enregistrement...
                  </>
                ) : (
                  'Valider le Pari'
                )}
              </Button>
            </Card>
          </div>
        </div>
      </main>

      <Footer />

      <RechargeModal
        open={rechargeOpen}
        onClose={() => setRechargeOpen(false)}
        balance={playBalance}
        onNavigateToResellers={() => {}}
      />
    </div>
  );
}


================================================================================
--- FICHIER : ./src/components/GoogleAuthModal.tsx ---
================================================================================

import { useState } from "react";
import { motion, AnimatePresence } from "motion/react";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from "./ui/dialog";
import { Button } from "./ui/button";
import { X } from "lucide-react";

interface GoogleAccount {
  email: string;
  name: string;
  avatar: string;
}

// Comptes Google de test pour simulation
const GOOGLE_TEST_ACCOUNTS: GoogleAccount[] = [
  {
    email: "joueur.test@gmail.com",
    name: "Joueur Test",
    avatar: "🎮",
  },
  {
    email: "marie.dupont@gmail.com",
    name: "Marie Dupont",
    avatar: "👩",
  },
  {
    email: "nouveau.joueur@gmail.com",
    name: "Nouveau Joueur",
    avatar: "🆕",
  },
];

interface GoogleAuthModalProps {
  open: boolean;
  onClose: () => void;
  onSelectAccount: (email: string, name: string) => void;
}

export function GoogleAuthModal({ open, onClose, onSelectAccount }: GoogleAuthModalProps) {
  const [selectedEmail, setSelectedEmail] = useState<string | null>(null);

  const handleSelectAccount = (account: GoogleAccount) => {
    setSelectedEmail(account.email);
    // Animation de sélection puis appel
    setTimeout(() => {
      onSelectAccount(account.email, account.name);
      setSelectedEmail(null);
    }, 300);
  };

  return (
    <Dialog open={open} onOpenChange={onClose}>
      <DialogContent className="max-w-md border-border bg-card">
        <DialogHeader>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <svg className="h-8 w-8" viewBox="0 0 24 24">
                <path
                  fill="#4285F4"
                  d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                />
                <path
                  fill="#34A853"
                  d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                />
                <path
                  fill="#FBBC05"
                  d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                />
                <path
                  fill="#EA4335"
                  d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                />
              </svg>
              <DialogTitle className="text-xl">Choisir un compte</DialogTitle>
            </div>
            <Button
              variant="ghost"
              size="sm"
              onClick={onClose}
              className="h-8 w-8 p-0"
            >
              <X className="h-4 w-4" />
            </Button>
          </div>
          <DialogDescription className="sr-only">
            Sélectionnez un compte Google pour vous connecter ou vous inscrire à Lotto Happy
          </DialogDescription>
        </DialogHeader>

        <div className="mt-4 space-y-2">
          <p className="text-sm text-muted-foreground mb-4">
            Pour continuer vers <span className="font-semibold text-foreground">Lotto Happy</span>
          </p>

          <AnimatePresence>
            {GOOGLE_TEST_ACCOUNTS.map((account) => (
              <motion.button
                key={account.email}
                initial={{ opacity: 0, x: -20 }}
                animate={{ opacity: 1, x: 0 }}
                exit={{ opacity: 0, scale: 0.95 }}
                whileHover={{ scale: 1.02 }}
                whileTap={{ scale: 0.98 }}
                onClick={() => handleSelectAccount(account)}
                className={`
                  w-full flex items-center gap-4 p-4 rounded-xl border-2 
                  transition-all duration-200
                  ${
                    selectedEmail === account.email
                      ? "border-[#4285F4] bg-[#4285F4]/10"
                      : "border-border bg-muted/30 hover:border-[#4285F4]/50 hover:bg-muted/50"
                  }
                `}
              >
                {/* Avatar */}
                <div className="flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-[#4285F4] to-[#34A853] text-2xl">
                  {account.avatar}
                </div>

                {/* Info */}
                <div className="flex-1 text-left">
                  <p className="font-semibold text-foreground">{account.name}</p>
                  <p className="text-sm text-muted-foreground">{account.email}</p>
                </div>

                {/* Loading indicator quand sélectionné */}
                {selectedEmail === account.email && (
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="h-6 w-6 rounded-full border-2 border-[#4285F4] border-t-transparent animate-spin"
                  />
                )}
              </motion.button>
            ))}
          </AnimatePresence>

          {/* Divider */}
          <div className="relative py-4">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t border-border" />
            </div>
            <div className="relative flex justify-center">
              <span className="bg-card px-4 text-xs text-muted-foreground">
                Comptes de test pour démo
              </span>
            </div>
          </div>

          {/* Info */}
          <div className="rounded-lg border border-[#4285F4]/30 bg-[#4285F4]/5 p-3">
            <p className="text-xs text-muted-foreground">
              💡 <strong className="text-foreground">Comment tester :</strong>
              <br />
              • <strong>joueur.test@gmail.com</strong> : Compte existant (connexion directe)
              <br />
              • <strong>nouveau.joueur@gmail.com</strong> : Nouveau compte (inscription)
              <br />
              • <strong>marie.dupont@gmail.com</strong> : À créer manuellement pour tester
            </p>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}

================================================================================
--- FICHIER : ./src/components/Header.tsx ---
================================================================================

import { Plus } from "lucide-react";
import {
  Avatar,
  AvatarFallback,
  AvatarImage,
} from "./ui/avatar";
import { Button } from "./ui/button";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "./ui/select";
import { getCurrentUser } from "../utils/auth";

interface HeaderProps {
  balance?: number;
  onRecharge?: () => void;
  onNotifications?: () => void;
  onProfile?: () => void;
  games?: Array<{ id: string; name: string; country: string }>;
  onGameSelect?: (gameId: string) => void;
  showGameSelector?: boolean;
}

// Fonction pour formatter le solde de manière compacte sur mobile
function formatBalance(balance: number, isMobile: boolean = false): string {
  if (!isMobile) {
    return balance.toLocaleString("fr-FR");
  }
  
  // Format compact pour mobile
  if (balance >= 1000000) {
    return `${(balance / 1000000).toFixed(1)}M`;
  } else if (balance >= 10000) {
    return `${(balance / 1000).toFixed(1)}K`;
  }
  return balance.toLocaleString("fr-FR");
}

export function Header({
  balance = 12500,
  onRecharge,
  onNotifications,
  onProfile,
  games = [],
  onGameSelect,
  showGameSelector = false,
}: HeaderProps) {
  // Récupérer l'utilisateur actuel
  const currentUser = getCurrentUser();
  const userInitials = currentUser?.username?.substring(0, 2).toUpperCase() || 'U';
  
  return (
    <header className="sticky top-0 z-50 w-full border-b border-border bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/80 overflow-hidden">
      <div className="container flex h-14 sm:h-16 items-center justify-between gap-2 sm:gap-4 px-3 sm:px-4">
        {/* Logo - Responsive avec slogan sur mobile */}
        <div className="flex items-center gap-1.5 sm:gap-2 flex-shrink-0">
          <div className="flex h-8 w-8 sm:h-10 sm:w-10 items-center justify-center rounded-lg bg-gradient-to-br from-[#FF6B00] to-[#FF8800]">
            <span className="font-bold text-white text-xs sm:text-sm">
              LH
            </span>
          </div>
          {/* Texte + Slogan : visible sur mobile grâce au format compact du solde */}
          <div>
            <div className="font-bold text-foreground text-sm sm:text-base">
              Lotto Happy
            </div>
            <div className="text-[10px] sm:text-xs text-muted-foreground leading-tight">
              Votre gain notre priorité
            </div>
          </div>
        </div>

        {/* Actions - Format compact sur mobile */}
        <div className="flex items-center gap-2 sm:gap-3 ml-auto">
          {/* Balance - Format compact sur mobile, complet sur desktop */}
          <div className="flex items-center gap-1 sm:gap-2 rounded-full bg-muted px-2 sm:px-3 py-1 sm:py-1.5">
            {/* Format desktop : afficher tout */}
            <span className="font-semibold text-[#FFD700] hidden sm:inline text-sm">
              {balance.toLocaleString("fr-FR")} F
            </span>
            
            {/* Format mobile : compact */}
            <span className="font-semibold text-[#FFD700] sm:hidden text-xs">
              {formatBalance(balance, true)} F
            </span>
            
            <Button
              size="icon"
              className="h-5 w-5 sm:h-6 sm:w-6 rounded-full bg-[#FFD700] hover:bg-[#FFD700]/90"
              onClick={onRecharge}
            >
              <Plus className="h-3 w-3 sm:h-4 sm:w-4 text-[#121221]" />
            </Button>
          </div>
          
          {/* Profile Avatar - Plus petit sur mobile */}
          <Avatar
            className="h-8 w-8 sm:h-9 sm:w-9 cursor-pointer ring-2 ring-[#FFD700]/20 hover:ring-[#FFD700]/40 transition-all flex-shrink-0"
            onClick={onProfile}
          >
            <AvatarImage
              src="https://avatar.vercel.sh/user"
              alt="Profile"
            />
            <AvatarFallback className="bg-gradient-gold text-[#121212] text-xs">
              {userInitials}
            </AvatarFallback>
          </Avatar>
        </div>
      </div>
    </header>
  );
}

================================================================================
--- FICHIER : ./src/components/LoginScreen.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { motion } from "framer-motion"; // Assurez-vous que "framer-motion" est bien installé
import { Button } from "./ui/button";
import { Input } from "./ui/input";
import { Label } from "./ui/label";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "./ui/select";
import { toast } from "sonner";
import { useTheme } from "./ThemeProvider";
import { useAuth } from "../contexts/AuthContext";
import { GoogleAuthModal } from "./GoogleAuthModal";
import { validatePhoneNumber } from "../utils/auth";

interface LoginScreenProps {
  // --- CORRECTION DE LA SIGNATURE ---
  // onNavigateToPassword ne devrait prendre qu'un seul argument : l'identifiant.
  onNavigateToPassword: (identifier: string) => void;
  onNavigateToRegistration: (phoneNumber: string, countryCode: string, googleEmail?: string, googleName?: string) => void;
}

const COUNTRIES = [
  { code: "+228", name: "Togo", flag: "🇹🇬" },
  { code: "+233", name: "Ghana", flag: "🇬🇭" },
  { code: "+229", name: "Bénin", flag: "🇧🇯" },
  { code: "+226", name: "Burkina Faso", flag: "🇧🇫" },
  { code: "+225", name: "Côte d'Ivoire", flag: "🇨🇮" },
];

// --- LOGIQUE D'ANIMATION QUI MANQUAIT ---
interface Ball {
  id: number;
  size: number;
  x: number;
  y: number;
  duration: number;
  delay: number;
  number: number;
  color: string;
}

const BALL_COLORS = [
  "#FFD700", "#FF1744", "#2196F3", "#4CAF50", "#FF6B00",
  "#9C27B0", "#00BCD4", "#E91E63", "#FF9800", "#673AB7"
];

const generateBalls = (): Ball[] => {
  const balls: Ball[] = [];
  const count = 30;
  const usedNumbers = new Set<number>();
  for (let i = 0; i < count; i++) {
    const size = Math.random() * 90 + 60;
    let number: number;
    do {
      number = Math.floor(Math.random() * 90) + 1;
    } while (usedNumbers.has(number) && usedNumbers.size < 90);
    usedNumbers.add(number);
    const color = BALL_COLORS[Math.floor(Math.random() * BALL_COLORS.length)];
    balls.push({
      id: i, size, color, number,
      x: Math.random() * 110 - 5,
      y: Math.random() * 110 - 5,
      duration: Math.random() * 15 + 25,
      delay: Math.random() * 8,
    });
  }
  return balls;
};
// --- FIN DE LA LOGIQUE D'ANIMATION ---


export function LoginScreen({
  onNavigateToPassword,
  onNavigateToRegistration,
}: LoginScreenProps) {
  const { loginWithGoogle, error: authError } = useAuth();
  const [countryCode, setCountryCode] = useState("+228");
  const [phoneNumber, setPhoneNumber] = useState("");
  const [balls] = useState<Ball[]>(generateBalls()); // Cet appel va maintenant fonctionner
  const [animationMode, setAnimationMode] = useState(0);
  const [googleModalOpen, setGoogleModalOpen] = useState(false);
  
  const { actualTheme } = useTheme();
  const isDark = actualTheme === 'dark';

  useEffect(() => {
    if (authError) {
      toast.error(authError);
    }
  }, [authError]);

  useEffect(() => {
    const changeAnimation = () => setAnimationMode(prev => (prev + 1) % 3);
    const timeoutId = setTimeout(changeAnimation, Math.random() * 20000 + 30000);
    return () => clearTimeout(timeoutId);
  }, [animationMode]);

  const handleContinue = () => {
    if (!phoneNumber) {
      toast.error("Veuillez entrer un email ou un numéro de téléphone.");
      return;
    }

    const isEmail = phoneNumber.includes('@');

    if (isEmail) {
      // Si c'est un email, on le passe directement.
      onNavigateToPassword(phoneNumber);
      return;
    }
    
    // Si c'est un numéro de téléphone
    const validation = validatePhoneNumber(phoneNumber, countryCode);
    if (!validation.isValid) {
      toast.error(validation.message || "Numéro de téléphone invalide");
      return;
    }
    
    // On construit le numéro complet et on le passe.
    const fullNumber = `${countryCode}${phoneNumber}`;
    onNavigateToPassword(fullNumber);
  };

  const handleGoogleAccountSelect = async (email: string, name: string) => {
    setGoogleModalOpen(false);
    toast.info("Connexion avec Google en cours...");
    const result = await loginWithGoogle(email, name);
    if (result?.isNewUser) {
      toast.success("Compte Google validé. Veuillez finaliser votre inscription.");
      onNavigateToRegistration("", "", result.email, result.name);
    } else if (result) {
      toast.success(`Bienvenue, ${result.name}!`);
      // Le AuthContext gère la redirection
    }
    // L'erreur est déjà gérée et affichée par le AuthContext
  };

  return (
    <div 
      className="relative flex min-h-screen items-center justify-center overflow-hidden px-6 py-12"
      style={{ backgroundColor: isDark ? '#121212' : '#F4F4F7' }}
    >
      <div className="absolute inset-0 overflow-hidden">
        {balls.map((ball) => {
          const moveX1 = (Math.random() - 0.5) * 180;
          const moveX2 = (Math.random() - 0.5) * 180;
          const moveY1 = (Math.random() - 0.5) * 180;
          const moveY2 = (Math.random() - 0.5) * 180;
          const fontSize = ball.size * 0.28;
          const circleSize = ball.size * 0.55;
          const chaoticAnimation = { x: [0, moveX1, moveX2, 0], y: [0, moveY1, moveY2, 0], scale: [1, 1.1, 0.9, 1], rotate: [0, 5, -5, 0] };
          const transitionConfig = { duration: ball.duration, delay: ball.delay, repeat: Infinity, ease: "easeInOut" };
          return (
            <motion.div
              key={ball.id}
              className="absolute flex items-center justify-center rounded-full"
              style={{
                width: ball.size, height: ball.size, left: `${ball.x}%`, top: `${ball.y}%`,
                willChange: "transform", transform: "translate3d(0, 0, 0)",
                background: `radial-gradient(circle at 28% 25%, ${ball.color}FF 0%, ${ball.color}A0 100%)`,
                boxShadow: `0 30px 70px rgba(0,0,0,0.12), inset -10px -10px 25px rgba(0,0,0,0.12), inset 8px 8px 20px rgba(255,255,255,0.2)`
              }}
              animate={chaoticAnimation}
              transition={transitionConfig}
            >
              <div className="absolute rounded-full" style={{ width: ball.size * 0.35, height: ball.size * 0.28, top: ball.size * 0.12, left: ball.size * 0.15, background: `radial-gradient(ellipse at center, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 100%)`, filter: "blur(2px)" }} />
              <div className="absolute flex items-center justify-center rounded-full bg-white" style={{ width: circleSize, height: circleSize, boxShadow: `0 0 0 ${ball.size * 0.04}px ${ball.color}, inset 0 3px 8px rgba(0,0,0,0.1)` }}>
                <span className="font-bold" style={{ fontSize: `${fontSize}px`, color: "#1C1C1E", textShadow: "0 1px 2px rgba(0,0,0,0.1)", fontFamily: "Inter, system-ui, sans-serif" }}>
                  {ball.number}
                </span>
              </div>
            </motion.div>
          );
        })}
      </div>
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.8 }}
        className="relative z-10 w-full max-w-md"
      >
        <div
          className="rounded-3xl px-8 py-16 shadow-2xl"
          style={{
            backgroundColor: isDark ? 'rgba(28, 28, 30, 0.75)' : 'rgba(255, 255, 255, 0.7)',
            backdropFilter: 'blur(20px)',
            WebkitBackdropFilter: 'blur(20px)',
            border: isDark ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.5)',
          }}
        >
          <motion.div className="mb-8 text-center" initial={{ scale: 0.8, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} transition={{ delay: 0.2, duration: 0.6 }}>
            <div className="mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-2xl bg-gradient-to-br from-[#FF6B00] to-[#FF8800] shadow-lg"><span className="text-3xl font-bold text-white">LH</span></div>
            <h1 className="text-3xl font-bold" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>Lotto Happy</h1>
            <p className="mt-2 text-lg" style={{ color: isDark ? '#FFD700' : '#FF6B00' }}>Le jackpot n'est qu'à un clic</p>
          </motion.div>
          <motion.div className="space-y-6" initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.4, duration: 0.6 }}>
            <div className="space-y-2">
              <Label htmlFor="phone" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>Email ou Numéro de téléphone</Label>
              <div className="flex gap-2">
                {!phoneNumber.includes('@') && (
                  <Select value={countryCode} onValueChange={setCountryCode}>
                    <SelectTrigger className="w-32 focus:ring-2 focus:ring-[#FFD700]/20" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6' }}>
                      <SelectValue />
                    </SelectTrigger>
                    <SelectContent>
                      {COUNTRIES.map((country) => (<SelectItem key={country.code} value={country.code}><span className="flex items-center gap-2"><span>{country.flag}</span><span>{country.code}</span></span></SelectItem>))}
                    </SelectContent>
                  </Select>
                )}
                <Input id="phone" type="text" placeholder="90 12 34 56" value={phoneNumber} onChange={(e) => setPhoneNumber(e.target.value)} className="flex-1 focus:ring-2 focus:ring-[#FFD700]/20" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }}/>
              </div>
            </div>
            <Button className="w-full rounded-full bg-[#FFD700] text-lg text-[#121212] hover:bg-[#FFD700]/90 hover:shadow-lg hover:shadow-[#FFD700]/30 transition-all" onClick={handleContinue}>Continuer</Button>
            <div className="relative py-4">
              <div className="absolute inset-0 flex items-center"><div className="w-full border-t" style={{ borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6' }} /></div>
              <div className="relative flex justify-center"><span className="px-4 text-sm" style={{ backgroundColor: isDark ? 'rgba(28, 28, 30, 0.9)' : 'rgba(255, 255, 255, 0.9)', color: isDark ? '#8E8E93' : '#6e6e73' }}>Ou continuez avec</span></div>
            </div>
            <Button variant="outline" className="w-full border-2 hover:border-[#FFD700] hover:bg-[#FFD700]/5 transition-all" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }} onClick={() => setGoogleModalOpen(true)}>
              <svg className="mr-2 h-5 w-5" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" /><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" /><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" /><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" /></svg>
              Continuer avec Google
            </Button>
            <p className="text-center text-xs" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>
              En continuant, vous acceptez nos <a href="#" className="text-[#FF3B30] hover:underline">Conditions d'utilisation</a> et notre <a href="#" className="text-[#FF3B30] hover:underline">Politique de confidentialité</a>
            </p>
            <div className="rounded-lg border border-[#FF3B30] bg-[#FF3B30]/10 p-3 text-center">
              <p className="text-xs" style={{ color: isDark ? '#FF3B30' : '#1C1C1E' }}><strong>Jeu interdit aux moins de 18 ans</strong></p>
            </div>
          </motion.div>
        </div>
      </motion.div>
      <GoogleAuthModal open={googleModalOpen} onClose={() => setGoogleModalOpen(false)} onSelectAccount={handleGoogleAccountSelect} />
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/NationalGameCard.tsx ---
================================================================================

// src/components/NationalGameCard.tsx

// On n'a PLUS BESOIN d'importer les SVG ici. Le composant est maintenant plus simple.

import { Button } from "./ui/button";
import { Card } from "./ui/card";

// Définition des propriétés (props) que le composant attend de recevoir
interface NationalGameCardProps {
  id: string;
  flagUrl: string; // PROP MODIFIÉE: On attend maintenant une URL de drapeau
  organizationName: string;
  gameName: string;
  jackpot: number;
  onPlay: () => void;
}

// Définition du composant React
export function NationalGameCard({
  id,
  flagUrl, // On utilise la nouvelle prop
  organizationName,
  gameName,
  jackpot,
  onPlay,
}: NationalGameCardProps) {
  return (
    <Card
      id={id}
      className="group overflow-hidden border border-border bg-card transition-all hover:border-[#FFD700]/30 hover:shadow-lg hover:shadow-[#FFD700]/10 scroll-mt-20"
    >
      {/* Zone d'affichage du drapeau */}
      <div className="relative aspect-[16/9] overflow-hidden bg-gradient-to-br from-[#1C1C1E] to-[#2C2C2E] flex items-center justify-center">
        {/* LOGIQUE SIMPLIFIÉE: On utilise directement l'URL dans la balise <img> */}
        {flagUrl ? (
          <img
            src={flagUrl} // La source est maintenant la prop 'flagUrl'
            alt={`Drapeau de ${organizationName}`}
            className="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
          />
        ) : (
          // Fallback au cas où l'URL est manquante
          <div className="w-full h-full bg-gray-700" />
        )}

        <div className="absolute inset-0 bg-gradient-to-t from-[#121212] via-transparent to-transparent opacity-50" />
      </div>

      {/* Zone d'information sous le drapeau */}
      <div className="space-y-3 p-5">
        <div>
          <h3 className="text-xl font-bold text-foreground">
            {organizationName}
          </h3>
          <p className="text-sm text-muted-foreground mt-1">
            Jeu : {gameName}
          </p>
        </div>

        <div className="flex items-center justify-between pt-2">
          <div>
            <p className="text-xs text-muted-foreground">
              Jackpot
            </p>
            <p className="text-xl font-bold text-[#FFD700]">
              {jackpot.toLocaleString("fr-FR")} FCFA
            </p>
          </div>

          <Button
            className="rounded-full bg-[#FFD700] px-6 text-[#121212] hover:bg-[#FFD700]/90 hover:shadow-lg hover:shadow-[#FFD700]/30 transition-all"
            onClick={onPlay}
          >
            Jouer
          </Button>
        </div>
      </div>
    </Card>
  );
}

================================================================================
--- FICHIER : ./src/components/PasswordLoginScreen.tsx ---
================================================================================

// src/components/PasswordLoginScreen.tsx

import { useState } from 'react';
import { motion } from 'framer-motion';
import { Button } from './ui/button';
import { Input } from './ui/input';
import { Label } from './ui/label';
// MODIFICATION : J'utilise 'toast' de 'react-hot-toast' ou 'sonner' selon ce que tu as
import { toast } from 'sonner'; 
import { ArrowLeft, Eye, EyeOff, Loader2 } from 'lucide-react';
import { useTheme } from './ThemeProvider';
import { useAuth } from '../contexts/AuthContext';

interface PasswordLoginScreenProps {
  identifier: string;
  onBack: () => void;
  // La prop essentielle pour la redirection vers l'inscription
  onNavigateToRegistration: (identifier: string) => void; 
}

export function PasswordLoginScreen({ identifier, onBack, onNavigateToRegistration }: PasswordLoginScreenProps) {
  const { login, isLoading } = useAuth();
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  
  const { actualTheme } = useTheme();
  const isDark = actualTheme === 'dark';

  const handleLogin = async () => {
    if (!password) {
      toast.error('Veuillez entrer un mot de passe.');
      return;
    }
    
    try {
      // 1. On lance la tentative de connexion
      await login({ emailOrPhone: identifier, password });
      
      // 2. Si ça réussit, il n'y a RIEN à faire ici.
      // Le AuthContext a mis à jour l'utilisateur, et le useEffect dans App.tsx
      // va détecter ce changement et s'occuper de la redirection.
      // Afficher un toast ici est redondant car l'écran va disparaître immédiatement.
      
    } catch (err: any) {
      // 3. Si ça échoue, on attrape l'erreur propagée par AuthContext
      const errorStatus = err?.response?.status;

      if (errorStatus === 404) {
        // C'EST LE CAS QUI NOUS INTÉRESSE ! Utilisateur non trouvé.
        toast.error("Aucun compte trouvé. Redirection vers l'inscription...");
        
        // On attend 2 secondes pour que l'utilisateur ait le temps de lire le message
        // avant que l'écran ne change. C'est une meilleure UX.
        setTimeout(() => {
          onNavigateToRegistration(identifier);
        }, 2000);

      } else if (errorStatus === 401) {
        // Mot de passe incorrect. On affiche un message clair.
        toast.error("Mot de passe incorrect.");
      } else {
        // Pour toutes les autres erreurs (problème de réseau, serveur 500...)
        const errorMessage = err?.response?.data?.detail || "Une erreur inattendue est survenue.";
        toast.error(errorMessage);
      }
    }
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    // Si l'utilisateur appuie sur "Entrée" et qu'on n'est pas déjà en train de charger
    if (e.key === 'Enter' && !isLoading) {
      handleLogin();
    }
  };
  
  // ----- LE JSX RESTE INCHANGÉ, IL EST PARFAIT -----
  return (
    <div 
      className="relative flex min-h-screen items-center justify-center overflow-hidden px-6 py-12"
      style={{ backgroundColor: isDark ? '#121212' : '#F4F4F7' }}
    >
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.8 }}
        className="relative z-10 w-full max-w-md"
      >
        <div 
          className="rounded-3xl px-8 py-16 shadow-2xl"
          style={{ backgroundColor: isDark ? 'rgba(28, 28, 30, 0.75)' : 'rgba(255, 255, 255, 0.7)', backdropFilter: 'blur(20px)', WebkitBackdropFilter: 'blur(20px)', border: isDark ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.5)' }}
        >
          <button onClick={onBack} className="mb-6 flex items-center gap-2 transition-colors" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>
            <ArrowLeft className="h-5 w-5" />
            <span>Retour</span>
          </button>
          <motion.div className="mb-8 text-center" initial={{ scale: 0.8, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} transition={{ delay: 0.2, duration: 0.6 }}>
            <div className="mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-2xl bg-gradient-to-br from-[#FF6B00] to-[#FF8800] shadow-lg"><span className="text-3xl font-bold text-white">LH</span></div>
            <h1 className="text-3xl font-bold" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>Bon retour !</h1>
            <p className="mt-2" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>Connectez-vous à votre compte</p>
          </motion.div>
          <motion.div className="space-y-6" initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.4, duration: 0.6 }}>
            <div className="space-y-2">
              <Label htmlFor="password" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>Mot de passe</Label>
              <div className="relative">
                <Input id="password" type={showPassword ? 'text' : 'password'} placeholder="Entrez votre mot de passe" value={password} onChange={(e) => setPassword(e.target.value)} onKeyPress={handleKeyPress} className="pr-12 focus:ring-2 focus:ring-[#FFD700]/20" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }}/>
                <button type="button" onClick={() => setShowPassword(!showPassword)} className="absolute right-3 top-1/2 -translate-y-1/2 transition-colors" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>
                  {showPassword ? <EyeOff className="h-5 w-5" /> : <Eye className="h-5 w-5" />}
                </button>
              </div>
            </div>
            <div className="text-right"><a href="#" className="text-sm text-[#FFD700] hover:underline">Mot de passe oublié ?</a></div>
            <Button className="w-full rounded-full bg-[#FFD700] text-lg text-[#121212] hover:bg-[#FFD700]/90 hover:shadow-lg hover:shadow-[#FFD700]/30 transition-all" onClick={handleLogin} disabled={isLoading}>
              {isLoading ? (<><Loader2 className="mr-2 h-5 w-5 animate-spin" />Connexion en cours...</>) : ('Se connecter')}
            </Button>
          </motion.div>
        </div>
      </motion.div>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/ProfileScreen.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { Header } from "./Header";
import { Footer } from "./Footer";
import { RechargeModal } from "./RechargeModal";
import { ConvertModal } from "./ConvertModal";
import { WithdrawModal } from "./WithdrawModal";
import { BetHistory } from "./BetHistory";
import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Badge } from "./ui/badge";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "./ui/tabs";
import { Avatar, AvatarImage, AvatarFallback } from "./ui/avatar";
import { Input } from "./ui/input";
import { Label } from "./ui/label";
import { Switch } from "./ui/switch";
import { useTheme } from "./ThemeProvider";
import { useAuth } from "../contexts/AuthContext";

// --- IMPORTS CORRIGÉS ---
import { changePassword as apiChangePassword } from "../utils/authAPI";
import { getMyTransactionHistory } from "../utils/playerAPI";
import { PlayerTransaction } from "../utils/transactionsAPI"; // Importer l'interface
import { createWithdrawalRequest } from "../utils/withdrawalsAPI";
import { toast } from "sonner";

import { 
  ArrowLeft, 
  Trophy, 
  User, 
  Bell, 
  Lock, 
  Smartphone, 
  Eye, 
  EyeOff,
  ArrowRightLeft,
  QrCode,
  Palette,
  Sun,
  Moon,
  Monitor,
  LogOut,
  TrendingUp,
  TrendingDown,
  Repeat,
  Wallet
} from "lucide-react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "./ui/dialog";
import { toast } from "sonner@2.0.3";

interface ProfileScreenProps {
  onBack: () => void;
  playBalance?: number;
  winningsBalance?: number;
  onRecharge?: (amount: number) => void;
  onConvertWinnings?: (amount: number) => boolean;
}

export function ProfileScreen({ onBack, playBalance, winningsBalance, onRecharge, onConvertWinnings }: ProfileScreenProps) {
  const { user, logout, refreshUser } = useAuth();
  const [rechargeOpen, setRechargeOpen] = useState(false);
  const [convertOpen, setConvertOpen] = useState(false);
  const [withdrawOpen, setWithdrawOpen] = useState(false);
  const [transactions, setTransactions] = useState<PlayerTransaction[]>([]);
  const [loadingTransactions, setLoadingTransactions] = useState(true);
  const [notifications, setNotifications] = useState(true);
  const [emailNotifications, setEmailNotifications] = useState(false);
  const { theme, setTheme } = useTheme();
  
  const [passwordModalOpen, setPasswordModalOpen] = useState(false);
  const [twoFactorModalOpen, setTwoFactorModalOpen] = useState(false);
  const [devicesModalOpen, setDevicesModalOpen] = useState(false);
  
  const [oldPassword, setOldPassword] = useState('');
  const [newPassword, setNewPassword] = useState('');
  const [confirmNewPassword, setConfirmNewPassword] = useState('');
  const [showOldPassword, setShowOldPassword] = useState(false);
  const [showNewPassword, setShowNewPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);
  
  const [twoFactorCode, setTwoFactorCode] = useState('');

  useEffect(() => {
    const fetchTransactions = async () => {
      if (user) {
        setLoadingTransactions(true);
        try {
          // --- APPEL CORRIGÉ ---
          const history = await getMyTransactionHistory();
          setTransactions(history);
        } catch (error) {
          toast.error("Impossible de charger l'historique des transactions.");
        } finally {
          setLoadingTransactions(false);
        }
      }
    };
    fetchTransactions();
  }, [user]);

  const handleChangePassword = async () => {
    if (!oldPassword || !newPassword || !confirmNewPassword) {
      toast.error('Veuillez remplir tous les champs');
      return;
    }
    if (newPassword !== confirmNewPassword) {
      toast.error('Les nouveaux mots de passe ne correspondent pas');
      return;
    }
    if (newPassword.length < 6) {
      toast.error('Le mot de passe doit contenir au moins 6 caractères');
      return;
    }
    
    try {
      await apiChangePassword(oldPassword, newPassword);
      toast.success('Mot de passe modifié avec succès !');
      setPasswordModalOpen(false);
      setOldPassword('');
      setNewPassword('');
      setConfirmNewPassword('');
    } catch (error: any) {
      toast.error(error.message || 'Erreur lors du changement de mot de passe');
    }
  };
  
  const handleActivate2FA = () => {
    if (twoFactorCode.length !== 6) {
      toast.error('Veuillez entrer le code à 6 chiffres');
      return;
    }
    
    toast.success('Authentification à deux facteurs activée !');
    setTwoFactorModalOpen(false);
    setTwoFactorCode('');
  };
  
  const handleDisconnectDevice = (deviceName: string) => {
    toast.success(`Déconnecté de ${deviceName}`);
  };
  
  const handleLogout = () => {
    logout();
    toast.success('Déconnexion réussie ! À bientôt 👋');
  };

  const handleWithdraw = async (amount: number, provider: string, phoneNumber: string) => {
    try {
        await createWithdrawalRequest({ amount, provider, withdrawalPhoneNumber: phoneNumber });
        await refreshUser();
        toast.success("Demande de retrait envoyée avec succès !");
        setWithdrawOpen(false);
    } catch (error: any) {
        toast.error(error.message || "Erreur lors de la demande de retrait");
    }
  }

  return (
    <div className="min-h-screen bg-background">
      <Header 
        balance={playBalance}
        onRecharge={() => setRechargeOpen(true)} 
        onProfile={() => {}} 
      />

      <main className="container px-4 py-8">
        <Button
          variant="ghost"
          className="mb-6 hover:bg-accent/10"
          onClick={onBack}
        >
          <ArrowLeft className="mr-2 h-4 w-4" />
          Retour
        </Button>

        <Card className="mb-8 border-border bg-card p-6">
          <div className="flex flex-col items-center gap-4 sm:flex-row">
            <Avatar className="h-24 w-24 ring-4 ring-[#FFD700]/20">
              <AvatarImage src="https://avatar.vercel.sh/user" alt="Profile" />
              <AvatarFallback className="gradient-gold text-2xl text-[#121212]">
                {user?.username?.substring(0, 2).toUpperCase() || 'KA'}
              </AvatarFallback>
            </Avatar>
            <div className="flex-1 text-center sm:text-left">
              <h1 className="text-2xl font-bold text-foreground">
                {user?.username || 'Utilisateur'}
              </h1>
              <p className="text-muted-foreground">
                {user?.phoneNumber || '+228 90 12 34 56'}
              </p>
              <div className="mt-2 flex items-center justify-center gap-2 sm:justify-start">
                <Badge className="bg-gradient-gold text-white">
                  <Trophy className="mr-1 h-3 w-3 text-white" />
                  Membre Or
                </Badge>
                <Badge className="bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90">
                  Niveau 5
                </Badge>
              </div>
            </div>
            <div className="grid grid-cols-2 gap-2 sm:gap-4">
              <div className="text-center rounded-lg border-2 border-[#FFD700] bg-[#FFD700]/10 p-2 sm:p-3 md:p-4">
                <p className="text-base sm:text-xl md:text-2xl font-bold text-[#FFD700] break-words">
                  {playBalance?.toLocaleString('fr-FR') || 0} F
                </p>
                <p className="text-[10px] sm:text-xs text-muted-foreground mt-1">Solde de Jeu</p>
              </div>
              <div className="text-center rounded-lg border-2 border-[#34C759] bg-[#34C759]/10 p-2 sm:p-3 md:p-4">
                <p className="text-base sm:text-xl md:text-2xl font-bold text-[#34C759] break-words">
                  {winningsBalance?.toLocaleString('fr-FR') || 0} F
                </p>
                <p className="text-[10px] sm:text-xs text-muted-foreground mt-1">Solde des Gains</p>
              </div>
            </div>
          </div>
          
          <div className="mt-4 sm:mt-6 flex flex-col xs:flex-row justify-center gap-2 sm:gap-3">
            <Button
              className="bg-[#34C759] text-white hover:bg-[#34C759]/90 text-xs sm:text-sm px-3 sm:px-4"
              onClick={() => setConvertOpen(true)}
            >
              <ArrowRightLeft className="mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4" />
              Convertir mes gains
            </Button>
            <Button
              className="bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90 text-xs sm:text-sm px-3 sm:px-4"
              onClick={() => setWithdrawOpen(true)}
            >
              <Wallet className="mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4" />
              Retirer mon argent
            </Button>
          </div>
        </Card>

        <Tabs defaultValue="bets" className="space-y-4 sm:space-y-6">
          <div className="w-full overflow-x-auto scrollbar-visible -mx-3 px-3 sm:mx-0 sm:px-0">
            <TabsList className="inline-flex w-auto min-w-full sm:grid sm:w-full sm:grid-cols-3 bg-muted h-auto">
              <TabsTrigger 
                value="bets" 
                className="text-xs sm:text-sm py-2 px-3 sm:px-4 whitespace-nowrap flex-shrink-0"
              >
                Paris
              </TabsTrigger>
              <TabsTrigger 
                value="transactions" 
                className="text-xs sm:text-sm py-2 px-3 sm:px-4 whitespace-nowrap flex-shrink-0"
              >
                Transactions
              </TabsTrigger>
              <TabsTrigger 
                value="settings" 
                className="text-xs sm:text-sm py-2 px-3 sm:px-4 whitespace-nowrap flex-shrink-0"
              >
                Paramètres
              </TabsTrigger>
            </TabsList>
          </div>

          <TabsContent value="bets" className="space-y-4">
            {user?.id ? (
              <BetHistory userId={user.id} />
            ) : (
              <Card className="border-border bg-card p-8 text-center">
                <p className="text-muted-foreground">Vous devez être connecté pour voir vos paris</p>
              </Card>
            )}
          </TabsContent>

          <TabsContent value="transactions" className="space-y-4">
            {loadingTransactions ? <p>Chargement...</p> : transactions.length === 0 ? (
              <Card className="border-border bg-card p-8">
                <div className="text-center text-muted-foreground">
                  <p className="mb-2">📊 Aucune transaction pour le moment</p>
                  <p className="text-sm">Vos transactions apparaîtront ici</p>
                </div>
              </Card>
            ) : (
              transactions.map((transaction) => {
                let Icon = Repeat;
                let iconColor = 'text-muted-foreground';
                let bgColor = 'bg-muted';
                
                if (transaction.type === 'RECHARGE') {
                  Icon = TrendingUp;
                  iconColor = 'text-[#34C759]';
                  bgColor = 'bg-[#34C759]/10';
                } else if (transaction.type === 'BET') {
                  Icon = TrendingDown;
                  iconColor = 'text-[#FF6B00]';
                  bgColor = 'bg-[#FF6B00]/10';
                } else if (transaction.type === 'CONVERSION') {
                  Icon = Repeat;
                  iconColor = 'text-[#FFD700]';
                  bgColor = 'bg-[#FFD700]/10';
                } else if (transaction.type === 'WIN') {
                  Icon = Trophy;
                  iconColor = 'text-[#34C759]';
                  bgColor = 'bg-[#34C759]/10';
                } else if (transaction.type === 'WITHDRAWAL') {
                  Icon = Wallet;
                  iconColor = 'text-[#FF6B00]';
                  bgColor = 'bg-[#FF6B00]/10';
                }
                
                const transactionDate = new Date(transaction.date);
                const formattedDate = transactionDate.toLocaleDateString('fr-FR', {
                  day: 'numeric',
                  month: 'short',
                  year: 'numeric',
                  hour: '2-digit',
                  minute: '2-digit',
                });
                
                return (
                  <Card key={transaction.id} className="border-border bg-card p-4">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <div className={`rounded-full p-2 ${bgColor}`}>
                          <Icon className={`h-5 w-5 ${iconColor}`} />
                        </div>
                        <div>
                          <h3 className="font-semibold text-foreground">
                            {transaction.description}
                          </h3>
                          <p className="text-sm text-muted-foreground">
                            {formattedDate}
                          </p>
                        </div>
                      </div>
                      <div className="text-right">
                        <p className={`font-bold ${transaction.amount >= 0 ? 'text-[#34C759]' : 'text-foreground'}`}>
                          {transaction.amount >= 0 ? '+' : ''}{transaction.amount.toLocaleString('fr-FR')} F
                        </p>
                        <p className="text-xs text-muted-foreground">
                          Solde : {transaction.balanceAfter.toLocaleString('fr-FR')} F
                        </p>
                      </div>
                    </div>
                  </Card>
                );
              })
            )}
          </TabsContent>

          <TabsContent value="settings" className="space-y-6">
            <Card className="border-border bg-card p-6">
              <h3 className="mb-4 flex items-center gap-2 font-semibold text-foreground">
                <User className="h-5 w-5" />
                Informations du compte
              </h3>
              <div className="space-y-4">
                <div>
                  <Label>Nom d'utilisateur</Label>
                  <p className="text-sm text-muted-foreground">
                    {user?.username || 'Non renseigné'}
                  </p>
                </div>
                <div>
                  <Label>Numéro de téléphone</Label>
                  <p className="text-sm text-muted-foreground">
                    {user?.phoneNumber || 'Non renseigné'}
                  </p>
                </div>
                <div>
                  <Label>Adresse email</Label>
                  <p className="text-sm text-muted-foreground">
                    {user?.email || 'Non renseignée'}
                  </p>
                </div>
              </div>
            </Card>

            <Card className="border-border bg-card p-6">
              <h3 className="mb-4 flex items-center gap-2 font-semibold text-foreground">
                <Bell className="h-5 w-5" />
                Notifications
              </h3>
              <div className="space-y-4">
                <div className="flex items-center justify-between">
                  <div className="space-y-0.5">
                    <Label htmlFor="push-notifications">Notifications push</Label>
                    <p className="text-sm text-muted-foreground">
                      Recevez des alertes pour les tirages et gains
                    </p>
                  </div>
                  <Switch
                    id="push-notifications"
                    checked={notifications}
                    onCheckedChange={setNotifications}
                  />
                </div>
                <div className="flex items-center justify-between">
                  <div className="space-y-0.5">
                    <Label htmlFor="email-notifications">Notifications email</Label>
                    <p className="text-sm text-muted-foreground">
                      Recevez des résumés hebdomadaires
                    </p>
                  </div>
                  <Switch
                    id="email-notifications"
                    checked={emailNotifications}
                    onCheckedChange={setEmailNotifications}
                  />
                </div>
              </div>
            </Card>

            <Card className="border-border bg-card p-6">
              <h3 className="mb-4 flex items-center gap-2 font-semibold text-foreground">
                <Lock className="h-5 w-5" />
                Sécurité
              </h3>
              <div className="space-y-3">
                <Button variant="outline" className="w-full justify-start h-auto min-h-[40px] whitespace-normal text-left" onClick={() => setPasswordModalOpen(true)}>
                  Changer le mot de passe
                </Button>
                <Button variant="outline" className="w-full justify-start h-auto min-h-[40px] whitespace-normal text-left py-2" onClick={() => setTwoFactorModalOpen(true)}>
                  Activer l'authentification à deux facteurs
                </Button>
                <Button variant="outline" className="w-full justify-start h-auto min-h-[40px] whitespace-normal text-left" onClick={() => setDevicesModalOpen(true)}>
                  Gérer les appareils connectés
                </Button>
              </div>
            </Card>

            <Card className="border-border bg-card p-6">
              <h3 className="mb-4 flex items-center gap-2 font-semibold text-foreground">
                <Palette className="h-5 w-5" />
                Apparence
              </h3>
              <div className="space-y-4">
                <Label className="text-foreground">Choisissez votre thème</Label>
                <p className="text-sm text-muted-foreground mb-4">
                  Personnalisez l'apparence de l'application selon vos préférences
                </p>
                
                <div className="grid grid-cols-1 gap-3 sm:grid-cols-3">
                  <button
                    onClick={() => setTheme('light')}
                    className={`flex flex-col items-center gap-3 rounded-xl border-2 p-4 transition-all hover:bg-muted/50 ${
                      theme === 'light'
                        ? 'border-[#FFD700] bg-[#FFD700]/10'
                        : 'border-border bg-card'
                    }`}
                  >
                    <div className="flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-[#FFD700] to-[#FFA500]">
                      <Sun className="h-6 w-6 text-[#121212]" />
                    </div>
                    <div className="text-center">
                      <p className="font-semibold text-foreground">Clair</p>
                      <p className="text-xs text-muted-foreground">Lumineux et accueillant</p>
                    </div>
                    {theme === 'light' && (
                      <div className="mt-1 h-1 w-full rounded-full bg-[#FFD700]" />
                    )}
                  </button>

                  <button
                    onClick={() => setTheme('dark')}
                    className={`flex flex-col items-center gap-3 rounded-xl border-2 p-4 transition-all hover:bg-muted/50 ${
                      theme === 'dark'
                        ? 'border-[#FFD700] bg-[#FFD700]/10'
                        : 'border-border bg-card'
                    }`}
                  >
                    <div className="flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-[#4F00BC] to-[#2D006B]">
                      <Moon className="h-6 w-6 text-white" />
                    </div>
                    <div className="text-center">
                      <p className="font-semibold text-foreground">Sombre</p>
                      <p className="text-xs text-muted-foreground">Confort pour vos yeux</p>
                    </div>
                    {theme === 'dark' && (
                      <div className="mt-1 h-1 w-full rounded-full bg-[#FFD700]" />
                    )}
                  </button>

                  <button
                    onClick={() => setTheme('auto')}
                    className={`flex flex-col items-center gap-3 rounded-xl border-2 p-4 transition-all hover:bg-muted/50 ${
                      theme === 'auto'
                        ? 'border-[#FFD700] bg-[#FFD700]/10'
                        : 'border-border bg-card'
                    }`}
                  >
                    <div className="flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-[#FF6B00] to-[#FF8800]">
                      <Monitor className="h-6 w-6 text-white" />
                    </div>
                    <div className="text-center">
                      <p className="font-semibold text-foreground">Automatique</p>
                      <p className="text-xs text-muted-foreground">Suit votre système</p>
                    </div>
                    {theme === 'auto' && (
                      <div className="mt-1 h-1 w-full rounded-full bg-[#FFD700]" />
                    )}
                  </button>
                </div>

                <div className="mt-4 rounded-lg border border-border bg-muted/50 p-3">
                  <p className="text-xs text-muted-foreground">
                    💡 <strong>Conseil :</strong> Le thème automatique s'adapte aux préférences de votre appareil.
                    {theme === 'auto' && ' Actuellement : ' + (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'Sombre' : 'Clair')}
                  </p>
                </div>
              </div>
            </Card>

            <Card className="border-border bg-card p-6">
              <h3 className="mb-4 flex items-center gap-2 font-semibold text-foreground">
                <LogOut className="h-5 w-5" />
                Déconnexion
              </h3>
              <div className="space-y-4">
                <Button
                  className="bg-[#FF3B30] text-white hover:bg-[#FF3B30]/90"
                  onClick={handleLogout}
                >
                  Se déconnecter
                </Button>
              </div>
            </Card>
          </TabsContent>
        </Tabs>
      </main>

      <Footer />

      <RechargeModal 
        open={rechargeOpen} 
        onClose={() => setRechargeOpen(false)}
        balance={playBalance || 0}
        onNavigateToResellers={() => {}}
      />

      <ConvertModal
        open={convertOpen}
        onClose={() => setConvertOpen(false)}
        winningsBalance={winningsBalance || 0}
        onConvert={onConvertWinnings || (() => false)}
      />

      <WithdrawModal
        open={withdrawOpen}
        onOpenChange={setWithdrawOpen}
        currentBalance={playBalance || 0}
        onWithdraw={handleWithdraw}
      />

      <Dialog open={passwordModalOpen} onOpenChange={setPasswordModalOpen}>
        <DialogContent className="sm:max-w-[500px]">
          <DialogHeader>
            <DialogTitle>Changer votre mot de passe</DialogTitle>
            <DialogDescription>
              Saisissez votre ancien mot de passe et choisissez-en un nouveau.
            </DialogDescription>
          </DialogHeader>
          <div className="space-y-4 py-4">
            <div className="space-y-2">
              <Label htmlFor="old-password">Ancien mot de passe</Label>
              <div className="relative">
                <Input
                  id="old-password"
                  type={showOldPassword ? 'text' : 'password'}
                  placeholder="Entrez votre ancien mot de passe"
                  value={oldPassword}
                  onChange={(e) => setOldPassword(e.target.value)}
                  className="pr-10"
                />
                <button
                  type="button"
                  onClick={() => setShowOldPassword(!showOldPassword)}
                  className="absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground"
                >
                  {showOldPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                </button>
              </div>
            </div>
            
            <div className="space-y-2">
              <Label htmlFor="new-password">Nouveau mot de passe</Label>
              <div className="relative">
                <Input
                  id="new-password"
                  type={showNewPassword ? 'text' : 'password'}
                  placeholder="Entrez votre nouveau mot de passe"
                  value={newPassword}
                  onChange={(e) => setNewPassword(e.target.value)}
                  className="pr-10"
                />
                <button
                  type="button"
                  onClick={() => setShowNewPassword(!showNewPassword)}
                  className="absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground"
                >
                  {showNewPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                </button>
              </div>
            </div>
            
            <div className="space-y-2">
              <Label htmlFor="confirm-password">Confirmer le nouveau mot de passe</Label>
              <div className="relative">
                <Input
                  id="confirm-password"
                  type={showConfirmPassword ? 'text' : 'password'}
                  placeholder="Retapez votre nouveau mot de passe"
                  value={confirmNewPassword}
                  onChange={(e) => setConfirmNewPassword(e.target.value)}
                  className="pr-10"
                />
                <button
                  type="button"
                  onClick={() => setShowConfirmPassword(!showConfirmPassword)}
                  className="absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground"
                >
                  {showConfirmPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                </button>
              </div>
            </div>
          </div>
          
          <div className="flex gap-3">
            <Button
              variant="outline"
              className="flex-1"
              onClick={() => setPasswordModalOpen(false)}
            >
              Annuler
            </Button>
            <Button
              className="flex-1 bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90"
              onClick={handleChangePassword}
            >
              Enregistrer
            </Button>
          </div>
        </DialogContent>
      </Dialog>

      <Dialog open={twoFactorModalOpen} onOpenChange={setTwoFactorModalOpen}>
        <DialogContent className="sm:max-w-[500px]">
          <DialogHeader>
            <DialogTitle>Activer l'authentification à deux facteurs</DialogTitle>
            <DialogDescription>
              Scannez le QR code avec votre application d'authentification et entrez le code de vérification.
            </DialogDescription>
          </DialogHeader>
          
          <div className="space-y-6 py-4">
            <div className="flex justify-center">
              <div className="rounded-xl border-2 border-dashed border-border bg-muted p-8 text-center">
                <QrCode className="mx-auto h-32 w-32 text-muted-foreground" />
                <p className="mt-4 text-sm text-muted-foreground">
                  QR Code d'authentification
                </p>
              </div>
            </div>
            
            <div className="space-y-2">
              <Label htmlFor="two-factor-code">Code de vérification</Label>
              <Input
                id="two-factor-code"
                type="text"
                placeholder="Entrez le code à 6 chiffres"
                value={twoFactorCode}
                onChange={(e) => setTwoFactorCode(e.target.value.replace(/\D/g, '').slice(0, 6))}
                className="text-center text-lg tracking-widest"
                maxLength={6}
              />
              <p className="text-xs text-muted-foreground text-center">
                Entrez les 6 chiffres affichés dans votre application d'authentification
              </p>
            </div>
          </div>
          
          <div className="flex gap-3">
            <Button
              variant="outline"
              className="flex-1"
              onClick={() => setTwoFactorModalOpen(false)}
            >
              Annuler
            </Button>
            <Button
              className="flex-1 bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90"
              onClick={handleActivate2FA}
            >
              Activer
            </Button>
          </div>
        </DialogContent>
      </Dialog>

      <Dialog open={devicesModalOpen} onOpenChange={setDevicesModalOpen}>
        <DialogContent className="sm:max-w-[500px]">
          <DialogHeader>
            <DialogTitle>Appareils Connectés</DialogTitle>
            <DialogDescription>
              Gérez les appareils qui ont accès à votre compte Loto Happy.
            </DialogDescription>
          </DialogHeader>
          
          <div className="space-y-3 py-4">
            <Card className="border-[#FFD700] bg-card/50 p-4">
              <div className="flex items-start gap-3">
                <div className="rounded-full bg-[#FFD700]/10 p-2">
                  <Smartphone className="h-5 w-5 text-[#FFD700]" />
                </div>
                <div className="flex-1">
                  <div className="flex items-center gap-2">
                    <p className="font-semibold text-foreground">Chrome sur Windows</p>
                    <Badge className="bg-[#34C759] text-white">Actif maintenant</Badge>
                  </div>
                  <p className="text-sm text-muted-foreground">Lomé, Togo</p>
                  <p className="text-xs text-muted-foreground mt-1">Dernière activité : Il y a quelques secondes</p>
                </div>
              </div>
            </Card>
            
            <Card className="border-border bg-card p-4">
              <div className="flex items-start justify-between gap-3">
                <div className="flex items-start gap-3">
                  <div className="rounded-full bg-muted p-2">
                    <Smartphone className="h-5 w-5 text-muted-foreground" />
                  </div>
                  <div>
                    <p className="font-semibold text-foreground">iPhone 14 Pro</p>
                    <p className="text-sm text-muted-foreground">Lomé, Togo</p>
                    <p className="text-xs text-muted-foreground mt-1">Dernière activité : Il y a 2 heures</p>
                  </div>
                </div>
                <Button
                  variant="outline"
                  size="sm"
                  className="border-[#FF3B30] text-[#FF3B30] hover:bg-[#FF3B30]/10"
                  onClick={() => handleDisconnectDevice('iPhone 14 Pro')}
                >
                  Se déconnecter
                </Button>
              </div>
            </Card>
            
            <Card className="border-border bg-card p-4">
              <div className="flex items-start justify-between gap-3">
                <div className="flex items-start gap-3">
                  <div className="rounded-full bg-muted p-2">
                    <Smartphone className="h-5 w-5 text-muted-foreground" />
                  </div>
                  <div>
                    <p className="font-semibold text-foreground">Safari sur iPad</p>
                    <p className="text-sm text-muted-foreground">Cotonou, Bénin</p>
                    <p className="text-xs text-muted-foreground mt-1">Dernière activité : Il y a 3 jours</p>
                  </div>
                </div>
                <Button
                  variant="outline"
                  size="sm"
                  className="border-[#FF3B30] text-[#FF3B30] hover:bg-[#FF3B30]/10"
                  onClick={() => handleDisconnectDevice('Safari sur iPad')}
                >
                  Se déconnecter
                </Button>
              </div>
            </Card>
          </div>
          
          <Button
            variant="outline"
            className="w-full"
            onClick={() => setDevicesModalOpen(false)}
          >
            Fermer
          </Button>
        </DialogContent>
      </Dialog>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/RechargeModal.tsx ---
================================================================================

import { useState } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "./ui/dialog";
import { Button } from "./ui/button";
import { Input } from "./ui/input";
import { Label } from "./ui/label";
import { toast } from "sonner@2.0.3";
import { Users } from "lucide-react";

interface RechargeModalProps {
  open: boolean;
  onClose: () => void;
  balance: number;
  onNavigateToResellers?: (amount: number) => void;
}

const QUICK_AMOUNTS = [1000, 5000, 10000, 25000, 50000, 100000];

export function RechargeModal({ open, onClose, balance = 0, onNavigateToResellers }: RechargeModalProps) {
  const [amount, setAmount] = useState("");

  const handleFindReseller = () => {
    if (!amount || parseInt(amount) < 500) {
      toast.error("Le montant minimum est de 500 F CFA");
      return;
    }

    const rechargeAmount = parseInt(amount);
    
    // Naviguer vers l'écran des revendeurs avec le montant
    if (onNavigateToResellers) {
      onNavigateToResellers(rechargeAmount);
      onClose();
      setAmount("");
    }
  };

  return (
    <Dialog open={open} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-md">
        <DialogHeader>
          <DialogTitle>Recharger mon compte</DialogTitle>
          <DialogDescription>
            Indiquez le montant que vous souhaitez recharger
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-6">
          {/* Affichage du solde actuel */}
          <div className="rounded-lg border border-[#FFD700] bg-[#FFD700]/10 p-4 text-center">
            <p className="text-sm text-muted-foreground mb-1">Solde de Jeu actuel</p>
            <p className="text-2xl font-bold text-[#FFD700]">
              {balance.toLocaleString('fr-FR')} F CFA
            </p>
          </div>

          {/* Amount Input */}
          <div className="space-y-2">
            <Label htmlFor="amount">Montant à recharger (F CFA)</Label>
            <Input
              id="amount"
              type="number"
              placeholder="Entrez le montant"
              value={amount}
              onChange={(e) => setAmount(e.target.value)}
              className="bg-input-background border-input focus:border-[#FFD700]"
            />
          </div>

          {/* Quick Amounts */}
          <div className="space-y-2">
            <Label>Montants rapides</Label>
            <div className="grid grid-cols-3 gap-2">
              {QUICK_AMOUNTS.map((amt) => (
                <Button
                  key={amt}
                  variant="outline"
                  className="border-border hover:border-[#FFD700] hover:bg-[#FFD700]/10"
                  onClick={() => setAmount(amt.toString())}
                >
                  {amt.toLocaleString('fr-FR')}
                </Button>
              ))}
            </div>
          </div>

          {/* Info */}
          <div className="rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground">
            💡 Vous serez redirigé vers nos revendeurs agréés pour finaliser votre rechargement via Mobile Money
          </div>

          {/* Submit Button */}
          <Button
            className="w-full bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90"
            onClick={handleFindReseller}
          >
            <Users className="mr-2 h-4 w-4" />
            Trouver un revendeur
          </Button>
        </div>
      </DialogContent>
    </Dialog>
  );
}

================================================================================
--- FICHIER : ./src/components/RegistrationScreen.tsx ---
================================================================================

// src/components/RegistrationScreen.tsx

import { useState, useEffect } from 'react';
import { motion } from 'framer-motion';
import { Button } from './ui/button';
import { Input } from './ui/input';
import { Label } from './ui/label';
// L'import de sonner doit être simple
import { toast } from 'sonner';
import { ArrowLeft, Eye, EyeOff, ShieldCheck, User, Mail, Phone, Loader2 } from 'lucide-react';
import { useTheme } from './ThemeProvider';
import { useAuth } from '../contexts/AuthContext';
// Remarque : le composant Select n'est plus utilisé dans ce flux simplifié, mais on peut le garder pour plus tard.
// import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';

// CORRECTION: L'interface des props est mise à jour.
interface RegistrationScreenProps {
  prefilledIdentifier: string; // La nouvelle prop unique
  onBack: () => void;
}

export function RegistrationScreen({ prefilledIdentifier, onBack }: RegistrationScreenProps) {
  const { register, isLoading } = useAuth();
  const { actualTheme } = useTheme();
  const isDark = actualTheme === 'dark';

  // --- ÉTATS DU FORMULAIRE ---
  const [username, setUsername] = useState('');
  const [email, setEmail] = useState('');
  const [phoneNumber, setPhoneNumber] = useState('');
  // Supposons un code pays par défaut, car il est difficile de le deviner.
  const [countryCode, setCountryCode] = useState('+228'); 
  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  // Ce `useEffect` est crucial. Il s'exécute une seule fois au montage
  // pour analyser `prefilledIdentifier` et remplir les champs.
  useEffect(() => {
    if (prefilledIdentifier.includes('@')) {
      setEmail(prefilledIdentifier);
    } else {
      // Pour les numéros de téléphone, c'est plus complexe.
      // On le place dans le champ `phoneNumber` et on laisse le code pays par défaut.
      // On retire le '+' potentiel pour ne pas le dupliquer.
      setPhoneNumber(prefilledIdentifier.replace('+', ''));
    }
    // Le tableau de dépendances vide assure que cela ne se produit qu'une seule fois.
  }, []);


// DANS src/components/RegistrationScreen.tsx
// REMPLACE ta fonction handleRegister par CELLE-CI :

const handleRegister = async () => {
  // La validation reste la même
  if (!username || username.length < 3) { toast.error("Le nom d'utilisateur doit contenir au moins 3 caractères."); return; }
  if (!email || !email.includes('@')) { toast.error("Veuillez entrer une adresse email valide."); return; }
  if (!phoneNumber || phoneNumber.length < 8) { toast.error("Veuillez entrer un numéro de téléphone valide."); return; }
  if (!password || password.length < 8) { toast.error("Le mot de passe doit contenir au moins 8 caractères."); return; }
  if (password !== confirmPassword) { toast.error("Les mots de passe ne correspondent pas."); return; }
  
  try {
    const fullPhoneNumber = `${countryCode}${phoneNumber}`;
    
    await register({
      username,
      email,
      phoneNumber: fullPhoneNumber,
      password,
    });

    toast.success(`Compte créé ! Bienvenue ${username} ! 🎉`);

  } catch (err: any) {
    // --- PARTIE DÉBOGAGE AGRESSIF ---
    console.error("--- ERREUR D'INSCRIPTION DÉTAILLÉE ---", err);
    
    const errorStatus = err.response?.status;
    const errorData = err.response?.data;

    // Affiche les données de la réponse dans la console pour une analyse détaillée
    console.log("STATUT DE L'ERREUR:", errorStatus);
    console.log("DONNÉES DE LA RÉPONSE:", errorData);

    // AFFICHE UNE ALERTE BLOQUANTE POUR NE PAS RATER LE MESSAGE
    alert(
      `Échec de l'inscription !\n\n` +
      `Statut: ${errorStatus}\n\n` +
      `Message du Backend:\n` +
      `${JSON.stringify(errorData, null, 2)}`
    );
  }
};

  // Le JSX est simplifié pour ne montrer que le formulaire d'inscription classique
  // La logique Google a été retirée pour clarifier, elle peut être réintégrée plus tard si besoin.
  return (
    <div 
      className="relative flex min-h-screen items-center justify-center overflow-hidden px-6 py-12"
      style={{ backgroundColor: isDark ? '#121212' : '#F4F4F7' }}
    >
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.8 }}
        className="relative z-10 w-full max-w-md"
      >
        <div 
          className="rounded-3xl px-8 py-16 shadow-2xl"
          style={{ backgroundColor: isDark ? 'rgba(28, 28, 30, 0.75)' : 'rgba(255, 255, 255, 0.7)', backdropFilter: 'blur(20px)', WebkitBackdropFilter: 'blur(20px)', border: isDark ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.5)' }}
        >
          <button onClick={onBack} className="mb-6 flex items-center gap-2 transition-colors" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>
            <ArrowLeft className="h-5 w-5" />
            <span>Retour</span>
          </button>
          
          <motion.div className="mb-8 text-center" initial={{ scale: 0.8, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} transition={{ delay: 0.2, duration: 0.6 }}>
            <div className="mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-2xl bg-gradient-to-br from-[#FF6B00] to-[#FF8800] shadow-lg"><span className="text-3xl font-bold text-white">LH</span></div>
            <h1 className="text-3xl font-bold" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>Créez votre compte</h1>
            <p className="mt-2" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>Rejoignez Loto Happy dès maintenant</p>
          </motion.div>

          <motion.div className="space-y-6" initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.4, duration: 0.6 }}>
            {/* Numéro de téléphone */}
            <div className="space-y-2">
              <Label htmlFor="phone" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}><Phone className="inline h-4 w-4 mr-2" />Numéro de téléphone</Label>
              <div className="flex">
                <Input value={countryCode} onChange={e => setCountryCode(e.target.value)} className="w-20 mr-2 rounded-l-md" />
                <Input id="phone" type="tel" placeholder="90102030" value={phoneNumber} onChange={(e) => setPhoneNumber(e.target.value)} className="flex-1 rounded-r-md" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }}/>
              </div>
            </div>
          
            {/* Adresse email */}
            <div className="space-y-2">
              <Label htmlFor="email" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}><Mail className="inline h-4 w-4 mr-2" />Adresse email</Label>
              <Input id="email" type="email" placeholder="votre@email.com" value={email} onChange={(e) => setEmail(e.target.value)} style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }}/>
            </div>
            
            {/* Nom d'utilisateur */}
            <div className="space-y-2">
              <Label htmlFor="username" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}><User className="inline h-4 w-4 mr-2" />Nom d'utilisateur</Label>
              <Input id="username" type="text" placeholder="Au moins 3 caractères" value={username} onChange={(e) => setUsername(e.target.value)} style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }}/>
            </div>

            {/* Créer un mot de passe */}
            <div className="space-y-2">
              <Label htmlFor="password" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>Créer un mot de passe</Label>
              <div className="relative">
                <Input id="password" type={showPassword ? 'text' : 'password'} placeholder="Au moins 6 caractères" value={password} onChange={(e) => setPassword(e.target.value)} className="pr-12" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }}/>
<button type="button" onClick={() => setShowPassword(!showPassword)} className="absolute right-3 top-1/2 -translate-y-1/2" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>
  {showPassword ? <EyeOff className="h-5 w-5" /> : <Eye className="h-5 w-5" />}
</button>
              </div>
            </div>

            {/* Confirmer le mot de passe */}
            <div className="space-y-2">
              <Label htmlFor="confirmPassword" style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>Confirmer le mot de passe</Label>
              <div className="relative">
                <Input id="confirmPassword" type={showConfirmPassword ? 'text' : 'password'} placeholder="Retapez votre mot de passe" value={confirmPassword} onChange={(e) => setConfirmPassword(e.target.value)} className="pr-12" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6', color: isDark ? '#EAEAEA' : '#1C1C1E' }}/>
<button type="button" onClick={() => setShowConfirmPassword(!showConfirmPassword)} className="absolute right-3 top-1/2 -translate-y-1/2" style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}> {showConfirmPassword ? <EyeOff className="h-5 w-5" /> : <Eye className="h-5 w-5" />} </button>
              </div>
            </div>

            <Button className="w-full bg-[#FFD700] text-lg text-[#121212] hover:bg-[#FFD700]/90 h-14" onClick={handleRegister} disabled={isLoading}>
              {isLoading ? <Loader2 className="mr-2 h-6 w-6 animate-spin" /> : <ShieldCheck className="mr-2 h-6 w-6" />}
              Créer mon compte
            </Button>
          </motion.div>
        </div>
      </motion.div>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/ResellerDashboard.tsx ---
================================================================================

// src/components/ResellerDashboard.tsx

import { useState, useEffect } from "react";
import { useAuth } from "../contexts/AuthContext";
import { creditPlayerAccountAPI, findPlayerByPhoneAPI, getResellerHistoryAPI, FoundPlayer, RechargeHistoryItem } from "../utils/resellerAPI";
import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Input } from "./ui/input";
import { Label } from "./ui/label";
import { Avatar, AvatarFallback } from "./ui/avatar";
import { useTheme } from "./ThemeProvider";
import { Wallet, Search, ShoppingCart, MessageCircle, Phone, Loader2 } from "lucide-react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "./ui/dialog";
import { toast } from "sonner";
import { ResellerProfileSettings } from "./ResellerProfileSettings";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "./ui/select";

interface ResellerDashboardProps {
  onLogout: () => void;
}

const COUNTRIES = [ { code: '+228', name: 'Togo', flag: '🇹🇬' }, { code: '+229', name: 'Bénin', flag: '🇧🇯' }, { code: '+225', name: "Côte d'Ivoire", flag: '🇨🇮' }, { code: '+233', name: 'Ghana', flag: '🇬🇭' }, { code: '+226', name: 'Burkina Faso', flag: '🇧🇫' } ];

export function ResellerDashboard({ onLogout }: ResellerDashboardProps) {
  const { actualTheme } = useTheme();
  const isDark = actualTheme === 'dark';
  
  const { user: reseller, isLoading: isAuthLoading, refreshUser } = useAuth();
  
  const [searchCountryCode, setSearchCountryCode] = useState("+228");
  const [searchTerm, setSearchTerm] = useState('');
  const [foundPlayer, setFoundPlayer] = useState<FoundPlayer | null>(null);
  const [isFindingPlayer, setIsFindingPlayer] = useState(false);
  const [amount, setAmount] = useState('');
  const [history, setHistory] = useState<RechargeHistoryItem[]>([]);
  const [isHistoryLoading, setIsHistoryLoading] = useState(true);
  
  const [buyTokensOpen, setBuyTokensOpen] = useState(false);
  const [profileOpen, setProfileOpen] = useState(false);
  const [isSubmitting, setIsSubmitting] = useState(false);

  useEffect(() => {
    if (searchTerm.trim().length < 8) {
      setFoundPlayer(null);
      return;
    }
    const handler = setTimeout(async () => {
      setIsFindingPlayer(true);
      setFoundPlayer(null);
      try {
        const fullPhoneNumber = `${searchCountryCode}${searchTerm.trim().replace(/\s/g, '')}`;
        const player = await findPlayerByPhoneAPI(fullPhoneNumber);
        setFoundPlayer(player);
        toast.success(`Joueur trouvé : ${player.username}`);
      } catch (error) {
        setFoundPlayer(null);
      } finally {
        setIsFindingPlayer(false);
      }
    }, 500);
    return () => clearTimeout(handler);
  }, [searchTerm, searchCountryCode]);
  
  useEffect(() => {
    const fetchHistory = async () => {
      setIsHistoryLoading(true);
      try {
        const response = await getResellerHistoryAPI(0, 5);
        setHistory(response.items);
      } catch (error) {
        console.error("Erreur chargement historique:", error);
        toast.error("Impossible de charger l'historique des transactions.");
      } finally {
        setIsHistoryLoading(false);
      }
    };
    if (reseller) {
        fetchHistory();
    }
  }, [reseller, isSubmitting]);

  if (isAuthLoading) { return <div className="flex min-h-screen items-center justify-center"><Loader2 className="h-8 w-8 animate-spin" /></div>; }
  if (!reseller || reseller.role !== 'reseller') { return <div className="flex min-h-screen items-center justify-center"><p className="text-muted-foreground">Accès non autorisé</p></div>; }
  
  const handleCreditAccount = async () => {
    if (!foundPlayer) return toast.error('Veuillez trouver un joueur valide avant de créditer.');
    if (!amount || parseFloat(amount) <= 0) return toast.error('Veuillez entrer un montant valide.');
    
    setIsSubmitting(true);
    try {
      const result = await creditPlayerAccountAPI(foundPlayer.phoneNumber, parseFloat(amount));
      toast.success(result.message || "Compte crédité avec succès !");
      setSearchTerm('');
      setAmount('');
      setFoundPlayer(null);
      if (refreshUser) {
        await refreshUser();
      }
    } catch (err: any) {
      toast.error(err?.response?.data?.detail || "Erreur lors du crédit.");
    } finally {
      setIsSubmitting(false);
    }
  };
  
  const handleWhatsAppContact = () => {
    const message = encodeURIComponent(`Bonjour, je suis le revendeur ${reseller.username} et je souhaite acheter des jetons pour Lotto Happy.`);
    window.open(`https://wa.me/22890000000?text=${message}`, '_blank');
  };

  return (
    <div className="min-h-screen" style={{ backgroundColor: isDark ? '#121212' : '#F4F4F7' }}>
      <header className="sticky top-0 z-50 border-b backdrop-blur" style={{ backgroundColor: isDark ? 'rgba(28, 28, 30, 0.95)' : 'rgba(255, 255, 255, 0.95)', borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6' }}>
        <div className="container mx-auto flex h-16 items-center justify-between px-4">
          <div className="flex items-center gap-2">
            <div className="flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-[#FF6B00] to-[#FF8800] shadow-lg"><span className="font-bold text-white text-sm">LH</span></div>
            <div><div className="font-bold text-foreground">Lotto Happy</div><div className="text-xs text-muted-foreground">Espace Revendeurs</div></div>
          </div>
          <button onClick={() => setProfileOpen(true)} className="flex items-center gap-2 rounded-full transition-all hover:opacity-80">
            <Avatar className="h-10 w-10 border-2 border-[#FFD700] cursor-pointer"><AvatarFallback className="font-bold" style={{ background: 'linear-gradient(135deg, #FF6B00 0%, #FFD700 100%)', color: '#FFFFFF' }}>{reseller.username.substring(0, 2).toUpperCase()}</AvatarFallback></Avatar>
          </button>
        </div>
      </header>

      <div className="container mx-auto px-4 py-6 sm:py-8">
        <div className="mb-6 sm:mb-8 grid gap-4 sm:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
          <Card className="border-border bg-card p-4 sm:p-6" style={{ background: isDark ? 'linear-gradient(135deg, #1C1C1E 0%, #2C2C2E 100%)' : 'linear-gradient(135deg, #FFFFFF 0%, #F9F9F9 100%)' }}>
            <div className="flex items-start justify-between">
              <div><p className="text-xs sm:text-sm text-muted-foreground">Mon Solde de Jetons</p><h2 className="mt-1 sm:mt-2 text-2xl sm:text-3xl font-bold text-[#FFD700]">{(reseller.tokenBalance ?? 0).toLocaleString('fr-FR')} F</h2></div>
              <div className="rounded-full bg-[#FFD700]/10 p-2 sm:p-3"><Wallet className="h-5 w-5 sm:h-6 sm:w-6 text-[#FFD700]" /></div>
            </div>
            <Button className="mt-3 sm:mt-4 w-full bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90" onClick={() => setBuyTokensOpen(true)}><ShoppingCart className="mr-2 h-4 w-4" />Acheter des Jetons</Button>
          </Card>
        </div>

        <Card className="mb-8 border-border bg-card p-8">
          <h3 className="mb-6 text-2xl font-bold text-foreground">Recharger un Joueur</h3>
          <div className="grid gap-6 md:grid-cols-2">
            <div className="space-y-2">
              <Label htmlFor="search">Rechercher un joueur (Numéro)</Label>
              <div className="flex gap-2">
                <Select value={searchCountryCode} onValueChange={setSearchCountryCode}>
                  <SelectTrigger className="w-32">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    {COUNTRIES.map((c) => (<SelectItem key={c.code} value={c.code}><span className="flex items-center gap-2"><span>{c.flag}</span><span>{c.code}</span></span></SelectItem>))}
                  </SelectContent>
                </Select>
                <div className="relative flex-1">
                  <Search className="absolute left-3 top-3 h-5 w-5 text-muted-foreground" />
                  <Input id="search" type="text" placeholder="Ex: 90123456" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="pl-10" />
                  {isFindingPlayer && <Loader2 className="absolute right-3 top-3 h-5 w-5 animate-spin"/>}
                </div>
              </div>
              {foundPlayer && <p className="mt-2 text-sm text-green-500">Joueur trouvé : <span className="font-bold">{foundPlayer.username}</span></p>}
            </div>
            <div className="space-y-2">
              <Label htmlFor="amount">Montant à créditer (F CFA)</Label>
              <Input id="amount" type="number" placeholder="Ex: 5000" value={amount} onChange={(e) => setAmount(e.target.value)} />
            </div>
          </div>
          <Button className="mt-6 w-full bg-[#34C759] text-white hover:bg-[#34C759]/90" size="lg" onClick={handleCreditAccount} disabled={isSubmitting || !foundPlayer}>{isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin"/>}Créditer le compte</Button>
        </Card>

        <Card className="border-border bg-card p-6">
          <h3 className="mb-4 text-xl font-bold text-foreground">Transactions Récentes</h3>
          {isHistoryLoading ? (<div className="py-8 text-center"><Loader2 className="h-6 w-6 animate-spin mx-auto"/></div>) 
            : !history || history.length === 0 ? (<div className="py-8 text-center text-muted-foreground">Aucune transaction pour le moment</div>) 
            : (<div className="space-y-3">{history.map((tx) => (<div key={tx.id} className="flex items-center justify-between rounded-lg border border-border p-4" style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF' }}><div><p className="font-semibold text-foreground">{tx.playerCredited.username}</p><p className="text-sm text-muted-foreground">{tx.playerCredited.phoneNumber}</p></div><div className="text-right"><p className="font-bold text-[#34C759]">+{Math.abs(tx.amount).toLocaleString('fr-FR')} F</p><p className="text-xs text-muted-foreground">{new Date(tx.date).toLocaleDateString('fr-FR', { day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' })}</p></div></div>))}</div>)}
        </Card>
      </div>
      
      <Dialog open={buyTokensOpen} onOpenChange={setBuyTokensOpen}>
        <DialogContent>
          <DialogHeader><DialogTitle>Acheter des Jetons</DialogTitle><DialogDescription>Contactez l'administration de Lotto Happy pour acheter des jetons</DialogDescription></DialogHeader>
          <div className="space-y-4 py-4">
            <p className="text-sm text-muted-foreground">Pour recharger votre solde de jetons, veuillez contacter notre équipe administrative via les canaux ci-dessous :</p>
            <div className="space-y-3"><Button className="w-full bg-[#25D366] text-white hover:bg-[#25D366]/90" onClick={handleWhatsAppContact}><MessageCircle className="mr-2 h-5 w-5" />Contacter par WhatsApp</Button><Button variant="outline" className="w-full" onClick={() => window.open('tel:+22890000000')}><Phone className="mr-2 h-5 w-5" />Appeler le Support</Button></div>
            <div className="rounded-lg border border-border bg-muted p-4"><p className="text-xs text-muted-foreground"><strong>Note :</strong> Les jetons achetés seront crédités sur votre compte après validation du paiement par l'administration.</p></div>
          </div>
        </DialogContent>
      </Dialog>
      
      <ResellerProfileSettings open={profileOpen} onClose={() => setProfileOpen(false)} onLogout={onLogout} />
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/ResellerProfileSettings.tsx ---
================================================================================

// src/components/ResellerProfileSettings.tsx

import { useState } from "react";
// CORRECTION : On importe le hook useAuth et la fonction de l'API d'authentification
import { useAuth } from "../contexts/AuthContext";
import { changePassword as apiChangePassword } from "../utils/authAPI";
import { Button } from "./ui/button";
import { Input } from "./ui/input";
import { Label } from "./ui/label";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from "./ui/dialog";
import { Avatar, AvatarFallback } from "./ui/avatar";
import { useTheme } from "./ThemeProvider";
import { toast } from "sonner";
import { User, Lock, LogOut, Phone, Shield, Palette, Sun, Moon, Monitor, Loader2 } from "lucide-react";

interface ResellerProfileSettingsProps {
  open: boolean;
  onClose: () => void;
  onLogout: () => void;
}

export function ResellerProfileSettings({ open, onClose, onLogout }: ResellerProfileSettingsProps) {
  const { actualTheme, theme, setTheme } = useTheme();
  const isDark = actualTheme === 'dark';
  
  // --- CORRECTION MAJEURE : On utilise le contexte ---
  const { user: reseller } = useAuth();
  
  const [currentPassword, setCurrentPassword] = useState("");
  const [newPassword, setNewPassword] = useState("");
  const [confirmNewPassword, setConfirmNewPassword] = useState("");
  const [isSubmitting, setIsSubmitting] = useState(false);

  // Si le composant s'affiche avant que l'utilisateur ne soit chargé, on ne rend rien.
  if (!reseller) {
    return null;
  }

  const handleChangePassword = async () => {
    if (!currentPassword || !newPassword || !confirmNewPassword) { return toast.error("Veuillez remplir tous les champs de mot de passe."); }
    if (newPassword.length < 8) { return toast.error("Le nouveau mot de passe doit faire au moins 8 caractères."); }
    if (newPassword !== confirmNewPassword) { return toast.error("Les nouveaux mots de passe ne correspondent pas."); }
    
    setIsSubmitting(true);
    try {
      await apiChangePassword({ current_password: currentPassword, new_password: newPassword });
      toast.success("Mot de passe mis à jour avec succès !");
      // On vide les champs et on ferme la modale
      setCurrentPassword(""); setNewPassword(""); setConfirmNewPassword("");
      onClose();
    } catch (err: any) {
      // On affiche l'erreur spécifique du backend (ex: "Mot de passe actuel incorrect")
      toast.error(err?.response?.data?.detail || "Échec de la mise à jour du mot de passe.");
    } finally {
      setIsSubmitting(false);
    }
  };
  
  return (
    <Dialog open={open} onOpenChange={onClose}>
      <DialogContent 
        className="max-w-md max-h-[90vh] overflow-y-auto scrollbar-visible"
        style={{ backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF' }}
      >
        <DialogHeader>
          <DialogTitle className="text-center text-foreground">Paramètres du Compte</DialogTitle>
        </DialogHeader>
        
        <div className="space-y-6 py-4">
          <div className="flex flex-col items-center gap-4">
            <Avatar className="h-24 w-24 border-4 border-[#FFD700]">
              <AvatarFallback className="text-2xl font-bold" style={{ background: 'linear-gradient(135deg, #FF6B00 0%, #FFD700 100%)', color: '#FFFFFF' }}>
                {reseller.username.substring(0, 2).toUpperCase()}
              </AvatarFallback>
            </Avatar>
            <div className="text-center">
              <h3 className="font-bold text-foreground">{reseller.username}</h3>
              <p className="text-sm text-muted-foreground">Revendeur Agréé</p>
            </div>
          </div>
          
          <div className="space-y-4 rounded-lg border border-border p-4">
            <div className="flex items-center gap-3">
              <div className="rounded-full bg-[#FF6B00]/10 p-2"><User className="h-4 w-4 text-[#FF6B00]" /></div>
              <div><p className="text-xs text-muted-foreground">Nom d'utilisateur</p><p className="font-semibold text-foreground">{reseller.username}</p></div>
            </div>
            <div className="flex items-center gap-3">
              <div className="rounded-full bg-[#4F00BC]/10 p-2"><Phone className="h-4 w-4 text-[#4F00BC]" /></div>
              <div><p className="text-xs text-muted-foreground">Numéro de téléphone</p><p className="font-semibold text-foreground">{reseller.phoneNumber}</p></div>
            </div>
            <div className="flex items-center gap-3">
              <div className="rounded-full bg-[#FFD700]/10 p-2"><Shield className="h-4 w-4 text-[#FFD700]" /></div>
              <div><p className="text-xs text-muted-foreground">Rôle</p><p className="font-semibold text-foreground capitalize">{reseller.role}</p></div>
            </div>
          </div>
          
          <div className="space-y-3 rounded-lg border border-border p-4">
            <div className="flex items-center gap-2 mb-2"><Lock className="h-5 w-5 text-foreground" /><h4 className="font-semibold text-foreground">Changer le mot de passe</h4></div>
            <div className="space-y-2"><Label htmlFor="currentPassword">Mot de passe actuel</Label><Input id="currentPassword" type="password" value={currentPassword} onChange={(e) => setCurrentPassword(e.target.value)} /></div>
            <div className="space-y-2"><Label htmlFor="newPassword">Nouveau mot de passe</Label><Input id="newPassword" type="password" value={newPassword} onChange={(e) => setNewPassword(e.target.value)} /></div>
            <div className="space-y-2"><Label htmlFor="confirmNewPassword">Confirmer le nouveau mot de passe</Label><Input id="confirmNewPassword" type="password" value={confirmNewPassword} onChange={(e) => setConfirmNewPassword(e.target.value)} /></div>
            <Button onClick={handleChangePassword} disabled={isSubmitting} className="w-full">
              {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
              Mettre à jour le mot de passe
            </Button>
          </div>
          
          <div className="space-y-3 rounded-lg border border-border p-4">
            <div className="flex items-center gap-2 mb-2"><Palette className="h-5 w-5 text-foreground" /><h4 className="font-semibold text-foreground">Apparence</h4></div>
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-2">
              <Button variant={theme === 'light' ? 'default' : 'outline'} onClick={() => setTheme('light')} className="flex items-center gap-2 justify-start"><Sun className="h-4 w-4" /> Clair</Button>
              <Button variant={theme === 'dark' ? 'default' : 'outline'} onClick={() => setTheme('dark')} className="flex items-center gap-2 justify-start"><Moon className="h-4 w-4" /> Sombre</Button>
              <Button variant={theme === 'auto' ? 'default' : 'outline'} onClick={() => setTheme('auto')} className="flex items-center gap-2 justify-start"><Monitor className="h-4 w-4" /> Système</Button>
            </div>
          </div>
          
          <Button onClick={onLogout} variant="destructive" className="w-full">
            <LogOut className="mr-2 h-4 w-4" />
            Se déconnecter
          </Button>
        </div>
      </DialogContent>
    </Dialog>
  );
}

================================================================================
--- FICHIER : ./src/components/ResellersScreen.tsx ---
================================================================================

import { useState } from "react";
import { Header } from "./Header";
import { Footer } from "./Footer";
import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Badge } from "./ui/badge";
import { ArrowLeft, Phone, Star, MessageCircle } from "lucide-react";

interface ResellersScreenProps {
  onBack: () => void;
  rechargeAmount?: number;
  userPhoneNumber?: string;
  playBalance?: number;
  onRecharge?: () => void;
  onProfile?: () => void;
}

interface Reseller {
  id: string;
  name: string;
  country: string;
  countryCode: string;
  flagUrl: string;
  rating: number;
  votes: number;
  phone: string;
  whatsapp: string;
}

const RESELLERS: Reseller[] = [
  {
    id: "1",
    name: "GREGOIRE RT SERVICE",
    country: "Togo",
    countryCode: "tg",
    flagUrl: "https://flagcdn.com/tg.svg",
    rating: 4.8,
    votes: 264,
    phone: "+228 90 12 34 56",
    whatsapp: "+22890123456",
  },
  {
    id: "2",
    name: "AKOSSIWA LOTO CENTER",
    country: "Togo",
    countryCode: "tg",
    flagUrl: "https://flagcdn.com/tg.svg",
    rating: 4.9,
    votes: 187,
    phone: "+228 91 23 45 67",
    whatsapp: "+22891234567",
  },
  {
    id: "3",
    name: "MAISON DU LOTO COTONOU",
    country: "Bénin",
    countryCode: "bj",
    flagUrl: "https://flagcdn.com/bj.svg",
    rating: 4.7,
    votes: 312,
    phone: "+229 97 12 34 56",
    whatsapp: "+22997123456",
  },
  {
    id: "4",
    name: "CHANCE PLUS ABIDJAN",
    country: "Côte d'Ivoire",
    countryCode: "ci",
    flagUrl: "https://flagcdn.com/ci.svg",
    rating: 4.6,
    votes: 428,
    phone: "+225 07 12 34 56 78",
    whatsapp: "+2250712345678",
  },
  {
    id: "5",
    name: "KOKOU DISTRIBUTEUR LOMÉ",
    country: "Togo",
    countryCode: "tg",
    flagUrl: "https://flagcdn.com/tg.svg",
    rating: 4.5,
    votes: 156,
    phone: "+228 92 34 56 78",
    whatsapp: "+22892345678",
  },
  {
    id: "6",
    name: "SUPER CHANCE PORTO-NOVO",
    country: "Bénin",
    countryCode: "bj",
    flagUrl: "https://flagcdn.com/bj.svg",
    rating: 4.8,
    votes: 203,
    phone: "+229 96 23 45 67",
    whatsapp: "+22996234567",
  },
  {
    id: "7",
    name: "GOLDEN LOTO ACCRA",
    country: "Ghana",
    countryCode: "gh",
    flagUrl: "https://flagcdn.com/gh.svg",
    rating: 4.7,
    votes: 389,
    phone: "+233 24 123 4567",
    whatsapp: "+233241234567",
  },
  {
    id: "8",
    name: "MEGA CHANCE OUAGA",
    country: "Burkina Faso",
    countryCode: "bf",
    flagUrl: "https://flagcdn.com/bf.svg",
    rating: 4.6,
    votes: 274,
    phone: "+226 70 12 34 56",
    whatsapp: "+22670123456",
  },
  {
    id: "9",
    name: "DAKAR LOTO EXPRESS",
    country: "Sénégal",
    countryCode: "sn",
    flagUrl: "https://flagcdn.com/sn.svg",
    rating: 4.9,
    votes: 521,
    phone: "+221 77 123 45 67",
    whatsapp: "+221771234567",
  },
];

const COUNTRIES = [
  { code: "all", name: "Tous", flagUrl: "" },
  { code: "tg", name: "Togo", flagUrl: "https://flagcdn.com/tg.svg" },
  { code: "bj", name: "Bénin", flagUrl: "https://flagcdn.com/bj.svg" },
  { code: "ci", name: "Côte d'Ivoire", flagUrl: "https://flagcdn.com/ci.svg" },
  { code: "gh", name: "Ghana", flagUrl: "https://flagcdn.com/gh.svg" },
  { code: "bf", name: "Burkina Faso", flagUrl: "https://flagcdn.com/bf.svg" },
  { code: "sn", name: "Sénégal", flagUrl: "https://flagcdn.com/sn.svg" },
];

export function ResellersScreen({ onBack, rechargeAmount, userPhoneNumber = "+228 90 12 34 56", playBalance, onRecharge, onProfile }: ResellersScreenProps) {
  const [selectedCountry, setSelectedCountry] = useState("all");

  const filteredResellers = selectedCountry === "all" 
    ? RESELLERS 
    : RESELLERS.filter(r => r.countryCode === selectedCountry);

  const handleCall = (phone: string) => {
    window.location.href = `tel:${phone}`;
  };

  const handleWhatsApp = (whatsapp: string) => {
    // Construire le message pré-rempli
    let message = "Bonjour, je suis un utilisateur de Lotto Happy. ";
    
    if (rechargeAmount) {
      message += `Je souhaite recharger mon compte du montant de ${rechargeAmount.toLocaleString('fr-FR')} F CFA. `;
    }
    
    message += `Mon numéro de compte Lotto Happy est le ${userPhoneNumber}.`;
    
    // Encoder le message pour l'URL
    const encodedMessage = encodeURIComponent(message);
    
    // Ouvrir WhatsApp avec le message pré-rempli
    window.open(`https://wa.me/${whatsapp}?text=${encodedMessage}`, '_blank');
  };

  const renderStars = (rating: number) => {
    return (
      <div className="flex items-center gap-1">
        {[1, 2, 3, 4, 5].map((star) => (
          <Star
            key={star}
            className={`h-4 w-4 ${
              star <= Math.floor(rating)
                ? "fill-[#FFD700] text-[#FFD700]"
                : star - 0.5 <= rating
                ? "fill-[#FFD700]/50 text-[#FFD700]"
                : "text-muted"
            }`}
          />
        ))}
        <span className="ml-1 text-sm text-muted-foreground">
          {rating.toFixed(1)}
        </span>
      </div>
    );
  };

  return (
    <div className="min-h-screen bg-background">
      <Header balance={playBalance} onRecharge={onRecharge} onProfile={onProfile} />

      <main className="container px-4 py-8">
        {/* Back Button */}
        <Button
          variant="ghost"
          className="mb-6 hover:bg-accent/10"
          onClick={onBack}
        >
          <ArrowLeft className="mr-2 h-4 w-4" />
          Retour
        </Button>

        {/* Title */}
        <div className="mb-6">
          <h1 className="text-3xl font-bold text-foreground mb-2">Revendeurs Agréés</h1>
          <p className="text-muted-foreground">
            Contactez nos partenaires de confiance pour recharger votre compte
          </p>
        </div>

        {/* Country Filters */}
        <div className="mb-8 overflow-x-auto scrollbar-visible">
          <div className="flex gap-2 pb-2">
            {COUNTRIES.map((country) => (
              <Button
                key={country.code}
                variant={selectedCountry === country.code ? "default" : "outline"}
                className={
                  selectedCountry === country.code
                    ? "bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90 whitespace-nowrap"
                    : "border-border hover:border-[#FFD700] hover:bg-[#FFD700]/10 whitespace-nowrap"
                }
                onClick={() => setSelectedCountry(country.code)}
              >
                {country.flagUrl && (
                  <img src={country.flagUrl} alt={country.name} className="mr-2 h-4 w-6 object-cover rounded-sm" />
                )}
                {country.name}
              </Button>
            ))}
          </div>
        </div>

        {/* Resellers List */}
        <div className="space-y-4 mb-8">
          {filteredResellers.length > 0 ? (
            filteredResellers.map((reseller) => (
              <Card key={reseller.id} className="border-border bg-card p-5 hover:border-[#FFD700]/50 transition-all">
                <div className="flex flex-col sm:flex-row sm:items-center gap-4">
                  {/* Info Section */}
                  <div className="flex-1 space-y-2">
                    <div className="flex items-center gap-2 flex-wrap">
                      <h3 className="font-bold text-foreground">{reseller.name}</h3>
                      <Badge variant="outline" className="border-border">
                        <img 
                          src={reseller.flagUrl} 
                          alt={reseller.country} 
                          className="mr-1 h-3 w-4 object-cover rounded-sm" 
                        />
                        {reseller.country}
                      </Badge>
                    </div>
                    
                    <div className="flex items-center gap-3">
                      {renderStars(reseller.rating)}
                      <span className="text-sm text-muted-foreground">
                        ({reseller.votes} votes)
                      </span>
                    </div>
                  </div>

                  {/* Action Buttons */}
                  <div className="flex gap-2">
                    <Button
                      variant="outline"
                      size="sm"
                      className="flex-1 sm:flex-none border-[#34C759] text-[#34C759] hover:bg-[#34C759]/10"
                      onClick={() => handleCall(reseller.phone)}
                    >
                      <Phone className="mr-2 h-4 w-4" />
                      <span className="hidden sm:inline">Appeler</span>
                    </Button>
                    <Button
                      variant="outline"
                      size="sm"
                      className="flex-1 sm:flex-none border-[#25D366] text-[#25D366] hover:bg-[#25D366]/10"
                      onClick={() => handleWhatsApp(reseller.whatsapp)}
                    >
                      <MessageCircle className="mr-2 h-4 w-4" />
                      <span className="hidden sm:inline">WhatsApp</span>
                    </Button>
                  </div>
                </div>
              </Card>
            ))
          ) : (
            <Card className="border-border bg-card p-8 text-center">
              <p className="text-muted-foreground">
                Aucun revendeur trouvé pour ce pays
              </p>
            </Card>
          )}
        </div>

        {/* Info Card */}
        <Card className="border-[#FFD700] bg-[#FFD700]/10 p-6">
          <h3 className="font-semibold text-foreground mb-3">
            💡 Comment ça marche ?
          </h3>
          <ul className="space-y-2 text-sm text-muted-foreground">
            <li>1️⃣ Choisissez un revendeur agréé de votre pays</li>
            <li>2️⃣ Contactez-le par téléphone ou WhatsApp</li>
            <li>3️⃣ Effectuez votre paiement via Mobile Money</li>
            <li>4️⃣ Votre compte sera crédité instantanément !</li>
          </ul>
        </Card>
      </main>

      <Footer />
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/ResultsScreen.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { Header } from "./Header";
import { Footer } from "./Footer";
import { Button } from "./ui/button";
import { Card } from "./ui/card";
import { Badge } from "./ui/badge";
import { Calendar } from "./ui/calendar";
import { Popover, PopoverContent, PopoverTrigger } from "./ui/popover";
import { ArrowLeft, Calendar as CalendarIcon, Trophy, Clock } from "lucide-react";
import { format } from "date-fns";
import { fr } from "date-fns/locale";
import { getDraws, DrawExtended } from "../utils/draws";
import { getOperatorById } from "../utils/games";

interface ResultsScreenProps {
  onBack: () => void;
}

export function ResultsScreen({ onBack }: ResultsScreenProps) {
  const [selectedDate, setSelectedDate] = useState<Date | undefined>(new Date());
  const [archivedDraws, setArchivedDraws] = useState<DrawExtended[]>([]);

  useEffect(() => {
    // Charger tous les tirages complétés
    const draws = getDraws();
    const archived = draws.filter(d => d.status === 'completed');
    // Trier par date (plus récent en premier)
    archived.sort((a, b) => {
      const dateA = new Date(`${a.date}T${a.time}`);
      const dateB = new Date(`${b.date}T${b.time}`);
      return dateB.getTime() - dateA.getTime();
    });
    setArchivedDraws(archived);
  }, []);

  // Filtrer les résultats par date sélectionnée
  const filteredResults = selectedDate
    ? archivedDraws.filter((draw) => {
        const drawDate = new Date(draw.date);
        return (
          drawDate.getDate() === selectedDate.getDate() &&
          drawDate.getMonth() === selectedDate.getMonth() &&
          drawDate.getFullYear() === selectedDate.getFullYear()
        );
      })
    : [];

  return (
    <div className="min-h-screen bg-background">
      <Header balance={0} onRecharge={() => {}} onProfile={() => {}} />

      <main className="container px-4 py-8">
        {/* Back Button */}
        <Button variant="ghost" className="mb-6 hover:bg-accent/10" onClick={onBack}>
          <ArrowLeft className="mr-2 h-4 w-4" />
          Retour
        </Button>

        <div className="mb-8">
          <h1 className="text-3xl font-bold text-foreground">Résultats des Tirages</h1>
          <p className="text-muted-foreground">
            Consultez les résultats des tirages passés
          </p>
        </div>

        {/* Date Selector */}
        <Card className="mb-8 border-border bg-card p-6">
          <div className="flex flex-col items-start gap-4 sm:flex-row sm:items-center sm:justify-between">
            <div>
              <h2 className="font-semibold text-foreground">Sélectionnez une date</h2>
              <p className="text-sm text-muted-foreground">
                Cliquez pour voir les résultats d'une journée spécifique
              </p>
            </div>
            <Popover>
              <PopoverTrigger asChild>
                <Button
                  variant="outline"
                  className="w-full sm:w-[240px] justify-start text-left font-normal border-[#FFD700]/30 hover:border-[#FFD700] hover:bg-[#FFD700]/5"
                >
                  <CalendarIcon className="mr-2 h-4 w-4 text-[#FFD700]" />
                  {selectedDate ? (
                    format(selectedDate, "PPP", { locale: fr })
                  ) : (
                    <span>Choisir une date</span>
                  )}
                </Button>
              </PopoverTrigger>
              <PopoverContent className="w-auto p-0" align="end">
                <Calendar
                  mode="single"
                  selected={selectedDate}
                  onSelect={setSelectedDate}
                  initialFocus
                  locale={fr}
                />
              </PopoverContent>
            </Popover>
          </div>
        </Card>

        {/* Results List */}
        {filteredResults.length === 0 ? (
          <Card className="border-border bg-card p-12 text-center">
            <Trophy className="mx-auto mb-4 h-16 w-16 text-muted-foreground" />
            <h3 className="mb-2 font-semibold text-foreground">Aucun résultat</h3>
            <p className="text-sm text-muted-foreground">
              {selectedDate
                ? `Aucun tirage n'a été effectué le ${format(selectedDate, "PPP", { locale: fr })}`
                : "Sélectionnez une date pour voir les résultats"}
            </p>
          </Card>
        ) : (
          <div className="grid gap-6">
            {filteredResults.map((draw) => {
              const operator = getOperatorById(draw.operatorId);
              if (!operator) return null;

              return (
                <Card key={draw.id} className="border-border bg-card overflow-hidden">
                  {/* Header */}
                  <div 
                    className="p-6 border-b border-border"
                    style={{ 
                      background: `linear-gradient(135deg, ${operator.color}15 0%, transparent 100%)` 
                    }}
                  >
                    <div className="flex items-start justify-between">
                      <div className="flex items-center gap-4">
                        <span className="text-5xl">{operator.icon}</span>
                        <div>
                          <h3 className="text-2xl font-bold text-foreground">
                            {operator.name}
                          </h3>
                          <p className="text-sm text-muted-foreground">
                            {operator.country}
                          </p>
                          <div className="flex items-center gap-3 mt-2 text-sm text-muted-foreground">
                            <div className="flex items-center gap-1">
                              <CalendarIcon className="h-4 w-4" />
                              <span>{new Date(draw.date).toLocaleDateString('fr-FR')}</span>
                            </div>
                            <div className="flex items-center gap-1">
                              <Clock className="h-4 w-4" />
                              <span>{draw.time}</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Winning Numbers */}
                  <div className="p-6 bg-gradient-to-r from-[#FFD700]/10 to-[#FF6B00]/10">
                    <h4 className="text-sm font-semibold text-muted-foreground mb-3">
                      Numéros Gagnants
                    </h4>
                    <div className="flex flex-wrap gap-3">
                      {draw.winningNumbers?.map((num, index) => (
                        <div
                          key={index}
                          className="flex h-14 w-14 items-center justify-center rounded-full bg-gradient-to-br from-[#FFD700] to-[#FF6B00] shadow-lg"
                        >
                          <span className="text-xl font-bold text-[#121212]">
                            {num}
                          </span>
                        </div>
                      )) || (
                        <p className="text-muted-foreground">Aucun numéro disponible</p>
                      )}
                    </div>
                  </div>

                  {/* Stats */}
                  <div className="p-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                      <p className="text-sm text-muted-foreground mb-1">Participants</p>
                      <p className="text-2xl font-bold text-foreground">
                        {draw.participants || 0}
                      </p>
                    </div>
                    <div>
                      <p className="text-sm text-muted-foreground mb-1">Gagnants</p>
                      <p className="text-2xl font-bold text-green-500">
                        {draw.winners || 0}
                      </p>
                    </div>
                    <div>
                      <p className="text-sm text-muted-foreground mb-1">Total Mises</p>
                      <p className="text-2xl font-bold text-foreground">
                        {draw.totalBets?.toLocaleString('fr-FR') || 0} F
                      </p>
                    </div>
                    <div>
                      <p className="text-sm text-muted-foreground mb-1">Total Gains</p>
                      <p className="text-2xl font-bold text-[#FF6B00]">
                        {draw.totalWinnings?.toLocaleString('fr-FR') || 0} F
                      </p>
                    </div>
                  </div>
                </Card>
              );
            })}
          </div>
        )}

        {/* All Results Button */}
        {filteredResults.length > 0 && (
          <div className="mt-8 text-center">
            <Button
              variant="outline"
              onClick={() => setSelectedDate(undefined)}
            >
              Voir tous les résultats
            </Button>
          </div>
        )}
      </main>

      <Footer />
    </div>
  );
}


================================================================================
--- FICHIER : ./src/components/ThemeProvider.tsx ---
================================================================================

import { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import { toast } from 'sonner@2.0.3';

type Theme = 'light' | 'dark' | 'auto';
type ActualTheme = 'light' | 'dark';

interface ThemeContextType {
  theme: Theme;
  actualTheme: ActualTheme;
  toggleTheme: () => void;
  setTheme: (theme: Theme) => void;
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined);

export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setThemeState] = useState<Theme>(() => {
    // Récupérer le thème sauvegardé ou utiliser 'dark' par défaut
    const savedTheme = localStorage.getItem('loto-happy-theme') as Theme;
    return savedTheme || 'dark';
  });

  const [actualTheme, setActualTheme] = useState<ActualTheme>('dark');

  // Détecter le thème du système
  useEffect(() => {
    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
    
    const updateActualTheme = () => {
      if (theme === 'auto') {
        setActualTheme(mediaQuery.matches ? 'dark' : 'light');
      } else {
        setActualTheme(theme as ActualTheme);
      }
    };

    updateActualTheme();

    // Écouter les changements de préférence système
    mediaQuery.addEventListener('change', updateActualTheme);
    return () => mediaQuery.removeEventListener('change', updateActualTheme);
  }, [theme]);

  // Appliquer le thème au body
  useEffect(() => {
    if (actualTheme === 'light') {
      document.body.classList.add('theme-light');
    } else {
      document.body.classList.remove('theme-light');
    }
  }, [actualTheme]);

  // Sauvegarder dans localStorage
  useEffect(() => {
    localStorage.setItem('loto-happy-theme', theme);
  }, [theme]);

  const setTheme = (newTheme: Theme) => {
    setThemeState(newTheme);
    
    // Toast de confirmation
    if (newTheme === 'light') {
      toast.success('Thème Clair activé', {
        description: 'Parfait pour une utilisation en journée',
        duration: 2000,
      });
    } else if (newTheme === 'dark') {
      toast.success('Thème Sombre activé', {
        description: 'Confort optimal pour vos yeux',
        duration: 2000,
      });
    } else {
      toast.success('Thème Automatique activé', {
        description: 'Le thème s\'adapte à vos préférences système',
        duration: 2000,
      });
    }
  };

  const toggleTheme = () => {
    // Toggle entre light et dark uniquement
    if (actualTheme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  };

  return (
    <ThemeContext.Provider value={{ theme, actualTheme, toggleTheme, setTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

export function useTheme() {
  const context = useContext(ThemeContext);
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
}


================================================================================
--- FICHIER : ./src/components/WinnerFeed.tsx ---
================================================================================

import { useState, useEffect } from "react";
import { Trophy } from "lucide-react";
import { Card } from "./ui/card";
import { motion, AnimatePresence } from "motion/react";
import { useTheme } from "./ThemeProvider";
import { getDraws } from "../utils/draws";
import { getTickets } from "../utils/draws";

interface Winner {
  id: string;
  username: string;
  gameName: string;
  amount: number;
  date: string;
}

export function WinnerFeed() {
  const [visibleWinners, setVisibleWinners] = useState<Winner[]>([]);
  const [allWinners, setAllWinners] = useState<Winner[]>([]);
  const [winnerIndex, setWinnerIndex] = useState(4);
  
  // Récupérer le thème actuel
  const { actualTheme } = useTheme();
  const isDark = actualTheme === 'dark';

  // Charger les vrais gagnants depuis localStorage
  useEffect(() => {
    const tickets = getTickets();
    const draws = getDraws();
    
    // Filtrer les tickets gagnants
    const winningTickets = tickets.filter(t => t.status === 'won' && t.winAmount && t.winAmount > 0);
    
    // Créer la liste des gagnants avec infos complètes
    const winners: Winner[] = winningTickets.map(ticket => {
      const draw = draws.find(d => d.id === ticket.drawId);
      return {
        id: ticket.id,
        username: ticket.username,
        gameName: ticket.gameName,
        amount: ticket.winAmount || 0,
        date: ticket.purchaseDate,
      };
    });
    
    // Trier par date (plus récent en premier)
    winners.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
    
    setAllWinners(winners);
    setVisibleWinners(winners.slice(0, Math.min(4, winners.length)));
  }, []);

  // Animation de rotation automatique toutes les 5 secondes
  useEffect(() => {
    if (allWinners.length <= 4) return; // Pas besoin d'animation si moins de 4 gagnants

    const interval = setInterval(() => {
      setVisibleWinners((current) => {
        if (current.length === 0) return current;

        // Retirer le dernier gagnant (le plus ancien)
        const remaining = current.slice(0, -1);

        // Récupérer le prochain gagnant du pool
        const nextWinner = allWinners[winnerIndex % allWinners.length];
        
        // Incrémenter l'index pour le prochain
        setWinnerIndex((prev) => prev + 1);

        // Ajouter le nouveau gagnant au début
        return [nextWinner, ...remaining];
      });
    }, 5000); // Rotation toutes les 5 secondes

    return () => clearInterval(interval);
  }, [winnerIndex, allWinners]);

  // Calculer "il y a X min/heures"
  const getTimeAgo = (dateString: string) => {
    const now = new Date();
    const date = new Date(dateString);
    const diff = now.getTime() - date.getTime();
    
    const minutes = Math.floor(diff / 60000);
    const hours = Math.floor(minutes / 60);
    const days = Math.floor(hours / 24);
    
    if (days > 0) return `il y a ${days}j`;
    if (hours > 0) return `il y a ${hours}h`;
    if (minutes > 0) return `il y a ${minutes} min`;
    return "à l'instant";
  };

  if (visibleWinners.length === 0) {
    return (
      <Card className="p-8 text-center border-border bg-card">
        <Trophy className="h-12 w-12 mx-auto mb-4 text-muted-foreground" />
        <p className="text-muted-foreground">Aucun gagnant pour le moment</p>
        <p className="text-sm text-muted-foreground mt-2">
          Les gagnants récents apparaîtront ici
        </p>
      </Card>
    );
  }

  return (
    <div className="space-y-4">
      <h2 className="text-2xl font-bold text-foreground">
        Ils ont gagné récemment ! 🎉
      </h2>
      
      <div className="space-y-3">
        <AnimatePresence mode="popLayout">
          {visibleWinners.map((winner) => (
            <motion.div
              key={winner.id}
              layout
              initial={{ opacity: 0, y: -20 }}
              animate={{ 
                opacity: 1, 
                y: 0,
                transition: {
                  duration: 0.5,
                  ease: "easeOut"
                }
              }}
              exit={{ 
                opacity: 0, 
                y: 20,
                transition: {
                  duration: 0.4,
                  ease: "easeIn"
                }
              }}
            >
              <Card
                className="flex items-center gap-4 p-4 transition-all rounded-xl"
                style={{
                  backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF',
                  borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#e5e5e5',
                }}
              >
                <div className="flex h-14 w-14 flex-shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-[#FFD700] to-[#FFA500]">
                  <Trophy className="h-7 w-7 text-[#121212]" />
                </div>

                <div className="flex-1 space-y-1">
                  <p 
                    className="text-sm"
                    style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                  >
                    <span className="font-bold">{winner.username}</span>{" "}
                    <span style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>
                      au {winner.gameName}
                    </span>
                  </p>
                  <div className="flex items-center gap-2">
                    <span className="text-lg font-bold text-[#FFD700]">
                      {winner.amount.toLocaleString('fr-FR')} F CFA
                    </span>
                    <span 
                      className="text-xs"
                      style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}
                    >
                      • {getTimeAgo(winner.date)}
                    </span>
                  </div>
                </div>
              </Card>
            </motion.div>
          ))}
        </AnimatePresence>
      </div>
    </div>
  );
}


================================================================================
--- FICHIER : ./src/components/WinNotification.tsx ---
================================================================================

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'motion/react';
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from './ui/dialog';
import { Button } from './ui/button';
import { Card } from './ui/card';
import { Badge } from './ui/badge';
import { Trophy, Sparkles, X, Gift, Star, PartyPopper } from 'lucide-react';
import { getUnreadWinNotifications, markNotificationAsRead, markAllNotificationsAsRead, WinNotification } from '../utils/draws';
import { useTheme } from './ThemeProvider';

interface WinNotificationProps {
  userId: string;
}

export function WinNotificationPanel({ userId }: WinNotificationProps) {
  const [notifications, setNotifications] = useState<WinNotification[]>([]);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [showModal, setShowModal] = useState(false);
  const { isDark } = useTheme();

  useEffect(() => {
    // Charger les notifications non lues
    const unreadNotifications = getUnreadWinNotifications(userId);
    if (unreadNotifications.length > 0) {
      setNotifications(unreadNotifications);
      setShowModal(true);
    }
  }, [userId]);

  const currentNotification = notifications[currentIndex];

  const handleNext = () => {
    if (currentNotification) {
      markNotificationAsRead(currentNotification.id);
    }
    
    if (currentIndex < notifications.length - 1) {
      setCurrentIndex(prev => prev + 1);
    } else {
      handleClose();
    }
  };

  const handleClose = () => {
    // Marquer toutes comme lues
    notifications.forEach(n => markNotificationAsRead(n.id));
    setShowModal(false);
    setNotifications([]);
    setCurrentIndex(0);
  };

  if (!currentNotification) return null;

  const getMatchText = (matchCount: number) => {
    if (matchCount === 5) return "JACKPOT ! 5 NUMÉROS CORRECTS !";
    if (matchCount === 4) return "BRAVO ! 4 NUMÉROS CORRECTS !";
    if (matchCount === 3) return "FÉLICITATIONS ! 3 NUMÉROS CORRECTS !";
    return "";
  };

  const getMatchColor = (matchCount: number) => {
    if (matchCount === 5) return "#FFD700"; // Or
    if (matchCount === 4) return "#FF6B00"; // Orange
    return "#4F00BC"; // Violet
  };

  return (
    <Dialog open={showModal} onOpenChange={setShowModal}>
      <DialogContent 
        className="max-w-lg border-0 p-0 max-h-[90vh] overflow-y-auto scrollbar-visible"
        style={{
          backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF',
        }}
      >
        <DialogHeader className="sr-only">
          <DialogTitle>Notification de gain</DialogTitle>
          <DialogDescription>Vous avez gagné à la loterie</DialogDescription>
        </DialogHeader>

        {/* Confettis animés en arrière-plan */}
        <div className="absolute inset-0 overflow-hidden pointer-events-none">
          {[...Array(20)].map((_, i) => (
            <motion.div
              key={i}
              className="absolute"
              initial={{ 
                top: -20, 
                left: `${Math.random() * 100}%`,
                rotate: 0,
                opacity: 1
              }}
              animate={{ 
                top: '110%',
                rotate: 360,
                opacity: 0
              }}
              transition={{
                duration: 3 + Math.random() * 2,
                delay: Math.random() * 2,
                repeat: Infinity,
                ease: "linear"
              }}
            >
              {i % 3 === 0 ? (
                <Sparkles className="h-4 w-4 text-[#FFD700]" />
              ) : i % 3 === 1 ? (
                <Star className="h-3 w-3 text-[#FF6B00]" />
              ) : (
                <div className="h-2 w-2 rounded-full bg-[#4F00BC]" />
              )}
            </motion.div>
          ))}
        </div>

        {/* Contenu principal */}
        <div className="relative p-8 pb-6">
          {/* Icône principale */}
          <motion.div
            initial={{ scale: 0, rotate: -180 }}
            animate={{ scale: 1, rotate: 0 }}
            transition={{ 
              type: "spring", 
              stiffness: 200, 
              damping: 15,
              delay: 0.2 
            }}
            className="flex justify-center mb-6"
          >
            <div 
              className="relative p-6 rounded-full"
              style={{
                background: `linear-gradient(135deg, ${getMatchColor(currentNotification.matchCount)}40, ${getMatchColor(currentNotification.matchCount)}20)`
              }}
            >
              <Trophy 
                className="h-16 w-16" 
                style={{ color: getMatchColor(currentNotification.matchCount) }}
              />
              <motion.div
                className="absolute -top-1 -right-1"
                animate={{ 
                  rotate: [0, 15, -15, 0],
                  scale: [1, 1.2, 1]
                }}
                transition={{
                  duration: 2,
                  repeat: Infinity,
                  ease: "easeInOut"
                }}
              >
                <PartyPopper className="h-8 w-8 text-[#FFD700]" />
              </motion.div>
            </div>
          </motion.div>

          {/* Texte principal */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4 }}
            className="text-center mb-6"
          >
            <h2 
              className="text-2xl font-bold mb-2"
              style={{ color: getMatchColor(currentNotification.matchCount) }}
            >
              {getMatchText(currentNotification.matchCount)}
            </h2>
            <p className="text-muted-foreground mb-4">
              Tirage {currentNotification.game} du {currentNotification.drawDate}
            </p>
          </motion.div>

          {/* Montant gagné */}
          <motion.div
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ 
              type: "spring",
              stiffness: 300,
              damping: 20,
              delay: 0.6 
            }}
            className="mb-6"
          >
            <Card 
              className="p-6 text-center border-2"
              style={{
                borderColor: getMatchColor(currentNotification.matchCount),
                background: isDark 
                  ? `linear-gradient(135deg, ${getMatchColor(currentNotification.matchCount)}15, transparent)`
                  : `linear-gradient(135deg, ${getMatchColor(currentNotification.matchCount)}10, transparent)`
              }}
            >
              <div className="flex items-center justify-center gap-2 mb-2">
                <Gift className="h-5 w-5 text-[#FFD700]" />
                <span className="text-sm text-muted-foreground">Vous avez gagné</span>
              </div>
              <div 
                className="text-4xl font-bold"
                style={{ color: getMatchColor(currentNotification.matchCount) }}
              >
                {currentNotification.winAmount.toLocaleString()} F
              </div>
            </Card>
          </motion.div>

          {/* Numéros */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.8 }}
            className="space-y-3 mb-6"
          >
            <div>
              <p className="text-xs text-muted-foreground mb-2">Numéros gagnants</p>
              <div className="flex gap-2 justify-center flex-wrap">
                {(Array.isArray(currentNotification.winningNumbers) 
                  ? currentNotification.winningNumbers 
                  : currentNotification.winningNumbers.toString().split(',')
                ).map((num, i) => {
                  const numStr = num.toString().trim();
                  const isMatched = currentNotification.playerNumbers.split(',').map(n => n.trim()).includes(numStr);
                  return (
                    <Badge
                      key={i}
                      className={`text-base px-3 py-1 ${
                        isMatched 
                          ? 'border-2' 
                          : 'opacity-50'
                      }`}
                      style={{
                        backgroundColor: isMatched ? getMatchColor(currentNotification.matchCount) + '20' : 'transparent',
                        borderColor: isMatched ? getMatchColor(currentNotification.matchCount) : 'currentColor',
                        color: isMatched ? getMatchColor(currentNotification.matchCount) : 'currentColor'
                      }}
                    >
                      {numStr}
                    </Badge>
                  );
                })}
              </div>
            </div>
            
            <div>
              <p className="text-xs text-muted-foreground mb-2">Vos numéros</p>
              <div className="flex gap-2 justify-center flex-wrap">
                {currentNotification.playerNumbers.split(',').map((num, i) => (
                  <Badge key={i} variant="outline" className="text-base px-3 py-1">
                    {num.trim()}
                  </Badge>
                ))}
              </div>
            </div>
          </motion.div>

          {/* Info crédit automatique */}
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 1 }}
            className="mb-6 p-3 rounded-lg bg-green-500/10 border border-green-500/30"
          >
            <p className="text-sm text-center text-green-600 dark:text-green-400">
              ✓ Les gains ont été automatiquement crédités sur votre Solde des Gains
            </p>
          </motion.div>

          {/* Progression */}
          {notifications.length > 1 && (
            <div className="text-center text-sm text-muted-foreground mb-4">
              Gain {currentIndex + 1} sur {notifications.length}
            </div>
          )}

          {/* Boutons */}
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 1.2 }}
            className="flex gap-3"
          >
            {currentIndex < notifications.length - 1 ? (
              <>
                <Button
                  variant="outline"
                  className="flex-1"
                  onClick={handleClose}
                >
                  Voir plus tard
                </Button>
                <Button
                  className="flex-1"
                  onClick={handleNext}
                  style={{
                    backgroundColor: getMatchColor(currentNotification.matchCount),
                    color: '#FFFFFF'
                  }}
                >
                  Suivant
                </Button>
              </>
            ) : (
              <Button
                className="w-full"
                onClick={handleClose}
                style={{
                  backgroundColor: getMatchColor(currentNotification.matchCount),
                  color: '#FFFFFF'
                }}
              >
                Continuer à jouer
              </Button>
            )}
          </motion.div>
        </div>
      </DialogContent>
    </Dialog>
  );
}


================================================================================
--- FICHIER : ./src/components/WithdrawModal.tsx ---
================================================================================

import { useState, useEffect } from 'react';
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from './ui/dialog';
import { Button } from './ui/button';
import { Input } from './ui/input';
import { Label } from './ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';
import { toast } from 'sonner@2.0.3';
import { Wallet, ArrowRight, Smartphone, AlertCircle, CheckCircle } from 'lucide-react';
import { useTheme } from './ThemeProvider';
import { 
  getCurrentUser, 
  MOBILE_MONEY_OPERATORS, 
  getOperatorsForCountry, 
  detectOperatorFromNumber,
  validateNumberForOperator,
  PHONE_FORMATS
} from '../utils/auth';

interface WithdrawModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  currentBalance: number;
  onWithdraw: (amount: number, provider: string, phoneNumber: string) => void;
}

// Montants rapides
const QUICK_AMOUNTS = [1000, 5000, 10000, 25000, 50000];

export function WithdrawModal({ open, onOpenChange, currentBalance, onWithdraw }: WithdrawModalProps) {
  const [amount, setAmount] = useState('');
  const [provider, setProvider] = useState('');
  const [phoneNumber, setPhoneNumber] = useState('');
  const [step, setStep] = useState(1); // 1: Montant, 2: Opérateur, 3: Confirmation
  const [detectedOperator, setDetectedOperator] = useState<string | null>(null);
  const [hasPreFilled, setHasPreFilled] = useState(false);
  
  const { actualTheme } = useTheme();
  const isDark = actualTheme === 'dark';
  const currentUser = getCurrentUser();
  
  // Détecter le code pays de l'utilisateur
  const userCountryCode = currentUser?.phoneNumber 
    ? '+' + currentUser.phoneNumber.substring(0, 3) 
    : '+228';
  
  // Obtenir les opérateurs disponibles pour le pays
  const availableOperators = getOperatorsForCountry(userCountryCode);

  // Pré-remplir UNIQUEMENT au passage à l'étape 3, une seule fois
  useEffect(() => {
    if (step === 3 && !hasPreFilled && currentUser?.phoneNumber && provider) {
      // Retirer l'indicatif (3 premiers chiffres) pour avoir le numéro local
      const localNumber = currentUser.phoneNumber.substring(3);
      
      // Vérifier si le numéro de l'utilisateur correspond à l'opérateur sélectionné
      const validation = validateNumberForOperator(localNumber, userCountryCode, provider);
      
      if (validation.isValid) {
        // Le numéro correspond → pré-remplir
        setPhoneNumber(localNumber);
        setDetectedOperator(provider);
      } else {
        // Le numéro ne correspond pas → laisser vide pour saisie manuelle
        setPhoneNumber('');
        setDetectedOperator(null);
      }
      
      setHasPreFilled(true);
    }
    
    // Réinitialiser hasPreFilled si on revient en arrière
    if (step < 3) {
      setHasPreFilled(false);
    }
  }, [step, provider, currentUser, userCountryCode, hasPreFilled]);

  const handleAmountSelect = (value: number) => {
    setAmount(value.toString());
  };

  const handleContinue = () => {
    const withdrawAmount = parseFloat(amount);
    
    if (step === 1) {
      // Validation du montant
      if (!amount || withdrawAmount <= 0) {
        toast.error('Veuillez entrer un montant valide');
        return;
      }
      
      if (withdrawAmount < 500) {
        toast.error('Le montant minimum de retrait est 500 F CFA');
        return;
      }
      
      if (withdrawAmount > currentBalance) {
        toast.error('Solde insuffisant');
        return;
      }
      
      setStep(2);
    } else if (step === 2) {
      // Validation de l'opérateur
      if (!provider) {
        toast.error('Veuillez sélectionner un opérateur');
        return;
      }
      
      setStep(3);
    } else if (step === 3) {
      // Validation du numéro
      if (!phoneNumber || phoneNumber.length < 8) {
        toast.error('Veuillez entrer un numéro valide');
        return;
      }
      
      // ✅ NOUVELLE VALIDATION : Vérifier que le numéro correspond à l'opérateur sélectionné
      const validation = validateNumberForOperator(phoneNumber, userCountryCode, provider);
      if (!validation.isValid) {
        toast.error(validation.message || 'Numéro invalide pour cet opérateur');
        return;
      }
      
      // Effectuer le retrait
      onWithdraw(withdrawAmount, provider, phoneNumber);
      
      // Réinitialiser et fermer
      setAmount('');
      setProvider('');
      setPhoneNumber('');
      setStep(1);
      setHasPreFilled(false);
      onOpenChange(false);
    }
  };

  const handleBack = () => {
    if (step > 1) {
      setStep(step - 1);
    }
  };

  const handleClose = () => {
    setAmount('');
    setProvider('');
    setStep(1);
    onOpenChange(false);
  };

  const selectedProvider = MOBILE_MONEY_OPERATORS.find(p => p.id === provider);

  return (
    <Dialog open={open} onOpenChange={handleClose}>
      <DialogContent 
        className="sm:max-w-[425px]"
        style={{
          backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF',
          borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#e5e5e5',
        }}
      >
        <DialogHeader>
          <DialogTitle 
            className="flex items-center gap-2 text-2xl"
            style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
          >
            <Wallet className="h-6 w-6 text-[#FFD700]" />
            Retirer mon argent
          </DialogTitle>
          <DialogDescription style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>
            {step === 1 && 'Combien souhaitez-vous retirer ?'}
            {step === 2 && 'Choisissez votre opérateur Mobile Money'}
            {step === 3 && 'Confirmez votre retrait'}
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-6 py-4">
          {/* Indicateur d'étapes */}
          <div className="flex items-center justify-center gap-2">
            {[1, 2, 3].map((s) => (
              <div
                key={s}
                className="h-2 w-16 rounded-full transition-all"
                style={{
                  backgroundColor: s <= step 
                    ? '#FFD700' 
                    : isDark ? '#3A3A3C' : '#d1d1d6'
                }}
              />
            ))}
          </div>

          {/* Solde actuel */}
          <div 
            className="rounded-xl p-4 text-center"
            style={{
              backgroundColor: isDark ? '#2C2C2E' : '#F4F4F7',
              borderWidth: '2px',
              borderColor: '#FFD700',
            }}
          >
            <p 
              className="text-sm mb-1"
              style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}
            >
              Solde de jeu disponible
            </p>
            <p className="text-3xl font-bold text-[#FFD700]">
              {currentBalance.toLocaleString('fr-FR')} F
            </p>
          </div>

          {/* ÉTAPE 1 : Montant */}
          {step === 1 && (
            <div className="space-y-4">
              <div className="space-y-2">
                <Label style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>
                  Montant à retirer
                </Label>
                <div className="relative">
                  <Input
                    type="number"
                    placeholder="Entrez le montant"
                    value={amount}
                    onChange={(e) => setAmount(e.target.value)}
                    className="pr-12 text-lg"
                    style={{
                      backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF',
                      borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6',
                      color: isDark ? '#EAEAEA' : '#1C1C1E',
                    }}
                  />
                  <span 
                    className="absolute right-4 top-1/2 -translate-y-1/2 font-medium"
                    style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}
                  >
                    F CFA
                  </span>
                </div>
              </div>

              {/* Montants rapides */}
              <div className="space-y-2">
                <Label style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>
                  Montants rapides
                </Label>
                <div className="grid grid-cols-3 gap-2">
                  {QUICK_AMOUNTS.filter(qa => qa <= currentBalance).map((qa) => (
                    <Button
                      key={qa}
                      variant="outline"
                      className="h-12"
                      onClick={() => handleAmountSelect(qa)}
                      style={{
                        backgroundColor: amount === qa.toString() 
                          ? '#FFD700' 
                          : isDark ? '#1C1C1E' : '#FFFFFF',
                        borderColor: amount === qa.toString()
                          ? '#FFD700'
                          : isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6',
                        color: amount === qa.toString()
                          ? '#121212'
                          : isDark ? '#EAEAEA' : '#1C1C1E',
                      }}
                    >
                      {(qa / 1000).toFixed(0)}K
                    </Button>
                  ))}
                </div>
              </div>

              {/* Info minimum */}
              <div 
                className="flex items-start gap-2 rounded-lg p-3"
                style={{
                  backgroundColor: isDark ? 'rgba(255, 107, 0, 0.1)' : 'rgba(255, 107, 0, 0.05)',
                  borderWidth: '1px',
                  borderColor: 'rgba(255, 107, 0, 0.3)',
                }}
              >
                <AlertCircle className="h-4 w-4 mt-0.5 text-[#FF6B00] flex-shrink-0" />
                <p 
                  className="text-sm"
                  style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                >
                  Montant minimum : <strong>500 F CFA</strong>
                  <br />
                  Le retrait est gratuit et instantané
                </p>
              </div>
            </div>
          )}

          {/* ÉTAPE 2 : Opérateur */}
          {step === 2 && (
            <div className="space-y-4">
              <Label style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>
                Choisissez votre opérateur
              </Label>
              <div className="grid gap-3">
                {availableOperators.map((p) => (
                  <button
                    key={p.id}
                    onClick={() => setProvider(p.id)}
                    className="flex items-center gap-3 rounded-xl p-4 transition-all"
                    style={{
                      backgroundColor: provider === p.id 
                        ? isDark ? '#2C2C2E' : '#F4F4F7'
                        : isDark ? '#1C1C1E' : '#FFFFFF',
                      borderWidth: '2px',
                      borderColor: provider === p.id ? p.color : isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6',
                    }}
                  >
                    <span className="text-3xl">{p.icon}</span>
                    <div className="flex-1 text-left">
                      <p 
                        className="font-medium"
                        style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                      >
                        {p.name}
                      </p>
                      <p 
                        className="text-sm"
                        style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}
                      >
                        Retrait instantané
                      </p>
                    </div>
                    {provider === p.id && (
                      <div 
                        className="h-6 w-6 rounded-full flex items-center justify-center"
                        style={{ backgroundColor: p.color }}
                      >
                        <svg className="h-4 w-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                        </svg>
                      </div>
                    )}
                  </button>
                ))}
              </div>
            </div>
          )}

          {/* ÉTAPE 3 : Confirmation */}
          {step === 3 && (
            <div className="space-y-4">
              {/* Numéro de téléphone */}
              <div className="space-y-2">
                <Label style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}>
                  <Smartphone className="inline h-4 w-4 mr-2" />
                  Numéro de téléphone
                </Label>
                <Input
                  type="tel"
                  placeholder="90102030"
                  value={phoneNumber}
                  onChange={(e) => setPhoneNumber(e.target.value.replace(/[^0-9]/g, ''))}
                  className="text-lg"
                  style={{
                    backgroundColor: isDark ? '#1C1C1E' : '#FFFFFF',
                    borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6',
                    color: isDark ? '#EAEAEA' : '#1C1C1E',
                  }}
                />
                {selectedProvider && (
                  <p 
                    className="text-xs"
                    style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}
                  >
                    Pour {selectedProvider.name}, le numéro doit commencer par : {selectedProvider.prefixes.join(', ')}
                  </p>
                )}
              </div>

              {/* Récapitulatif */}
              <div 
                className="rounded-xl p-4 space-y-3"
                style={{
                  backgroundColor: isDark ? '#2C2C2E' : '#F4F4F7',
                  borderWidth: '1px',
                  borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6',
                }}
              >
                <h4 
                  className="font-medium"
                  style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                >
                  Récapitulatif du retrait
                </h4>
                
                <div className="space-y-2">
                  <div className="flex items-center justify-between">
                    <span style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>Montant</span>
                    <span 
                      className="font-bold"
                      style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                    >
                      {parseFloat(amount).toLocaleString('fr-FR')} F CFA
                    </span>
                  </div>
                  
                  <div className="flex items-center justify-between">
                    <span style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>Opérateur</span>
                    <div className="flex items-center gap-2">
                      <span>{selectedProvider?.icon}</span>
                      <span 
                        className="font-medium"
                        style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                      >
                        {selectedProvider?.name}
                      </span>
                    </div>
                  </div>
                  
                  <div className="flex items-center justify-between">
                    <span style={{ color: isDark ? '#8E8E93' : '#6e6e73' }}>Frais</span>
                    <span 
                      className="font-medium text-[#34C759]"
                    >
                      GRATUIT
                    </span>
                  </div>
                  
                  <div 
                    className="pt-2 mt-2 flex items-center justify-between"
                    style={{
                      borderTopWidth: '1px',
                      borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6',
                    }}
                  >
                    <span 
                      className="font-medium"
                      style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                    >
                      Vous recevez
                    </span>
                    <span className="text-xl font-bold text-[#FFD700]">
                      {parseFloat(amount).toLocaleString('fr-FR')} F CFA
                    </span>
                  </div>
                </div>
              </div>

              {/* Avertissement */}
              <div 
                className="flex items-start gap-2 rounded-lg p-3"
                style={{
                  backgroundColor: isDark ? 'rgba(79, 0, 188, 0.1)' : 'rgba(79, 0, 188, 0.05)',
                  borderWidth: '1px',
                  borderColor: 'rgba(79, 0, 188, 0.3)',
                }}
              >
                <AlertCircle className="h-4 w-4 mt-0.5 text-[#4F00BC] flex-shrink-0" />
                <p 
                  className="text-sm"
                  style={{ color: isDark ? '#EAEAEA' : '#1C1C1E' }}
                >
                  Assurez-vous que le numéro est correct. Le transfert est instantané et irréversible.
                </p>
              </div>
            </div>
          )}

          {/* Boutons d'action */}
          <div className="flex gap-3 pt-2">
            {step > 1 && (
              <Button
                variant="outline"
                className="flex-1"
                onClick={handleBack}
                style={{
                  borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : '#d1d1d6',
                  color: isDark ? '#EAEAEA' : '#1C1C1E',
                }}
              >
                Retour
              </Button>
            )}
            <Button
              className="flex-1 bg-[#FFD700] text-[#121212] hover:bg-[#FFD700]/90"
              onClick={handleContinue}
            >
              {step === 3 ? 'Confirmer le retrait' : 'Continuer'}
              <ArrowRight className="ml-2 h-4 w-4" />
            </Button>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}

================================================================================
--- FICHIER : ./src/components/admin/AdminAdministrators.tsx ---
================================================================================

// src/components/admin/AdminAdministrators.tsx

import { useState, useEffect } from "react";
import { getAdmins, createAdmin, updateAdminRole, updateAdminStatus } from "../../utils/adminAPI";
import { AdminUser } from "../../types";
import { Card } from "../ui/card";
import { Button } from "../ui/button";
import { Input } from "../ui/input";
import { Label } from "../ui/label";
import { Badge } from "../ui/badge";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from "../ui/dialog";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "../ui/select";
import { Shield, UserPlus, Edit, Eye, EyeOff, Loader2 } from "lucide-react";
import { toast } from "sonner";
 
const ADMIN_ROLES = ['Support Client', 'Admin du Jeu', 'Admin Financier', 'Super Admin'] as const;
type AdminRole = typeof ADMIN_ROLES[number];

export function AdminAdministrators() {
  const [admins, setAdmins] = useState<AdminUser[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  
  const [createModalOpen, setCreateModalOpen] = useState(false);
  const [editModalOpen, setEditModalOpen] = useState(false);
  const [selectedAdmin, setSelectedAdmin] = useState<AdminUser | null>(null);
  const [isSubmitting, setIsSubmitting] = useState(false);
  
  const [newUsername, setNewUsername] = useState('');
  const [newEmail, setNewEmail] = useState('');
  const [newPassword, setNewPassword] = useState('');
  const [newRole, setNewRole] = useState<AdminRole>('Support Client');
  const [showPassword, setShowPassword] = useState(false);
  
  const [editRole, setEditRole] = useState<AdminRole>('Support Client');
  
  const fetchAdmins = async () => {
    setIsLoading(true); setError(null);
    try {
      const data = await getAdmins();
      setAdmins(data);
    } catch (err) { setError("Impossible de charger la liste des administrateurs."); console.error(err); } 
    finally { setIsLoading(false); }
  };
  
  useEffect(() => { fetchAdmins(); }, []);
  
  const handleCreateAdmin = async () => {
    if (!newUsername || !newEmail || !newPassword || !newRole) { return toast.error('Veuillez remplir tous les champs'); }
    if (newPassword.length < 8) { return toast.error('Le mot de passe doit faire au moins 8 caractères'); }
    
    setIsSubmitting(true);
    try {
      await createAdmin({ username: newUsername, email: newEmail, password: newPassword, role: newRole } as any);
      toast.success("Administrateur créé avec succès !");
      await fetchAdmins();
      setCreateModalOpen(false);
      setNewUsername(''); setNewEmail(''); setNewPassword(''); setNewRole('Support Client');
    } catch (err: any) { toast.error(err?.response?.data?.detail || "Erreur lors de la création."); } 
    finally { setIsSubmitting(false); }
  };
  
  const handleEditAdmin = async () => {
    if (!selectedAdmin) return;
    setIsSubmitting(true);
    try {
      // CORRECTION : On utilise bien 'id' comme confirmé par le backend
      await updateAdminRole(selectedAdmin.id, editRole);
      toast.success("Rôle de l'administrateur mis à jour.");
      await fetchAdmins();
      setEditModalOpen(false);
      setSelectedAdmin(null);
    } catch (err: any) { toast.error(err?.response?.data?.detail || "Erreur lors de la mise à jour."); } 
    finally { setIsSubmitting(false); }
  };
  
  const handleToggleStatus = async (admin: AdminUser) => {
    const newStatus = admin.status === 'active' ? 'suspended' : 'active';
    toast.info("Mise à jour du statut en cours...");
    try {
      // CORRECTION : On utilise bien 'id' comme confirmé par le backend
      await updateAdminStatus(admin.id, newStatus);
      toast.success("Statut mis à jour avec succès !");
      setEditModalOpen(false);
      await fetchAdmins();
    } catch (err) { toast.error("Échec de la mise à jour du statut."); }
  };
  
  const openEditModal = (admin: AdminUser) => {
    setSelectedAdmin(admin);
    setEditRole(admin.role as AdminRole);
    setEditModalOpen(true);
  };
  
  const getRoleBadgeColor = (role: string) => {
    switch (role) {
      case 'Super Admin': return 'bg-red-500 hover:bg-red-600';
      case 'Admin Financier': return 'bg-blue-500 hover:bg-blue-600';
      case 'Admin du Jeu': return 'bg-purple-500 hover:bg-purple-600';
      case 'Support Client': return 'bg-green-500 hover:bg-green-600';
      default: return 'bg-gray-500 hover:bg-gray-600';
    }
  };
  
  if (isLoading) { return <div className="p-8 flex justify-center items-center"><Loader2 className="h-8 w-8 animate-spin" /></div>; }
  if (error) { return <div className="p-8 text-center text-red-500">{error}</div>; }

  return (
    <div className="p-4 sm:p-6 lg:p-8 space-y-6">
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <div><h1 className="text-2xl sm:text-3xl font-bold text-foreground flex items-center gap-3"><Shield className="h-7 w-7 text-yellow-400" />Gestion des Administrateurs</h1><p className="text-sm text-muted-foreground mt-1">Gérez les comptes et permissions de votre équipe</p></div>
        <Button onClick={() => setCreateModalOpen(true)} className="bg-yellow-400 text-black hover:bg-yellow-500 w-full sm:w-auto"><UserPlus className="mr-2 h-4 w-4" />Nouvel Administrateur</Button>
      </div>
      <Card className="border-border bg-card overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead className="bg-muted"><tr className="border-b"><th className="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Utilisateur</th><th className="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Rôle</th><th className="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider">Statut</th><th className="px-4 py-3 text-right text-xs font-medium uppercase tracking-wider">Actions</th></tr></thead>
            <tbody className="divide-y divide-border">
              {admins.map((admin) => (
                // CORRECTION : On utilise bien 'id' pour la clé unique
                <tr key={admin.id} className="hover:bg-accent/50">
                  <td className="px-4 py-4">
                    <div className="font-medium text-foreground">{admin.username}</div>
                    <div className="text-xs text-muted-foreground">{admin.email}</div>
                  </td>
                  <td className="px-4 py-4"><Badge className={`${getRoleBadgeColor(admin.role)} text-white`}>{admin.role}</Badge></td>
                  <td className="px-4 py-4"><Badge variant={admin.status === 'active' ? 'default' : 'destructive'} className={admin.status === 'active' ? 'bg-green-500' : ''}>{admin.status === 'active' ? 'Actif' : 'Suspendu'}</Badge></td>
                  <td className="px-4 py-4 text-right"><div className="flex justify-end gap-2"><Button size="sm" variant="outline" onClick={() => openEditModal(admin)}><Edit className="h-4 w-4" /></Button></div></td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </Card>
      
      <Dialog open={createModalOpen} onOpenChange={setCreateModalOpen}>
        <DialogContent className="max-w-md"><DialogHeader><DialogTitle>Créer un Nouvel Administrateur</DialogTitle><DialogDescription>Remplissez les informations du nouvel administrateur</DialogDescription></DialogHeader>
          <div className="space-y-4 py-4">
            <div><Label htmlFor="username">Nom d'utilisateur</Label><Input id="username" value={newUsername} onChange={(e) => setNewUsername(e.target.value)} className="mt-1" /></div>
            <div><Label htmlFor="email">Email</Label><Input id="email" type="email" value={newEmail} onChange={(e) => setNewEmail(e.target.value)} className="mt-1" /></div>
            <div><Label htmlFor="password">Mot de passe</Label><div className="relative mt-1"><Input id="password" type={showPassword ? "text" : "password"} value={newPassword} onChange={(e) => setNewPassword(e.target.value)} placeholder="Minimum 8 caractères" /><button type="button" onClick={() => setShowPassword(!showPassword)} className="absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground">{showPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}</button></div></div>
            <div><Label htmlFor="role">Assigner un Rôle</Label><Select value={newRole} onValueChange={(value: AdminRole) => setNewRole(value)}><SelectTrigger className="mt-1"><SelectValue /></SelectTrigger><SelectContent>{ADMIN_ROLES.map(role => <SelectItem key={role} value={role}>{role}</SelectItem>)}</SelectContent></Select></div>
          </div>
          <DialogFooter><Button variant="outline" onClick={() => setCreateModalOpen(false)}>Annuler</Button><Button onClick={handleCreateAdmin} disabled={isSubmitting} className="bg-yellow-400 text-black hover:bg-yellow-500">{isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}Créer le compte</Button></DialogFooter>
        </DialogContent>
      </Dialog>
      
      <Dialog open={editModalOpen} onOpenChange={setEditModalOpen}>
        <DialogContent className="max-w-md"><DialogHeader><DialogTitle>Modifier: {selectedAdmin?.username}</DialogTitle><DialogDescription>Modifiez les informations de {selectedAdmin?.username}</DialogDescription></DialogHeader>
          {selectedAdmin && (
            <div className="space-y-4 py-4">
              <div><Label>Nom d'utilisateur</Label><p className="text-sm text-muted-foreground mt-1">{selectedAdmin.username}</p></div>
              <div><Label>Email</Label><p className="text-sm text-muted-foreground mt-1">{selectedAdmin.email}</p></div>
              <div><Label htmlFor="edit-role">Rôle</Label><Select value={editRole} onValueChange={(value: AdminRole) => setEditRole(value)}><SelectTrigger className="mt-1"><SelectValue /></SelectTrigger><SelectContent>{ADMIN_ROLES.map(role => <SelectItem key={role} value={role}>{role}</SelectItem>)}</SelectContent></Select></div>
              <div className="pt-2 border-t border-border">
                <Button variant="outline" onClick={() => handleToggleStatus(selectedAdmin)} className={`w-full ${selectedAdmin.status === 'active' ? 'text-red-500 border-red-500 hover:bg-red-500/10' : 'text-green-500 border-green-500 hover:bg-green-500/10'}`}>
                  {selectedAdmin.status === 'active' ? 'Suspendre le compte' : 'Réactiver le compte'}
                </Button>
              </div>
            </div>
          )}
          <DialogFooter><Button variant="outline" onClick={() => { setEditModalOpen(false); setSelectedAdmin(null); }}>Annuler</Button><Button onClick={handleEditAdmin} disabled={isSubmitting} className="bg-yellow-400 text-black hover:bg-yellow-500">{isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}Enregistrer</Button></DialogFooter>
        </DialogContent>
      </Dialog>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/admin/AdminDashboard.tsx ---
================================================================================

import { Card } from "../ui/card";
import { TrendingUp, TrendingDown, Users, Trophy, AlertTriangle, Loader2 } from "lucide-react";
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, PieChart, Pie, Cell, Legend } from "recharts";
import { useState, useEffect } from "react";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "../ui/select";
import { Badge } from "../ui/badge";
// MODIFIÉ: Import du nouveau type DashboardPeriod et conservation de RiskTimePeriod
import { DashboardPeriod, RiskTimePeriod, DashboardData, getDashboardSummary } from "../../utils/dashboardAPI";

export function AdminDashboard() {
  const [dashboardData, setDashboardData] = useState<DashboardData | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  
  // État pour le filtre global du dashboard
  const [dashboardPeriod, setDashboardPeriod] = useState<DashboardPeriod>('day');
  
  // Note: Le filtre pour les combinaisons à risque n'est plus nécessaire car le backend ne le supporte pas sur cet endpoint
  // const [riskPeriod, setRiskPeriod] = useState<RiskTimePeriod>('today');

  // La fonction charge les données en fonction du filtre global
  const loadDashboardData = async (period: DashboardPeriod) => {
    // Affiche le spinner uniquement au premier chargement
    if (!dashboardData) setIsLoading(true);
    setError(null);
    try {
      const data = await getDashboardSummary(period);
      setDashboardData(data);
    } catch (err) {
      console.error("Erreur lors du chargement du dashboard:", err);
      setError("Impossible de charger les données du tableau de bord.");
    } finally {
      setIsLoading(false);
    }
  };
  
  // L'effet se déclenche quand `dashboardPeriod` change
  useEffect(() => {
    loadDashboardData(dashboardPeriod);
  }, [dashboardPeriod]);
  
  // Le rafraîchissement automatique utilise aussi la période sélectionnée
  useEffect(() => {
    const interval = setInterval(() => {
      loadDashboardData(dashboardPeriod);
    }, 30000); // Rafraîchir toutes les 30 secondes
    return () => clearInterval(interval);
  }, [dashboardPeriod]);
  
  const getRiskColor = (level: string) => ({'critical': 'bg-red-500/20 text-red-500 border-red-500/30','high': 'bg-orange-500/20 text-orange-500 border-orange-500/30','medium': 'bg-yellow-500/20 text-yellow-500 border-yellow-500/30',}[level] || 'bg-green-500/20 text-green-500 border-green-500/30');
  const getRiskLabel = (level: string) => ({'critical': 'CRITIQUE','high': 'ÉLEVÉ','medium': 'MOYEN',}[level] || 'FAIBLE');

  const getTitleSuffix = (period: DashboardPeriod) => {
    switch (period) {
      case 'day': return 'du Jour';
      case 'week': return 'de la Semaine';
      case 'month': return 'du Mois';
      case 'year': return "de l'Année";
      default: return '';
    }
  };

  if (isLoading) { return <div className="flex justify-center items-center h-[calc(100vh-100px)]"><Loader2 className="h-12 w-12 animate-spin text-foreground" /></div>; }
  if (error) { return <div className="p-8 text-center"><h2 className="text-xl text-red-500">{error}</h2></div>; }
  if (!dashboardData) { return <div className="p-8 text-center text-muted-foreground">Aucune donnée disponible.</div>; }

  const { kpis, revenueLast7Days, popularGames, riskAnalysis } = dashboardData;
  
  const kpiCards = [
    { title: `Chiffre d'Affaires ${getTitleSuffix(dashboardPeriod)}`, value: `${kpis.totalRevenue.toLocaleString('fr-FR')} F`, icon: TrendingUp, color: "#FFD700", trend: `${kpis.revenueTrend >= 0 ? '+' : ''}${kpis.revenueTrend.toFixed(1)}%` },
    { title: `Gains Payés ${getTitleSuffix(dashboardPeriod)}`, value: `${kpis.totalWinnings.toLocaleString('fr-FR')} F`, icon: TrendingDown, color: "#FF6B00", trend: `${kpis.winningsTrend.toFixed(1)}%` },
    { title: `Bénéfice Brut ${getTitleSuffix(dashboardPeriod)}`, value: `${kpis.totalProfit.toLocaleString('fr-FR')} F`, icon: Trophy, color: "#4F00BC", trend: `${kpis.profitTrend >= 0 ? '+' : ''}${kpis.profitTrend.toFixed(1)}%` },
    { title: `Nouveaux Joueurs ${getTitleSuffix(dashboardPeriod)}`, value: kpis.newPlayers.toString(), icon: Users, color: "#00C853", trend: `+${kpis.newPlayers}` },
  ];

  return (
    <div className="p-3 sm:p-4 md:p-6 lg:p-8 space-y-4 sm:space-y-6 md:space-y-8">
      <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <h1 className="text-xl sm:text-2xl md:text-3xl font-bold">Tableau de Bord</h1>
          <p className="text-xs sm:text-sm text-muted-foreground mt-1">Vue d'ensemble de l'activité de la plateforme</p>
        </div>
        <Select value={dashboardPeriod} onValueChange={(value) => setDashboardPeriod(value as DashboardPeriod)}>
          <SelectTrigger className="w-full sm:w-[180px]">
            <SelectValue placeholder="Sélectionner une période" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="day">Aujourd'hui</SelectItem>
            <SelectItem value="week">Cette semaine</SelectItem>
            <SelectItem value="month">Ce mois-ci</SelectItem>
            <SelectItem value="year">Cette année</SelectItem>
          </SelectContent>
        </Select>
      </div>

      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6">
        {kpiCards.map((kpi, index) => <Card key={index} className="p-3 sm:p-4 md:p-6"><div className="flex items-start justify-between gap-2"><div className="flex-1 min-w-0"><p className="text-[10px] sm:text-xs md:text-sm text-muted-foreground mb-1">{kpi.title}</p><p className="text-base sm:text-lg md:text-2xl font-bold">{kpi.value}</p><p className="text-xs sm:text-sm mt-1 sm:mt-2" style={{ color: kpi.color }}>{kpi.trend}</p></div><div className="p-1.5 sm:p-2 md:p-3 rounded-lg" style={{ backgroundColor: `${kpi.color}20` }}><kpi.icon className="h-4 w-4 sm:h-6 sm:w-6" style={{ color: kpi.color }} /></div></div></Card>)}
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6">
        <Card className="p-4 md:p-6"><h3 className="text-base md:text-lg font-bold mb-4">Revenus des 7 derniers jours</h3><ResponsiveContainer width="100%" height={300}><BarChart data={revenueLast7Days}><CartesianGrid strokeDasharray="3 3" stroke="#333" /><XAxis dataKey="day" stroke="#888" fontSize={12} /><YAxis stroke="#888" fontSize={12} /><Tooltip contentStyle={{ backgroundColor: '#1C1C1E', border: '1px solid #333' }} formatter={(value: number) => `${value.toLocaleString('fr-FR')} F`} /><Bar dataKey="amount" fill="#FFD700" radius={[8, 8, 0, 0]} /></BarChart></ResponsiveContainer></Card>
        <Card className="p-4 md:p-6"><h3 className="text-base md:text-lg font-bold mb-4">Jeux les plus populaires</h3><ResponsiveContainer width="100%" height={300}><PieChart><Pie data={popularGames} dataKey="value" nameKey="name" cx="50%" cy="50%" outerRadius={100} labelLine={false} label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}><Tooltip formatter={(value: number) => `${value}%`} />{popularGames.map((entry, index) => <Cell key={`cell-${index}`} fill={entry.color} />)}</Pie><Legend wrapperStyle={{ fontSize: '12px' }} /></PieChart></ResponsiveContainer></Card>
      </div>

      <Card className="p-4 md:p-6">
        <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
          <div className="flex items-center gap-3"><div className="p-2 rounded-lg bg-red-500/20"><AlertTriangle className="h-5 w-5 text-red-500" /></div><div><h3 className="text-base md:text-lg font-bold">Combinaisons à Surveiller</h3><p className="text-xs sm:text-sm text-muted-foreground">Suivi des tickets en attente de tirage</p></div></div>
        </div>
        <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 mb-6">
          <div className="p-3 rounded-lg border"><p className="text-xs text-muted-foreground mb-1">Total combinaisons</p><p className="text-lg font-bold">{riskAnalysis.summary.totalCombinations}</p></div>
          <div className="p-3 rounded-lg border"><p className="text-xs text-muted-foreground mb-1">Mises totales</p><p className="text-lg font-bold">{riskAnalysis.summary.totalAtRisk.toLocaleString('fr-FR')} F</p></div>
          <div className="p-3 rounded-lg border border-red-500/30 bg-red-500/10"><p className="text-xs text-red-400 mb-1">Risque critique</p><p className="text-lg font-bold text-red-500">{riskAnalysis.summary.criticalRisk}</p></div>
          <div className="p-3 rounded-lg border border-orange-500/30 bg-orange-500/10"><p className="text-xs text-orange-400 mb-1">Risque élevé</p><p className="text-lg font-bold text-orange-500">{riskAnalysis.summary.highRisk}</p></div>
          <div className="p-3 rounded-lg border border-yellow-500/30 bg-yellow-500/10"><p className="text-xs text-yellow-400 mb-1">Risque moyen</p><p className="text-lg font-bold text-yellow-500">{riskAnalysis.summary.mediumRisk}</p></div>
          <div className="p-3 rounded-lg border"><p className="text-xs text-muted-foreground mb-1">Gain potentiel max</p><p className="text-lg font-bold text-[#FFD700]">{riskAnalysis.summary.maxPotentialPayout.toLocaleString('fr-FR')} F</p></div>
        </div>
        {riskAnalysis.combinations.length === 0 ? (<div className="text-center py-12"><p className="text-muted-foreground">Aucune combinaison à risque élevé en attente de tirage</p></div>) : (<div className="overflow-x-auto"><table className="w-full"><thead><tr className="border-b"><th className="text-left py-3 px-2 text-xs font-medium text-muted-foreground">Rang</th><th className="text-left py-3 px-2 text-xs font-medium text-muted-foreground">Combinaison</th><th className="text-left py-3 px-2 text-xs font-medium text-muted-foreground">Jeu</th><th className="text-center py-3 px-2 text-xs font-medium text-muted-foreground">Fois jouée</th><th className="text-right py-3 px-2 text-xs font-medium text-muted-foreground">Mise totale</th><th className="text-right py-3 px-2 text-xs font-medium text-muted-foreground">Gain potentiel</th><th className="text-center py-3 px-2 text-xs font-medium text-muted-foreground">Risque</th></tr></thead><tbody>{riskAnalysis.combinations.map((stat, index) => (<tr key={index} className="border-b border-border/50 hover:bg-muted/30"><td className="py-3 px-2"><span className="font-medium">#{index + 1}</span></td><td className="py-3 px-2"><div className="flex flex-wrap gap-1">{stat.combination.map((num) => (<span key={num} className="inline-flex items-center justify-center w-7 h-7 rounded-full bg-gradient-to-br from-[#FFD700] to-[#FF6B00] text-white text-xs font-bold">{num}</span>))}</div></td><td className="py-3 px-2"><span className="text-sm">{stat.operatorName}</span></td><td className="py-3 px-2 text-center"><span className="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-blue-500/20 text-blue-400 text-xs font-medium">{stat.count}×</span></td><td className="py-3 px-2 text-right"><span className="font-medium">{stat.totalAmount.toLocaleString()} F</span></td><td className="py-3 px-2 text-right"><span className="font-bold text-[#FFD700]">{stat.potentialPayout.toLocaleString()} F</span></td><td className="py-3 px-2 text-center"><Badge variant="outline" className={`text-xs font-medium border ${getRiskColor(stat.riskLevel)}`}>{getRiskLabel(stat.riskLevel)}</Badge></td></tr>))}</tbody></table></div>)}
        <div className="mt-4 p-3 rounded-lg bg-muted/50 border"><p className="text-xs text-muted-foreground"><strong className="text-foreground">💡 Note:</strong> Cette section affiche les combinaisons qui sont le plus jouées sur les tirages à venir. Le "Gain potentiel" représente le montant total que vous devrez payer si cette combinaison gagne.</p></div>
      </Card>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/admin/AdminFinance.tsx ---
================================================================================

// src/components/admin/AdminFinance.tsx

import { useState, useEffect } from "react";
import { Card } from "../ui/card";
import { Button } from "../ui/button";
import { Badge } from "../ui/badge";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "../ui/tabs";
import { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from "../ui/alert-dialog";
import { Input } from "../ui/input";
import { toast } from "sonner";
// CORRECTION : Ajout de l'icône TrendingUp qui était manquante
import { CheckCircle, XCircle, Wallet, Trophy, DollarSign, Users, Loader2, TrendingUp } from "lucide-react";
// CORRECTION : Renommage des fonctions importées pour correspondre à ce que j'ai fourni précédemment
import { getGlobalFinancialStats, getWithdrawals, updateWithdrawalStatus } from "../../utils/withdrawalsAPI";
import { Withdrawal, FinancialStats } from "../../types"; // Assurez-vous que ces types sont bien définis dans src/types.ts

const StatCard = ({ title, value, icon: Icon, iconBg, iconColor, isCurrency = true, profitColor = false }: { title: string, value: number, icon: React.ElementType, iconBg: string, iconColor: string, isCurrency?: boolean, profitColor?: boolean }) => (
    <Card className="p-4 md:p-6"><div className="flex items-center justify-between"><div><p className="text-sm text-muted-foreground mb-1">{title}</p><p className={`text-2xl font-bold ${profitColor ? (value >= 0 ? 'text-green-500' : 'text-red-500') : ''}`}>{isCurrency ? value.toLocaleString('fr-FR') + ' F' : value.toLocaleString('fr-FR')}</p></div><div className={`rounded-full p-3 ${iconBg}`}><Icon className={`h-6 w-6 ${iconColor}`} /></div></div></Card>
);

const WithdrawalCard = ({ request, onApprove, onReject }: { request: Withdrawal, onApprove: (req: Withdrawal) => void, onReject: (req: Withdrawal) => void }) => {
    const statusConfig = { pending: { color: 'yellow-500', text: 'En attente' }, approved: { color: 'green-500', text: 'Approuvé' }, rejected: { color: 'red-500', text: 'Rejeté' }};
    const currentStatus = request.status as keyof typeof statusConfig;

    return (
        <Card key={request.id} className={`p-6 border-l-4 border-l-${statusConfig[currentStatus]?.color || 'gray-500'}`}>
            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div className="flex-1">
                    <div className="flex items-center gap-3 mb-2">
                        <h3 className="font-bold text-lg">{request.player?.username || 'Utilisateur inconnu'}</h3>
                        <Badge className={`bg-${statusConfig[currentStatus]?.color}/20 text-${statusConfig[currentStatus]?.color}`}>{statusConfig[currentStatus]?.text || 'Inconnu'}</Badge>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-x-6 gap-y-2 text-sm mt-2">
                        <span>Montant: <span className="font-semibold">{request.amount.toLocaleString('fr-FR')} F</span></span>
                        <span>Opérateur: <span className="font-semibold">{request.provider || 'N/A'}</span></span>
                        <span>Numéro: <span className="font-semibold">{request.player?.phone_number || 'N/A'}</span></span>
                    </div>
                    <p className="text-xs text-muted-foreground mt-2">{new Date(request.created_at).toLocaleString('fr-FR')}</p>
                </div>
                {request.status === 'pending' && (
                    <div className="flex gap-2">
                        <Button size="sm" onClick={() => onApprove(request)} className="bg-green-500 hover:bg-green-600"><CheckCircle className="mr-2 h-4 w-4" />Approuver</Button>
                        <Button size="sm" variant="outline" onClick={() => onReject(request)} className="border-red-500 text-red-500 hover:bg-red-500/10"><XCircle className="mr-2 h-4 w-4" />Rejeter</Button>
                    </div>
                )}
            </div>
        </Card>
    );
};

export function AdminFinance() {
  const [stats, setStats] = useState<FinancialStats | null>(null);
  const [allWithdrawals, setAllWithdrawals] = useState<Withdrawal[]>([]);
  
  const [isLoading, setIsLoading] = useState({ stats: true, withdrawals: true });
  const [error, setError] = useState<string | null>(null);
  
  const [showApproveDialog, setShowApproveDialog] = useState(false);
  const [showRejectDialog, setShowRejectDialog] = useState(false);
  const [selectedRequest, setSelectedRequest] = useState<Withdrawal | null>(null);
  // Le rejet ne nécessite pas de raison dans la nouvelle API simple
  const [isSubmitting, setIsSubmitting] = useState(false);

  const fetchAllData = async () => {
    setIsLoading({ stats: true, withdrawals: true });
    setError(null);
    try {
      // Les appels sont faits en parallèle
      const [statsData, withdrawalsData] = await Promise.all([
        getGlobalFinancialStats(),
        getWithdrawals(),
      ]);
      
      // CORRECTION : On assigne directement les données reçues
      setStats(statsData);
      setAllWithdrawals(withdrawalsData);

    } catch (err) { 
      setError("Impossible de charger les données. Une erreur est survenue."); 
      console.error("Erreur détaillée:", err);
    } 
    finally { 
      setIsLoading({ stats: false, withdrawals: false }); 
    }
  };

  useEffect(() => { fetchAllData(); }, []);

  const handleApprove = (request: Withdrawal) => { setSelectedRequest(request); setShowApproveDialog(true); };
  const handleReject = (request: Withdrawal) => { setSelectedRequest(request); setShowRejectDialog(true); };

  const confirmProcessRequest = async (action: 'approved' | 'rejected') => {
    if (!selectedRequest) return;
    
    setIsSubmitting(true);
    try {
      await updateWithdrawalStatus(selectedRequest.id, action);
      toast.success(`Demande ${action === 'approved' ? 'approuvée' : 'rejetée'}.`);
      await fetchAllData(); // Recharger toutes les données pour mettre à jour la UI
    } catch (err: any) { 
      toast.error(err?.response?.data?.detail || "Erreur lors de la mise à jour."); 
    } 
    finally {
      setIsSubmitting(false);
      setShowApproveDialog(false);
      setShowRejectDialog(false);
      setSelectedRequest(null);
    }
  };
  
  const pendingRequests = allWithdrawals.filter(w => w.status === 'pending');
  const approvedRequests = allWithdrawals.filter(w => w.status === 'approved');
  const rejectedRequests = allWithdrawals.filter(w => w.status === 'rejected');

  const renderTabContent = (requests: Withdrawal[], type: 'pending' | 'approved' | 'rejected') => {
      const emptyMessages = { pending: { icon: Wallet, text: "Aucune demande de retrait en attente" }, approved: { icon: CheckCircle, text: "Aucune demande approuvée" }, rejected: { icon: XCircle, text: "Aucune demande rejetée" }};
      const EmptyIcon = emptyMessages[type].icon;
      if (requests.length === 0) { return <Card className="p-8 text-center"><EmptyIcon className="h-12 w-12 mx-auto mb-4 text-muted-foreground" /><p className="text-muted-foreground">{emptyMessages[type].text}</p></Card>; }
      return requests.map((req) => <WithdrawalCard key={req.id} request={req} onApprove={handleApprove} onReject={handleReject} />);
  };

  return (
    <div className="p-4 md:p-6 lg:p-8">
      <div className="mb-6 md:mb-8"><h1 className="text-2xl md:text-3xl font-bold">Gestion Financière</h1><p className="text-sm md:text-base text-muted-foreground">Suivez les statistiques et approuvez les demandes de retrait</p></div>
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-8">
        {isLoading.stats ? <Card className="p-6 flex items-center justify-center col-span-full"><Loader2 className="h-6 w-6 animate-spin"/></Card> : error ? <Card className="p-6 text-center text-red-500 col-span-full">{error}</Card> : (
            <>
                <StatCard title="Crédits totaux" value={stats?.totalCredits ?? 0} icon={TrendingUp} iconBg="bg-[#FF6B00]/10" iconColor="text-[#FF6B00]" />
                <StatCard title="Retraits totaux" value={stats?.totalWithdrawals ?? 0} icon={Trophy} iconBg="bg-[#FFD700]/10" iconColor="text-[#FFD700]" />
                <StatCard title="Bénéfice (Solde)" value={stats?.balance ?? 0} icon={DollarSign} iconBg="bg-green-500/10" iconColor="text-green-500" profitColor />
                <StatCard title="Retraits en attente" value={stats?.pendingWithdrawalsCount ?? 0} icon={Users} iconBg="bg-blue-500/10" iconColor="text-blue-500" isCurrency={false} />
            </>
        )}
      </div>
      <Tabs defaultValue="pending" className="space-y-6">
        <TabsList className="grid w-full grid-cols-3 bg-muted">
          <TabsTrigger value="pending">En attente ({pendingRequests.length})</TabsTrigger>
          <TabsTrigger value="approved">Approuvées ({approvedRequests.length})</TabsTrigger>
          <TabsTrigger value="rejected">Rejetées ({rejectedRequests.length})</TabsTrigger>
        </TabsList>
        {isLoading.withdrawals ? <Card className="p-8 flex items-center justify-center"><Loader2 className="h-8 w-8 animate-spin"/></Card> : (
        <>
            <TabsContent value="pending" className="space-y-4">{renderTabContent(pendingRequests, 'pending')}</TabsContent>
            <TabsContent value="approved" className="space-y-4">{renderTabContent(approvedRequests, 'approved')}</TabsContent>
            <TabsContent value="rejected" className="space-y-4">{renderTabContent(rejectedRequests, 'rejected')}</TabsContent>
        </>
        )}
      </Tabs>
      <AlertDialog open={showApproveDialog} onOpenChange={setShowApproveDialog}><AlertDialogContent><AlertDialogHeader><AlertDialogTitle>Approuver le retrait ?</AlertDialogTitle><AlertDialogDescription>Confirmez l'approbation de <strong>{selectedRequest?.amount.toLocaleString('fr-FR')} F</strong> pour <strong>{selectedRequest?.player?.username}</strong>.</AlertDialogDescription></AlertDialogHeader><AlertDialogFooter><AlertDialogCancel disabled={isSubmitting}>Annuler</AlertDialogCancel><AlertDialogAction onClick={() => confirmProcessRequest('approved')} disabled={isSubmitting} className="bg-green-500 hover:bg-green-600">{isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin"/>}Approuver</AlertDialogAction></AlertDialogFooter></AlertDialogContent></AlertDialog>
      <AlertDialog open={showRejectDialog} onOpenChange={setShowRejectDialog}><AlertDialogContent><AlertDialogHeader><AlertDialogTitle>Rejeter le retrait ?</AlertDialogTitle><AlertDialogDescription>Confirmez le rejet de la demande de <strong>{selectedRequest?.amount.toLocaleString('fr-FR')} F</strong> pour <strong>{selectedRequest?.player?.username}</strong>. Cette action est irréversible.</AlertDialogDescription></AlertDialogHeader><AlertDialogFooter><AlertDialogCancel disabled={isSubmitting}>Annuler</AlertDialogCancel><AlertDialogAction onClick={() => confirmProcessRequest('rejected')} disabled={isSubmitting} className="bg-red-500 hover:bg-red-600">{isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin"/>}Confirmer le Rejet</AlertDialogAction></AlertDialogFooter></AlertDialogContent></AlertDialog>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/admin/AdminGames.tsx ---
================================================================================

// src/components/admin/AdminGames.tsx

import { useState, useEffect } from "react";
import { Card } from "../ui/card";
import { Button } from "../ui/button";
import { Input } from "../ui/input";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "../ui/tabs";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from "../ui/dialog";
import { Label } from "../ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "../ui/select";
import { Separator } from "../ui/separator";
import { toast } from "sonner";
import { Plus, Calendar, Trophy, Clock, Info, Loader2, Archive } from "lucide-react";
import { Draw, Multipliers, getAdminDrawsByStatus, createAdminDraw, publishDrawResults } from "../../utils/drawsAPI";

// --- CONFIGURATIONS ---
const OPERATORS_CONFIG = [
    { id: 'benin-lotto', name: 'Bénin Lotto', icon: '🇧🇯', country: 'Bénin' },
    { id: 'lotto-kadoo-togo', name: 'Lotto Kadoo', icon: '🇹🇬', country: 'Togo' },
    { id: 'lonaci-ci', name: 'Lonaci', icon: '🇨🇮', country: 'Côte d\'Ivoire' },
    { id: 'green-lotto-nigeria', name: 'Green Lotto', icon: '🇳🇬', country: 'Nigéria' },
    { id: 'pmu-senegal', name: 'PMU Sénégal', icon: '🇸🇳', country: 'Sénégal' },
];

const BET_TYPES_CONFIG: Record<string, { name: string; label: string }> = {
    'NAP1': { name: 'Simple Numéro', label: 'NAP1' },
    'NAP2': { name: 'Deux Numéros', label: 'NAP2 / Two Sure' },
    'NAP3': { name: 'Trois Numéros', label: 'NAP3' },
    'NAP4': { name: 'Quatre Numéros', label: 'NAP4' },
    'NAP5': { name: 'Cinq Numéros', label: 'NAP5 / Perm Nap' },
    'PERMUTATION': { name: 'Combinaison', label: 'Permutation' },
    'BANKA': { name: 'Numéro de Base', label: 'Against / Banka' },
    'CHANCE_PLUS': { name: 'Position Exacte', label: 'Chance+' },
    'ANAGRAMME': { name: 'Numéros inversés', label: 'Anagramme / WE dans WE' },
};

const getDefaultMultipliers = (): Multipliers => ({
    'NAP1': 10, 'NAP2': 500, 'NAP3': 2500, 'NAP4': 10000, 'NAP5': 100000,
    'PERMUTATION': 500, 'BANKA': 500, 'CHANCE_PLUS': 90, 'ANAGRAMME': 10,
});

// MISE À JOUR : Ajout du statut 'pending'
type AdminDrawStatus = 'upcoming' | 'pending' | 'completed' | 'archived' | 'cancelled';

// --- COMPOSANT PRINCIPAL ---
export function AdminGames() {
    const [activeTab, setActiveTab] = useState<AdminDrawStatus>('upcoming');
    const [isLoading, setIsLoading] = useState(true);
    const [draws, setDraws] = useState<Draw[]>([]);
    
    const [isCreateModalOpen, setCreateModalOpen] = useState(false);
    const [isResultsModalOpen, setResultsModalOpen] = useState(false);
    const [selectedDraw, setSelectedDraw] = useState<Draw | null>(null);

    const loadDraws = async (status: AdminDrawStatus) => {
        setIsLoading(true);
        try {
            const items = await getAdminDrawsByStatus(status);
            setDraws(items);
        } catch (error) {
            toast.error(`Impossible de charger les tirages "${status}".`);
            setDraws([]);
        } finally {
            setIsLoading(false);
        }
    };

    useEffect(() => {
        loadDraws(activeTab);
    }, [activeTab]);
    
    return (
        <div className="p-4 md:p-8 space-y-8">
            <header className="flex justify-between items-start flex-wrap gap-4">
                <div>
                    <h1 className="text-3xl font-bold">Gestion des Jeux</h1>
                    <p className="text-muted-foreground mt-1">Créez des tirages, saisissez les résultats et consultez les archives</p>
                </div>
                <Button onClick={() => setCreateModalOpen(true)} className="bg-yellow-400 text-black hover:bg-yellow-500">
                    <Plus className="mr-2 h-4 w-4" />Nouveau Tirage
                </Button>
            </header>
            
            <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as AdminDrawStatus)}>
                <TabsList className="grid w-full max-w-lg grid-cols-3">
                    <TabsTrigger value="upcoming">À Venir</TabsTrigger>
                    {/* MISE À JOUR : L'onglet "Résultats" appelle maintenant le statut 'pending' */}
                    <TabsTrigger value="pending">Résultats</TabsTrigger>
                    <TabsTrigger value="archived">Archives</TabsTrigger>
                </TabsList>

                <TabsContent value={activeTab} className="mt-6">
                    {isLoading ? (
                        <div className="flex justify-center p-12"><Loader2 className="h-8 w-8 animate-spin text-muted-foreground"/></div>
                    ) : draws.length === 0 ? (
                       <EmptyState status={activeTab} onCreateClick={() => setCreateModalOpen(true)} />
                    ) : (
                        <div className="grid gap-4">
                            {draws.map((draw) => (
                                <DrawCard key={draw.id} draw={draw} onEnterResults={() => {setSelectedDraw(draw); setResultsModalOpen(true);}} />
                            ))}
                        </div>
                    )}
                </TabsContent>
            </Tabs>
            
            <CreateDrawModal 
                isOpen={isCreateModalOpen} 
                onClose={() => setCreateModalOpen(false)} 
                onSuccess={() => {
                    if (activeTab === 'upcoming') {
                        loadDraws('upcoming');
                    } else {
                        setActiveTab('upcoming');
                    }
                }}
            />
            {selectedDraw && (
                <ResultsModal
                    isOpen={isResultsModalOpen}
                    onClose={() => setResultsModalOpen(false)}
                    draw={selectedDraw}
                    onSuccess={() => loadDraws(activeTab)}
                />
            )}
        </div>
    );
}

// --- SOUS-COMPOSANTS ---

function DrawCard({ draw, onEnterResults }: { draw: Draw; onEnterResults: () => void; }) {
    const operator = OPERATORS_CONFIG.find(op => op.id === draw.operatorId);
    
    const drawDate = new Date(draw.drawDate);
    const formattedDate = !isNaN(drawDate.getTime()) ? drawDate.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit', year: 'numeric' }) : "Date invalide";
    const formattedTime = !isNaN(drawDate.getTime()) ? drawDate.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' }) : "";

    return (
      <Card className="p-4 md:p-6">
        <div className="flex justify-between items-start flex-wrap gap-4">
            <div className="flex items-start gap-4">
                <span className="text-3xl pt-1">{operator?.icon || '🎲'}</span>
                <div>
                    <h3 className="font-bold text-lg">{draw.operatorName || 'Inconnu'}</h3>
                    <div className="mt-2 flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-muted-foreground">
                        <div className="flex items-center gap-1.5"><Calendar className="h-4 w-4" /><span>{formattedDate}</span></div>
                        <div className="flex items-center gap-1.5"><Clock className="h-4 w-4" /><span>{formattedTime}</span></div>
                    </div>
                    {draw.winningNumbers && draw.winningNumbers.length > 0 && 
                        <div className="flex items-center gap-1.5 mt-3 text-sm font-semibold text-yellow-400">
                           <Trophy className="h-4 w-4" /> Numéros: {draw.winningNumbers.join(', ')}
                        </div>
                    }
                </div>
            </div>
            {/* MISE À JOUR : Le bouton s'affiche maintenant pour les tirages en statut 'pending' */}
            {draw.status === 'pending' && (
                <Button size="sm" onClick={onEnterResults} className="bg-orange-500 hover:bg-orange-600 text-white">
                    Saisir les Résultats
                </Button>
            )}
        </div>
      </Card>
    );
}

function EmptyState({ status, onCreateClick }: { status: AdminDrawStatus; onCreateClick: () => void; }) {
    // MISE À JOUR : Ajout d'un message pour l'état 'pending'
    const messages = {
        upcoming: { icon: Calendar, text: "Aucun tirage à venir" },
        pending: { icon: Trophy, text: "Aucun tirage en attente de résultat" },
        completed: { icon: Trophy, text: "Aucun résultat à afficher" },
        archived: { icon: Archive, text: "Aucune archive trouvée" },
        cancelled: { icon: Archive, text: "Aucun tirage annulé" }
    };
    const { icon: Icon, text } = messages[status];

    return (
        <Card className="p-12 text-center text-muted-foreground border-dashed flex flex-col items-center justify-center">
            <Icon className="h-12 w-12 mb-4" />
            <p className="mb-6 font-semibold">{text}</p>
            {status === 'upcoming' && <Button onClick={onCreateClick} className="bg-yellow-400 text-black hover:bg-yellow-500">Créer un tirage</Button>}
        </Card>
    );
}

function CreateDrawModal({ isOpen, onClose, onSuccess }: { isOpen: boolean; onClose: () => void; onSuccess: () => void; }) {
    const [isSubmitting, setIsSubmitting] = useState(false);
    const [newDraw, setNewDraw] = useState({ operatorId: "", date: "", time: "" });
    const [multipliers, setMultipliers] = useState<Multipliers>(getDefaultMultipliers());

    const handleCreate = async () => {
        if (!newDraw.operatorId || !newDraw.date || !newDraw.time) {
            return toast.error("Veuillez remplir tous les champs obligatoires.");
        }
        setIsSubmitting(true);
        try {
            await createAdminDraw({ ...newDraw, multipliers });
            toast.success("Tirage créé avec succès !");
            onSuccess();
            onClose();
        } catch (error) {
            toast.error("Erreur lors de la création du tirage.");
        } finally {
            setIsSubmitting(false);
        }
    };
    
    return (
        <Dialog open={isOpen} onOpenChange={onClose}>
            <DialogContent className="max-w-3xl flex flex-col max-h-[90vh]">
                <DialogHeader>
                    <DialogTitle>Créer un Nouveau Tirage</DialogTitle>
                    <DialogDescription>Sélectionnez l'opérateur, la date/heure et configurez les multiplicateurs.</DialogDescription>
                </DialogHeader>
                <div className="py-4 space-y-6 overflow-y-auto pr-6">
                    <div className="space-y-2">
                        <Label>Opérateur *</Label>
                        <Select value={newDraw.operatorId} onValueChange={(v) => setNewDraw({...newDraw, operatorId: v})}>
                            <SelectTrigger><SelectValue placeholder="Choisir un opérateur..." /></SelectTrigger>
                            <SelectContent>{OPERATORS_CONFIG.map(op => <SelectItem key={op.id} value={op.id}><div className="flex items-center gap-2"><span>{op.icon}</span><span>{op.name} ({op.country})</span></div></SelectItem>)}</SelectContent>
                        </Select>
                    </div>
                    <div className="grid grid-cols-2 gap-4">
                        <div><Label>Date du tirage *</Label><Input type="date" value={newDraw.date} onChange={(e) => setNewDraw({...newDraw, date: e.target.value})} /></div>
                        <div><Label>Heure du tirage *</Label><Input type="time" value={newDraw.time} onChange={(e) => setNewDraw({...newDraw, time: e.target.value})} /></div>
                    </div>
                    <Separator />
                    <div className="space-y-4">
                        <div className="flex items-center gap-2"><Info className="h-4 w-4 text-yellow-400" /><Label className="text-base">Multiplicateurs de Gains</Label></div>
                        <p className="text-xs text-muted-foreground">Configurez les multiplicateurs pour chaque type de pari. Le gain = Mise × Multiplicateur.</p>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
                            {Object.keys(BET_TYPES_CONFIG).map(key => {const config = BET_TYPES_CONFIG[key]; return (<div key={key}><Label htmlFor={key} className="text-sm font-medium">{config.name} <span className="text-xs text-muted-foreground">({config.label})</span></Label><div className="flex items-center gap-2 mt-1"><Input id={key} type="number" value={multipliers[key] || ''} onChange={(e) => setMultipliers({...multipliers, [key]: Number(e.target.value)})}/><span className="text-sm text-muted-foreground">×</span></div></div>);})}
                        </div>
                    </div>
                </div>
                <DialogFooter className="pt-4 border-t mt-auto">
                    <Button variant="ghost" onClick={onClose}>Annuler</Button>
                    <Button onClick={handleCreate} disabled={isSubmitting} className="bg-yellow-400 text-black hover:bg-yellow-500">
                        {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin"/>}Créer le Tirage
                    </Button>
                </DialogFooter>
            </DialogContent>
        </Dialog>
    );
}

function ResultsModal({ isOpen, onClose, onSuccess, draw }: { isOpen: boolean; onClose: () => void; onSuccess: () => void; draw: Draw; }) {
    const [isSubmitting, setIsSubmitting] = useState(false);
    const [winningNumbers, setWinningNumbers] = useState("");

    const handleSave = async () => {
        const numbersArray = winningNumbers.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n));
        if (numbersArray.length === 0) {
            return toast.error("Veuillez saisir des numéros valides.");
        }
        setIsSubmitting(true);
        try {
            await publishDrawResults(draw.id, numbersArray);
            toast.success("Résultats publiés et gains distribués !");
            onSuccess();
            onClose();
        } catch (error) {
            toast.error("Erreur lors de la publication des résultats.");
        } finally {
            setIsSubmitting(false);
        }
    };

    return (
        <Dialog open={isOpen} onOpenChange={onClose}>
            <DialogContent>
                <DialogHeader>
                    <DialogTitle>Saisir les Résultats pour {draw.operatorName}</DialogTitle>
                    <DialogDescription>Entrez les numéros gagnants séparés par une virgule.</DialogDescription>
                </DialogHeader>
                <div className="py-4">
                    <Label htmlFor="winning-numbers">Numéros Gagnants *</Label>
                    <Input id="winning-numbers" placeholder="ex: 5, 12, 23, 45, 67" value={winningNumbers} onChange={(e) => setWinningNumbers(e.target.value)} />
                </div>
                <DialogFooter>
                    <Button variant="ghost" onClick={onClose}>Annuler</Button>
                    <Button onClick={handleSave} disabled={isSubmitting} className="bg-yellow-400 text-black hover:bg-yellow-500">
                        {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin"/>}Enregistrer et Payer
                    </Button>
                </DialogFooter>
            </DialogContent>
        </Dialog>
    );
}

================================================================================
--- FICHIER : ./src/components/admin/AdminPlayers.tsx ---
================================================================================

// src/components/admin/AdminPlayers.tsx

import { useState, useEffect } from "react";
import { getPlayersPage, Player, adjustPlayerBalanceAPI } from "../../utils/playerAPI"; 
import { updateUserStatusAPI } from "../../utils/resellerAPI"; // On réutilise cette fonction
import { Card } from "../ui/card";
import { Button } from "../ui/button";
import { Input } from "../ui/input";
import { Badge } from "../ui/badge";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from "../ui/dialog";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "../ui/table";
import { Label } from "../ui/label";
import { toast } from "sonner";
import { Eye, Ban, CheckCircle, Loader2, ChevronLeft, ChevronRight } from "lucide-react";

interface PlayerDetailsModal {
  isOpen: boolean;
  player: Player | null;
}

export function AdminPlayers() {
  const [players, setPlayers] = useState<Player[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [currentPage, setCurrentPage] = useState(1);
  const [isLastPage, setIsLastPage] = useState(false);
  const PLAYERS_PER_PAGE = 10;
  const [searchTerm, setSearchTerm] = useState("");
  const [detailsModal, setDetailsModal] = useState<PlayerDetailsModal>({ isOpen: false, player: null });
  const [adjustAmount, setAdjustAmount] = useState("");
  const [adjustReason, setAdjustReason] = useState("");
  const [refreshKey, setRefreshKey] = useState(0);
  const [isSubmitting, setIsSubmitting] = useState(false);

  useEffect(() => {
    const fetchPlayers = async (page: number) => {
      setIsLoading(true); setError(null);
      try {
        const data = await getPlayersPage(page, PLAYERS_PER_PAGE);
        setPlayers(data);
        setIsLastPage(data.length < PLAYERS_PER_PAGE);
      } catch (err) { setError("Impossible de charger les joueurs."); console.error(err); } 
      finally { setIsLoading(false); }
    };
    fetchPlayers(currentPage);
  }, [currentPage, refreshKey]);

  const handleNextPage = () => !isLastPage && setCurrentPage(p => p + 1);
  const handlePrevPage = () => currentPage > 1 && setCurrentPage(p => p - 1);
  
  const handleToggleStatus = async (player: Player) => {
    const newStatus = player.status === 'active' ? 'suspended' : 'active';
    setIsSubmitting(true);
    try {
      await updateUserStatusAPI(player._id, newStatus);
      toast.success(`Statut du joueur mis à jour.`);
      setDetailsModal({ isOpen: false, player: null });
      setRefreshKey(p => p + 1);
    } catch (err) { toast.error("Échec de la mise à jour du statut."); } 
    finally { setIsSubmitting(false); }
  };

  const handleAdjustBalance = async (player: Player, balanceType: 'game' | 'winnings') => {
    const amount = parseFloat(adjustAmount);
    if (isNaN(amount)) { return toast.error("Le montant est invalide."); }
    if (!adjustReason) { return toast.error("Veuillez fournir une raison."); }
    setIsSubmitting(true);
    try {
      await adjustPlayerBalanceAPI(player._id, amount, balanceType, adjustReason);
      toast.success("Solde du joueur mis à jour !");
      setAdjustAmount(""); setAdjustReason("");
      setDetailsModal({ isOpen: false, player: null });
      setRefreshKey(p => p + 1);
    } catch (err: any) {
      // --- LA CORRECTION EST ICI ---
      const errorDetail = err?.response?.data?.detail;
      let errorMessage = "Échec de la mise à jour du solde.";
      if (typeof errorDetail === 'string') {
        errorMessage = errorDetail;
      } else if (Array.isArray(errorDetail) && errorDetail[0]?.msg) {
        errorMessage = `Erreur: ${errorDetail[0].msg}`; // Affiche le message de validation de FastAPI
      }
      toast.error(errorMessage);
    } finally {
      setIsSubmitting(false);
    }
  };

  const filteredPlayers = (players || []).filter(p => p.username.toLowerCase().includes(searchTerm.toLowerCase()) || p.phoneNumber.includes(searchTerm) || p.email.toLowerCase().includes(searchTerm.toLowerCase()));
  
  return (
    <div className="p-4 md:p-6 lg:p-8 space-y-6 md:space-y-8">
      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div><h1 className="text-2xl md:text-3xl font-bold text-foreground">Gestion des Joueurs</h1><p className="text-sm md:text-base text-muted-foreground">Gérer tous les comptes joueurs</p></div>
        <div className="flex flex-col sm:flex-row items-stretch sm:items-center gap-3 md:gap-4"><Input placeholder="Rechercher un joueur..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="w-full sm:w-60 md:w-80" /><Badge variant="outline" className="text-sm md:text-base px-3 md:px-4 py-2 text-center">{filteredPlayers.length} joueur{filteredPlayers.length !== 1 ? 's' : ''} sur la page</Badge></div>
      </div>
      <Card className="border-border">
        {isLoading ? (<div className="flex items-center justify-center h-64"><Loader2 className="h-8 w-8 animate-spin text-[#FFD700]" /></div>) : error ? (<div className="text-center text-red-500 p-8">{error}</div>) : (
          <>
            <div className="hidden md:block overflow-auto"><Table><TableHeader><TableRow className="border-border hover:bg-accent/50"><TableHead>Nom d'utilisateur</TableHead><TableHead>Numéro de téléphone</TableHead><TableHead>Email</TableHead><TableHead>Solde Jeu</TableHead><TableHead>Solde Gains</TableHead><TableHead>Statut</TableHead><TableHead className="text-right">Actions</TableHead></TableRow></TableHeader><TableBody>{filteredPlayers.map((player) => (<TableRow key={player._id} className="border-border hover:bg-accent/30"><TableCell className="font-medium">{player.username}</TableCell><TableCell>{player.phoneNumber}</TableCell><TableCell>{player.email}</TableCell><TableCell>{(player.balanceGame ?? 0).toLocaleString('fr-FR')} F</TableCell><TableCell>{(player.balanceWinnings ?? 0).toLocaleString('fr-FR')} F</TableCell><TableCell><Badge variant={player.status === 'suspended' ? 'destructive' : 'default'} className={player.status === 'suspended' ? '' : 'bg-green-600 hover:bg-green-700'}>{player.status === 'suspended' ? 'Suspendu' : 'Actif'}</Badge></TableCell><TableCell className="text-right"><Button variant="ghost" size="sm" onClick={() => setDetailsModal({ isOpen: true, player })}><Eye className="h-4 w-4 mr-2" />Détails</Button></TableCell></TableRow>))}</TableBody></Table></div>
            <div className="md:hidden space-y-3 p-4">{filteredPlayers.map((player) => (<Card key={player._id} className="p-4 border-border"><div className="space-y-3"><div className="flex items-start justify-between"><div><p className="font-bold text-foreground">{player.username}</p><p className="text-sm text-muted-foreground">{player.phoneNumber}</p><p className="text-xs text-muted-foreground truncate">{player.email}</p></div><Badge variant={player.status === 'suspended' ? 'destructive' : 'default'} className={player.status === 'suspended' ? 'text-xs' : 'bg-green-600 text-xs'}>{player.status === 'suspended' ? 'Suspendu' : 'Actif'}</Badge></div><div className="grid grid-cols-2 gap-2 text-sm"><div><p className="text-muted-foreground text-xs">Solde Jeu</p><p className="font-medium text-[#FFD700]">{(player.balanceGame ?? 0).toLocaleString('fr-FR')} F</p></div><div><p className="text-muted-foreground text-xs">Solde Gains</p><p className="font-medium text-[#FF6B00]">{(player.balanceWinnings ?? 0).toLocaleString('fr-FR')} F</p></div></div><Button variant="outline" size="sm" className="w-full" onClick={() => setDetailsModal({ isOpen: true, player })}><Eye className="h-4 w-4 mr-2" />Voir les détails</Button></div></Card>))}</div>
            <div className="flex items-center justify-between p-4 border-t"><span className="text-sm text-muted-foreground">Page {currentPage}</span><div className="flex gap-2"><Button variant="outline" size="sm" onClick={handlePrevPage} disabled={currentPage === 1}><ChevronLeft className="h-4 w-4 mr-2" />Précédent</Button><Button variant="outline" size="sm" onClick={handleNextPage} disabled={isLastPage}>Suivant<ChevronRight className="h-4 w-4 ml-2" /></Button></div></div>
          </>
        )}
      </Card>
      <Dialog open={detailsModal.isOpen} onOpenChange={(open) => { if (!open) { setDetailsModal({ isOpen: false, player: null }); setAdjustAmount(""); setAdjustReason(""); } else { setDetailsModal({ ...detailsModal, isOpen: true }); } }}><DialogContent className="max-w-2xl max-h-[90vh] overflow-y-auto scrollbar-visible bg-card border-border"><DialogHeader><DialogTitle className="text-base md:text-lg">Détails du joueur : {detailsModal.player?.username}</DialogTitle></DialogHeader>{detailsModal.player && (<div className="space-y-4 md:space-y-6"><div className="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4"><div><Label className="text-muted-foreground text-xs md:text-sm">Numéro de téléphone</Label><p className="font-medium text-sm md:text-base">{detailsModal.player.phoneNumber}</p></div><div><Label className="text-muted-foreground text-xs md:text-sm">Email</Label><p className="font-medium text-sm md:text-base break-all">{detailsModal.player.email}</p></div><div><Label className="text-muted-foreground text-xs md:text-sm">Solde de Jeu</Label><p className="font-medium text-[#FFD700] text-sm md:text-base">{(detailsModal.player.balanceGame ?? 0).toLocaleString('fr-FR')} F CFA</p></div><div><Label className="text-muted-foreground text-xs md:text-sm">Solde des Gains</Label><p className="font-medium text-[#FF6B00] text-sm md:text-base">{(detailsModal.player.balanceWinnings ?? 0).toLocaleString('fr-FR')} F CFA</p></div><div><Label className="text-muted-foreground text-xs md:text-sm">Créé le</Label><p className="font-medium text-sm">{new Date(detailsModal.player.createdAt).toLocaleString('fr-FR')}</p></div><div><Label className="text-muted-foreground text-xs md:text-sm">Statut</Label><Badge variant={detailsModal.player.status === 'suspended' ? 'destructive' : 'default'} className={detailsModal.player.status === 'suspended' ? 'text-xs' : 'bg-green-600 text-xs'}>{detailsModal.player.status === 'suspended' ? 'Suspendu' : 'Actif'}</Badge></div></div><div className="border-t border-border pt-4 space-y-3 md:space-y-4"><Label className="text-xs md:text-sm">Actions administrateur</Label><div className="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4"><div><Input type="number" placeholder="Montant (ex: 5000 ou -100)" value={adjustAmount} onChange={(e) => setAdjustAmount(e.target.value)} className="text-sm" /></div><div><Input placeholder="Raison de l'ajustement" value={adjustReason} onChange={(e) => setAdjustReason(e.target.value)} className="text-sm" /></div></div><div className="flex flex-col sm:flex-row gap-2"><Button variant="outline" size="sm" className="w-full sm:w-auto text-xs md:text-sm" onClick={() => handleAdjustBalance(detailsModal.player!, 'game')} disabled={isSubmitting}>{isSubmitting && <Loader2 className="h-4 w-4 mr-2 animate-spin"/>}Ajuster Solde Jeu</Button><Button variant="outline" size="sm" className="w-full sm:w-auto text-xs md:text-sm" onClick={() => handleAdjustBalance(detailsModal.player!, 'winnings')} disabled={isSubmitting}>{isSubmitting && <Loader2 className="h-4 w-4 mr-2 animate-spin"/>}Ajuster Solde Gains</Button></div></div></div>)}{detailsModal.player && <DialogFooter className="flex flex-col sm:flex-row gap-2"><Button variant={detailsModal.player?.status === 'suspended' ? 'default' : 'destructive'} size="sm" className="w-full sm:w-auto text-xs md:text-sm" onClick={() => handleToggleStatus(detailsModal.player!)} disabled={isSubmitting}>{isSubmitting && <Loader2 className="h-4 w-4 mr-2 animate-spin"/>}{detailsModal.player?.status === 'suspended' ? <><CheckCircle className="h-4 w-4 mr-2" /> Réactiver</> : <><Ban className="h-4 w-4 mr-2" /> Suspendre</>}</Button><Button variant="outline" size="sm" className="w-full sm:w-auto text-xs md:text-sm" onClick={() => setDetailsModal({ isOpen: false, player: null })}>Fermer</Button></DialogFooter>}</DialogContent></Dialog>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/admin/AdminResellers.tsx ---
================================================================================

// src/components/admin/AdminResellers.tsx

import { useState, useEffect } from "react";
import { getResellersPage, createResellerAPI, updateUserStatusAPI, adjustResellerBalanceAPI, Reseller } from "../../utils/resellerAPI";
import { Card } from "../ui/card";
import { Button } from "../ui/button";
import { Input } from "../ui/input";
import { Badge } from "../ui/badge";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from "../ui/dialog";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "../ui/table";
import { Label } from "../ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "../ui/select";
import { toast } from "sonner";
import { Eye, Ban, CheckCircle, Plus, Loader2, ChevronLeft, ChevronRight } from "lucide-react";

interface ResellerDetailsModal { isOpen: boolean; reseller: Reseller | null; }
interface CreateResellerModal { isOpen: boolean; }

const COUNTRIES = [ { code: '+228', name: 'Togo', flag: '🇹🇬' }, { code: '+229', name: 'Bénin', flag: '🇧🇯' }, { code: '+225', name: "Côte d'Ivoire", flag: '🇨🇮' }, { code: '+233', name: 'Ghana', flag: '🇬🇭' }, { code: '+226', name: 'Burkina Faso', flag: '🇧🇫' } ];

export function AdminResellers() {
  const [resellers, setResellers] = useState<Reseller[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [currentPage, setCurrentPage] = useState(1);
  const [isLastPage, setIsLastPage] = useState(false);
  const RESELLERS_PER_PAGE = 5;
  const [searchTerm, setSearchTerm] = useState("");
  const [detailsModal, setDetailsModal] = useState<ResellerDetailsModal>({ isOpen: false, reseller: null });
  const [createModal, setCreateModal] = useState<CreateResellerModal>({ isOpen: false });
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [refreshKey, setRefreshKey] = useState(0);
  const [adjustAmount, setAdjustAmount] = useState("");
  const [adjustReason, setAdjustReason] = useState("");
  const [newResellerUsername, setNewResellerUsername] = useState("");
  const [newResellerCountryCode, setNewResellerCountryCode] = useState("+228");
  const [newResellerPhone, setNewResellerPhone] = useState("");
  const [newResellerEmail, setNewResellerEmail] = useState("");
  const [newResellerPassword, setNewResellerPassword] = useState("");
  const [newResellerTokenBalance, setNewResellerTokenBalance] = useState("");

  useEffect(() => {
    const fetchResellers = async (page: number) => {
      setIsLoading(true); setError(null);
      try {
        const data = await getResellersPage(page, RESELLERS_PER_PAGE);
        setResellers(data);
        setIsLastPage(data.length < RESELLERS_PER_PAGE);
      } catch (err) { setError("Impossible de charger les revendeurs."); } 
      finally { setIsLoading(false); }
    };
    fetchResellers(currentPage);
  }, [currentPage, refreshKey]);
  
  const handleNextPage = () => !isLastPage && setCurrentPage(p => p + 1);
  const handlePrevPage = () => currentPage > 1 && setCurrentPage(p => p - 1);

  const handleCreateReseller = async () => {
    if (!newResellerUsername || !newResellerPhone || !newResellerEmail || !newResellerPassword) { return toast.error("Veuillez remplir tous les champs obligatoires."); }
    if (!newResellerEmail.includes('@')) { return toast.error("Format d'email invalide."); }
    if (newResellerPassword.length < 8) { return toast.error("Le mot de passe doit contenir au moins 8 caractères."); }
    const fullPhoneNumber = `${newResellerCountryCode}${newResellerPhone.replace(/\s/g, '')}`;
    const initialTokenBalance = newResellerTokenBalance ? parseFloat(newResellerTokenBalance) : 0;
    setIsSubmitting(true);
    try {
      await createResellerAPI({ username: newResellerUsername, phoneNumber: fullPhoneNumber, email: newResellerEmail, password: newResellerPassword, initialTokenBalance });
      toast.success("Revendeur créé avec succès !");
      setCreateModal({ isOpen: false });
      setRefreshKey(prev => prev + 1);
      setNewResellerUsername(""); setNewResellerPhone(""); setNewResellerEmail(""); setNewResellerPassword(""); setNewResellerTokenBalance("");
    } catch (err: any) { toast.error(err?.response?.data?.detail || "Erreur lors de la création."); } 
    finally { setIsSubmitting(false); }
  };

  const handleToggleStatus = async (reseller: Reseller) => {
    const newStatus = reseller.status === 'active' ? 'suspended' : 'active';
    setIsSubmitting(true);
    try {
      await updateUserStatusAPI(reseller._id, newStatus);
      toast.success(`Statut mis à jour.`);
      setDetailsModal({ isOpen: false, reseller: null });
      setRefreshKey(prev => prev + 1);
    } catch(err) { toast.error("Échec de la mise à jour du statut."); } 
    finally { setIsSubmitting(false); }
  };
  
  const handleAdjustTokens = async (reseller: Reseller) => {
    const amount = parseFloat(adjustAmount);
    if (isNaN(amount)) { return toast.error("Veuillez entrer un montant valide."); }
    if (!adjustReason) { return toast.error("Veuillez fournir une raison."); }
    setIsSubmitting(true);
    try {
      await adjustResellerBalanceAPI(reseller._id, amount, adjustReason);
      toast.success("Solde de jetons mis à jour !");
      setAdjustAmount(""); setAdjustReason("");
      setDetailsModal({ isOpen: false, reseller: null });
      setRefreshKey(prev => prev + 1);
    } catch (err: any) {
      const errorDetail = err?.response?.data?.detail;
      let errorMessage = "Échec de l'ajustement du solde.";
      if (typeof errorDetail === 'string') { errorMessage = errorDetail; } 
      else if (Array.isArray(errorDetail) && errorDetail[0]?.msg) { errorMessage = `Erreur: ${errorDetail[0].msg}`; }
      toast.error(errorMessage);
    } finally {
      setIsSubmitting(false);
    }
  };
  
  const filteredResellers = (resellers || []).filter(r => r.username.toLowerCase().includes(searchTerm.toLowerCase()) || r.phoneNumber.includes(searchTerm) || r.email.toLowerCase().includes(searchTerm.toLowerCase()));

  return (
    <div className="p-4 md:p-6 lg:p-8 space-y-6 md:space-y-8">
      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div><h1 className="text-2xl md:text-3xl font-bold text-foreground">Gestion des Revendeurs</h1><p className="text-sm md:text-base text-muted-foreground">Gérer tous les comptes revendeurs</p></div>
        <div className="flex flex-col sm:flex-row items-stretch sm:items-center gap-3 md:gap-4"><Button onClick={() => setCreateModal({ isOpen: true })} className="bg-[#FFD700] text-black hover:bg-[#FFD700]/90"><Plus className="h-4 w-4 mr-2" />Créer un revendeur</Button><Input placeholder="Rechercher..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="w-full sm:w-60" /><Badge variant="outline" className="px-4 py-2">{filteredResellers.length} revendeur{filteredResellers.length !== 1 ? 's' : ''} sur la page</Badge></div>
      </div>
      <Card className="border-border">
        {isLoading ? (<div className="flex items-center justify-center h-64"><Loader2 className="h-8 w-8 animate-spin text-[#FFD700]" /></div>) 
        : error ? (<div className="text-center text-red-500 p-8">{error}</div>) 
        : (<>
            <div className="hidden md:block overflow-auto"><Table><TableHeader><TableRow><TableHead>Utilisateur</TableHead><TableHead>Téléphone</TableHead><TableHead>Email</TableHead><TableHead>Solde Jetons</TableHead><TableHead>Statut</TableHead><TableHead className="text-right">Actions</TableHead></TableRow></TableHeader><TableBody>{filteredResellers.map((reseller) => (<TableRow key={reseller._id}><TableCell className="font-medium">{reseller.username}</TableCell><TableCell>{reseller.phoneNumber}</TableCell><TableCell>{reseller.email}</TableCell><TableCell className="text-[#FFD700]">{(reseller.tokenBalance ?? 0).toLocaleString('fr-FR')} F</TableCell><TableCell><Badge variant={reseller.status === 'suspended' ? 'destructive' : 'default'} className={reseller.status === 'suspended' ? '' : 'bg-green-600'}>{reseller.status === 'suspended' ? 'Suspendu' : 'Actif'}</Badge></TableCell><TableCell className="text-right"><Button variant="ghost" size="sm" onClick={() => setDetailsModal({ isOpen: true, reseller })}><Eye className="h-4 w-4 mr-2" />Détails</Button></TableCell></TableRow>))}</TableBody></Table></div>
            <div className="md:hidden p-4 space-y-3">{filteredResellers.map((reseller) => (<Card key={reseller._id} className="p-4"><div className="space-y-3"><div className="flex items-start justify-between"><div><p className="font-bold">{reseller.username}</p><p className="text-sm text-muted-foreground">{reseller.phoneNumber}</p></div><Badge variant={reseller.status === 'suspended' ? 'destructive' : 'default'} className={reseller.status === 'suspended' ? 'text-xs' : 'bg-green-600 text-xs'}>{reseller.status === 'suspended' ? 'Suspendu' : 'Actif'}</Badge></div><div className="grid grid-cols-1"><p className="text-muted-foreground text-xs">Solde Jetons</p><p className="font-medium text-[#FFD700]">{(reseller.tokenBalance ?? 0).toLocaleString('fr-FR')} F</p></div><Button variant="outline" size="sm" className="w-full" onClick={() => setDetailsModal({ isOpen: true, reseller })}><Eye className="h-4 w-4 mr-2" />Voir les détails</Button></div></Card>))}</div>
            <div className="flex items-center justify-between p-4 border-t"><span className="text-sm text-muted-foreground">Page {currentPage}</span><div className="flex gap-2"><Button variant="outline" size="sm" onClick={handlePrevPage} disabled={currentPage === 1}><ChevronLeft className="h-4 w-4 mr-2" />Précédent</Button><Button variant="outline" size="sm" onClick={handleNextPage} disabled={isLastPage}>Suivant<ChevronRight className="h-4 w-4 ml-2" /></Button></div></div>
           </>
        )}
      </Card>
      
      {/* --- MODALE DE CRÉATION RESTAURÉE --- */}
      <Dialog open={createModal.isOpen} onOpenChange={(open) => setCreateModal({ isOpen: open })}>
        <DialogContent className="max-w-md bg-card border-border">
          <DialogHeader><DialogTitle>Créer un nouveau revendeur</DialogTitle><DialogDescription className="sr-only">Formulaire de création d'un nouveau compte revendeur</DialogDescription></DialogHeader>
          <div className="space-y-4">
            <div className="space-y-2"><Label htmlFor="username">Nom d'utilisateur *</Label><Input id="username" placeholder="Ex: SUPER_LOTO" value={newResellerUsername} onChange={(e) => setNewResellerUsername(e.target.value)} /></div>
            <div className="space-y-2"><Label htmlFor="phone">Numéro de téléphone *</Label><div className="flex gap-2"><Select value={newResellerCountryCode} onValueChange={setNewResellerCountryCode}><SelectTrigger className="w-32"><SelectValue /></SelectTrigger><SelectContent>{COUNTRIES.map((c) => (<SelectItem key={c.code} value={c.code}><span className="flex items-center gap-2"><span>{c.flag}</span><span>{c.code}</span></span></SelectItem>))}</SelectContent></Select><Input id="phone" placeholder="90 12 34 56" value={newResellerPhone} onChange={(e) => setNewResellerPhone(e.target.value)} className="flex-1" /></div></div>
            <div className="space-y-2"><Label htmlFor="email">Email *</Label><Input id="email" type="email" placeholder="revendeur@example.com" value={newResellerEmail} onChange={(e) => setNewResellerEmail(e.target.value)} /></div>
            <div className="space-y-2"><Label htmlFor="password">Mot de passe *</Label><Input id="password" type="password" placeholder="Minimum 8 caractères" value={newResellerPassword} onChange={(e) => setNewResellerPassword(e.target.value)} /></div>
            <div className="space-y-2"><Label htmlFor="tokenBalance">Solde de jetons initial (optionnel)</Label><Input id="tokenBalance" type="number" placeholder="0" value={newResellerTokenBalance} onChange={(e) => setNewResellerTokenBalance(e.target.value)} /></div>
          </div>
          <DialogFooter className="flex gap-2"><Button variant="outline" onClick={() => setCreateModal({ isOpen: false })}>Annuler</Button><Button onClick={handleCreateReseller} disabled={isSubmitting} className="bg-[#FFD700] text-black hover:bg-[#FFD700]/90">{isSubmitting && <Loader2 className="h-4 w-4 mr-2 animate-spin" />}Créer le revendeur</Button></DialogFooter>
        </DialogContent>
      </Dialog>
      
      <Dialog open={detailsModal.isOpen} onOpenChange={(open) => { if (!open) { setDetailsModal({ isOpen: false, reseller: null }); setAdjustAmount(""); setAdjustReason(""); } else { setDetailsModal({ ...detailsModal, isOpen: true }); } }}>
        <DialogContent className="max-w-2xl bg-card border-border">
            <DialogHeader><DialogTitle>Détails du revendeur : {detailsModal.reseller?.username}</DialogTitle></DialogHeader>
            {detailsModal.reseller && (
                <div className="space-y-6">
                    <div className="grid grid-cols-2 gap-4">
                        <div><Label className="text-muted-foreground">Téléphone</Label><p className="font-medium">{detailsModal.reseller.phoneNumber}</p></div>
                        <div><Label className="text-muted-foreground">Email</Label><p className="font-medium">{detailsModal.reseller.email}</p></div>
                        <div><Label className="text-muted-foreground">Solde Jetons</Label><p className="font-medium text-[#FFD700]">{(detailsModal.reseller.tokenBalance ?? 0).toLocaleString('fr-FR')} F</p></div>
                        <div><Label className="text-muted-foreground">Statut</Label><Badge variant={detailsModal.reseller.status === 'suspended' ? 'destructive' : 'default'} className={detailsModal.reseller.status === 'suspended' ? '' : 'bg-green-600'}>{detailsModal.reseller.status === 'suspended' ? 'Suspendu' : 'Actif'}</Badge></div>
                    </div>
                    <div className="border-t pt-4 space-y-4">
                        <Label>Actions administrateur</Label>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <Input type="number" placeholder="Montant (ex: 5000 ou -1000)" value={adjustAmount} onChange={(e) => setAdjustAmount(e.target.value)} />
                            <Input placeholder="Raison de l'ajustement" value={adjustReason} onChange={(e) => setAdjustReason(e.target.value)} />
                        </div>
                        <div className="flex gap-2">
                            <Button variant="outline" size="sm" onClick={() => handleAdjustTokens(detailsModal.reseller!)} disabled={isSubmitting}>
                                {isSubmitting && <Loader2 className="h-4 w-4 mr-2 animate-spin"/>}Ajuster le Solde
                            </Button>
                        </div>
                    </div>
                </div>
            )}
            <DialogFooter className="flex gap-2">
                <Button variant={detailsModal.reseller?.status === 'suspended' ? 'default' : 'destructive'} onClick={() => handleToggleStatus(detailsModal.reseller!)} disabled={isSubmitting}>
                    {isSubmitting && <Loader2 className="h-4 w-4 mr-2 animate-spin"/>}
                    {detailsModal.reseller?.status === 'suspended' ? (<><CheckCircle className="h-4 w-4 mr-2"/>Réactiver</>) : (<><Ban className="h-4 w-4 mr-2"/>Suspendre</>)}
                </Button>
                <Button variant="outline" onClick={() => setDetailsModal({ isOpen: false, reseller: null })}>Fermer</Button>
            </DialogFooter>
        </DialogContent>
      </Dialog>
    </div>
  );
}

================================================================================
--- FICHIER : ./src/components/figma/ImageWithFallback.tsx ---
================================================================================

import React, { useState } from 'react'

const ERROR_IMG_SRC =
  'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg=='

export function ImageWithFallback(props: React.ImgHTMLAttributes<HTMLImageElement>) {
  const [didError, setDidError] = useState(false)

  const handleError = () => {
    setDidError(true)
  }

  const { src, alt, style, className, ...rest } = props

  return didError ? (
    <div
      className={`inline-block bg-gray-100 text-center align-middle ${className ?? ''}`}
      style={style}
    >
      <div className="flex items-center justify-center w-full h-full">
        <img src={ERROR_IMG_SRC} alt="Error loading image" {...rest} data-original-url={src} />
      </div>
    </div>
  ) : (
    <img src={src} alt={alt} className={className} style={style} {...rest} onError={handleError} />
  )
}


================================================================================
--- FICHIER : ./src/components/ui/accordion.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as AccordionPrimitive from "@radix-ui/react-accordion@1.2.3";
import { ChevronDownIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function Accordion({
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Root>) {
  return <AccordionPrimitive.Root data-slot="accordion" {...props} />;
}

function AccordionItem({
  className,
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Item>) {
  return (
    <AccordionPrimitive.Item
      data-slot="accordion-item"
      className={cn("border-b last:border-b-0", className)}
      {...props}
    />
  );
}

function AccordionTrigger({
  className,
  children,
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Trigger>) {
  return (
    <AccordionPrimitive.Header className="flex">
      <AccordionPrimitive.Trigger
        data-slot="accordion-trigger"
        className={cn(
          "focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",
          className,
        )}
        {...props}
      >
        {children}
        <ChevronDownIcon className="text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200" />
      </AccordionPrimitive.Trigger>
    </AccordionPrimitive.Header>
  );
}

function AccordionContent({
  className,
  children,
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Content>) {
  return (
    <AccordionPrimitive.Content
      data-slot="accordion-content"
      className="data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm"
      {...props}
    >
      <div className={cn("pt-0 pb-4", className)}>{children}</div>
    </AccordionPrimitive.Content>
  );
}

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };


================================================================================
--- FICHIER : ./src/components/ui/alert-dialog.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog@1.1.6";

import { cn } from "./utils";
import { buttonVariants } from "./button";

function AlertDialog({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {
  return <AlertDialogPrimitive.Root data-slot="alert-dialog" {...props} />;
}

function AlertDialogTrigger({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {
  return (
    <AlertDialogPrimitive.Trigger data-slot="alert-dialog-trigger" {...props} />
  );
}

function AlertDialogPortal({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {
  return (
    <AlertDialogPrimitive.Portal data-slot="alert-dialog-portal" {...props} />
  );
}

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    ref={ref}
    data-slot="alert-dialog-overlay"
    className={cn(
      "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
      className,
    )}
    {...props}
  />
));
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;

function AlertDialogContent({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {
  return (
    <AlertDialogPortal>
      <AlertDialogOverlay />
      <AlertDialogPrimitive.Content
        data-slot="alert-dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
          className,
        )}
        {...props}
      />
    </AlertDialogPortal>
  );
}

function AlertDialogHeader({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  );
}

function AlertDialogFooter({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className,
      )}
      {...props}
    />
  );
}

function AlertDialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {
  return (
    <AlertDialogPrimitive.Title
      data-slot="alert-dialog-title"
      className={cn("text-lg font-semibold", className)}
      {...props}
    />
  );
}

function AlertDialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {
  return (
    <AlertDialogPrimitive.Description
      data-slot="alert-dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  );
}

function AlertDialogAction({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {
  return (
    <AlertDialogPrimitive.Action
      className={cn(buttonVariants(), className)}
      {...props}
    />
  );
}

function AlertDialogCancel({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {
  return (
    <AlertDialogPrimitive.Cancel
      className={cn(buttonVariants({ variant: "outline" }), className)}
      {...props}
    />
  );
}

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
};

================================================================================
--- FICHIER : ./src/components/ui/alert.tsx ---
================================================================================

import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority@0.7.1";

import { cn } from "./utils";

const alertVariants = cva(
  "relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",
  {
    variants: {
      variant: {
        default: "bg-card text-card-foreground",
        destructive:
          "text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

function Alert({
  className,
  variant,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
  return (
    <div
      data-slot="alert"
      role="alert"
      className={cn(alertVariants({ variant }), className)}
      {...props}
    />
  );
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-title"
      className={cn(
        "col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",
        className,
      )}
      {...props}
    />
  );
}

function AlertDescription({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-description"
      className={cn(
        "text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",
        className,
      )}
      {...props}
    />
  );
}

export { Alert, AlertTitle, AlertDescription };


================================================================================
--- FICHIER : ./src/components/ui/aspect-ratio.tsx ---
================================================================================

"use client";

import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio@1.1.2";

function AspectRatio({
  ...props
}: React.ComponentProps<typeof AspectRatioPrimitive.Root>) {
  return <AspectRatioPrimitive.Root data-slot="aspect-ratio" {...props} />;
}

export { AspectRatio };


================================================================================
--- FICHIER : ./src/components/ui/avatar.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as AvatarPrimitive from "@radix-ui/react-avatar@1.1.3";

import { cn } from "./utils";

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-10 shrink-0 overflow-hidden rounded-full",
        className,
      )}
      {...props}
    />
  );
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  );
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className,
      )}
      {...props}
    />
  );
}

export { Avatar, AvatarImage, AvatarFallback };


================================================================================
--- FICHIER : ./src/components/ui/badge.tsx ---
================================================================================

import * as React from "react";
import { Slot } from "@radix-ui/react-slot@1.1.2";
import { cva, type VariantProps } from "class-variance-authority@0.7.1";

import { cn } from "./utils";

const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive:
          "border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

function Badge({
  className,
  variant,
  asChild = false,
  ...props
}: React.ComponentProps<"span"> &
  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "span";

  return (
    <Comp
      data-slot="badge"
      className={cn(badgeVariants({ variant }), className)}
      {...props}
    />
  );
}

export { Badge, badgeVariants };


================================================================================
--- FICHIER : ./src/components/ui/breadcrumb.tsx ---
================================================================================

import * as React from "react";
import { Slot } from "@radix-ui/react-slot@1.1.2";
import { ChevronRight, MoreHorizontal } from "lucide-react@0.487.0";

import { cn } from "./utils";

function Breadcrumb({ ...props }: React.ComponentProps<"nav">) {
  return <nav aria-label="breadcrumb" data-slot="breadcrumb" {...props} />;
}

function BreadcrumbList({ className, ...props }: React.ComponentProps<"ol">) {
  return (
    <ol
      data-slot="breadcrumb-list"
      className={cn(
        "text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",
        className,
      )}
      {...props}
    />
  );
}

function BreadcrumbItem({ className, ...props }: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="breadcrumb-item"
      className={cn("inline-flex items-center gap-1.5", className)}
      {...props}
    />
  );
}

function BreadcrumbLink({
  asChild,
  className,
  ...props
}: React.ComponentProps<"a"> & {
  asChild?: boolean;
}) {
  const Comp = asChild ? Slot : "a";

  return (
    <Comp
      data-slot="breadcrumb-link"
      className={cn("hover:text-foreground transition-colors", className)}
      {...props}
    />
  );
}

function BreadcrumbPage({ className, ...props }: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="breadcrumb-page"
      role="link"
      aria-disabled="true"
      aria-current="page"
      className={cn("text-foreground font-normal", className)}
      {...props}
    />
  );
}

function BreadcrumbSeparator({
  children,
  className,
  ...props
}: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="breadcrumb-separator"
      role="presentation"
      aria-hidden="true"
      className={cn("[&>svg]:size-3.5", className)}
      {...props}
    >
      {children ?? <ChevronRight />}
    </li>
  );
}

function BreadcrumbEllipsis({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="breadcrumb-ellipsis"
      role="presentation"
      aria-hidden="true"
      className={cn("flex size-9 items-center justify-center", className)}
      {...props}
    >
      <MoreHorizontal className="size-4" />
      <span className="sr-only">More</span>
    </span>
  );
}

export {
  Breadcrumb,
  BreadcrumbList,
  BreadcrumbItem,
  BreadcrumbLink,
  BreadcrumbPage,
  BreadcrumbSeparator,
  BreadcrumbEllipsis,
};


================================================================================
--- FICHIER : ./src/components/ui/button.tsx ---
================================================================================

import * as React from "react";
import { Slot } from "@radix-ui/react-slot@1.1.2";
import { cva, type VariantProps } from "class-variance-authority@0.7.1";

import { cn } from "./utils";

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9 rounded-md",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

const Button = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> &
    VariantProps<typeof buttonVariants> & {
      asChild?: boolean;
    }
>(({ className, variant, size, asChild = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";

  return (
    <Comp
      data-slot="button"
      className={cn(buttonVariants({ variant, size, className }))}
      ref={ref}
      {...props}
    />
  );
});
Button.displayName = "Button";

export { Button, buttonVariants };

================================================================================
--- FICHIER : ./src/components/ui/calendar.tsx ---
================================================================================

"use client";

import * as React from "react";
import { ChevronLeft, ChevronRight } from "lucide-react@0.487.0";
import { DayPicker } from "react-day-picker@8.10.1";

import { cn } from "./utils";
import { buttonVariants } from "./button";

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  ...props
}: React.ComponentProps<typeof DayPicker>) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row gap-2",
        month: "flex flex-col gap-4",
        caption: "flex justify-center pt-1 relative items-center w-full",
        caption_label: "text-sm font-medium",
        nav: "flex items-center gap-1",
        nav_button: cn(
          buttonVariants({ variant: "outline" }),
          "size-7 bg-transparent p-0 opacity-50 hover:opacity-100",
        ),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-x-1",
        head_row: "flex",
        head_cell:
          "text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: cn(
          "relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",
          props.mode === "range"
            ? "[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md"
            : "[&:has([aria-selected])]:rounded-md",
        ),
        day: cn(
          buttonVariants({ variant: "ghost" }),
          "size-8 p-0 font-normal aria-selected:opacity-100",
        ),
        day_range_start:
          "day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",
        day_range_end:
          "day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground aria-selected:text-muted-foreground",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle:
          "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        IconLeft: ({ className, ...props }) => (
          <ChevronLeft className={cn("size-4", className)} {...props} />
        ),
        IconRight: ({ className, ...props }) => (
          <ChevronRight className={cn("size-4", className)} {...props} />
        ),
      }}
      {...props}
    />
  );
}

export { Calendar };


================================================================================
--- FICHIER : ./src/components/ui/card.tsx ---
================================================================================

import * as React from "react";

import { cn } from "./utils";

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",
        className,
      )}
      {...props}
    />
  );
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className,
      )}
      {...props}
    />
  );
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <h4
      data-slot="card-title"
      className={cn("leading-none", className)}
      {...props}
    />
  );
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <p
      data-slot="card-description"
      className={cn("text-muted-foreground", className)}
      {...props}
    />
  );
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className,
      )}
      {...props}
    />
  );
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6 [&:last-child]:pb-6", className)}
      {...props}
    />
  );
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 pb-6 [.border-t]:pt-6", className)}
      {...props}
    />
  );
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
};


================================================================================
--- FICHIER : ./src/components/ui/carousel.tsx ---
================================================================================

"use client";

import * as React from "react";
import useEmblaCarousel, {
  type UseEmblaCarouselType,
} from "embla-carousel-react@8.6.0";
import { ArrowLeft, ArrowRight } from "lucide-react@0.487.0";

import { cn } from "./utils";
import { Button } from "./button";

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
  opts?: CarouselOptions;
  plugins?: CarouselPlugin;
  orientation?: "horizontal" | "vertical";
  setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0];
  api: ReturnType<typeof useEmblaCarousel>[1];
  scrollPrev: () => void;
  scrollNext: () => void;
  canScrollPrev: boolean;
  canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
  const context = React.useContext(CarouselContext);

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />");
  }

  return context;
}

function Carousel({
  orientation = "horizontal",
  opts,
  setApi,
  plugins,
  className,
  children,
  ...props
}: React.ComponentProps<"div"> & CarouselProps) {
  const [carouselRef, api] = useEmblaCarousel(
    {
      ...opts,
      axis: orientation === "horizontal" ? "x" : "y",
    },
    plugins,
  );
  const [canScrollPrev, setCanScrollPrev] = React.useState(false);
  const [canScrollNext, setCanScrollNext] = React.useState(false);

  const onSelect = React.useCallback((api: CarouselApi) => {
    if (!api) return;
    setCanScrollPrev(api.canScrollPrev());
    setCanScrollNext(api.canScrollNext());
  }, []);

  const scrollPrev = React.useCallback(() => {
    api?.scrollPrev();
  }, [api]);

  const scrollNext = React.useCallback(() => {
    api?.scrollNext();
  }, [api]);

  const handleKeyDown = React.useCallback(
    (event: React.KeyboardEvent<HTMLDivElement>) => {
      if (event.key === "ArrowLeft") {
        event.preventDefault();
        scrollPrev();
      } else if (event.key === "ArrowRight") {
        event.preventDefault();
        scrollNext();
      }
    },
    [scrollPrev, scrollNext],
  );

  React.useEffect(() => {
    if (!api || !setApi) return;
    setApi(api);
  }, [api, setApi]);

  React.useEffect(() => {
    if (!api) return;
    onSelect(api);
    api.on("reInit", onSelect);
    api.on("select", onSelect);

    return () => {
      api?.off("select", onSelect);
    };
  }, [api, onSelect]);

  return (
    <CarouselContext.Provider
      value={{
        carouselRef,
        api: api,
        opts,
        orientation:
          orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
        scrollPrev,
        scrollNext,
        canScrollPrev,
        canScrollNext,
      }}
    >
      <div
        onKeyDownCapture={handleKeyDown}
        className={cn("relative", className)}
        role="region"
        aria-roledescription="carousel"
        data-slot="carousel"
        {...props}
      >
        {children}
      </div>
    </CarouselContext.Provider>
  );
}

function CarouselContent({ className, ...props }: React.ComponentProps<"div">) {
  const { carouselRef, orientation } = useCarousel();

  return (
    <div
      ref={carouselRef}
      className="overflow-hidden"
      data-slot="carousel-content"
    >
      <div
        className={cn(
          "flex",
          orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col",
          className,
        )}
        {...props}
      />
    </div>
  );
}

function CarouselItem({ className, ...props }: React.ComponentProps<"div">) {
  const { orientation } = useCarousel();

  return (
    <div
      role="group"
      aria-roledescription="slide"
      data-slot="carousel-item"
      className={cn(
        "min-w-0 shrink-0 grow-0 basis-full",
        orientation === "horizontal" ? "pl-4" : "pt-4",
        className,
      )}
      {...props}
    />
  );
}

function CarouselPrevious({
  className,
  variant = "outline",
  size = "icon",
  ...props
}: React.ComponentProps<typeof Button>) {
  const { orientation, scrollPrev, canScrollPrev } = useCarousel();

  return (
    <Button
      data-slot="carousel-previous"
      variant={variant}
      size={size}
      className={cn(
        "absolute size-8 rounded-full",
        orientation === "horizontal"
          ? "top-1/2 -left-12 -translate-y-1/2"
          : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
        className,
      )}
      disabled={!canScrollPrev}
      onClick={scrollPrev}
      {...props}
    >
      <ArrowLeft />
      <span className="sr-only">Previous slide</span>
    </Button>
  );
}

function CarouselNext({
  className,
  variant = "outline",
  size = "icon",
  ...props
}: React.ComponentProps<typeof Button>) {
  const { orientation, scrollNext, canScrollNext } = useCarousel();

  return (
    <Button
      data-slot="carousel-next"
      variant={variant}
      size={size}
      className={cn(
        "absolute size-8 rounded-full",
        orientation === "horizontal"
          ? "top-1/2 -right-12 -translate-y-1/2"
          : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
        className,
      )}
      disabled={!canScrollNext}
      onClick={scrollNext}
      {...props}
    >
      <ArrowRight />
      <span className="sr-only">Next slide</span>
    </Button>
  );
}

export {
  type CarouselApi,
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselPrevious,
  CarouselNext,
};


================================================================================
--- FICHIER : ./src/components/ui/chart.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as RechartsPrimitive from "recharts@2.15.2";

import { cn } from "./utils";

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const;

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode;
    icon?: React.ComponentType;
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  );
};

type ChartContextProps = {
  config: ChartConfig;
};

const ChartContext = React.createContext<ChartContextProps | null>(null);

function useChart() {
  const context = React.useContext(ChartContext);

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />");
  }

  return context;
}

function ChartContainer({
  id,
  className,
  children,
  config,
  ...props
}: React.ComponentProps<"div"> & {
  config: ChartConfig;
  children: React.ComponentProps<
    typeof RechartsPrimitive.ResponsiveContainer
  >["children"];
}) {
  const uniqueId = React.useId();
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`;

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-slot="chart"
        data-chart={chartId}
        className={cn(
          "[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",
          className,
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  );
}

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([, config]) => config.theme || config.color,
  );

  if (!colorConfig.length) {
    return null;
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color;
    return color ? `  --color-${key}: ${color};` : null;
  })
  .join("\n")}
}
`,
          )
          .join("\n"),
      }}
    />
  );
};

const ChartTooltip = RechartsPrimitive.Tooltip;

function ChartTooltipContent({
  active,
  payload,
  className,
  indicator = "dot",
  hideLabel = false,
  hideIndicator = false,
  label,
  labelFormatter,
  labelClassName,
  formatter,
  color,
  nameKey,
  labelKey,
}: React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
  React.ComponentProps<"div"> & {
    hideLabel?: boolean;
    hideIndicator?: boolean;
    indicator?: "line" | "dot" | "dashed";
    nameKey?: string;
    labelKey?: string;
  }) {
  const { config } = useChart();

  const tooltipLabel = React.useMemo(() => {
    if (hideLabel || !payload?.length) {
      return null;
    }

    const [item] = payload;
    const key = `${labelKey || item?.dataKey || item?.name || "value"}`;
    const itemConfig = getPayloadConfigFromPayload(config, item, key);
    const value =
      !labelKey && typeof label === "string"
        ? config[label as keyof typeof config]?.label || label
        : itemConfig?.label;

    if (labelFormatter) {
      return (
        <div className={cn("font-medium", labelClassName)}>
          {labelFormatter(value, payload)}
        </div>
      );
    }

    if (!value) {
      return null;
    }

    return <div className={cn("font-medium", labelClassName)}>{value}</div>;
  }, [
    label,
    labelFormatter,
    payload,
    hideLabel,
    labelClassName,
    config,
    labelKey,
  ]);

  if (!active || !payload?.length) {
    return null;
  }

  const nestLabel = payload.length === 1 && indicator !== "dot";

  return (
    <div
      className={cn(
        "border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",
        className,
      )}
    >
      {!nestLabel ? tooltipLabel : null}
      <div className="grid gap-1.5">
        {payload.map((item, index) => {
          const key = `${nameKey || item.name || item.dataKey || "value"}`;
          const itemConfig = getPayloadConfigFromPayload(config, item, key);
          const indicatorColor = color || item.payload.fill || item.color;

          return (
            <div
              key={item.dataKey}
              className={cn(
                "[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5",
                indicator === "dot" && "items-center",
              )}
            >
              {formatter && item?.value !== undefined && item.name ? (
                formatter(item.value, item.name, item, index, item.payload)
              ) : (
                <>
                  {itemConfig?.icon ? (
                    <itemConfig.icon />
                  ) : (
                    !hideIndicator && (
                      <div
                        className={cn(
                          "shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",
                          {
                            "h-2.5 w-2.5": indicator === "dot",
                            "w-1": indicator === "line",
                            "w-0 border-[1.5px] border-dashed bg-transparent":
                              indicator === "dashed",
                            "my-0.5": nestLabel && indicator === "dashed",
                          },
                        )}
                        style={
                          {
                            "--color-bg": indicatorColor,
                            "--color-border": indicatorColor,
                          } as React.CSSProperties
                        }
                      />
                    )
                  )}
                  <div
                    className={cn(
                      "flex flex-1 justify-between leading-none",
                      nestLabel ? "items-end" : "items-center",
                    )}
                  >
                    <div className="grid gap-1.5">
                      {nestLabel ? tooltipLabel : null}
                      <span className="text-muted-foreground">
                        {itemConfig?.label || item.name}
                      </span>
                    </div>
                    {item.value && (
                      <span className="text-foreground font-mono font-medium tabular-nums">
                        {item.value.toLocaleString()}
                      </span>
                    )}
                  </div>
                </>
              )}
            </div>
          );
        })}
      </div>
    </div>
  );
}

const ChartLegend = RechartsPrimitive.Legend;

function ChartLegendContent({
  className,
  hideIcon = false,
  payload,
  verticalAlign = "bottom",
  nameKey,
}: React.ComponentProps<"div"> &
  Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
    hideIcon?: boolean;
    nameKey?: string;
  }) {
  const { config } = useChart();

  if (!payload?.length) {
    return null;
  }

  return (
    <div
      className={cn(
        "flex items-center justify-center gap-4",
        verticalAlign === "top" ? "pb-3" : "pt-3",
        className,
      )}
    >
      {payload.map((item) => {
        const key = `${nameKey || item.dataKey || "value"}`;
        const itemConfig = getPayloadConfigFromPayload(config, item, key);

        return (
          <div
            key={item.value}
            className={cn(
              "[&>svg]:text-muted-foreground flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3",
            )}
          >
            {itemConfig?.icon && !hideIcon ? (
              <itemConfig.icon />
            ) : (
              <div
                className="h-2 w-2 shrink-0 rounded-[2px]"
                style={{
                  backgroundColor: item.color,
                }}
              />
            )}
            {itemConfig?.label}
          </div>
        );
      })}
    </div>
  );
}

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string,
) {
  if (typeof payload !== "object" || payload === null) {
    return undefined;
  }

  const payloadPayload =
    "payload" in payload &&
    typeof payload.payload === "object" &&
    payload.payload !== null
      ? payload.payload
      : undefined;

  let configLabelKey: string = key;

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === "string"
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string;
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string;
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config];
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
};


================================================================================
--- FICHIER : ./src/components/ui/checkbox.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as CheckboxPrimitive from "@radix-ui/react-checkbox@1.1.4";
import { CheckIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function Checkbox({
  className,
  ...props
}: React.ComponentProps<typeof CheckboxPrimitive.Root>) {
  return (
    <CheckboxPrimitive.Root
      data-slot="checkbox"
      className={cn(
        "peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    >
      <CheckboxPrimitive.Indicator
        data-slot="checkbox-indicator"
        className="flex items-center justify-center text-current transition-none"
      >
        <CheckIcon className="size-3.5" />
      </CheckboxPrimitive.Indicator>
    </CheckboxPrimitive.Root>
  );
}

export { Checkbox };


================================================================================
--- FICHIER : ./src/components/ui/collapsible.tsx ---
================================================================================

"use client";

import * as CollapsiblePrimitive from "@radix-ui/react-collapsible@1.1.3";

function Collapsible({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.Root>) {
  return <CollapsiblePrimitive.Root data-slot="collapsible" {...props} />;
}

function CollapsibleTrigger({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleTrigger>) {
  return (
    <CollapsiblePrimitive.CollapsibleTrigger
      data-slot="collapsible-trigger"
      {...props}
    />
  );
}

function CollapsibleContent({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleContent>) {
  return (
    <CollapsiblePrimitive.CollapsibleContent
      data-slot="collapsible-content"
      {...props}
    />
  );
}

export { Collapsible, CollapsibleTrigger, CollapsibleContent };


================================================================================
--- FICHIER : ./src/components/ui/command.tsx ---
================================================================================

"use client";

import * as React from "react";
import { Command as CommandPrimitive } from "cmdk@1.1.1";
import { SearchIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "./dialog";

function Command({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive>) {
  return (
    <CommandPrimitive
      data-slot="command"
      className={cn(
        "bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",
        className,
      )}
      {...props}
    />
  );
}

function CommandDialog({
  title = "Command Palette",
  description = "Search for a command to run...",
  children,
  ...props
}: React.ComponentProps<typeof Dialog> & {
  title?: string;
  description?: string;
}) {
  return (
    <Dialog {...props}>
      <DialogHeader className="sr-only">
        <DialogTitle>{title}</DialogTitle>
        <DialogDescription>{description}</DialogDescription>
      </DialogHeader>
      <DialogContent className="overflow-hidden p-0">
        <Command className="[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
}

function CommandInput({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Input>) {
  return (
    <div
      data-slot="command-input-wrapper"
      className="flex h-9 items-center gap-2 border-b px-3"
    >
      <SearchIcon className="size-4 shrink-0 opacity-50" />
      <CommandPrimitive.Input
        data-slot="command-input"
        className={cn(
          "placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",
          className,
        )}
        {...props}
      />
    </div>
  );
}

function CommandList({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.List>) {
  return (
    <CommandPrimitive.List
      data-slot="command-list"
      className={cn(
        "max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto scrollbar-visible",
        className,
      )}
      {...props}
    />
  );
}

function CommandEmpty({
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Empty>) {
  return (
    <CommandPrimitive.Empty
      data-slot="command-empty"
      className="py-6 text-center text-sm"
      {...props}
    />
  );
}

function CommandGroup({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Group>) {
  return (
    <CommandPrimitive.Group
      data-slot="command-group"
      className={cn(
        "text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",
        className,
      )}
      {...props}
    />
  );
}

function CommandSeparator({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Separator>) {
  return (
    <CommandPrimitive.Separator
      data-slot="command-separator"
      className={cn("bg-border -mx-1 h-px", className)}
      {...props}
    />
  );
}

function CommandItem({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Item>) {
  return (
    <CommandPrimitive.Item
      data-slot="command-item"
      className={cn(
        "data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    />
  );
}

function CommandShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="command-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className,
      )}
      {...props}
    />
  );
}

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
};


================================================================================
--- FICHIER : ./src/components/ui/context-menu.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as ContextMenuPrimitive from "@radix-ui/react-context-menu@2.2.6";
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function ContextMenu({
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Root>) {
  return <ContextMenuPrimitive.Root data-slot="context-menu" {...props} />;
}

function ContextMenuTrigger({
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Trigger>) {
  return (
    <ContextMenuPrimitive.Trigger data-slot="context-menu-trigger" {...props} />
  );
}

function ContextMenuGroup({
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Group>) {
  return (
    <ContextMenuPrimitive.Group data-slot="context-menu-group" {...props} />
  );
}

function ContextMenuPortal({
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Portal>) {
  return (
    <ContextMenuPrimitive.Portal data-slot="context-menu-portal" {...props} />
  );
}

function ContextMenuSub({
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Sub>) {
  return <ContextMenuPrimitive.Sub data-slot="context-menu-sub" {...props} />;
}

function ContextMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.RadioGroup>) {
  return (
    <ContextMenuPrimitive.RadioGroup
      data-slot="context-menu-radio-group"
      {...props}
    />
  );
}

function ContextMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.SubTrigger> & {
  inset?: boolean;
}) {
  return (
    <ContextMenuPrimitive.SubTrigger
      data-slot="context-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto" />
    </ContextMenuPrimitive.SubTrigger>
  );
}

function ContextMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.SubContent>) {
  return (
    <ContextMenuPrimitive.SubContent
      data-slot="context-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className,
      )}
      {...props}
    />
  );
}

function ContextMenuContent({
  className,
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Content>) {
  return (
    <ContextMenuPrimitive.Portal>
      <ContextMenuPrimitive.Content
        data-slot="context-menu-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto scrollbar-visible rounded-md border p-1 shadow-md",
          className,
        )}
        {...props}
      />
    </ContextMenuPrimitive.Portal>
  );
}

function ContextMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Item> & {
  inset?: boolean;
  variant?: "default" | "destructive";
}) {
  return (
    <ContextMenuPrimitive.Item
      data-slot="context-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    />
  );
}

function ContextMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.CheckboxItem>) {
  return (
    <ContextMenuPrimitive.CheckboxItem
      data-slot="context-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <ContextMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </ContextMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </ContextMenuPrimitive.CheckboxItem>
  );
}

function ContextMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.RadioItem>) {
  return (
    <ContextMenuPrimitive.RadioItem
      data-slot="context-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <ContextMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </ContextMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </ContextMenuPrimitive.RadioItem>
  );
}

function ContextMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Label> & {
  inset?: boolean;
}) {
  return (
    <ContextMenuPrimitive.Label
      data-slot="context-menu-label"
      data-inset={inset}
      className={cn(
        "text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className,
      )}
      {...props}
    />
  );
}

function ContextMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Separator>) {
  return (
    <ContextMenuPrimitive.Separator
      data-slot="context-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  );
}

function ContextMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="context-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className,
      )}
      {...props}
    />
  );
}

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
};


================================================================================
--- FICHIER : ./src/components/ui/dialog.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as DialogPrimitive from "@radix-ui/react-dialog@1.1.6";
import { XIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function Dialog({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Root>) {
  return <DialogPrimitive.Root data-slot="dialog" {...props} />;
}

function DialogTrigger({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {
  return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />;
}

function DialogPortal({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Portal>) {
  return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />;
}

function DialogClose({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Close>) {
  return <DialogPrimitive.Close data-slot="dialog-close" {...props} />;
}

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => {
  return (
    <DialogPrimitive.Overlay
      ref={ref}
      data-slot="dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className,
      )}
      {...props}
    />
  );
});
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

function DialogContent({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Content>) {
  return (
    <DialogPortal data-slot="dialog-portal">
      <DialogOverlay />
      <DialogPrimitive.Content
        data-slot="dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
          className,
        )}
        {...props}
      >
        {children}
        <DialogPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4">
          <XIcon />
          <span className="sr-only">Close</span>
        </DialogPrimitive.Close>
      </DialogPrimitive.Content>
    </DialogPortal>
  );
}

function DialogHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  );
}

function DialogFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className,
      )}
      {...props}
    />
  );
}

function DialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Title>) {
  return (
    <DialogPrimitive.Title
      data-slot="dialog-title"
      className={cn("text-lg leading-none font-semibold", className)}
      {...props}
    />
  );
}

function DialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Description>) {
  return (
    <DialogPrimitive.Description
      data-slot="dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  );
}

export {
  Dialog,
  DialogClose,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogOverlay,
  DialogPortal,
  DialogTitle,
  DialogTrigger,
};

================================================================================
--- FICHIER : ./src/components/ui/drawer.tsx ---
================================================================================

"use client";

import * as React from "react";
import { Drawer as DrawerPrimitive } from "vaul@1.1.2";

import { cn } from "./utils";

function Drawer({
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Root>) {
  return <DrawerPrimitive.Root data-slot="drawer" {...props} />;
}

function DrawerTrigger({
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Trigger>) {
  return <DrawerPrimitive.Trigger data-slot="drawer-trigger" {...props} />;
}

function DrawerPortal({
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Portal>) {
  return <DrawerPrimitive.Portal data-slot="drawer-portal" {...props} />;
}

function DrawerClose({
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Close>) {
  return <DrawerPrimitive.Close data-slot="drawer-close" {...props} />;
}

function DrawerOverlay({
  className,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Overlay>) {
  return (
    <DrawerPrimitive.Overlay
      data-slot="drawer-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className,
      )}
      {...props}
    />
  );
}

function DrawerContent({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Content>) {
  return (
    <DrawerPortal data-slot="drawer-portal">
      <DrawerOverlay />
      <DrawerPrimitive.Content
        data-slot="drawer-content"
        className={cn(
          "group/drawer-content bg-background fixed z-50 flex h-auto flex-col",
          "data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b",
          "data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t",
          "data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm",
          "data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",
          className,
        )}
        {...props}
      >
        <div className="bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block" />
        {children}
      </DrawerPrimitive.Content>
    </DrawerPortal>
  );
}

function DrawerHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="drawer-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  );
}

function DrawerFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="drawer-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  );
}

function DrawerTitle({
  className,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Title>) {
  return (
    <DrawerPrimitive.Title
      data-slot="drawer-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  );
}

function DrawerDescription({
  className,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Description>) {
  return (
    <DrawerPrimitive.Description
      data-slot="drawer-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  );
}

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
};


================================================================================
--- FICHIER : ./src/components/ui/dropdown-menu.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu@2.1.6";
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function DropdownMenu({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
  return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />;
}

function DropdownMenuPortal({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
  return (
    <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
  );
}

function DropdownMenuTrigger({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
  return (
    <DropdownMenuPrimitive.Trigger
      data-slot="dropdown-menu-trigger"
      {...props}
    />
  );
}

function DropdownMenuContent({
  className,
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
  return (
    <DropdownMenuPrimitive.Portal>
      <DropdownMenuPrimitive.Content
        data-slot="dropdown-menu-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto scrollbar-visible rounded-md border p-1 shadow-md",
          className,
        )}
        {...props}
      />
    </DropdownMenuPrimitive.Portal>
  );
}

function DropdownMenuGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
  return (
    <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
  );
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
  inset?: boolean;
  variant?: "default" | "destructive";
}) {
  return (
    <DropdownMenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    />
  );
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
  return (
    <DropdownMenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.CheckboxItem>
  );
}

function DropdownMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
  return (
    <DropdownMenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  );
}

function DropdownMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
  return (
    <DropdownMenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.RadioItem>
  );
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
  inset?: boolean;
}) {
  return (
    <DropdownMenuPrimitive.Label
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className,
      )}
      {...props}
    />
  );
}

function DropdownMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
  return (
    <DropdownMenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  );
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className,
      )}
      {...props}
    />
  );
}

function DropdownMenuSub({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
  return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />;
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
  inset?: boolean;
}) {
  return (
    <DropdownMenuPrimitive.SubTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8",
        className,
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto size-4" />
    </DropdownMenuPrimitive.SubTrigger>
  );
}

function DropdownMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
  return (
    <DropdownMenuPrimitive.SubContent
      data-slot="dropdown-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className,
      )}
      {...props}
    />
  );
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
};


================================================================================
--- FICHIER : ./src/components/ui/form.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label@2.1.2";
import { Slot } from "@radix-ui/react-slot@1.1.2";
import {
  Controller,
  FormProvider,
  useFormContext,
  useFormState,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from "react-hook-form@7.55.0";

import { cn } from "./utils";
import { Label } from "./label";

const Form = FormProvider;

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue,
);

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  );
};

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext);
  const itemContext = React.useContext(FormItemContext);
  const { getFieldState } = useFormContext();
  const formState = useFormState({ name: fieldContext.name });
  const fieldState = getFieldState(fieldContext.name, formState);

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>");
  }

  const { id } = itemContext;

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  };
};

type FormItemContextValue = {
  id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue,
);

function FormItem({ className, ...props }: React.ComponentProps<"div">) {
  const id = React.useId();

  return (
    <FormItemContext.Provider value={{ id }}>
      <div
        data-slot="form-item"
        className={cn("grid gap-2", className)}
        {...props}
      />
    </FormItemContext.Provider>
  );
}

function FormLabel({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  const { error, formItemId } = useFormField();

  return (
    <Label
      data-slot="form-label"
      data-error={!!error}
      className={cn("data-[error=true]:text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  );
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
  const { error, formItemId, formDescriptionId, formMessageId } =
    useFormField();

  return (
    <Slot
      data-slot="form-control"
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  );
}

function FormDescription({ className, ...props }: React.ComponentProps<"p">) {
  const { formDescriptionId } = useFormField();

  return (
    <p
      data-slot="form-description"
      id={formDescriptionId}
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  );
}

function FormMessage({ className, ...props }: React.ComponentProps<"p">) {
  const { error, formMessageId } = useFormField();
  const body = error ? String(error?.message ?? "") : props.children;

  if (!body) {
    return null;
  }

  return (
    <p
      data-slot="form-message"
      id={formMessageId}
      className={cn("text-destructive text-sm", className)}
      {...props}
    >
      {body}
    </p>
  );
}

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
};


================================================================================
--- FICHIER : ./src/components/ui/hover-card.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as HoverCardPrimitive from "@radix-ui/react-hover-card@1.1.6";

import { cn } from "./utils";

function HoverCard({
  ...props
}: React.ComponentProps<typeof HoverCardPrimitive.Root>) {
  return <HoverCardPrimitive.Root data-slot="hover-card" {...props} />;
}

function HoverCardTrigger({
  ...props
}: React.ComponentProps<typeof HoverCardPrimitive.Trigger>) {
  return (
    <HoverCardPrimitive.Trigger data-slot="hover-card-trigger" {...props} />
  );
}

function HoverCardContent({
  className,
  align = "center",
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof HoverCardPrimitive.Content>) {
  return (
    <HoverCardPrimitive.Portal data-slot="hover-card-portal">
      <HoverCardPrimitive.Content
        data-slot="hover-card-content"
        align={align}
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",
          className,
        )}
        {...props}
      />
    </HoverCardPrimitive.Portal>
  );
}

export { HoverCard, HoverCardTrigger, HoverCardContent };


================================================================================
--- FICHIER : ./src/components/ui/input-otp.tsx ---
================================================================================

"use client";

import * as React from "react";
import { OTPInput, OTPInputContext } from "input-otp@1.4.2";
import { MinusIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function InputOTP({
  className,
  containerClassName,
  ...props
}: React.ComponentProps<typeof OTPInput> & {
  containerClassName?: string;
}) {
  return (
    <OTPInput
      data-slot="input-otp"
      containerClassName={cn(
        "flex items-center gap-2 has-disabled:opacity-50",
        containerClassName,
      )}
      className={cn("disabled:cursor-not-allowed", className)}
      {...props}
    />
  );
}

function InputOTPGroup({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="input-otp-group"
      className={cn("flex items-center gap-1", className)}
      {...props}
    />
  );
}

function InputOTPSlot({
  index,
  className,
  ...props
}: React.ComponentProps<"div"> & {
  index: number;
}) {
  const inputOTPContext = React.useContext(OTPInputContext);
  const { char, hasFakeCaret, isActive } = inputOTPContext?.slots[index] ?? {};

  return (
    <div
      data-slot="input-otp-slot"
      data-active={isActive}
      className={cn(
        "data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm bg-input-background transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",
        className,
      )}
      {...props}
    >
      {char}
      {hasFakeCaret && (
        <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
          <div className="animate-caret-blink bg-foreground h-4 w-px duration-1000" />
        </div>
      )}
    </div>
  );
}

function InputOTPSeparator({ ...props }: React.ComponentProps<"div">) {
  return (
    <div data-slot="input-otp-separator" role="separator" {...props}>
      <MinusIcon />
    </div>
  );
}

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };


================================================================================
--- FICHIER : ./src/components/ui/input.tsx ---
================================================================================

import * as React from "react";

import { cn } from "./utils";

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className,
      )}
      {...props}
    />
  );
}

export { Input };


================================================================================
--- FICHIER : ./src/components/ui/label.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label@2.1.2";

import { cn } from "./utils";

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className,
      )}
      {...props}
    />
  );
}

export { Label };


================================================================================
--- FICHIER : ./src/components/ui/menubar.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as MenubarPrimitive from "@radix-ui/react-menubar@1.1.6";
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function Menubar({
  className,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Root>) {
  return (
    <MenubarPrimitive.Root
      data-slot="menubar"
      className={cn(
        "bg-background flex h-9 items-center gap-1 rounded-md border p-1 shadow-xs",
        className,
      )}
      {...props}
    />
  );
}

function MenubarMenu({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {
  return <MenubarPrimitive.Menu data-slot="menubar-menu" {...props} />;
}

function MenubarGroup({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Group>) {
  return <MenubarPrimitive.Group data-slot="menubar-group" {...props} />;
}

function MenubarPortal({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {
  return <MenubarPrimitive.Portal data-slot="menubar-portal" {...props} />;
}

function MenubarRadioGroup({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {
  return (
    <MenubarPrimitive.RadioGroup data-slot="menubar-radio-group" {...props} />
  );
}

function MenubarTrigger({
  className,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Trigger>) {
  return (
    <MenubarPrimitive.Trigger
      data-slot="menubar-trigger"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none",
        className,
      )}
      {...props}
    />
  );
}

function MenubarContent({
  className,
  align = "start",
  alignOffset = -4,
  sideOffset = 8,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Content>) {
  return (
    <MenubarPortal>
      <MenubarPrimitive.Content
        data-slot="menubar-content"
        align={align}
        alignOffset={alignOffset}
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[12rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-md",
          className,
        )}
        {...props}
      />
    </MenubarPortal>
  );
}

function MenubarItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Item> & {
  inset?: boolean;
  variant?: "default" | "destructive";
}) {
  return (
    <MenubarPrimitive.Item
      data-slot="menubar-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    />
  );
}

function MenubarCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.CheckboxItem>) {
  return (
    <MenubarPrimitive.CheckboxItem
      data-slot="menubar-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <MenubarPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </MenubarPrimitive.ItemIndicator>
      </span>
      {children}
    </MenubarPrimitive.CheckboxItem>
  );
}

function MenubarRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.RadioItem>) {
  return (
    <MenubarPrimitive.RadioItem
      data-slot="menubar-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <MenubarPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </MenubarPrimitive.ItemIndicator>
      </span>
      {children}
    </MenubarPrimitive.RadioItem>
  );
}

function MenubarLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Label> & {
  inset?: boolean;
}) {
  return (
    <MenubarPrimitive.Label
      data-slot="menubar-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className,
      )}
      {...props}
    />
  );
}

function MenubarSeparator({
  className,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Separator>) {
  return (
    <MenubarPrimitive.Separator
      data-slot="menubar-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  );
}

function MenubarShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="menubar-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className,
      )}
      {...props}
    />
  );
}

function MenubarSub({
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {
  return <MenubarPrimitive.Sub data-slot="menubar-sub" {...props} />;
}

function MenubarSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.SubTrigger> & {
  inset?: boolean;
}) {
  return (
    <MenubarPrimitive.SubTrigger
      data-slot="menubar-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-none select-none data-[inset]:pl-8",
        className,
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto h-4 w-4" />
    </MenubarPrimitive.SubTrigger>
  );
}

function MenubarSubContent({
  className,
  ...props
}: React.ComponentProps<typeof MenubarPrimitive.SubContent>) {
  return (
    <MenubarPrimitive.SubContent
      data-slot="menubar-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className,
      )}
      {...props}
    />
  );
}

export {
  Menubar,
  MenubarPortal,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarGroup,
  MenubarSeparator,
  MenubarLabel,
  MenubarItem,
  MenubarShortcut,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarSub,
  MenubarSubTrigger,
  MenubarSubContent,
};


================================================================================
--- FICHIER : ./src/components/ui/navigation-menu.tsx ---
================================================================================

import * as React from "react";
import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu@1.2.5";
import { cva } from "class-variance-authority@0.7.1";
import { ChevronDownIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function NavigationMenu({
  className,
  children,
  viewport = true,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Root> & {
  viewport?: boolean;
}) {
  return (
    <NavigationMenuPrimitive.Root
      data-slot="navigation-menu"
      data-viewport={viewport}
      className={cn(
        "group/navigation-menu relative flex max-w-max flex-1 items-center justify-center",
        className,
      )}
      {...props}
    >
      {children}
      {viewport && <NavigationMenuViewport />}
    </NavigationMenuPrimitive.Root>
  );
}

function NavigationMenuList({
  className,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.List>) {
  return (
    <NavigationMenuPrimitive.List
      data-slot="navigation-menu-list"
      className={cn(
        "group flex flex-1 list-none items-center justify-center gap-1",
        className,
      )}
      {...props}
    />
  );
}

function NavigationMenuItem({
  className,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Item>) {
  return (
    <NavigationMenuPrimitive.Item
      data-slot="navigation-menu-item"
      className={cn("relative", className)}
      {...props}
    />
  );
}

const navigationMenuTriggerStyle = cva(
  "group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=open]:hover:bg-accent data-[state=open]:text-accent-foreground data-[state=open]:focus:bg-accent data-[state=open]:bg-accent/50 focus-visible:ring-ring/50 outline-none transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1",
);

function NavigationMenuTrigger({
  className,
  children,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Trigger>) {
  return (
    <NavigationMenuPrimitive.Trigger
      data-slot="navigation-menu-trigger"
      className={cn(navigationMenuTriggerStyle(), "group", className)}
      {...props}
    >
      {children}{" "}
      <ChevronDownIcon
        className="relative top-[1px] ml-1 size-3 transition duration-300 group-data-[state=open]:rotate-180"
        aria-hidden="true"
      />
    </NavigationMenuPrimitive.Trigger>
  );
}

function NavigationMenuContent({
  className,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Content>) {
  return (
    <NavigationMenuPrimitive.Content
      data-slot="navigation-menu-content"
      className={cn(
        "data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 top-0 left-0 w-full p-2 pr-2.5 md:absolute md:w-auto",
        "group-data-[viewport=false]/navigation-menu:bg-popover group-data-[viewport=false]/navigation-menu:text-popover-foreground group-data-[viewport=false]/navigation-menu:data-[state=open]:animate-in group-data-[viewport=false]/navigation-menu:data-[state=closed]:animate-out group-data-[viewport=false]/navigation-menu:data-[state=closed]:zoom-out-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:zoom-in-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:fade-in-0 group-data-[viewport=false]/navigation-menu:data-[state=closed]:fade-out-0 group-data-[viewport=false]/navigation-menu:top-full group-data-[viewport=false]/navigation-menu:mt-1.5 group-data-[viewport=false]/navigation-menu:overflow-hidden group-data-[viewport=false]/navigation-menu:rounded-md group-data-[viewport=false]/navigation-menu:border group-data-[viewport=false]/navigation-menu:shadow group-data-[viewport=false]/navigation-menu:duration-200 **:data-[slot=navigation-menu-link]:focus:ring-0 **:data-[slot=navigation-menu-link]:focus:outline-none",
        className,
      )}
      {...props}
    />
  );
}

function NavigationMenuViewport({
  className,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Viewport>) {
  return (
    <div
      className={cn(
        "absolute top-full left-0 isolate z-50 flex justify-center",
      )}
    >
      <NavigationMenuPrimitive.Viewport
        data-slot="navigation-menu-viewport"
        className={cn(
          "origin-top-center bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border shadow md:w-[var(--radix-navigation-menu-viewport-width)]",
          className,
        )}
        {...props}
      />
    </div>
  );
}

function NavigationMenuLink({
  className,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Link>) {
  return (
    <NavigationMenuPrimitive.Link
      data-slot="navigation-menu-link"
      className={cn(
        "data-[active=true]:focus:bg-accent data-[active=true]:hover:bg-accent data-[active=true]:bg-accent/50 data-[active=true]:text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus-visible:ring-ring/50 [&_svg:not([class*='text-'])]:text-muted-foreground flex flex-col gap-1 rounded-sm p-2 text-sm transition-all outline-none focus-visible:ring-[3px] focus-visible:outline-1 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    />
  );
}

function NavigationMenuIndicator({
  className,
  ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Indicator>) {
  return (
    <NavigationMenuPrimitive.Indicator
      data-slot="navigation-menu-indicator"
      className={cn(
        "data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden",
        className,
      )}
      {...props}
    >
      <div className="bg-border relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm shadow-md" />
    </NavigationMenuPrimitive.Indicator>
  );
}

export {
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
  navigationMenuTriggerStyle,
};


================================================================================
--- FICHIER : ./src/components/ui/pagination.tsx ---
================================================================================

import * as React from "react";
import {
  ChevronLeftIcon,
  ChevronRightIcon,
  MoreHorizontalIcon,
} from "lucide-react@0.487.0";

import { cn } from "./utils";
import { Button, buttonVariants } from "./button";

function Pagination({ className, ...props }: React.ComponentProps<"nav">) {
  return (
    <nav
      role="navigation"
      aria-label="pagination"
      data-slot="pagination"
      className={cn("mx-auto flex w-full justify-center", className)}
      {...props}
    />
  );
}

function PaginationContent({
  className,
  ...props
}: React.ComponentProps<"ul">) {
  return (
    <ul
      data-slot="pagination-content"
      className={cn("flex flex-row items-center gap-1", className)}
      {...props}
    />
  );
}

function PaginationItem({ ...props }: React.ComponentProps<"li">) {
  return <li data-slot="pagination-item" {...props} />;
}

type PaginationLinkProps = {
  isActive?: boolean;
} & Pick<React.ComponentProps<typeof Button>, "size"> &
  React.ComponentProps<"a">;

function PaginationLink({
  className,
  isActive,
  size = "icon",
  ...props
}: PaginationLinkProps) {
  return (
    <a
      aria-current={isActive ? "page" : undefined}
      data-slot="pagination-link"
      data-active={isActive}
      className={cn(
        buttonVariants({
          variant: isActive ? "outline" : "ghost",
          size,
        }),
        className,
      )}
      {...props}
    />
  );
}

function PaginationPrevious({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) {
  return (
    <PaginationLink
      aria-label="Go to previous page"
      size="default"
      className={cn("gap-1 px-2.5 sm:pl-2.5", className)}
      {...props}
    >
      <ChevronLeftIcon />
      <span className="hidden sm:block">Previous</span>
    </PaginationLink>
  );
}

function PaginationNext({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) {
  return (
    <PaginationLink
      aria-label="Go to next page"
      size="default"
      className={cn("gap-1 px-2.5 sm:pr-2.5", className)}
      {...props}
    >
      <span className="hidden sm:block">Next</span>
      <ChevronRightIcon />
    </PaginationLink>
  );
}

function PaginationEllipsis({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      aria-hidden
      data-slot="pagination-ellipsis"
      className={cn("flex size-9 items-center justify-center", className)}
      {...props}
    >
      <MoreHorizontalIcon className="size-4" />
      <span className="sr-only">More pages</span>
    </span>
  );
}

export {
  Pagination,
  PaginationContent,
  PaginationLink,
  PaginationItem,
  PaginationPrevious,
  PaginationNext,
  PaginationEllipsis,
};


================================================================================
--- FICHIER : ./src/components/ui/popover.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as PopoverPrimitive from "@radix-ui/react-popover@1.1.6";

import { cn } from "./utils";

function Popover({
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Root>) {
  return <PopoverPrimitive.Root data-slot="popover" {...props} />;
}

function PopoverTrigger({
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {
  return <PopoverPrimitive.Trigger data-slot="popover-trigger" {...props} />;
}

function PopoverContent({
  className,
  align = "center",
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Content>) {
  return (
    <PopoverPrimitive.Portal>
      <PopoverPrimitive.Content
        data-slot="popover-content"
        align={align}
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",
          className,
        )}
        {...props}
      />
    </PopoverPrimitive.Portal>
  );
}

function PopoverAnchor({
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {
  return <PopoverPrimitive.Anchor data-slot="popover-anchor" {...props} />;
}

export { Popover, PopoverTrigger, PopoverContent, PopoverAnchor };


================================================================================
--- FICHIER : ./src/components/ui/progress.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as ProgressPrimitive from "@radix-ui/react-progress@1.1.2";

import { cn } from "./utils";

function Progress({
  className,
  value,
  ...props
}: React.ComponentProps<typeof ProgressPrimitive.Root>) {
  return (
    <ProgressPrimitive.Root
      data-slot="progress"
      className={cn(
        "bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",
        className,
      )}
      {...props}
    >
      <ProgressPrimitive.Indicator
        data-slot="progress-indicator"
        className="bg-primary h-full w-full flex-1 transition-all"
        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
      />
    </ProgressPrimitive.Root>
  );
}

export { Progress };


================================================================================
--- FICHIER : ./src/components/ui/radio-group.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group@1.2.3";
import { CircleIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function RadioGroup({
  className,
  ...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Root>) {
  return (
    <RadioGroupPrimitive.Root
      data-slot="radio-group"
      className={cn("grid gap-3", className)}
      {...props}
    />
  );
}

function RadioGroupItem({
  className,
  ...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Item>) {
  return (
    <RadioGroupPrimitive.Item
      data-slot="radio-group-item"
      className={cn(
        "border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator
        data-slot="radio-group-indicator"
        className="relative flex items-center justify-center"
      >
        <CircleIcon className="fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
}

export { RadioGroup, RadioGroupItem };


================================================================================
--- FICHIER : ./src/components/ui/resizable.tsx ---
================================================================================

"use client";

import * as React from "react";
import { GripVerticalIcon } from "lucide-react@0.487.0";
import * as ResizablePrimitive from "react-resizable-panels@2.1.7";

import { cn } from "./utils";

function ResizablePanelGroup({
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) {
  return (
    <ResizablePrimitive.PanelGroup
      data-slot="resizable-panel-group"
      className={cn(
        "flex h-full w-full data-[panel-group-direction=vertical]:flex-col",
        className,
      )}
      {...props}
    />
  );
}

function ResizablePanel({
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.Panel>) {
  return <ResizablePrimitive.Panel data-slot="resizable-panel" {...props} />;
}

function ResizableHandle({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean;
}) {
  return (
    <ResizablePrimitive.PanelResizeHandle
      data-slot="resizable-handle"
      className={cn(
        "bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
        className,
      )}
      {...props}
    >
      {withHandle && (
        <div className="bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border">
          <GripVerticalIcon className="size-2.5" />
        </div>
      )}
    </ResizablePrimitive.PanelResizeHandle>
  );
}

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };


================================================================================
--- FICHIER : ./src/components/ui/scroll-area.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area@1.2.3";

import { cn } from "./utils";

function ScrollArea({
  className,
  children,
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {
  return (
    <ScrollAreaPrimitive.Root
      data-slot="scroll-area"
      className={cn("relative", className)}
      {...props}
    >
      <ScrollAreaPrimitive.Viewport
        data-slot="scroll-area-viewport"
        className="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"
      >
        {children}
      </ScrollAreaPrimitive.Viewport>
      <ScrollBar />
      <ScrollAreaPrimitive.Corner />
    </ScrollAreaPrimitive.Root>
  );
}

function ScrollBar({
  className,
  orientation = "vertical",
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {
  return (
    <ScrollAreaPrimitive.ScrollAreaScrollbar
      data-slot="scroll-area-scrollbar"
      orientation={orientation}
      className={cn(
        "flex touch-none p-px transition-colors select-none",
        orientation === "vertical" &&
          "h-full w-2.5 border-l border-l-transparent",
        orientation === "horizontal" &&
          "h-2.5 flex-col border-t border-t-transparent",
        className,
      )}
      {...props}
    >
      <ScrollAreaPrimitive.ScrollAreaThumb
        data-slot="scroll-area-thumb"
        className="bg-border relative flex-1 rounded-full"
      />
    </ScrollAreaPrimitive.ScrollAreaScrollbar>
  );
}

export { ScrollArea, ScrollBar };


================================================================================
--- FICHIER : ./src/components/ui/select.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as SelectPrimitive from "@radix-ui/react-select@2.1.6";
import {
  CheckIcon,
  ChevronDownIcon,
  ChevronUpIcon,
} from "lucide-react@0.487.0";

import { cn } from "./utils";

function Select({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
  return <SelectPrimitive.Root data-slot="select" {...props} />;
}

function SelectGroup({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
  return <SelectPrimitive.Group data-slot="select-group" {...props} />;
}

function SelectValue({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
  return <SelectPrimitive.Value data-slot="select-value" {...props} />;
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
  size?: "sm" | "default";
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon asChild>
        <ChevronDownIcon className="size-4 opacity-50" />
      </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
  );
}

function SelectContent({
  className,
  children,
  position = "popper",
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Content
        data-slot="select-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto scrollbar-visible rounded-md border shadow-md",
          position === "popper" &&
            "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
          className,
        )}
        position={position}
        {...props}
      >
        <SelectScrollUpButton />
        <SelectPrimitive.Viewport
          className={cn(
            "p-1",
            position === "popper" &&
              "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1",
          )}
        >
          {children}
        </SelectPrimitive.Viewport>
        <SelectScrollDownButton />
      </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
  );
}

function SelectLabel({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
  return (
    <SelectPrimitive.Label
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  );
}

function SelectItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
        className,
      )}
      {...props}
    >
      <span className="absolute right-2 flex size-3.5 items-center justify-center">
        <SelectPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </SelectPrimitive.ItemIndicator>
      </span>
      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
  );
}

function SelectSeparator({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
      {...props}
    />
  );
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
  return (
    <SelectPrimitive.ScrollUpButton
      data-slot="select-scroll-up-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className,
      )}
      {...props}
    >
      <ChevronUpIcon className="size-4" />
    </SelectPrimitive.ScrollUpButton>
  );
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
  return (
    <SelectPrimitive.ScrollDownButton
      data-slot="select-scroll-down-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className,
      )}
      {...props}
    >
      <ChevronDownIcon className="size-4" />
    </SelectPrimitive.ScrollDownButton>
  );
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
};


================================================================================
--- FICHIER : ./src/components/ui/separator.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as SeparatorPrimitive from "@radix-ui/react-separator@1.1.2";

import { cn } from "./utils";

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator-root"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className,
      )}
      {...props}
    />
  );
}

export { Separator };


================================================================================
--- FICHIER : ./src/components/ui/sheet.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as SheetPrimitive from "@radix-ui/react-dialog@1.1.6";
import { XIcon } from "lucide-react@0.487.0";

import { cn } from "./utils";

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
  return <SheetPrimitive.Root data-slot="sheet" {...props} />;
}

function SheetTrigger({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
  return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />;
}

function SheetClose({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
  return <SheetPrimitive.Close data-slot="sheet-close" {...props} />;
}

function SheetPortal({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
  return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />;
}

function SheetOverlay({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
  return (
    <SheetPrimitive.Overlay
      data-slot="sheet-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className,
      )}
      {...props}
    />
  );
}

function SheetContent({
  className,
  children,
  side = "right",
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
  side?: "top" | "right" | "bottom" | "left";
}) {
  return (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content
        data-slot="sheet-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
          side === "right" &&
            "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
          side === "left" &&
            "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
          side === "top" &&
            "data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
          side === "bottom" &&
            "data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
          className,
        )}
        {...props}
      >
        {children}
        <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
          <XIcon className="size-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  );
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  );
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  );
}

function SheetTitle({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
  return (
    <SheetPrimitive.Title
      data-slot="sheet-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  );
}

function SheetDescription({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
  return (
    <SheetPrimitive.Description
      data-slot="sheet-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  );
}

export {
  Sheet,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
};


================================================================================
--- FICHIER : ./src/components/ui/sidebar.tsx ---
================================================================================

"use client";

import * as React from "react";
import { Slot } from "@radix-ui/react-slot@1.1.2";
import { VariantProps, cva } from "class-variance-authority@0.7.1";
import { PanelLeftIcon } from "lucide-react@0.487.0";

import { useIsMobile } from "./use-mobile";
import { cn } from "./utils";
import { Button } from "./button";
import { Input } from "./input";
import { Separator } from "./separator";
import {
  Sheet,
  SheetContent,
  SheetDescription,
  SheetHeader,
  SheetTitle,
} from "./sheet";
import { Skeleton } from "./skeleton";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "./tooltip";

const SIDEBAR_COOKIE_NAME = "sidebar_state";
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = "16rem";
const SIDEBAR_WIDTH_MOBILE = "18rem";
const SIDEBAR_WIDTH_ICON = "3rem";
const SIDEBAR_KEYBOARD_SHORTCUT = "b";

type SidebarContextProps = {
  state: "expanded" | "collapsed";
  open: boolean;
  setOpen: (open: boolean) => void;
  openMobile: boolean;
  setOpenMobile: (open: boolean) => void;
  isMobile: boolean;
  toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContextProps | null>(null);

function useSidebar() {
  const context = React.useContext(SidebarContext);
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.");
  }

  return context;
}

function SidebarProvider({
  defaultOpen = true,
  open: openProp,
  onOpenChange: setOpenProp,
  className,
  style,
  children,
  ...props
}: React.ComponentProps<"div"> & {
  defaultOpen?: boolean;
  open?: boolean;
  onOpenChange?: (open: boolean) => void;
}) {
  const isMobile = useIsMobile();
  const [openMobile, setOpenMobile] = React.useState(false);

  // This is the internal state of the sidebar.
  // We use openProp and setOpenProp for control from outside the component.
  const [_open, _setOpen] = React.useState(defaultOpen);
  const open = openProp ?? _open;
  const setOpen = React.useCallback(
    (value: boolean | ((value: boolean) => boolean)) => {
      const openState = typeof value === "function" ? value(open) : value;
      if (setOpenProp) {
        setOpenProp(openState);
      } else {
        _setOpen(openState);
      }

      // This sets the cookie to keep the sidebar state.
      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
    },
    [setOpenProp, open],
  );

  // Helper to toggle the sidebar.
  const toggleSidebar = React.useCallback(() => {
    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
  }, [isMobile, setOpen, setOpenMobile]);

  // Adds a keyboard shortcut to toggle the sidebar.
  React.useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (
        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
        (event.metaKey || event.ctrlKey)
      ) {
        event.preventDefault();
        toggleSidebar();
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [toggleSidebar]);

  // We add a state so that we can do data-state="expanded" or "collapsed".
  // This makes it easier to style the sidebar with Tailwind classes.
  const state = open ? "expanded" : "collapsed";

  const contextValue = React.useMemo<SidebarContextProps>(
    () => ({
      state,
      open,
      setOpen,
      isMobile,
      openMobile,
      setOpenMobile,
      toggleSidebar,
    }),
    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar],
  );

  return (
    <SidebarContext.Provider value={contextValue}>
      <TooltipProvider delayDuration={0}>
        <div
          data-slot="sidebar-wrapper"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH,
              "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
              ...style,
            } as React.CSSProperties
          }
          className={cn(
            "group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",
            className,
          )}
          {...props}
        >
          {children}
        </div>
      </TooltipProvider>
    </SidebarContext.Provider>
  );
}

function Sidebar({
  side = "left",
  variant = "sidebar",
  collapsible = "offcanvas",
  className,
  children,
  ...props
}: React.ComponentProps<"div"> & {
  side?: "left" | "right";
  variant?: "sidebar" | "floating" | "inset";
  collapsible?: "offcanvas" | "icon" | "none";
}) {
  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

  if (collapsible === "none") {
    return (
      <div
        data-slot="sidebar"
        className={cn(
          "bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",
          className,
        )}
        {...props}
      >
        {children}
      </div>
    );
  }

  if (isMobile) {
    return (
      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
        <SheetContent
          data-sidebar="sidebar"
          data-slot="sidebar"
          data-mobile="true"
          className="bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
            } as React.CSSProperties
          }
          side={side}
        >
          <SheetHeader className="sr-only">
            <SheetTitle>Sidebar</SheetTitle>
            <SheetDescription>Displays the mobile sidebar.</SheetDescription>
          </SheetHeader>
          <div className="flex h-full w-full flex-col">{children}</div>
        </SheetContent>
      </Sheet>
    );
  }

  return (
    <div
      className="group peer text-sidebar-foreground hidden md:block"
      data-state={state}
      data-collapsible={state === "collapsed" ? collapsible : ""}
      data-variant={variant}
      data-side={side}
      data-slot="sidebar"
    >
      {/* This is what handles the sidebar gap on desktop */}
      <div
        data-slot="sidebar-gap"
        className={cn(
          "relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear",
          "group-data-[collapsible=offcanvas]:w-0",
          "group-data-[side=right]:rotate-180",
          variant === "floating" || variant === "inset"
            ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]"
            : "group-data-[collapsible=icon]:w-(--sidebar-width-icon)",
        )}
      />
      <div
        data-slot="sidebar-container"
        className={cn(
          "fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",
          side === "left"
            ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
            : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
          // Adjust the padding for floating and inset variants.
          variant === "floating" || variant === "inset"
            ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]"
            : "group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",
          className,
        )}
        {...props}
      >
        <div
          data-sidebar="sidebar"
          data-slot="sidebar-inner"
          className="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"
        >
          {children}
        </div>
      </div>
    </div>
  );
}

function SidebarTrigger({
  className,
  onClick,
  ...props
}: React.ComponentProps<typeof Button>) {
  const { toggleSidebar } = useSidebar();

  return (
    <Button
      data-sidebar="trigger"
      data-slot="sidebar-trigger"
      variant="ghost"
      size="icon"
      className={cn("size-7", className)}
      onClick={(event) => {
        onClick?.(event);
        toggleSidebar();
      }}
      {...props}
    >
      <PanelLeftIcon />
      <span className="sr-only">Toggle Sidebar</span>
    </Button>
  );
}

function SidebarRail({ className, ...props }: React.ComponentProps<"button">) {
  const { toggleSidebar } = useSidebar();

  return (
    <button
      data-sidebar="rail"
      data-slot="sidebar-rail"
      aria-label="Toggle Sidebar"
      tabIndex={-1}
      onClick={toggleSidebar}
      title="Toggle Sidebar"
      className={cn(
        "hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex",
        "in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize",
        "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
        "hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full",
        "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
        "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
        className,
      )}
      {...props}
    />
  );
}

function SidebarInset({ className, ...props }: React.ComponentProps<"main">) {
  return (
    <main
      data-slot="sidebar-inset"
      className={cn(
        "bg-background relative flex w-full flex-1 flex-col",
        "md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",
        className,
      )}
      {...props}
    />
  );
}

function SidebarInput({
  className,
  ...props
}: React.ComponentProps<typeof Input>) {
  return (
    <Input
      data-slot="sidebar-input"
      data-sidebar="input"
      className={cn("bg-background h-8 w-full shadow-none", className)}
      {...props}
    />
  );
}

function SidebarHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-header"
      data-sidebar="header"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  );
}

function SidebarFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-footer"
      data-sidebar="footer"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  );
}

function SidebarSeparator({
  className,
  ...props
}: React.ComponentProps<typeof Separator>) {
  return (
    <Separator
      data-slot="sidebar-separator"
      data-sidebar="separator"
      className={cn("bg-sidebar-border mx-2 w-auto", className)}
      {...props}
    />
  );
}

function SidebarContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-content"
      data-sidebar="content"
      className={cn(
        "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
        className,
      )}
      {...props}
    />
  );
}

function SidebarGroup({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-group"
      data-sidebar="group"
      className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
      {...props}
    />
  );
}

function SidebarGroupLabel({
  className,
  asChild = false,
  ...props
}: React.ComponentProps<"div"> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "div";

  return (
    <Comp
      data-slot="sidebar-group-label"
      data-sidebar="group-label"
      className={cn(
        "text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
        className,
      )}
      {...props}
    />
  );
}

function SidebarGroupAction({
  className,
  asChild = false,
  ...props
}: React.ComponentProps<"button"> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "button";

  return (
    <Comp
      data-slot="sidebar-group-action"
      data-sidebar="group-action"
      className={cn(
        "text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 md:after:hidden",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  );
}

function SidebarGroupContent({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-group-content"
      data-sidebar="group-content"
      className={cn("w-full text-sm", className)}
      {...props}
    />
  );
}

function SidebarMenu({ className, ...props }: React.ComponentProps<"ul">) {
  return (
    <ul
      data-slot="sidebar-menu"
      data-sidebar="menu"
      className={cn("flex w-full min-w-0 flex-col gap-1", className)}
      {...props}
    />
  );
}

function SidebarMenuItem({ className, ...props }: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="sidebar-menu-item"
      data-sidebar="menu-item"
      className={cn("group/menu-item relative", className)}
      {...props}
    />
  );
}

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:p-0!",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

function SidebarMenuButton({
  asChild = false,
  isActive = false,
  variant = "default",
  size = "default",
  tooltip,
  className,
  ...props
}: React.ComponentProps<"button"> & {
  asChild?: boolean;
  isActive?: boolean;
  tooltip?: string | React.ComponentProps<typeof TooltipContent>;
} & VariantProps<typeof sidebarMenuButtonVariants>) {
  const Comp = asChild ? Slot : "button";
  const { isMobile, state } = useSidebar();

  const button = (
    <Comp
      data-slot="sidebar-menu-button"
      data-sidebar="menu-button"
      data-size={size}
      data-active={isActive}
      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
      {...props}
    />
  );

  if (!tooltip) {
    return button;
  }

  if (typeof tooltip === "string") {
    tooltip = {
      children: tooltip,
    };
  }

  return (
    <Tooltip>
      <TooltipTrigger asChild>{button}</TooltipTrigger>
      <TooltipContent
        side="right"
        align="center"
        hidden={state !== "collapsed" || isMobile}
        {...tooltip}
      />
    </Tooltip>
  );
}

function SidebarMenuAction({
  className,
  asChild = false,
  showOnHover = false,
  ...props
}: React.ComponentProps<"button"> & {
  asChild?: boolean;
  showOnHover?: boolean;
}) {
  const Comp = asChild ? Slot : "button";

  return (
    <Comp
      data-slot="sidebar-menu-action"
      data-sidebar="menu-action"
      className={cn(
        "text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 md:after:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0",
        className,
      )}
      {...props}
    />
  );
}

function SidebarMenuBadge({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-menu-badge"
      data-sidebar="menu-badge"
      className={cn(
        "text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none",
        "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  );
}

function SidebarMenuSkeleton({
  className,
  showIcon = false,
  ...props
}: React.ComponentProps<"div"> & {
  showIcon?: boolean;
}) {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`;
  }, []);

  return (
    <div
      data-slot="sidebar-menu-skeleton"
      data-sidebar="menu-skeleton"
      className={cn("flex h-8 items-center gap-2 rounded-md px-2", className)}
      {...props}
    >
      {showIcon && (
        <Skeleton
          className="size-4 rounded-md"
          data-sidebar="menu-skeleton-icon"
        />
      )}
      <Skeleton
        className="h-4 max-w-(--skeleton-width) flex-1"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  );
}

function SidebarMenuSub({ className, ...props }: React.ComponentProps<"ul">) {
  return (
    <ul
      data-slot="sidebar-menu-sub"
      data-sidebar="menu-sub"
      className={cn(
        "border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  );
}

function SidebarMenuSubItem({
  className,
  ...props
}: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="sidebar-menu-sub-item"
      data-sidebar="menu-sub-item"
      className={cn("group/menu-sub-item relative", className)}
      {...props}
    />
  );
}

function SidebarMenuSubButton({
  asChild = false,
  size = "md",
  isActive = false,
  className,
  ...props
}: React.ComponentProps<"a"> & {
  asChild?: boolean;
  size?: "sm" | "md";
  isActive?: boolean;
}) {
  const Comp = asChild ? Slot : "a";

  return (
    <Comp
      data-slot="sidebar-menu-sub-button"
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className,
      )}
      {...props}
    />
  );
}

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
};


================================================================================
--- FICHIER : ./src/components/ui/skeleton.tsx ---
================================================================================

import { cn } from "./utils";

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="skeleton"
      className={cn("bg-accent animate-pulse rounded-md", className)}
      {...props}
    />
  );
}

export { Skeleton };


================================================================================
--- FICHIER : ./src/components/ui/slider.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as SliderPrimitive from "@radix-ui/react-slider@1.2.3";

import { cn } from "./utils";

function Slider({
  className,
  defaultValue,
  value,
  min = 0,
  max = 100,
  ...props
}: React.ComponentProps<typeof SliderPrimitive.Root>) {
  const _values = React.useMemo(
    () =>
      Array.isArray(value)
        ? value
        : Array.isArray(defaultValue)
          ? defaultValue
          : [min, max],
    [value, defaultValue, min, max],
  );

  return (
    <SliderPrimitive.Root
      data-slot="slider"
      defaultValue={defaultValue}
      value={value}
      min={min}
      max={max}
      className={cn(
        "relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",
        className,
      )}
      {...props}
    >
      <SliderPrimitive.Track
        data-slot="slider-track"
        className={cn(
          "bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5",
        )}
      >
        <SliderPrimitive.Range
          data-slot="slider-range"
          className={cn(
            "bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full",
          )}
        />
      </SliderPrimitive.Track>
      {Array.from({ length: _values.length }, (_, index) => (
        <SliderPrimitive.Thumb
          data-slot="slider-thumb"
          key={index}
          className="border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"
        />
      ))}
    </SliderPrimitive.Root>
  );
}

export { Slider };


================================================================================
--- FICHIER : ./src/components/ui/sonner.tsx ---
================================================================================

"use client";

import { useTheme } from "next-themes@0.4.6";
import { Toaster as Sonner, ToasterProps } from "sonner@2.0.3";

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme();

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      style={
        {
          "--normal-bg": "var(--popover)",
          "--normal-text": "var(--popover-foreground)",
          "--normal-border": "var(--border)",
        } as React.CSSProperties
      }
      {...props}
    />
  );
};

export { Toaster };


================================================================================
--- FICHIER : ./src/components/ui/switch.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as SwitchPrimitive from "@radix-ui/react-switch@1.1.3";

import { cn } from "./utils";

function Switch({
  className,
  ...props
}: React.ComponentProps<typeof SwitchPrimitive.Root>) {
  return (
    <SwitchPrimitive.Root
      data-slot="switch"
      className={cn(
        "peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    >
      <SwitchPrimitive.Thumb
        data-slot="switch-thumb"
        className={cn(
          "bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0",
        )}
      />
    </SwitchPrimitive.Root>
  );
}

export { Switch };


================================================================================
--- FICHIER : ./src/components/ui/table.tsx ---
================================================================================

"use client";

import * as React from "react";

import { cn } from "./utils";

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto scrollbar-visible"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  );
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  );
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  );
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className,
      )}
      {...props}
    />
  );
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className,
      )}
      {...props}
    />
  );
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className,
      )}
      {...props}
    />
  );
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className,
      )}
      {...props}
    />
  );
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  );
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
};


================================================================================
--- FICHIER : ./src/components/ui/tabs.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as TabsPrimitive from "@radix-ui/react-tabs@1.1.3";

import { cn } from "./utils";

function Tabs({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Root>) {
  return (
    <TabsPrimitive.Root
      data-slot="tabs"
      className={cn("flex flex-col gap-2", className)}
      {...props}
    />
  );
}

function TabsList({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.List>) {
  return (
    <TabsPrimitive.List
      data-slot="tabs-list"
      className={cn(
        "bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",
        className,
      )}
      {...props}
    />
  );
}

function TabsTrigger({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
  return (
    <TabsPrimitive.Trigger
      data-slot="tabs-trigger"
      className={cn(
        "data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className,
      )}
      {...props}
    />
  );
}

function TabsContent({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Content>) {
  return (
    <TabsPrimitive.Content
      data-slot="tabs-content"
      className={cn("flex-1 outline-none", className)}
      {...props}
    />
  );
}

export { Tabs, TabsList, TabsTrigger, TabsContent };


================================================================================
--- FICHIER : ./src/components/ui/textarea.tsx ---
================================================================================

import * as React from "react";

import { cn } from "./utils";

function Textarea({ className, ...props }: React.ComponentProps<"textarea">) {
  return (
    <textarea
      data-slot="textarea"
      className={cn(
        "resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        className,
      )}
      {...props}
    />
  );
}

export { Textarea };


================================================================================
--- FICHIER : ./src/components/ui/toggle-group.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group@1.1.2";
import { type VariantProps } from "class-variance-authority@0.7.1";

import { cn } from "./utils";
import { toggleVariants } from "./toggle";

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants>
>({
  size: "default",
  variant: "default",
});

function ToggleGroup({
  className,
  variant,
  size,
  children,
  ...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Root> &
  VariantProps<typeof toggleVariants>) {
  return (
    <ToggleGroupPrimitive.Root
      data-slot="toggle-group"
      data-variant={variant}
      data-size={size}
      className={cn(
        "group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",
        className,
      )}
      {...props}
    >
      <ToggleGroupContext.Provider value={{ variant, size }}>
        {children}
      </ToggleGroupContext.Provider>
    </ToggleGroupPrimitive.Root>
  );
}

function ToggleGroupItem({
  className,
  children,
  variant,
  size,
  ...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Item> &
  VariantProps<typeof toggleVariants>) {
  const context = React.useContext(ToggleGroupContext);

  return (
    <ToggleGroupPrimitive.Item
      data-slot="toggle-group-item"
      data-variant={context.variant || variant}
      data-size={context.size || size}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        "min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",
        className,
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  );
}

export { ToggleGroup, ToggleGroupItem };


================================================================================
--- FICHIER : ./src/components/ui/toggle.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as TogglePrimitive from "@radix-ui/react-toggle@1.1.2";
import { cva, type VariantProps } from "class-variance-authority@0.7.1";

import { cn } from "./utils";

const toggleVariants = cva(
  "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline:
          "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-9 px-2 min-w-9",
        sm: "h-8 px-1.5 min-w-8",
        lg: "h-10 px-2.5 min-w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

function Toggle({
  className,
  variant,
  size,
  ...props
}: React.ComponentProps<typeof TogglePrimitive.Root> &
  VariantProps<typeof toggleVariants>) {
  return (
    <TogglePrimitive.Root
      data-slot="toggle"
      className={cn(toggleVariants({ variant, size, className }))}
      {...props}
    />
  );
}

export { Toggle, toggleVariants };


================================================================================
--- FICHIER : ./src/components/ui/tooltip.tsx ---
================================================================================

"use client";

import * as React from "react";
import * as TooltipPrimitive from "@radix-ui/react-tooltip@1.1.8";

import { cn } from "./utils";

function TooltipProvider({
  delayDuration = 0,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {
  return (
    <TooltipPrimitive.Provider
      data-slot="tooltip-provider"
      delayDuration={delayDuration}
      {...props}
    />
  );
}

function Tooltip({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Root>) {
  return (
    <TooltipProvider>
      <TooltipPrimitive.Root data-slot="tooltip" {...props} />
    </TooltipProvider>
  );
}

function TooltipTrigger({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {
  return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />;
}

function TooltipContent({
  className,
  sideOffset = 0,
  children,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Content>) {
  return (
    <TooltipPrimitive.Portal>
      <TooltipPrimitive.Content
        data-slot="tooltip-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",
          className,
        )}
        {...props}
      >
        {children}
        <TooltipPrimitive.Arrow className="bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]" />
      </TooltipPrimitive.Content>
    </TooltipPrimitive.Portal>
  );
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };


================================================================================
--- FICHIER : ./src/components/ui/use-mobile.ts ---
================================================================================

import * as React from "react";

const MOBILE_BREAKPOINT = 768;

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(
    undefined,
  );

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    };
    mql.addEventListener("change", onChange);
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
    return () => mql.removeEventListener("change", onChange);
  }, []);

  return !!isMobile;
}


================================================================================
--- FICHIER : ./src/components/ui/utils.ts ---
================================================================================

import { clsx, type ClassValue } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}


================================================================================
--- FICHIER : ./src/contexts/AuthContext.tsx ---
================================================================================

// src/contexts/AuthContext.tsx

import React, { createContext, useState, useContext, useEffect, ReactNode } from 'react';
// On importe les fonctions renommées pour éviter les conflits de noms
import { 
  User, 
  getCurrentUser, 
  loginUser as apiLogin, 
  registerUser as apiRegister 
} from '../utils/authAPI';
// CORRECTION : Les fonctions de token viennent de leur propre fichier, pas de apiClient.
import { getToken, saveToken, removeToken } from '../utils/tokenStorage'; // Assure-toi que ce fichier existe

// Interface simplifiée : plus besoin de 'token' ou 'error' ici.
interface AuthContextType {
  user: User | null;
  isLoading: boolean;
  login: (credentials: { emailOrPhone: string; password: string }) => Promise<void>;
  register: (userData: any) => Promise<void>;
  logout: () => void;
  // Les autres fonctions comme refreshUser et loginWithGoogle peuvent être ajoutées ici si besoin.
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export const AuthProvider = ({ children }: { children: ReactNode }) => {
  const [user, setUser] = useState<User | null>(null);
  // C'est le seul état de chargement dont nous avons besoin.
  const [isLoading, setIsLoading] = useState(true);

  // Ce `useEffect` s'exécute une seule fois au démarrage de l'application.
  useEffect(() => {
    const initializeAuth = async () => {
      const token = getToken(); // On récupère le token depuis le stockage.
      if (token) {
        try {
          // CORRECTION: getCurrentUser n'a plus besoin du token en argument.
          const userData = await getCurrentUser(); 
          setUser(userData);
        } catch (error) {
          // Si le token est invalide (expiré, etc.), on le supprime.
          console.error("Échec de l'authentification avec le token existant.", error);
          removeToken();
        }
      }
      setIsLoading(false); // On a fini le chargement initial.
    };
    
    initializeAuth();
  }, []); // Le tableau de dépendances vide signifie "exécuter une seule fois".

  const login = async (credentials: { emailOrPhone: string; password: string }) => {
    setIsLoading(true);
    try {
      const { user, token } = await apiLogin(credentials);
      saveToken(token); // 1. Sauvegarder le token
      setUser(user);    // 2. Mettre à jour l'utilisateur (ce qui déclenchera la redirection)
      // IMPORTANT : On ne met PAS setIsLoading(false) ici. La redirection va démonter
      // l'écran de connexion, donc c'est inutile et peut causer des bugs.
    } catch (error) {
      // Si une erreur survient (404, 401, etc.)...
      setIsLoading(false); // ... on arrête le chargement pour que l'utilisateur puisse réessayer.
      throw error;         // ... ET ON RELANCE L'ERREUR ! C'est crucial pour que le composant puisse la traiter.
    }
  };

  const register = async (userData: any) => {
    setIsLoading(true);
    try {
      const { user, token } = await apiRegister(userData);
      saveToken(token);
      setUser(user);
    } catch (error) {
      setIsLoading(false);
      throw error; // On applique le même modèle que pour le login.
    }
  };

  const logout = () => {
    setUser(null);
    removeToken();
    // Optionnel : rediriger vers la page de connexion si nécessaire.
    // window.location.href = '/login'; 
  };

  return (
    <AuthContext.Provider value={{ user, isLoading, login, register, logout }}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
};

================================================================================
--- FICHIER : ./src/services/apiClient.ts ---
================================================================================

import axios from 'axios';

/**
 * Récupère le token d'authentification depuis le stockage local.
 * Adaptez cette fonction si vous utilisez une autre méthode de stockage (ex: cookies).
 */
const getToken = (): string | null => {
  // Pour l'instant, on suppose que le token est stocké dans localStorage.
  // C'est simple pour le développement, mais pour la production,
  // une solution plus sécurisée comme les cookies httpOnly est recommandée.
  return localStorage.getItem('authToken');
};

/**
 * Crée une instance d'Axios pré-configurée pour notre API.
 * 
 * - Définit l'URL de base de l'API à partir des variables d'environnement.
 * - Ajoute automatiquement le token JWT à chaque requête sortante.
 * - Ajoute le header pour contourner la page d'avertissement de ngrok.
 */
const apiClient = axios.create({
  // --- CORRECTION APPLIQUÉE ICI ---
  // On utilise import.meta.env.VITE_... qui est la méthode de Vite pour lire les variables.
  baseURL: import.meta.env.VITE_API_BASE_URL,
  
  headers: {
    'ngrok-skip-browser-warning': 'true'
  }
});

// Intercepteur de requête : s'exécute AVANT chaque requête.
apiClient.interceptors.request.use(
  (config) => {
    const token = getToken();
    if (token) {
      // Si un token existe, on l'ajoute au header 'Authorization'.
      // Cela n'écrase pas les headers définis dans `create`.
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    // Gérer les erreurs de configuration de la requête.
    return Promise.reject(error);
  }
);

// Intercepteur de réponse : s'exécute APRÈS chaque réponse.
// Utile pour gérer globalement les erreurs d'authentification.
apiClient.interceptors.response.use(
  (response) => {
    // Si la réponse est un succès, on la retourne directement.
    return response;
  },
  (error) => {
    // Si on reçoit une erreur 401 (Non autorisé), cela signifie que le token
    // est invalide ou a expiré. On peut déconnecter l'utilisateur.
    if (error.response && error.response.status === 401) {
      // Supprimer le token invalide.
      localStorage.removeItem('authToken');
      // Rediriger vers la page de connexion.
      // window.location.href = '/login'; // Décommentez si vous voulez une redirection automatique.
      console.error("Authentication Error: Token is invalid or expired. Please log in again.");
    }
    // Propager l'erreur pour que le composant qui a fait l'appel puisse aussi la gérer.
    return Promise.reject(error);
  }
);


export default apiClient;

================================================================================
--- FICHIER : ./src/styles/globals.css ---
================================================================================

@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

@custom-variant dark (&:is(.dark *));

:root {
  --font-size: 16px;

  /* Africa Millions Color Palette - Dark Theme (Default) */
  --am-bg-main: #121212;
  --am-bg-card: #1c1c1e;
  --am-accent-gold: #ffd700;
  --am-accent-orange: #ff6b00;
  --am-accent-violet: #4f00bc;
  --am-text-primary: #eaeaea;
  --am-text-secondary: #8e8e93;
  --am-success: #34c759;
  --am-error: #ff3b30;
  --am-border: rgba(255, 255, 255, 0.08);

  /* Default shadcn variables - Dark Theme */
  --background: #121212;
  --foreground: #eaeaea;
  --card: #1c1c1e;
  --card-foreground: #eaeaea;
  --popover: #1c1c1e;
  --popover-foreground: #eaeaea;
  --primary: #ffd700;
  --primary-foreground: #121212;
  --secondary: #ff6b00;
  --secondary-foreground: #eaeaea;
  --muted: #1c1c1e;
  --muted-foreground: #8e8e93;
  --accent: #ffd700;
  --accent-foreground: #121212;
  --destructive: #ff3b30;
  --destructive-foreground: #eaeaea;
  --border: rgba(255, 255, 255, 0.08);
  --input: rgba(255, 255, 255, 0.08);
  --input-background: #1c1c1e;
  --switch-background: #8e8e93;
  --font-weight-medium: 500;
  --font-weight-normal: 400;
  --ring: #ffd700;
  --chart-1: #ffd700;
  --chart-2: #ff6b00;
  --chart-3: #4f00bc;
  --chart-4: #34c759;
  --chart-5: #ff3b30;
  --radius: 0.75rem;
  --sidebar: #1c1c1e;
  --sidebar-foreground: #eaeaea;
  --sidebar-primary: #ffd700;
  --sidebar-primary-foreground: #121212;
  --sidebar-accent: #1c1c1e;
  --sidebar-accent-foreground: #eaeaea;
  --sidebar-border: rgba(255, 255, 255, 0.08);
  --sidebar-ring: #ffd700;
}

/* Light Theme Variables */
.theme-light {
  /* Light Theme Color Palette - CORRIGÉ POUR LISIBILITÉ */
  --am-bg-main: #f4f4f7;
  --am-bg-card: #ffffff;
  --am-accent-gold: #ffd700;
  --am-accent-orange: #f97316; /* Orange vif pour meilleur contraste */
  --am-accent-violet: #4f00bc;
  --am-text-primary: #1a202c; /* Gris anthracite très foncé */
  --am-text-secondary: #718096; /* Gris moyen */
  --am-success: #34c759;
  --am-error: #ff3b30;
  --am-border: rgba(0, 0, 0, 0.1);

  /* Light Theme shadcn variables */
  --background: #f4f4f7;
  --foreground: #1a202c; /* Texte principal foncé */
  --card: #ffffff;
  --card-foreground: #1a202c; /* Texte des cartes foncé */
  --popover: #ffffff;
  --popover-foreground: #1a202c;
  --primary: #ffd700;
  --primary-foreground: #121212;
  --secondary: #f97316; /* Orange vif */
  --secondary-foreground: #ffffff;
  --muted: #f0f0f3;
  --muted-foreground: #718096; /* Gris moyen */
  --accent: #ffd700;
  --accent-foreground: #121212;
  --destructive: #ff3b30;
  --destructive-foreground: #ffffff;
  --border: rgba(0, 0, 0, 0.1);
  --input: rgba(0, 0, 0, 0.1);
  --input-background: #ffffff;
  --switch-background: #d1d1d6;
  --ring: #ffd700;
  --sidebar: #ffffff;
  --sidebar-foreground: #1a202c;
  --sidebar-primary: #ffd700;
  --sidebar-primary-foreground: #121212;
  --sidebar-accent: #f0f0f3;
  --sidebar-accent-foreground: #1a202c;
  --sidebar-border: rgba(0, 0, 0, 0.1);
  --sidebar-ring: #ffd700;
}

/* Amélioration visuelle pour les cartes en thème clair */
.theme-light .bg-card {
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
}

.dark {
  --background: #121212;
  --foreground: #eaeaea;
  --card: #1c1c1e;
  --card-foreground: #eaeaea;
  --popover: #1c1c1e;
  --popover-foreground: #eaeaea;
  --primary: #ffd700;
  --primary-foreground: #121212;
  --secondary: #ff6b00;
  --secondary-foreground: #eaeaea;
  --muted: #1c1c1e;
  --muted-foreground: #8e8e93;
  --accent: #ffd700;
  --accent-foreground: #121212;
  --destructive: #ff3b30;
  --destructive-foreground: #eaeaea;
  --border: rgba(255, 255, 255, 0.08);
  --input: rgba(255, 255, 255, 0.08);
  --ring: #ffd700;
  --font-weight-medium: 500;
  --font-weight-normal: 400;
  --chart-1: #ffd700;
  --chart-2: #ff6b00;
  --chart-3: #4f00bc;
  --chart-4: #34c759;
  --chart-5: #ff3b30;
  --sidebar: #1c1c1e;
  --sidebar-foreground: #eaeaea;
  --sidebar-primary: #ffd700;
  --sidebar-primary-foreground: #121212;
  --sidebar-accent: #1c1c1e;
  --sidebar-accent-foreground: #eaeaea;
  --sidebar-border: rgba(255, 255, 255, 0.08);
  --sidebar-ring: #ffd700;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-input-background: var(--input-background);
  --color-switch-background: var(--switch-background);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(
    --sidebar-primary-foreground
  );
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(
    --sidebar-accent-foreground
  );
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
    /* Transition fluide pour tous les éléments lors du changement de thème */
    transition: background-color 0.3s ease-in-out, 
                color 0.3s ease-in-out,
                border-color 0.3s ease-in-out,
                box-shadow 0.3s ease-in-out;
  }

  body {
    @apply bg-background text-foreground;
    font-family:
      "Inter",
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      Roboto,
      sans-serif;
  }

  /* --- CORRECTION DÉFINITIVE POUR LE DÉBORDEMENT HORIZONTAL --- */
  /* Ceci empêche la page entière, y compris le conteneur principal de l'app React (#root), 
     d'avoir une barre de défilement horizontale. */
  html,
  body,
  #root {
    overflow-x: hidden;
    width: 100%;
  }

  /* --- MASQUER LA BARRE DE DÉFILEMENT VERTICALE --- */
  /* Pour tous les navigateurs */
  * {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE et Edge */
  }

  /* Pour Chrome, Safari et Opera */
  *::-webkit-scrollbar {
    display: none;
  }
}

/**
 * Base typography. This is not applied to elements which have an ancestor with a Tailwind text class.
 */
@layer base {
  :where(
    :not(:has([class*=" text-"]), :not(:has([class^="text-"])))
  ) {
    h1 {
      font-size: var(--text-2xl);
      font-weight: 700;
      line-height: 1.3;
    }

    h2 {
      font-size: var(--text-xl);
      font-weight: 600;
      line-height: 1.4;
    }

    h3 {
      font-size: var(--text-lg);
      font-weight: 600;
      line-height: 1.4;
    }

    h4 {
      font-size: var(--text-base);
      font-weight: 600;
      line-height: 1.5;
    }

    p {
      font-size: var(--text-base);
      font-weight: var(--font-weight-normal);
      line-height: 1.6;
    }

    label {
      font-size: var(--text-base);
      font-weight: 500;
      line-height: 1.5;
    }

    button {
      font-size: var(--text-base);
      font-weight: 500;
      line-height: 1.5;
    }

    input {
      font-size: var(--text-base);
      font-weight: var(--font-weight-normal);
      line-height: 1.5;
    }
  }
}

html {
  font-size: var(--font-size);
}

/* Custom animations */
@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

.animate-shimmer {
  animation: shimmer 3s infinite linear;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(255, 215, 0, 0.1) 50%,
    transparent 100%
  );
  background-size: 1000px 100%;
}

/* Gradient backgrounds */
.gradient-orange-violet {
  background: linear-gradient(135deg, #ff6b00 0%, #4f00bc 100%);
}

/* Gradient adapté au thème clair - versions plus saturées/foncées */
.theme-light .gradient-orange-violet {
  background: linear-gradient(135deg, #e65100 0%, #3d0094 100%);
}

.gradient-gold {
  background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
}

/* Confetti pattern */
.confetti-bg {
  background-image:
    radial-gradient(
      circle at 20% 50%,
      rgba(255, 215, 0, 0.15) 1px,
      transparent 1px
    ),
    radial-gradient(
      circle at 60% 80%,
      rgba(255, 215, 0, 0.15) 1px,
      transparent 1px
    ),
    radial-gradient(
      circle at 80% 20%,
      rgba(255, 215, 0, 0.15) 1px,
      transparent 1px
    ),
    radial-gradient(
      circle at 40% 90%,
      rgba(255, 215, 0, 0.15) 1px,
      transparent 1px
    );
  background-size: 100px 100px;
}

/* Animation de pulsation pour les nouveaux gagnants */
@keyframes pulse-border {
  0%, 100% {
    border-color: rgba(255, 215, 0, 0.6);
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
  }
  50% {
    border-color: rgba(255, 215, 0, 1);
    box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
  }
}

.animate-pulse-border {
  animation: pulse-border 1s ease-in-out 2;
}

/* Style des onglets actifs avec indicateur or */
[data-slot="tabs-trigger"][data-state="active"] {
  color: #FFD700 !important;
  position: relative;
}

[data-slot="tabs-trigger"][data-state="active"]::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background-color: #FFD700;
  border-radius: 2px 2px 0 0;
}

/* Utilitaires responsive pour très petits écrans */
@layer utilities {
  /* Classes responsive pour écrans < 480px (xs) */
  @media (min-width: 480px) {
    .xs\:inline { display: inline; }
    .xs\:flex { display: flex; }
    .xs\:flex-row { flex-direction: row; }
    .xs\:items-center { align-items: center; }
    .xs\:gap-2 { gap: 0.5rem; }
    .xs\:gap-4 { gap: 1rem; }
    .xs\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .xs\:hidden { display: none; }
  }
  
  /* Empêcher le débordement de texte */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

/* Amélioration du défilement horizontal pour les onglets */
@layer base {
  /* Masquer la scrollbar mais garder le défilement */
  .overflow-x-auto {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE et Edge */
  }
  
  .overflow-x-auto::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
  
  /* Défilement fluide avec momentum sur mobile */
  .overflow-x-auto {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
  }
  
  /* Indicateur visuel de défilement (fade sur les bords) sur petits écrans */
  @media (max-width: 640px) {
    .overflow-x-auto::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      width: 20px;
      background: linear-gradient(to left, var(--background), transparent);
      pointer-events: none;
      opacity: 0.8;
    }
  }
  
  /* Amélioration du tap sur mobile pour les onglets */
  [role="tab"] {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }
  
  /* Amélioration de l'accessibilité et du scroll snap */
  .overflow-x-auto {
    scroll-snap-type: x proximity;
  }
  
  [role="tab"] {
    scroll-snap-align: start;
  }
}

/* ✨ SCROLLBAR VISIBLE ET STYLÉE POUR LES ÉCRANS LARGES */
@layer utilities {
  /* Scrollbar visible uniquement pour les éléments avec la classe .scrollbar-visible */
  .scrollbar-visible {
    scrollbar-width: thin; /* Firefox - scrollbar fine */
    scrollbar-color: #FFD700 transparent; /* Firefox - pouce or, fond transparent */
  }
  
  /* Chrome, Safari, Edge, Opera */
  .scrollbar-visible::-webkit-scrollbar {
    display: block; /* Afficher la scrollbar */
    width: 10px; /* Largeur de la scrollbar */
  }
  
  .scrollbar-visible::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05); /* Fond de la piste (subtil) */
    border-radius: 10px;
    margin: 4px 0; /* Espacement haut/bas */
  }
  
  .scrollbar-visible::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, #FFD700 0%, #FFA500 100%); /* Gradient or */
    border-radius: 10px;
    border: 2px solid transparent;
    background-clip: padding-box;
    transition: background 0.3s ease;
  }
  
  .scrollbar-visible::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(180deg, #FFA500 0%, #FFD700 100%); /* Gradient inversé au survol */
    border: 1px solid rgba(255, 215, 0, 0.3);
  }
  
  .scrollbar-visible::-webkit-scrollbar-thumb:active {
    background: #FFD700; /* Solid gold lors du drag */
  }

  /* Version thème clair */
  .theme-light .scrollbar-visible {
    scrollbar-color: #FFD700 rgba(0, 0, 0, 0.08);
  }
  
  .theme-light .scrollbar-visible::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
  }
  
  .theme-light .scrollbar-visible::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, #FFD700 0%, #FFA500 100%);
    border: 2px solid rgba(255, 255, 255, 0.8);
  }
  
  .theme-light .scrollbar-visible::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(180deg, #FFA500 0%, #FFD700 100%);
    border: 1px solid rgba(255, 215, 0, 0.5);
  }
}

================================================================================
--- FICHIER : ./src/utils/adminAPI.ts ---
================================================================================

// src/utils/adminAPI.ts

import apiClient from '../services/apiClient';
import { AdminUser } from '../types'; // Assurez-vous que le chemin vers votre fichier de types est correct

// =====================================================================
// ===== FONCTIONS POUR LE PANEL DE GESTION DES ADMINISTRATEURS ======
// =====================================================================

/**
 * Récupère la liste de tous les administrateurs.
 */
export const getAdmins = async (): Promise<AdminUser[]> => {
  const response = await apiClient.get<AdminUser[]>('/api/admin/users');
  return response.data;
};

/**
 * Crée un nouvel administrateur.
 */
export const createAdmin = async (adminData: Omit<AdminUser, 'id' | 'status' | 'createdAt'>): Promise<AdminUser> => {
  const response = await apiClient.post<AdminUser>('/api/admin/users', adminData);
  return response.data;
};

/**
 * Met à jour le rôle d'un administrateur spécifique.
 */
export const updateAdminRole = async (userId: string, role: string): Promise<AdminUser> => {
  const response = await apiClient.put<AdminUser>(`/api/admin/users/${userId}/role`, { role });
  return response.data;
};

/**
 * Met à jour le statut (actif/suspendu) d'un administrateur.
 */
export const updateAdminStatus = async (userId: string, status: 'active' | 'suspended'): Promise<AdminUser> => {
  const response = await apiClient.put<AdminUser>(`/api/admin/users/${userId}/status`, { status });
  return response.data;
};



================================================================================
--- FICHIER : ./src/utils/apiClient.ts ---
================================================================================

/**
 * Client API centralisé pour toutes les requêtes vers le backend
 * Gère automatiquement l'ajout du token JWT et les erreurs
 */

import { CONFIG } from './config';

// Configuration de l'URL du backend
const API_BASE_URL = CONFIG.API_BASE_URL;

// Export pour fallback
export const DEV_MODE = {
  useLocalStorageFallback: CONFIG.USE_LOCALHOST_FALLBACK,
};

// Clé pour stocker le token JWT
const TOKEN_KEY = 'loto_happy_access_token';

// ===== GESTION DU TOKEN =====

export function saveToken(token: string): void {
  localStorage.setItem(TOKEN_KEY, token);
}

export function getToken(): string | null {
  return localStorage.getItem(TOKEN_KEY);
}

export function removeToken(): void {
  localStorage.removeItem(TOKEN_KEY);
}

// ===== CLASSE D'ERREUR API =====

export class ApiError extends Error {
  constructor(
    public code: string,
    message: string,
    public details?: any,
    public status?: number
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

// ===== FONCTION GÉNÉRIQUE D'APPEL API =====

interface ApiCallOptions extends RequestInit {
  useFormData?: boolean; // Pour les endpoints qui attendent form-urlencoded
  skipAuth?: boolean; // Pour les endpoints publics
}

export async function apiCall<T = any>(
  endpoint: string,
  options: ApiCallOptions = {}
): Promise<T> {
  const { useFormData = false, skipAuth = false, ...fetchOptions } = options;

  // Préparer les headers
  const headers: Record<string, string> = {
    ...fetchOptions.headers as Record<string, string>,
  };

  // Ajouter le token si disponible et requis
  if (!skipAuth) {
    const token = getToken();
    if (token) {
      headers['Authorization'] = `Bearer ${token}`;
    }
  }

  // Pour les POST/PUT, ajouter Content-Type si non spécifié
  if (!useFormData && (options.method === 'POST' || options.method === 'PUT')) {
    if (!headers['Content-Type']) {
      headers['Content-Type'] = 'application/json';
    }
  }

  try {
    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
      ...fetchOptions,
      headers,
    });

    // Gérer les erreurs HTTP
    if (!response.ok) {
      let errorData;
      try {
        errorData = await response.json();
      } catch {
        throw new ApiError(
          'NETWORK_ERROR',
          'Erreur de communication avec le serveur',
          undefined,
          response.status
        );
      }

      // Format d'erreur backend
      if (errorData.detail && typeof errorData.detail === 'object' && errorData.detail.error) {
        const apiError = errorData.detail.error;
        throw new ApiError(
          apiError.code || 'UNKNOWN_ERROR',
          apiError.message || 'Une erreur est survenue',
          apiError.details,
          response.status
        );
      }

      // Format d'erreur simple
      throw new ApiError(
        'API_ERROR',
        errorData.detail || errorData.message || 'Une erreur est survenue',
        errorData,
        response.status
      );
    }

    // Réponse vide (204, DELETE, etc.)
    if (response.status === 204 || response.headers.get('content-length') === '0') {
      return null as T;
    }

    // Parser la réponse JSON
    const data = await response.json();
    
    // Retourner les données (le backend peut renvoyer { data: ... } ou directement l'objet)
    return (data.data !== undefined ? data.data : data) as T;

  } catch (error) {
    // Propager les ApiError
    if (error instanceof ApiError) {
      throw error;
    }

    // Erreur réseau ou autre
    throw new ApiError(
      'NETWORK_ERROR',
      'Impossible de contacter le serveur. Vérifiez votre connexion.',
      { originalError: (error as Error).message }
    );
  }
}

// ===== HELPERS POUR LES MÉTHODES HTTP =====

export const api = {
  get: <T = any>(endpoint: string, options?: ApiCallOptions) =>
    apiCall<T>(endpoint, { ...options, method: 'GET' }),

  post: <T = any>(endpoint: string, body?: any, options?: ApiCallOptions) =>
    apiCall<T>(endpoint, {
      ...options,
      method: 'POST',
      body: options?.useFormData ? body : JSON.stringify(body),
    }),

  put: <T = any>(endpoint: string, body?: any, options?: ApiCallOptions) =>
    apiCall<T>(endpoint, {
      ...options,
      method: 'PUT',
      body: options?.useFormData ? body : JSON.stringify(body),
    }),

  delete: <T = any>(endpoint: string, options?: ApiCallOptions) =>
    apiCall<T>(endpoint, { ...options, method: 'DELETE' }),

  patch: <T = any>(endpoint: string, body?: any, options?: ApiCallOptions) =>
    apiCall<T>(endpoint, {
      ...options,
      method: 'PATCH',
      body: options?.useFormData ? body : JSON.stringify(body),
    }),
};

export default api;


================================================================================
--- FICHIER : ./src/utils/auth.ts ---
================================================================================

// Système de gestion d'authentification avec localStorage

// Interface pour les transactions des joueurs
export interface PlayerTransaction {
  id: string;
  type: 'RECHARGE' | 'BET' | 'CONVERSION' | 'WIN' | 'WITHDRAWAL';
  description: string;
  amount: number;
  balanceAfter: number;
  date: string;
  metadata?: {
    gameName?: string;
    resellerName?: string;
    fromBalance?: 'winnings' | 'game';
    toBalance?: 'winnings' | 'game';
    provider?: string; // Opérateur Mobile Money
    phoneNumber?: string; // Numéro de retrait
  };
}

// Interface pour les demandes de retrait
export interface WithdrawalRequest {
  id: string;
  userId: string;
  username: string;
  phoneNumber: string; // Numéro du joueur
  amount: number;
  provider: string; // Opérateur Mobile Money
  withdrawalPhoneNumber: string; // Numéro vers lequel envoyer l'argent
  status: 'pending' | 'approved' | 'rejected';
  requestDate: string;
  processedDate?: string;
}

export interface AdminUser {
  id: string;
  username: string;
  email: string;
  // 'password' est retiré, il n'est pas dans la réponse de l'API
  role: 'Super Admin' | 'Admin Financier' | 'Admin du Jeu' | 'Support Client';
  status: 'active' | 'suspended'; // <-- Corrigé pour correspondre au backend
  lastLogin: string | null;         // <-- Corrigé pour autoriser null
  createdAt: string;
  // On ajoute phoneNumber car le backend le renvoie
  phoneNumber: string; 
}

export interface User {
  id: string; // ID unique pour chaque utilisateur
  isLoggedIn: boolean;
  username: string;
  phoneNumber: string;
  email: string; // Email REQUIS pour tous les utilisateurs
  password: string; // Stocké hashé (vide si connexion Google)
  authMethod?: 'password' | 'google'; // Méthode d'authentification
  role: 'player' | 'reseller' | 'admin'; // Nouveau champ pour distinguer les rôles
  balanceGame: number;
  balanceWinnings: number;
  tokenBalance?: number; // Pour les revendeurs uniquement
  dailyRechargeTotal?: number; // Montant total rechargé aujourd'hui
  dailyTransactionsCount?: number; // Nombre de transactions aujourd'hui
  transactionHistory?: Array<{ // Pour les revendeurs uniquement
    id: string;
    playerNumber: string;
    playerUsername: string;
    amount: number;
    date: string;
  }>;
  playerTransactionHistory?: PlayerTransaction[]; // Pour les joueurs uniquement
  status?: 'active' | 'suspended'; // Statut du compte (pour gestion admin)
}

// Clés de stockage
const STORAGE_KEY = 'lottoHappyUser';
const ALL_PLAYERS_KEY = 'lottoHappyAllPlayers'; // Stockage de tous les joueurs
const ALL_RESELLERS_KEY = 'lottoHappyAllResellers'; // Stockage de tous les revendeurs
const USERS_KEY = 'loto_happy_users'; // Nouvelle clé unifiée pour tous les utilisateurs
const WITHDRAWAL_REQUESTS_KEY = 'loto_happy_withdrawal_requests'; // Demandes de retrait
const ADMIN_USERS_KEY = 'lottoHappyAdmins'; // Stockage de tous les administrateurs

// Générer un ID unique
function generateUserId(): string {
  return `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
}

// ===== VALIDATION DES NUMÉROS DE TÉLÉPHONE ET OPÉRATEURS MOBILE MONEY =====

// Configuration des formats de numéros par pays
interface PhoneFormat {
  code: string;
  length: number; // Nombre de chiffres APRÈS l'indicatif
  name: string;
}

export const PHONE_FORMATS: PhoneFormat[] = [
  { code: '+228', length: 8, name: 'Togo' },
  { code: '+229', length: 8, name: 'Bénin' },
  { code: '+225', length: 10, name: 'Côte d\'Ivoire' },
  { code: '+233', length: 9, name: 'Ghana' },
  { code: '+226', length: 8, name: 'Burkina Faso' },
];

// Configuration des opérateurs Mobile Money par pays
export interface MobileMoneyOperator {
  id: string;
  name: string;
  icon: string;
  color: string;
  prefixes: string[]; // Préfixes acceptés (ex: ['90', '70', '91'])
  countries: string[]; // Codes pays supportés (ex: ['+228'])
}

export const MOBILE_MONEY_OPERATORS: MobileMoneyOperator[] = [
  {
    id: 'yas',
    name: 'Yas Togo (ex T-Money)',
    icon: '💰',
    color: '#FF6B00',
    prefixes: ['90', '70', '73', '93', '91'],
    countries: ['+228'],
  },
  {
    id: 'moov-togo',
    name: 'Moov Money Togo',
    icon: '📱',
    color: '#009DD9',
    prefixes: ['98', '78', '79', '99', '97'],
    countries: ['+228'],
  },
  {
    id: 'mtn-togo',
    name: 'MTN Mobile Money',
    icon: '📞',
    color: '#FFCB05',
    prefixes: ['92', '93', '94', '95', '96'], // MTN Togo (à confirmer)
    countries: ['+228', '+229', '+225', '+233', '+226'],
  },
  {
    id: 'moov-benin',
    name: 'Moov Money Bénin',
    icon: '💳',
    color: '#009DD9',
    prefixes: ['96', '97', '61', '62', '63'], // Moov Bénin
    countries: ['+229'],
  },
  {
    id: 'orange',
    name: 'Orange Money',
    icon: '🍊',
    color: '#FF7900',
    prefixes: ['07', '08', '09', '57', '58', '59', '67', '68', '69'], // Multi-pays
    countries: ['+225', '+226', '+229'],
  },
  {
    id: 'wave',
    name: 'Wave',
    icon: '🌊',
    color: '#4F46E5',
    prefixes: ['91', '92', '93', '94', '95'], // Wave multi-pays
    countries: ['+221', '+225', '+229'],
  },
  {
    id: 'flooz',
    name: 'Flooz (Moov)',
    icon: '💵',
    color: '#00B4D8',
    prefixes: ['96', '97', '98', '99'],
    countries: ['+228'],
  },
];

// Numéros de revendeurs (sans indicatif) pour vérification
const RESELLER_NUMBERS = [
  '990102030', // Togo - GREGOIRE_RT
  '660102030', // Bénin - MAISON_LOTO
  '070102030', // Côte d'Ivoire - CHANCE_PLUS
  '240102030', // Ghana - GOLDEN_LOTO
  '550102030', // Burkina Faso - MEGA_CHANCE
];

// Vérifier si un numéro est un numéro de revendeur
export function isResellerNumber(phoneNumber: string): boolean {
  // Nettoyer le numéro (retirer espaces, tirets, etc.)
  const cleanNumber = phoneNumber.replace(/[\s\-\.]/g, '');
  
  // Vérifier si le numéro se termine par un numéro de revendeur
  return RESELLER_NUMBERS.some(resellerNum => cleanNumber.endsWith(resellerNum));
}

// Détecter l'opérateur à partir d'un numéro et d'un code pays
export function detectOperatorFromNumber(
  phoneNumber: string, 
  countryCode: string
): MobileMoneyOperator | null {
  const cleanNumber = phoneNumber.replace(/[\s\-\.]/g, '');
  
  // Chercher un opérateur correspondant au pays et au préfixe
  for (const operator of MOBILE_MONEY_OPERATORS) {
    if (operator.countries.includes(countryCode)) {
      for (const prefix of operator.prefixes) {
        if (cleanNumber.startsWith(prefix)) {
          return operator;
        }
      }
    }
  }
  
  return null;
}

// Vérifier si un numéro correspond à un opérateur spécifique
export function validateNumberForOperator(
  phoneNumber: string,
  countryCode: string,
  operatorId: string
): { isValid: boolean; message?: string } {
  const cleanNumber = phoneNumber.replace(/[\s\-\.]/g, '');
  
  // Trouver l'opérateur
  const operator = MOBILE_MONEY_OPERATORS.find(op => op.id === operatorId);
  if (!operator) {
    return { isValid: false, message: 'Opérateur non reconnu' };
  }
  
  // Vérifier que l'opérateur est disponible dans ce pays
  if (!operator.countries.includes(countryCode)) {
    return { 
      isValid: false, 
      message: `${operator.name} n'est pas disponible dans ce pays` 
    };
  }
  
  // Vérifier le préfixe
  const hasValidPrefix = operator.prefixes.some(prefix => 
    cleanNumber.startsWith(prefix)
  );
  
  if (!hasValidPrefix) {
    const prefixesStr = operator.prefixes.join(', ');
    return {
      isValid: false,
      message: `Pour ${operator.name}, le numéro doit commencer par : ${prefixesStr}`
    };
  }
  
  return { isValid: true };
}

// Obtenir les opérateurs disponibles pour un pays
export function getOperatorsForCountry(countryCode: string): MobileMoneyOperator[] {
  return MOBILE_MONEY_OPERATORS.filter(op => 
    op.countries.includes(countryCode)
  );
}

// Valider le format d'un numéro de téléphone selon l'indicatif
export function validatePhoneNumber(
  phoneNumber: string, 
  countryCode: string
): { isValid: boolean; message?: string } {
  // Nettoyer le numéro (retirer espaces, tirets, etc.)
  const cleanNumber = phoneNumber.replace(/[\s\-\.]/g, '');
  
  // Vérifier si c'est un numéro de revendeur (toujours accepté)
  if (isResellerNumber(phoneNumber)) {
    return { isValid: true };
  }
  
  // Trouver le format attendu pour ce pays
  const format = PHONE_FORMATS.find(f => f.code === countryCode);
  
  if (!format) {
    return { 
      isValid: false, 
      message: 'Indicatif pays non reconnu' 
    };
  }
  
  // Vérifier que le numéro ne contient que des chiffres
  if (!/^\d+$/.test(cleanNumber)) {
    return { 
      isValid: false, 
      message: 'Le numéro ne doit contenir que des chiffres' 
    };
  }
  
  // Vérifier la longueur
  if (cleanNumber.length !== format.length) {
    return { 
      isValid: false, 
      message: `Le numéro ${format.name} doit contenir ${format.length} chiffres (${cleanNumber.length} saisis)` 
    };
  }
  
  return { isValid: true };
}

// Fonction de hashage simple (pour prototype)
export function hashPassword(password: string): string {
  return 'hashed_' + password;
}

// ===== REVENDEURS EN DUR (Constante - Valeurs par défaut) =====
const RESELLERS_DEFAULT: User[] = [
  {
    id: generateUserId(),
    isLoggedIn: false,
    username: 'GREGOIRE_RT',
    phoneNumber: '228990102030',
    email: 'gregoire.rt@lotohappy.com',
    password: hashPassword('Revendeur1'),
    authMethod: 'password',
    role: 'reseller',
    balanceGame: 0,
    balanceWinnings: 0,
    tokenBalance: 1500000,
    dailyRechargeTotal: 0,
    dailyTransactionsCount: 0,
    transactionHistory: [],
  },
  {
    id: generateUserId(),
    isLoggedIn: false,
    username: 'MAISON_LOTO',
    phoneNumber: '229660102030',
    email: 'maison.loto@lotohappy.com',
    password: hashPassword('Revendeur2'),
    authMethod: 'password',
    role: 'reseller',
    balanceGame: 0,
    balanceWinnings: 0,
    tokenBalance: 2000000,
    dailyRechargeTotal: 0,
    dailyTransactionsCount: 0,
    transactionHistory: [],
  },
  {
    id: generateUserId(),
    isLoggedIn: false,
    username: 'CHANCE_PLUS',
    phoneNumber: '225070102030',
    email: 'chance.plus@lotohappy.com',
    password: hashPassword('Revendeur3'),
    authMethod: 'password',
    role: 'reseller',
    balanceGame: 0,
    balanceWinnings: 0,
    tokenBalance: 1800000,
    dailyRechargeTotal: 0,
    dailyTransactionsCount: 0,
    transactionHistory: [],
  },
  {
    id: generateUserId(),
    isLoggedIn: false,
    username: 'GOLDEN_LOTO',
    phoneNumber: '233240102030',
    email: 'golden.loto@lotohappy.com',
    password: hashPassword('Revendeur4'),
    authMethod: 'password',
    role: 'reseller',
    balanceGame: 0,
    balanceWinnings: 0,
    tokenBalance: 2500000,
    dailyRechargeTotal: 0,
    dailyTransactionsCount: 0,
    transactionHistory: [],
  },
  {
    id: generateUserId(),
    isLoggedIn: false,
    username: 'MEGA_CHANCE',
    phoneNumber: '226550102030',
    email: 'mega.chance@lotohappy.com',
    password: hashPassword('Revendeur5'),
    authMethod: 'password',
    role: 'reseller',
    balanceGame: 0,
    balanceWinnings: 0,
    tokenBalance: 1200000,
    dailyRechargeTotal: 0,
    dailyTransactionsCount: 0,
    transactionHistory: [],
  },
];

// ===== GESTION DE TOUS LES REVENDEURS =====

// Récupérer tous les revendeurs
export function getAllResellers(): User[] {
  const resellersData = localStorage.getItem(ALL_RESELLERS_KEY);
  if (!resellersData) {
    // Premier chargement : initialiser avec les valeurs par défaut
    saveAllResellers(RESELLERS_DEFAULT);
    return RESELLERS_DEFAULT;
  }
  
  try {
    return JSON.parse(resellersData) as User[];
  } catch {
    // En cas d'erreur, réinitialiser avec les valeurs par défaut
    saveAllResellers(RESELLERS_DEFAULT);
    return RESELLERS_DEFAULT;
  }
}

// Sauvegarder tous les revendeurs
function saveAllResellers(resellers: User[]): void {
  localStorage.setItem(ALL_RESELLERS_KEY, JSON.stringify(resellers));
  // Synchroniser avec loto_happy_users pour le système de tirages
  syncToUnifiedUserStore();
}

// Ajouter ou mettre à jour un revendeur dans la liste globale
function addOrUpdateResellerInList(reseller: User): void {
  const resellers = getAllResellers();
  const existingIndex = resellers.findIndex(r => r.phoneNumber === reseller.phoneNumber);
  
  if (existingIndex !== -1) {
    // Mettre à jour le revendeur existant
    resellers[existingIndex] = reseller;
  } else {
    // Ajouter un nouveau revendeur (normalement ne devrait pas arriver)
    resellers.push(reseller);
  }
  
  saveAllResellers(resellers);
}

// Créer un nouveau revendeur (Admin uniquement)
export function createReseller(
  username: string,
  phoneNumber: string,
  email: string,
  password: string,
  tokenBalance: number = 0
): { success: boolean; message: string } {
  // Vérifier si le numéro existe déjà
  const resellers = getAllResellers();
  const existingReseller = resellers.find(r => r.phoneNumber === phoneNumber);
  
  if (existingReseller) {
    return {
      success: false,
      message: 'Un revendeur avec ce numéro de téléphone existe déjà'
    };
  }
  
  // Vérifier si l'email existe déjà
  const existingEmail = resellers.find(r => r.email.toLowerCase() === email.toLowerCase());
  if (existingEmail) {
    return {
      success: false,
      message: 'Un revendeur avec cet email existe déjà'
    };
  }
  
  // Créer le nouveau revendeur
  const newReseller: User = {
    id: generateUserId(),
    isLoggedIn: false,
    username,
    phoneNumber,
    email,
    password: hashPassword(password),
    authMethod: 'password',
    role: 'reseller',
    balanceGame: 0,
    balanceWinnings: 0,
    tokenBalance,
    dailyRechargeTotal: 0,
    dailyTransactionsCount: 0,
    transactionHistory: [],
    status: 'active',
  };
  
  // Ajouter à la liste
  resellers.push(newReseller);
  saveAllResellers(resellers);
  
  console.log('✅ Nouveau revendeur créé:', {
    username,
    phoneNumber,
    email,
    tokenBalance
  });
  
  return {
    success: true,
    message: `✅ Revendeur ${username} créé avec succès !`
  };
}

// Initialiser les revendeurs (appelé au démarrage)
export function initializeResellers(): void {
  // S'assure que les revendeurs existent dans localStorage
  getAllResellers();
}

// ✅ Initialiser un joueur de test avec email Google (pour démo)
export function initializeTestGoogleUser(): void {
  const allPlayers = getAllPlayers();
  
  // Vérifier si le joueur test existe déjà
  const exists = allPlayers.some(p => p.email === 'joueur.test@gmail.com');
  
  if (!exists) {
    // Créer le joueur de test
    const testUser: User = {
      id: generateUserId(),
      isLoggedIn: false,
      username: 'JoueurTest228',
      email: 'joueur.test@gmail.com',
      phoneNumber: '228123456789', // Numéro réel pour le Togo
      password: hashPassword('google_auth_joueur.test@gmail.com'),
      authMethod: 'google',
      role: 'player',
      balanceGame: 5000, // Solde généreux pour les tests
      balanceWinnings: 2000,
      playerTransactionHistory: [
        {
          id: 'init_1',
          type: 'RECHARGE',
          description: 'Solde initial de test',
          amount: 5000,
          balanceAfter: 5000,
          date: new Date().toISOString(),
        },
      ],
    };
    
    allPlayers.push(testUser);
    saveAllPlayers(allPlayers);
    console.log('✅ Joueur test Google créé : joueur.test@gmail.com');
  }
}

// ===== FONCTIONS DE VALIDATION D'UNICITÉ =====

// Vérifier si un utilisateur avec ce numéro de téléphone existe (joueur ou revendeur)
export function userExistsWithPhone(phoneNumber: string): boolean {
  // Nettoyer le numéro (enlever le +)
  const cleanNumber = phoneNumber.replace(/\+/g, '');
  
  // Vérifier dans tous les joueurs
  const allPlayers = getAllPlayers();
  const playerExists = allPlayers.some(p => p.phoneNumber === cleanNumber);
  if (playerExists) return true;
  
  // Vérifier dans les revendeurs
  const allResellers = getAllResellers();
  const exists = allResellers.some(r => r.phoneNumber === cleanNumber);
  console.log('Checking for:', cleanNumber, 'Found in players:', playerExists, 'Found in resellers:', exists);
  return exists;
}

// Vérifier si un utilisateur avec cet email existe (joueur, revendeur ou admin)
export function userExistsWithEmail(email: string): User | AdminUser | null {
  const cleanEmail = email.toLowerCase().trim();
  
  // Vérifier dans tous les joueurs
  const allPlayers = getAllPlayers();
  const playerFound = allPlayers.find(p => p.email.toLowerCase() === cleanEmail);
  if (playerFound) return playerFound;
  
  // Vérifier dans les revendeurs
  const allResellers = getAllResellers();
  const resellerFound = allResellers.find(r => r.email.toLowerCase() === cleanEmail);
  if (resellerFound) return resellerFound;
  
  // Vérifier dans les admins
  const allAdmins = getAllAdmins();
  const adminFound = allAdmins.find(a => a.email.toLowerCase() === cleanEmail);
  if (adminFound) return adminFound;
  
  return null;
}

// Vérifier si un username existe (joueur ou revendeur)
export function userExistsWithUsername(username: string): boolean {
  const cleanUsername = username.toLowerCase().trim();
  
  // Vérifier dans tous les joueurs
  const allPlayers = getAllPlayers();
  const playerExists = allPlayers.some(p => p.username.toLowerCase() === cleanUsername);
  if (playerExists) return true;
  
  // Vérifier dans les revendeurs
  const allResellers = getAllResellers();
  return allResellers.some(r => r.username.toLowerCase() === cleanUsername);
}

// Vérifier si un utilisateur existe
export function userExists(): boolean {
  return localStorage.getItem(STORAGE_KEY) !== null;
}

// ===== GESTION DE TOUS LES JOUEURS =====

// Récupérer tous les joueurs
export function getAllPlayers(): User[] {
  const playersData = localStorage.getItem(ALL_PLAYERS_KEY);
  if (!playersData) return [];
  
  try {
    return JSON.parse(playersData) as User[];
  } catch {
    return [];
  }
}

// Sauvegarder tous les joueurs
function saveAllPlayers(players: User[]): void {
  localStorage.setItem(ALL_PLAYERS_KEY, JSON.stringify(players));
  // Synchroniser avec loto_happy_users pour le système de tirages
  syncToUnifiedUserStore();
}

// Synchroniser tous les utilisateurs (joueurs + revendeurs + admin) vers loto_happy_users
export function syncToUnifiedUserStore(): void {
  const players = getAllPlayers();
  const resellers = getAllResellers();
  const allUsers = [...players, ...resellers];
  localStorage.setItem(USERS_KEY, JSON.stringify(allUsers));
}

// Initialiser la synchronisation au démarrage
export function initializeUserSync(): void {
  syncToUnifiedUserStore();
}

// Ajouter ou mettre à jour un joueur dans la liste globale
function addOrUpdatePlayerInList(player: User): void {
  const players = getAllPlayers();
  const existingIndex = players.findIndex(p => p.phoneNumber === player.phoneNumber);
  
  if (existingIndex !== -1) {
    // Mettre à jour le joueur existant
    players[existingIndex] = player;
  } else {
    // Ajouter un nouveau joueur
    players.push(player);
  }
  
  saveAllPlayers(players);
}

// Créer un nouvel utilisateur (Inscription classique)
export function createUser(
  username: string,
  phoneNumber: string,
  email: string,
  password: string
): { success: boolean; message: string; user?: User } {
  // Nettoyer les données
  const cleanNumber = phoneNumber.replace(/\+/g, '');
  const cleanUsername = username.trim();
  const cleanEmail = email.toLowerCase().trim();
  
  // ✅ VALIDATION 1: Vérifier si le numéro de téléphone existe déjà
  if (userExistsWithPhone(cleanNumber)) {
    return {
      success: false,
      message: 'Ce numéro de téléphone est déjà utilisé. Veuillez vous connecter ou utiliser un autre numéro.'
    };
  }
  
  // ✅ VALIDATION 2: Vérifier si l'email existe déjà
  const existingEmailUser = userExistsWithEmail(cleanEmail);
  if (existingEmailUser) {
    return {
      success: false,
      message: 'Cette adresse email est déjà utilisée. Veuillez vous connecter ou utiliser un autre email.'
    };
  }
  
  // ✅ VALIDATION 3: Vérifier si le username existe déjà
  if (userExistsWithUsername(cleanUsername)) {
    return {
      success: false,
      message: 'Ce nom d\'utilisateur est déjà pris. Veuillez en choisir un autre.'
    };
  }
  
  // Créer l'utilisateur
  const user: User = {
    id: generateUserId(),
    isLoggedIn: true,
    username: cleanUsername,
    phoneNumber: cleanNumber,
    email: cleanEmail,
    password: hashPassword(password),
    authMethod: 'password',
    role: 'player',
    balanceGame: 1000, // Solde initial de bienvenue
    balanceWinnings: 0,
    playerTransactionHistory: [
      {
        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
        type: 'RECHARGE',
        description: 'Bonus de bienvenue',
        amount: 1000,
        balanceAfter: 1000,
        date: new Date().toISOString(),
      }
    ],
    status: 'active',
  };
  
  // Sauvegarder comme utilisateur actuel
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  
  // Ajouter à la liste globale
  addOrUpdatePlayerInList(user);
  
  console.log('✅ Nouveau joueur créé:', {
    username: cleanUsername,
    phoneNumber: cleanNumber,
    email: cleanEmail
  });
  
  return { success: true, message: 'Compte créé avec succès !', user };
}

// Récupérer l'utilisateur actuel
export function getCurrentUser(): User | null {
  const userData = localStorage.getItem(STORAGE_KEY);
  if (!userData) return null;
  
  try {
    return JSON.parse(userData) as User;
  } catch {
    return null;
  }
}

// Connexion (gère joueurs ET revendeurs)
export function loginUser(phoneNumber: string, password: string): { success: boolean; role?: 'player' | 'reseller' } {
  // Nettoyer le numéro (enlever le +)
  const cleanNumber = phoneNumber.replace(/\+/g, '');
  
  // Vérifier si c'est un email ou un numéro de téléphone
  const isEmail = phoneNumber.includes('@');
  
  // Rechercher d'abord dans tous les joueurs
  const allPlayers = getAllPlayers();
  const playerFound = allPlayers.find(p => {
    if (isEmail) {
      return p.email === phoneNumber && p.password === hashPassword(password) && p.role === 'player';
    } else {
      return p.phoneNumber === cleanNumber && p.password === hashPassword(password) && p.role === 'player';
    }
  });
  
  if (playerFound) {
    playerFound.isLoggedIn = true;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(playerFound));
    return { success: true, role: 'player' };
  }
  
  // Essayer de se connecter comme revendeur
  const allResellers = getAllResellers();
  console.log('[LOGIN] Recherche revendeur - Identifiant:', isEmail ? phoneNumber : cleanNumber);
  console.log('[LOGIN] Nombre de revendeurs:', allResellers.length);
  console.log('[LOGIN] Revendeurs disponibles:', allResellers.map(r => ({ 
    username: r.username, 
    phone: r.phoneNumber,
    email: r.email,
    status: r.status 
  })));
  
  const resellerIndex = allResellers.findIndex(r => {
    if (isEmail) {
      // Connexion par email
      return r.email === phoneNumber && r.password === hashPassword(password);
    } else {
      // Connexion par téléphone
      return r.phoneNumber === cleanNumber && r.password === hashPassword(password);
    }
  });
  
  console.log('[LOGIN] Index trouvé:', resellerIndex);
  
  if (resellerIndex !== -1) {
    const reseller = { ...allResellers[resellerIndex] };
    console.log('[LOGIN] Revendeur trouvé:', reseller.username, 'Status:', reseller.status);
    
    // Vérifier si le compte est suspendu
    if (reseller.status === 'suspended') {
      console.log('[LOGIN] ❌ Compte suspendu');
      return { success: false };
    }
    
    // Connecter le revendeur
    reseller.isLoggedIn = true;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(reseller));
    console.log('[LOGIN] ✅ Connexion réussie en tant que revendeur');
    return { success: true, role: 'reseller' };
  }
  
  console.log('[LOGIN] ❌ Aucun utilisateur trouvé avec ces identifiants');
  return { success: false };
}

// Déconnexion
export function logoutUser(): void {
  const user = getCurrentUser();
  if (user) {
    user.isLoggedIn = false;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  }
}

// Vérifier si l'utilisateur est connecté
export function isUserLoggedIn(): boolean {
  const user = getCurrentUser();
  return user !== null && user.isLoggedIn === true;
}

// Mettre à jour le solde de jeu
export function updateGameBalance(amount: number): void {
  const user = getCurrentUser();
  if (user) {
    user.balanceGame += amount;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
    
    // Si c'est un joueur, synchroniser avec la liste globale
    if (user.role === 'player') {
      addOrUpdatePlayerInList(user);
    }
  }
}

// Mettre à jour le solde des gains
export function updateWinningsBalance(amount: number): void {
  const user = getCurrentUser();
  if (user) {
    user.balanceWinnings += amount;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
    
    // Si c'est un joueur, synchroniser avec la liste globale
    if (user.role === 'player') {
      addOrUpdatePlayerInList(user);
    }
  }
}

// Convertir les gains vers le solde de jeu
export function convertWinningsToGame(amount: number): boolean {
  const user = getCurrentUser();
  if (!user || user.balanceWinnings < amount) return false;
  
  user.balanceWinnings -= amount;
  user.balanceGame += amount;
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  
  // Si c'est un joueur, synchroniser avec la liste globale
  if (user.role === 'player') {
    addOrUpdatePlayerInList(user);
  }
  
  return true;
}

// Déduire le coût d'un pari
export function deductBetCost(amount: number): boolean {
  const user = getCurrentUser();
  if (!user || user.balanceGame < amount) return false;
  
  user.balanceGame -= amount;
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  
  // Si c'est un joueur, synchroniser avec la liste globale
  if (user.role === 'player') {
    addOrUpdatePlayerInList(user);
  }
  
  return true;
}

// Simuler un gain (pour tests)
export function simulateWin(amount: number): void {
  updateWinningsBalance(amount);
}

// Changer le mot de passe
export function changePassword(oldPassword: string, newPassword: string): boolean {
  const user = getCurrentUser();
  if (!user) return false;
  
  // Vérifier l'ancien mot de passe
  if (user.password !== hashPassword(oldPassword)) {
    return false;
  }
  
  // Mettre à jour avec le nouveau mot de passe
  user.password = hashPassword(newPassword);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  
  // Synchroniser avec la liste globale selon le rôle
  if (user.role === 'player') {
    addOrUpdatePlayerInList(user);
  } else if (user.role === 'reseller') {
    addOrUpdateResellerInList(user);
  }
  
  return true;
}

// Mettre à jour le profil utilisateur
export function updateUserProfile(updates: Partial<User>): boolean {
  const user = getCurrentUser();
  if (!user) return false;
  
  // Ne pas permettre de modifier certains champs critiques
  const { password, isLoggedIn, ...allowedUpdates } = updates;
  
  const updatedUser = { ...user, ...allowedUpdates };
  localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedUser));
  
  return true;
}

// ===== GESTION DE L'HISTORIQUE DES TRANSACTIONS JOUEURS =====

// Ajouter une transaction à l'historique d'un joueur
export function addPlayerTransaction(
  transaction: Omit<PlayerTransaction, 'id' | 'date'>
): void {
  const user = getCurrentUser();
  if (!user || user.role !== 'player') return;
  
  // Initialiser l'historique si nécessaire
  if (!user.playerTransactionHistory) {
    user.playerTransactionHistory = [];
  }
  
  // Créer la transaction complète
  const fullTransaction: PlayerTransaction = {
    ...transaction,
    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
    date: new Date().toISOString(),
  };
  
  // Ajouter au début de l'historique (plus récent en premier)
  user.playerTransactionHistory.unshift(fullTransaction);
  
  // Limiter à 100 transactions pour économiser l'espace
  if (user.playerTransactionHistory.length > 100) {
    user.playerTransactionHistory = user.playerTransactionHistory.slice(0, 100);
  }
  
  // Sauvegarder
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  addOrUpdatePlayerInList(user);
}

// Récupérer l'historique d'un joueur
export function getPlayerTransactionHistory(): PlayerTransaction[] {
  const user = getCurrentUser();
  if (!user || user.role !== 'player') return [];
  return user.playerTransactionHistory || [];
}

// Effacer l'historique d'un joueur
export function clearPlayerTransactionHistory(): void {
  const user = getCurrentUser();
  if (!user || user.role !== 'player') return;
  
  user.playerTransactionHistory = [];
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  addOrUpdatePlayerInList(user);
}

// ===== FONCTIONS SPÉCIFIQUES AUX REVENDEURS =====

// Rechercher un joueur par numéro ou username (RÉEL)
export function searchPlayer(searchTerm: string): User | null {
  // Nettoyer le terme de recherche
  const cleanTerm = searchTerm.trim().replace(/\+/g, '');
  
  // Récupérer tous les joueurs
  const allPlayers = getAllPlayers();
  
  // Rechercher par numéro ou username
  const player = allPlayers.find(p => 
    p.role === 'player' && (
      p.phoneNumber === cleanTerm ||
      p.phoneNumber.includes(cleanTerm) ||
      p.username.toLowerCase() === cleanTerm.toLowerCase() ||
      p.username.toLowerCase().includes(cleanTerm.toLowerCase())
    )
  );
  
  return player || null;
}

// Créditer le compte d'un joueur (fonction revendeur) - VERSION RÉELLE
export function creditPlayerAccount(
  searchTerm: string,
  amount: number
): { success: boolean; message: string } {
  const reseller = getCurrentUser();
  
  // Vérifier que c'est bien un revendeur
  if (!reseller || reseller.role !== 'reseller') {
    return { success: false, message: 'Non autorisé' };
  }
  
  // Vérifier que le revendeur a assez de jetons
  if (!reseller.tokenBalance || reseller.tokenBalance < amount) {
    return { success: false, message: 'Solde de jetons insuffisant' };
  }
  
  // Rechercher le joueur RÉEL
  const player = searchPlayer(searchTerm);
  
  if (!player) {
    return { success: false, message: 'Joueur introuvable. Vérifiez le numéro ou le username.' };
  }
  
  // Créditer le compte du joueur
  player.balanceGame += amount;
  
  // ✅ NOUVEAU : Ajouter une transaction dans l'historique du joueur
  if (!player.playerTransactionHistory) {
    player.playerTransactionHistory = [];
  }
  player.playerTransactionHistory.unshift({
    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
    type: 'RECHARGE',
    description: `Rechargement par ${reseller.username}`,
    amount: amount,
    balanceAfter: player.balanceGame,
    date: new Date().toISOString(),
    metadata: {
      resellerName: reseller.username,
    },
  });
  
  // Limiter l'historique du joueur
  if (player.playerTransactionHistory.length > 100) {
    player.playerTransactionHistory = player.playerTransactionHistory.slice(0, 100);
  }
  
  // Mettre à jour dans la liste globale
  const allPlayers = getAllPlayers();
  const playerIndex = allPlayers.findIndex(p => p.phoneNumber === player.phoneNumber);
  if (playerIndex !== -1) {
    allPlayers[playerIndex] = player;
    saveAllPlayers(allPlayers);
  }
  
  // Si c'est l'utilisateur connecté actuellement, mettre à jour aussi
  const currentUser = getCurrentUser();
  if (currentUser && currentUser.phoneNumber === player.phoneNumber && currentUser.role === 'player') {
    currentUser.balanceGame = player.balanceGame;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(currentUser));
  }
  
  // Déduire du solde du revendeur
  reseller.tokenBalance -= amount;
  reseller.dailyRechargeTotal = (reseller.dailyRechargeTotal || 0) + amount;
  reseller.dailyTransactionsCount = (reseller.dailyTransactionsCount || 0) + 1;
  
  // Ajouter à l'historique
  if (!reseller.transactionHistory) reseller.transactionHistory = [];
  reseller.transactionHistory.unshift({
    id: Date.now().toString(),
    playerNumber: player.phoneNumber,
    playerUsername: player.username,
    amount: amount,
    date: new Date().toISOString(),
  });
  
  // Sauvegarder le revendeur dans la session actuelle
  localStorage.setItem(STORAGE_KEY, JSON.stringify(reseller));
  
  // ✅ NOUVEAU : Synchroniser avec la liste globale des revendeurs
  addOrUpdateResellerInList(reseller);
  
  return { 
    success: true, 
    message: `✅ Le compte de ${player.username} a été crédité de ${amount.toLocaleString('fr-FR')} F CFA` 
  };
}

// ===== FONCTIONS POUR GOOGLE AUTH =====

// Créer un nouvel utilisateur avec Google Auth
export function createUserWithGoogle(
  email: string,
  username: string,
  phoneNumber: string
): { success: boolean; message: string; user?: User } {
  // Nettoyer les données
  const cleanNumber = phoneNumber.replace(/\+/g, '');
  const cleanUsername = username.trim();
  const cleanEmail = email.toLowerCase().trim();
  
  // ✅ VALIDATION 1: Vérifier si l'email existe déjà
  const existingEmailUser = userExistsWithEmail(cleanEmail);
  if (existingEmailUser) {
    // Si l'email existe déjà, l'utilisateur devrait se connecter
    return {
      success: false,
      message: 'Un compte existe déjà avec cette adresse email Google. Connectez-vous avec Google.'
    };
  }
  
  // ✅ VALIDATION 2: Vérifier si le numéro de téléphone existe déjà
  if (userExistsWithPhone(cleanNumber)) {
    return {
      success: false,
      message: 'Ce numéro de téléphone est déjà utilisé par un autre compte.'
    };
  }
  
  // ✅ VALIDATION 3: Vérifier si le username existe déjà
  if (userExistsWithUsername(cleanUsername)) {
    return {
      success: false,
      message: 'Ce nom d\'utilisateur est déjà pris. Veuillez en choisir un autre.'
    };
  }
  
  // Créer l'utilisateur
  const user: User = {
    id: generateUserId(),
    isLoggedIn: true,
    username: cleanUsername,
    email: cleanEmail,
    phoneNumber: cleanNumber,
    password: hashPassword('google_auth_' + cleanEmail), // Mot de passe auto-généré
    authMethod: 'google',
    role: 'player',
    balanceGame: 1000, // Solde initial de bienvenue
    balanceWinnings: 0,
    playerTransactionHistory: [
      {
        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
        type: 'RECHARGE',
        description: 'Bonus de bienvenue Google',
        amount: 1000,
        balanceAfter: 1000,
        date: new Date().toISOString(),
      }
    ],
    status: 'active',
  };
  
  // Sauvegarder comme utilisateur actuel
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  
  // Ajouter à la liste globale
  addOrUpdatePlayerInList(user);
  
  console.log('✅ Nouveau joueur créé avec Google:', {
    username: cleanUsername,
    phoneNumber: cleanNumber,
    email: cleanEmail
  });
  
  return { success: true, message: 'Compte créé avec succès !', user };
}

// Connecter un utilisateur avec Google Auth (email existant)
export function loginUserWithGoogle(email: string): boolean {
  const existingUser = userExistsWithEmail(email);
  
  // Vérifier que c'est bien un User (pas un AdminUser) et que c'est un joueur
  if (!existingUser || !('role' in existingUser) || existingUser.role !== 'player') {
    return false;
  }
  
  const player = existingUser as User;
  player.isLoggedIn = true;
  localStorage.setItem(STORAGE_KEY, JSON.stringify(player));
  
  // Synchroniser avec la liste globale
  addOrUpdatePlayerInList(player);
  
  return true;
}

// ===== RETRAIT D'ARGENT VIA MOBILE MONEY =====

// Retirer de l'argent du solde de jeu vers Mobile Money
export function withdrawMoney(
  amount: number,
  provider: string,
  phoneNumber: string
): { success: boolean; message: string } {
  const user = getCurrentUser();
  
  // Vérifier que c'est bien un joueur
  if (!user || user.role !== 'player') {
    return { success: false, message: 'Non autorisé' };
  }
  
  // Vérifier le montant minimum
  if (amount < 500) {
    return { success: false, message: 'Le montant minimum de retrait est 500 F CFA' };
  }
  
  // Vérifier le solde
  if (user.balanceGame < amount) {
    return { success: false, message: 'Solde insuffisant' };
  }
  
  // Déduire du solde de jeu
  user.balanceGame -= amount;
  
  // Initialiser l'historique si nécessaire
  if (!user.playerTransactionHistory) {
    user.playerTransactionHistory = [];
  }
  
  // Créer la transaction directement
  const transaction: PlayerTransaction = {
    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
    date: new Date().toISOString(),
    type: 'WITHDRAWAL',
    description: `Retrait via ${getProviderName(provider)}`,
    amount: -amount, // Négatif car c'est une sortie
    balanceAfter: user.balanceGame,
    metadata: {
      provider: provider,
      phoneNumber: phoneNumber,
    },
  };
  
  // Ajouter au début de l'historique (plus récent en premier)
  user.playerTransactionHistory.unshift(transaction);
  
  // Limiter à 100 transactions pour économiser l'espace
  if (user.playerTransactionHistory.length > 100) {
    user.playerTransactionHistory = user.playerTransactionHistory.slice(0, 100);
  }
  
  // Sauvegarder
  localStorage.setItem(STORAGE_KEY, JSON.stringify(user));
  addOrUpdatePlayerInList(user);
  
  // IMPORTANT : Créer une demande de retrait pour l'admin
  const withdrawalRequest: WithdrawalRequest = {
    id: `withdrawal_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
    userId: user.id,
    username: user.username,
    phoneNumber: user.phoneNumber,
    amount,
    provider,
    withdrawalPhoneNumber: phoneNumber,
    status: 'pending',
    requestDate: new Date().toISOString(),
  };
  
  // Sauvegarder la demande dans localStorage
  const requests = getWithdrawalRequests();
  requests.unshift(withdrawalRequest);
  localStorage.setItem(WITHDRAWAL_REQUESTS_KEY, JSON.stringify(requests));
  
  return {
    success: true,
    message: `✅ Demande de retrait de ${amount.toLocaleString('fr-FR')} F CFA envoyée ! Elle sera traitée sous peu.`
  };
}

// Récupérer toutes les demandes de retrait
function getWithdrawalRequests(): WithdrawalRequest[] {
  const stored = localStorage.getItem(WITHDRAWAL_REQUESTS_KEY);
  return stored ? JSON.parse(stored) : [];
}

// Exporter la fonction pour l'admin
export function getAllWithdrawalRequests(): WithdrawalRequest[] {
  return getWithdrawalRequests();
}

// Approuver une demande de retrait (admin)
export function approveWithdrawalRequest(requestId: string): boolean {
  const requests = getWithdrawalRequests();
  const index = requests.findIndex(r => r.id === requestId);
  
  if (index !== -1) {
    requests[index].status = 'approved';
    requests[index].processedDate = new Date().toISOString();
    localStorage.setItem(WITHDRAWAL_REQUESTS_KEY, JSON.stringify(requests));
    return true;
  }
  
  return false;
}

// Rejeter une demande de retrait (admin)
export function rejectWithdrawalRequest(requestId: string): boolean {
  const requests = getWithdrawalRequests();
  const index = requests.findIndex(r => r.id === requestId);
  
  if (index !== -1) {
    requests[index].status = 'rejected';
    requests[index].processedDate = new Date().toISOString();
    localStorage.setItem(WITHDRAWAL_REQUESTS_KEY, JSON.stringify(requests));
    return true;
  }
  
  return false;
}

// Obtenir le nom complet du provider
function getProviderName(providerId: string): string {
  const operator = MOBILE_MONEY_OPERATORS.find(op => op.id === providerId);
  return operator ? operator.name : providerId;
}

// ===== FONCTIONS ADMIN =====

// Constantes admin
const ADMIN_PHONE = '000000000000';
const ADMIN_PASSWORD = 'adminlotto';

// Vérifier si les identifiants correspondent à un admin (email ou numéro)
export function isAdminCredentials(phoneOrEmail: string, password: string): boolean {
  const cleanNumber = phoneOrEmail.replace(/[\\s\\-\\.+]/g, '');
  // Test 1: Vérifier l'admin par défaut avec numéro de téléphone
  const isDefaultAdmin = cleanNumber === ADMIN_PHONE || cleanNumber.endsWith(ADMIN_PHONE);
  if (isDefaultAdmin && password === ADMIN_PASSWORD) {
    return true;
  }
  
  // Test 2: Vérifier contre la base de données des admins (par email)
  const admins = getAllAdmins();
  console.log('[AUTH DEBUG] Admins disponibles:', admins.map(a => ({ email: a.email, status: a.status })));
  
  const admin = admins.find(a => a.email.toLowerCase() === phoneOrEmail.toLowerCase());
  
  if (admin) {
    console.log('[AUTH DEBUG] Admin trouvé:', admin.email, 'Status:', admin.status);
    
    // Vérifier que l'admin est actif
    if (admin.status === 'Désactivé') {
      console.log('[AUTH DEBUG] ❌ Admin désactivé');
      return false;
    }
    
    // Vérifier le mot de passe (comparer le hash)
    const enteredHash = hashPassword(password);
    const isMatch = enteredHash === admin.password;
    console.log('[AUTH DEBUG] Hash match:', isMatch);
    
    return isMatch;
  }
  
  console.log('[AUTH DEBUG] ❌ Aucun admin trouvé avec:', phoneOrEmail);
  return false;
}

// Connecter en tant qu'admin
export function loginAsAdmin(emailOrPhone?: string): User {
  let adminUsername = 'Super Admin';
  let adminEmail = 'admin@lottohappy.com';
  
  // Si un email/phone est fourni, chercher l'admin correspondant
  if (emailOrPhone) {
    const admins = getAllAdmins();
    const admin = admins.find(a => 
      a.email.toLowerCase() === emailOrPhone.toLowerCase()
    );
    
    if (admin) {
      adminUsername = admin.username;
      adminEmail = admin.email;
      
      // Mettre à jour la dernière connexion
      updateAdminLastLogin(admin.email);
    }
  }
  
  const adminUser: User = {
    id: generateUserId(),
    isLoggedIn: true,
    username: adminUsername,
    phoneNumber: ADMIN_PHONE,
    email: adminEmail,
    password: hashPassword(ADMIN_PASSWORD),
    authMethod: 'password',
    role: 'admin',
    balanceGame: 0,
    balanceWinnings: 0,
  };
  
  localStorage.setItem(STORAGE_KEY, JSON.stringify(adminUser));
  return adminUser;
}

// Suspendre/Réactiver un compte utilisateur
export function toggleUserStatus(phoneNumber: string): boolean {
  const allPlayers = getAllPlayers();
  const playerIndex = allPlayers.findIndex(p => p.phoneNumber === phoneNumber);
  
  if (playerIndex !== -1) {
    const currentStatus = allPlayers[playerIndex].status || 'active';
    allPlayers[playerIndex].status = currentStatus === 'active' ? 'suspended' : 'active';
    saveAllPlayers(allPlayers);
    return true;
  }
  
  const allResellers = getAllResellers();
  const resellerIndex = allResellers.findIndex(r => r.phoneNumber === phoneNumber);
  
  if (resellerIndex !== -1) {
    const currentStatus = allResellers[resellerIndex].status || 'active';
    allResellers[resellerIndex].status = currentStatus === 'active' ? 'suspended' : 'active';
    saveAllResellers(allResellers);
    return true;
  }
  
  return false;
}

// Créditer/Débiter un solde (admin)
export function adminAdjustBalance(
  phoneNumber: string,
  amount: number,
  balanceType: 'game' | 'winnings' | 'token',
  reason: string
): boolean {
  const allPlayers = getAllPlayers();
  const playerIndex = allPlayers.findIndex(p => p.phoneNumber === phoneNumber);
  
  if (playerIndex !== -1) {
    if (balanceType === 'game') {
      allPlayers[playerIndex].balanceGame += amount;
    } else if (balanceType === 'winnings') {
      allPlayers[playerIndex].balanceWinnings += amount;
    }
    saveAllPlayers(allPlayers);
    return true;
  }
  
  const allResellers = getAllResellers();
  const resellerIndex = allResellers.findIndex(r => r.phoneNumber === phoneNumber);
  
  if (resellerIndex !== -1 && balanceType === 'token') {
    allResellers[resellerIndex].tokenBalance = (allResellers[resellerIndex].tokenBalance || 0) + amount;
    saveAllResellers(allResellers);
    return true;
  }
  
  return false;
}

// ===== GESTION DES ADMINISTRATEURS =====

// Fonction pour créer l'admin par défaut
function createDefaultAdmins(): AdminUser[] {
  return [
    {
      id: generateUserId(),
      username: 'Super Admin',
      email: 'admin@lottohappy.com',
      password: hashPassword('adminlotto'),
      role: 'Super Admin',
      status: 'Actif',
      lastLogin: new Date().toISOString(),
      createdAt: new Date().toISOString(),
    },
  ];
}

// Récupérer tous les administrateurs
export function getAllAdmins(): AdminUser[] {
  const adminsData = localStorage.getItem(ADMIN_USERS_KEY);
  if (!adminsData) {
    // Premier chargement : initialiser avec le Super Admin par défaut
    const defaultAdmins = createDefaultAdmins();
    saveAllAdmins(defaultAdmins);
    return defaultAdmins;
  }
  
  try {
    return JSON.parse(adminsData) as AdminUser[];
  } catch {
    // En cas d'erreur, réinitialiser avec les valeurs par défaut
    const defaultAdmins = createDefaultAdmins();
    saveAllAdmins(defaultAdmins);
    return defaultAdmins;
  }
}

// Sauvegarder tous les administrateurs
function saveAllAdmins(admins: AdminUser[]): void {
  localStorage.setItem(ADMIN_USERS_KEY, JSON.stringify(admins));
}

// Créer un nouvel administrateur
export function createAdmin(
  username: string,
  email: string,
  password: string,
  role: 'Super Admin' | 'Admin Financier' | 'Admin du Jeu' | 'Support Client'
): { success: boolean; message: string; admin?: AdminUser } {
  const admins = getAllAdmins();
  
  // Vérifier si l'email existe déjà
  if (admins.some(a => a.email === email)) {
    return { success: false, message: 'Cet email est déjà utilisé' };
  }
  
  const newAdmin: AdminUser = {
    id: generateUserId(),
    username,
    email,
    password: hashPassword(password),
    role,
    status: 'Actif',
    lastLogin: 'Jamais connecté',
    createdAt: new Date().toISOString(),
  };
  
  admins.push(newAdmin);
  saveAllAdmins(admins);
  
  return { success: true, message: 'Administrateur créé avec succès', admin: newAdmin };
}

// Mettre à jour un administrateur
export function updateAdmin(
  adminId: string,
  updates: Partial<AdminUser>
): { success: boolean; message: string } {
  const admins = getAllAdmins();
  const adminIndex = admins.findIndex(a => a.id === adminId);
  
  if (adminIndex === -1) {
    return { success: false, message: 'Administrateur non trouvé' };
  }
  
  // Vérifier si l'email est changé et s'il existe déjà
  if (updates.email && updates.email !== admins[adminIndex].email) {
    if (admins.some(a => a.email === updates.email && a.id !== adminId)) {
      return { success: false, message: 'Cet email est déjà utilisé' };
    }
  }
  
  // Appliquer les mises à jour
  admins[adminIndex] = { ...admins[adminIndex], ...updates };
  saveAllAdmins(admins);
  
  return { success: true, message: 'Administrateur mis à jour avec succès' };
}

// Suspendre/Réactiver un administrateur
export function toggleAdminStatus(adminId: string): { success: boolean; message: string } {
  const admins = getAllAdmins();
  const adminIndex = admins.findIndex(a => a.id === adminId);
  
  if (adminIndex === -1) {
    return { success: false, message: 'Administrateur non trouvé' };
  }
  
  // Empêcher la suspension du dernier Super Admin actif
  if (admins[adminIndex].role === 'Super Admin' && admins[adminIndex].status === 'Actif') {
    const activeSuperAdmins = admins.filter(a => a.role === 'Super Admin' && a.status === 'Actif');
    if (activeSuperAdmins.length === 1) {
      return { success: false, message: 'Impossible de désactiver le dernier Super Admin actif' };
    }
  }
  
  admins[adminIndex].status = admins[adminIndex].status === 'Actif' ? 'Désactivé' : 'Actif';
  saveAllAdmins(admins);
  
  const action = admins[adminIndex].status === 'Actif' ? 'réactivé' : 'désactivé';
  return { success: true, message: `Administrateur ${action} avec succès` };
}

// Supprimer un administrateur
export function deleteAdmin(adminId: string): { success: boolean; message: string } {
  const admins = getAllAdmins();
  const adminIndex = admins.findIndex(a => a.id === adminId);
  
  if (adminIndex === -1) {
    return { success: false, message: 'Administrateur non trouvé' };
  }
  
  // Empêcher la suppression du dernier Super Admin
  if (admins[adminIndex].role === 'Super Admin') {
    const superAdmins = admins.filter(a => a.role === 'Super Admin');
    if (superAdmins.length === 1) {
      return { success: false, message: 'Impossible de supprimer le dernier Super Admin' };
    }
  }
  
  admins.splice(adminIndex, 1);
  saveAllAdmins(admins);
  
  return { success: true, message: 'Administrateur supprimé avec succès' };
}

// Mettre à jour la dernière connexion d'un admin
export function updateAdminLastLogin(email: string): void {
  const admins = getAllAdmins();
  const adminIndex = admins.findIndex(a => a.email === email);
  
  if (adminIndex !== -1) {
    admins[adminIndex].lastLogin = new Date().toISOString();
    saveAllAdmins(admins);
  }
}

// Récupérer le rôle admin de l'utilisateur actuel
export function getCurrentAdminRole(): 'Super Admin' | 'Admin Financier' | 'Admin du Jeu' | 'Support Client' | null {
  const currentUser = getCurrentUser();
  
  if (!currentUser || currentUser.role !== 'admin') {
    return null;
  }
  
  // Pour le moment, le système simple retourne toujours Super Admin
  // Dans une version avancée, on stockerait le rôle spécifique dans User
  const admins = getAllAdmins();
  const admin = admins.find(a => a.email === currentUser.email);
  
  return admin ? admin.role : 'Super Admin';
}

// Initialiser les administrateurs au démarrage
export function initializeAdmins(): void {
  getAllAdmins();
}

================================================================================
--- FICHIER : ./src/utils/authAPI.ts ---
================================================================================

// src/utils/authAPI.ts

import apiClient from '../services/apiClient';

// ===== INTERFACES =====
// Nous gardons ton interface User qui est bien détaillée.
export interface User {
  id: string;
  username: string;
  phoneNumber: string;
  email: string;
  role: 'player' | 'reseller' | 'Super Admin' | 'Admin du Jeu' | 'Support Client' | 'Admin Financier';
  balanceGame: number;
  balanceWinnings: number;
  tokenBalance?: number;
  status: 'active' | 'suspended';
  createdAt: string;
  lastLogin?: string | null;
}

// L'interface de réponse attendue de l'API pour les routes de connexion/inscription
interface AuthResponse {
  user: User;
  token: string;
}

// ===== FONCTIONS D'API =====

/**
 * Connecte un utilisateur.
 * CORRECTION MAJEURE : Cette fonction fait maintenant UN SEUL appel API.
 * Le backend, lors d'une connexion réussie, doit renvoyer à la fois le token et les données de l'utilisateur.
 * Cela rend le processus plus rapide et la gestion des erreurs (404, 401) beaucoup plus simple.
 */
// DANS src/utils/authAPI.ts

export const loginUser = async (credentials: {
  emailOrPhone: string;
  password: string;
}): Promise<{ user: User; token: string }> => {
  const formData = new URLSearchParams();
  formData.append('username', credentials.emailOrPhone); 
  formData.append('password', credentials.password);

  // UN SEUL APPEL qui retourne maintenant tout ce dont on a besoin.
  const response = await apiClient.post('/api/auth/login', formData);
  
  // On retourne directement les données reçues, qui contiennent maintenant 'user' et 'token'.
  return response.data;
};


/**
 * Récupère les informations de l'utilisateur authentifié.
 * CORRECTION : Le token n'est plus passé en argument.
 * Notre apiClient est configuré avec un intercepteur qui ajoute AUTOMATIQUEMENT le token
 * depuis le localStorage à chaque requête. C'est plus propre et plus sûr.
 */
export const getCurrentUser = async (): Promise<User> => {
  const response = await apiClient.get<User>('/api/auth/me');
  return response.data;
};


/**
 * Inscrit un nouveau joueur.
 */
export const registerUser = async (userData: any): Promise<AuthResponse> => {
  // L'endpoint /register attend du JSON.
  // Nous supposons que cet endpoint renvoie aussi l'utilisateur et un token, comme le login.
  const response = await apiClient.post<AuthResponse>('/api/auth/register', userData);
  return response.data;
};


/**
 * Change le mot de passe de l'utilisateur connecté.
 */
export const changePassword = async (passwordData: { current_password: string; new_password: string }): Promise<void> => {
  await apiClient.put('/api/auth/change-password', passwordData);
};


// ----- Fonctions non utilisées dans le flux principal pour l'instant -----

/**
 * Gère la connexion via Google (Placeholder).
 */
export const loginWithGoogle = async (googleToken: string, name: string): Promise<any> => {
  console.warn("La fonctionnalité de connexion Google n'est pas encore implémentée côté backend.");
  throw new Error("Connexion Google non disponible.");
};


/**
 * La déconnexion est gérée côté client en supprimant le token, pas besoin d'appel API.
 */
export const logoutUser = () => {
  console.log("Déconnexion de l'utilisateur (opération côté client).");
};

================================================================================
--- FICHIER : ./src/utils/config.ts ---
================================================================================

/**
 * Configuration de l'application
 */

export const CONFIG = {
  // Mode développement : utilise localStorage si le backend n'est pas accessible
  // Mettre à false pour forcer l'utilisation du backend
  USE_LOCALHOST_FALLBACK: false,
  
  // URL du backend
  API_BASE_URL: import.meta.env.VITE_API_BASE_URL || 'https://together-fresh-alien.ngrok-free.app',
  
  // Afficher les logs de développement
  DEBUG: true,
};


================================================================================
--- FICHIER : ./src/utils/dashboardAPI.ts ---
================================================================================

import apiClient from '../services/apiClient';

// Définit les types de filtres de période que le composant peut utiliser.
export type DashboardPeriod = 'day' | 'week' | 'month' | 'year';
export type RiskTimePeriod = '1h' | 'today' | 'week' | 'all';

// --- Interfaces décrivant la structure des données reçues de l'API ---

// Pour les 4 cartes de statistiques (KPIs)
export interface KpiStats {
  totalRevenue: number;
  revenueTrend: number;
  totalWinnings: number;
  winningsTrend: number;
  totalProfit: number;
  profitTrend: number;
  newPlayers: number;
  newPlayersTrend: number;
}

// Pour chaque point de donnée du graphique des revenus
export interface RevenueDataPoint {
  day: string;
  amount: number;
}

// Pour chaque part du graphique circulaire des jeux
export interface GameDataPoint {
  name: string;
  value: number; // en pourcentage
  color: string;
}

// Pour chaque ligne du tableau des combinaisons à risque
export interface CombinationStat {
  combination: number[];
  operatorName: string;
  count: number;
  totalAmount: number;
  potentialPayout: number;
  riskLevel: 'critical' | 'high' | 'medium' | 'low';
}

// Pour les cartes de résumé de la section "Analyse de Risque"
export interface RiskSummary {
  totalCombinations: number;
  totalAtRisk: number;
  criticalRisk: number;
  highRisk: number;
  mediumRisk: number;
  maxPotentialPayout: number;
}

// L'interface principale qui rassemble toutes les autres.
// C'est la structure complète de la réponse JSON de l'API.
export interface DashboardData {
  kpis: KpiStats;
  revenueLast7Days: RevenueDataPoint[];
  popularGames: GameDataPoint[];
  riskAnalysis: {
    summary: RiskSummary;
    combinations: CombinationStat[];
  };
}

/**
 * Récupère toutes les données consolidées pour le Dashboard Admin depuis l'API.
 * @param period - La période de temps ('day', 'week', 'month', 'year') pour filtrer les données.
 */
export const getDashboardSummary = async (period: DashboardPeriod): Promise<DashboardData> => {
  const response = await apiClient.get<DashboardData>('/api/admin/dashboard-summary', {
    params: { period }, // Envoie `?period=valeur` à l'API
  });
  return response.data;
};

================================================================================
--- FICHIER : ./src/utils/debugAuth.ts ---
================================================================================

// Fonctions de débogage pour tester le système d'authentification

import { getAllPlayers, getAllResellers, getCurrentUser } from './auth';

export function debugShowAllPlayers() {
  const players = getAllPlayers();
  console.log('=== TOUS LES JOUEURS ENREGISTRÉS ===');
  console.log('Nombre total:', players.length);
  players.forEach((player, index) => {
    console.log(`\n${index + 1}. ${player.username}`);
    console.log('   Téléphone:', player.phoneNumber);
    console.log('   Rôle:', player.role);
    console.log('   Solde Jeu:', player.balanceGame);
    console.log('   Solde Gains:', player.balanceWinnings);
  });
  console.log('=====================================\n');
}

export function debugShowAllResellers() {
  const resellers = getAllResellers();
  console.log('=== TOUS LES REVENDEURS ===');
  console.log('Nombre total:', resellers.length);
  resellers.forEach((reseller, index) => {
    console.log(`\n${index + 1}. ${reseller.username}`);
    console.log('   Téléphone:', reseller.phoneNumber);
    console.log('   Jetons:', reseller.tokenBalance);
    console.log('   Rechargé Aujourd\'hui:', reseller.dailyRechargeTotal);
    console.log('   Transactions:', reseller.dailyTransactionsCount);
  });
  console.log('===========================\n');
}

export function debugShowCurrentUser() {
  const user = getCurrentUser();
  console.log('=== UTILISATEUR ACTUEL ===');
  if (user) {
    console.log('Username:', user.username);
    console.log('Téléphone:', user.phoneNumber);
    console.log('Rôle:', user.role);
    console.log('Connecté:', user.isLoggedIn);
    console.log('Solde Jeu:', user.balanceGame);
    console.log('Solde Gains:', user.balanceWinnings);
    if (user.role === 'reseller') {
      console.log('Jetons:', user.tokenBalance);
      console.log('Rechargé Aujourd\'hui:', user.dailyRechargeTotal);
      console.log('Transactions:', user.dailyTransactionsCount);
    }
  } else {
    console.log('Aucun utilisateur connecté');
  }
  console.log('==========================\n');
}

export function debugClearAllData() {
  localStorage.removeItem('lottoHappyUser');
  localStorage.removeItem('lottoHappyAllPlayers');
  localStorage.removeItem('lottoHappyAllResellers');
  console.log('✅ Toutes les données ont été effacées');
}

// Rendre les fonctions accessibles globalement pour le débogage
if (typeof window !== 'undefined') {
  (window as any).debugAuth = {
    showAllPlayers: debugShowAllPlayers,
    showAllResellers: debugShowAllResellers,
    showCurrentUser: debugShowCurrentUser,
    clearAllData: debugClearAllData,
  };
  console.log('🔧 Fonctions de débogage disponibles:');
  console.log('   window.debugAuth.showAllPlayers() - Afficher tous les joueurs');
  console.log('   window.debugAuth.showAllResellers() - Afficher tous les revendeurs');
  console.log('   window.debugAuth.showCurrentUser() - Afficher l\'utilisateur actuel');
  console.log('   window.debugAuth.clearAllData() - Effacer toutes les données');
}

================================================================================
--- FICHIER : ./src/utils/debugResellers.ts ---
================================================================================

// 🔧 Script de débogage pour les revendeurs
// Ouvrir la console et taper : debugResellers()

import { getAllResellers, createReseller, hashPassword } from './auth';

// Fonction pour déboguer les revendeurs
export function debugResellers() {
  console.log('=== 🔍 DEBUG REVENDEURS ===');
  
  const resellers = getAllResellers();
  console.log(`📊 Nombre total de revendeurs: ${resellers.length}`);
  
  console.log('\n📋 Liste des revendeurs:');
  resellers.forEach((r, index) => {
    console.log(`\n${index + 1}. ${r.username}`);
    console.log(`   📞 Téléphone: ${r.phoneNumber}`);
    console.log(`   📧 Email: ${r.email}`);
    console.log(`   💰 Solde Jetons: ${(r.tokenBalance || 0).toLocaleString('fr-FR')} F`);
    console.log(`   ✅ Statut: ${r.status || 'active'}`);
    console.log(`   🔑 Hash Password: ${r.password.substring(0, 20)}...`);
  });
  
  // Vérifier le localStorage
  const storedResellers = localStorage.getItem('loto_happy_resellers');
  console.log('\n💾 Données brutes localStorage (loto_happy_resellers):');
  console.log(storedResellers ? JSON.parse(storedResellers) : 'Vide');
  
  // Vérifier le store unifié
  const unifiedStore = localStorage.getItem('loto_happy_users');
  console.log('\n🔗 Store unifié (loto_happy_users):');
  const users = unifiedStore ? JSON.parse(unifiedStore) : [];
  const resellersInUnified = users.filter((u: any) => u.role === 'reseller');
  console.log(`   Revendeurs dans le store unifié: ${resellersInUnified.length}`);
  
  return {
    total: resellers.length,
    resellers: resellers.map(r => ({
      username: r.username,
      phone: r.phoneNumber,
      email: r.email,
      status: r.status,
      tokenBalance: r.tokenBalance
    }))
  };
}

// Tester la création d'un revendeur
export function testCreateReseller() {
  console.log('=== 🧪 TEST CRÉATION REVENDEUR ===');
  
  const testData = {
    username: 'TEST_DEBUG_' + Date.now(),
    phoneNumber: '228' + Math.floor(Math.random() * 100000000),
    email: `test.debug.${Date.now()}@lotohappy.com`,
    password: 'Test123',
    tokenBalance: 50000
  };
  
  console.log('📝 Création avec les données:', testData);
  
  const result = createReseller(
    testData.username,
    testData.phoneNumber,
    testData.email,
    testData.password,
    testData.tokenBalance
  );
  
  console.log('📊 Résultat:', result);
  
  if (result.success) {
    console.log('✅ Revendeur créé avec succès !');
    console.log('🔑 Pour se connecter:');
    console.log(`   Numéro: ${testData.phoneNumber}`);
    console.log(`   Mot de passe: ${testData.password}`);
    
    // Vérifier immédiatement
    setTimeout(() => {
      const resellers = getAllResellers();
      const found = resellers.find(r => r.phoneNumber === testData.phoneNumber);
      console.log('\n🔍 Vérification dans la liste:', found ? '✅ Trouvé' : '❌ Non trouvé');
      if (found) {
        console.log('   Username:', found.username);
        console.log('   Status:', found.status);
        console.log('   Token Balance:', found.tokenBalance);
      }
    }, 100);
  } else {
    console.log('❌ Échec de la création:', result.message);
  }
  
  return result;
}

// Tester la connexion d'un revendeur
export function testResellerLogin(phoneNumber: string, password: string) {
  console.log('=== 🔐 TEST CONNEXION REVENDEUR ===');
  console.log(`📞 Numéro: ${phoneNumber}`);
  console.log(`🔑 Mot de passe: ${password}`);
  
  const resellers = getAllResellers();
  const cleanNumber = phoneNumber.replace(/[\s+]/g, '');
  
  console.log('🔍 Recherche avec numéro nettoyé:', cleanNumber);
  
  const found = resellers.find(r => r.phoneNumber === cleanNumber);
  
  if (found) {
    console.log('✅ Revendeur trouvé:', found.username);
    console.log('   Status:', found.status);
    
    const passwordHash = hashPassword(password);
    const passwordMatch = found.password === passwordHash;
    
    console.log('🔑 Vérification mot de passe:');
    console.log('   Hash saisi:', passwordHash.substring(0, 30) + '...');
    console.log('   Hash stocké:', found.password.substring(0, 30) + '...');
    console.log('   Match:', passwordMatch ? '✅ OUI' : '❌ NON');
    
    if (passwordMatch && found.status !== 'suspended') {
      console.log('✅ Connexion devrait réussir !');
      return true;
    } else if (found.status === 'suspended') {
      console.log('❌ Compte suspendu');
      return false;
    } else {
      console.log('❌ Mot de passe incorrect');
      return false;
    }
  } else {
    console.log('❌ Revendeur non trouvé');
    console.log('📋 Revendeurs disponibles:');
    resellers.forEach(r => {
      console.log(`   - ${r.username}: ${r.phoneNumber}`);
    });
    return false;
  }
}

// Nettoyer tous les revendeurs de test
export function cleanupTestResellers() {
  console.log('=== 🧹 NETTOYAGE REVENDEURS TEST ===');
  
  const resellers = getAllResellers();
  const testResellers = resellers.filter(r => 
    r.username.startsWith('TEST_') || 
    r.email.includes('test.debug')
  );
  
  console.log(`🗑️ ${testResellers.length} revendeurs de test trouvés`);
  testResellers.forEach(r => {
    console.log(`   - ${r.username} (${r.phoneNumber})`);
  });
  
  if (testResellers.length > 0) {
    console.log('\n⚠️ Pour les supprimer, utilisez la fonction Admin');
  }
  
  return testResellers;
}

// Exporter pour utilisation dans la console
if (typeof window !== 'undefined') {
  (window as any).debugResellers = debugResellers;
  (window as any).testCreateReseller = testCreateReseller;
  (window as any).testResellerLogin = testResellerLogin;
  (window as any).cleanupTestResellers = cleanupTestResellers;
  
  console.log('🔧 Fonctions de debug disponibles:');
  console.log('   - debugResellers() : Afficher tous les revendeurs');
  console.log('   - testCreateReseller() : Créer un revendeur de test');
  console.log('   - testResellerLogin(phone, password) : Tester une connexion');
  console.log('   - cleanupTestResellers() : Lister les revendeurs de test');
}


================================================================================
--- FICHIER : ./src/utils/draws.ts ---
================================================================================

// Système de gestion des tirages et gains - VERSION REFACTORISÉE
// Un tirage = Un opérateur + date/heure
// Les joueurs choisissent leur type de pari pour un tirage

import { 
  getOperatorById,
  getAllOperators,
  BetType, 
  BET_TYPES_CONFIG, 
  generateNAP2Combinations, 
  invertNumber,
  Draw as DrawType
} from './games';

// ===== INTERFACES =====

// On utilise Draw de games.ts, mais on ajoute des champs supplémentaires pour l'admin
export interface DrawExtended extends DrawType {
  participants?: number;
  winners?: number;
  totalBets?: number;
  totalWinnings?: number;
  profit?: number;
}

export interface Ticket {
  id: string;
  userId: string;
  username: string;
  drawId: string; // ID du tirage (pas drawId number, maintenant string)
  numbers: string; // Numéros choisis par le joueur
  betAmount: number;
  purchaseDate: string; // ISO string
  status?: 'pending' | 'won' | 'lost'; // Statut du ticket
  winAmount?: number; // Montant gagné si gagnant
  // Champs pour les paris avancés
  betType?: BetType; // Type de pari
  baseNumber?: number; // Pour BANKA
  associatedNumbers?: number[]; // Pour BANKA
  position?: 'first' | 'last'; // Pour CHANCE_PLUS
  combinations?: number[][]; // Pour PERMUTATION (toutes les combinaisons générées)
}

export interface BetHistoryItem {
  id: string;
  drawId: string;
  operatorName: string;
  numbers: string;
  betAmount: number;
  purchaseDate: string;
  drawDate: string;
  drawTime: string;
  status: 'upcoming' | 'pending' | 'won' | 'lost';
  winAmount?: number;
  winningNumbers?: number[];
  betType?: BetType;
}

export interface WinNotification {
  id: number;
  userId: string;
  drawId: string;
  operatorName: string;
  drawDate: string;
  winningNumbers: number[];
  playerNumbers: string;
  matchCount: number;
  winAmount: number;
  timestamp: string;
  read: boolean;
}

// Clés de stockage
const TICKETS_KEY = 'loto_happy_tickets';
const WIN_NOTIFICATIONS_KEY = 'loto_happy_win_notifications';
const USERS_KEY = 'loto_happy_users';
const CURRENT_USER_KEY = 'lottoHappyUser';

// ===== GESTION DES TIRAGES =====
// Note: Les tirages sont maintenant gérés dans games.ts via localStorage 'loto_happy_draws'

import { 
  getDrawsFromLocalStorage, 
  saveDrawsToLocalStorage, 
  getDrawById as getDrawByIdFromGames,
  getAllUpcomingDraws as getAllUpcomingDrawsFromGames
} from './games';

// Wrapper pour compatibilité
export function getDraws(): DrawExtended[] {
  return getDrawsFromLocalStorage() as DrawExtended[];
}

export function saveDraws(draws: DrawExtended[]): void {
  saveDrawsToLocalStorage(draws);
}

export function getDrawsByStatus(status: 'upcoming' | 'pending' | 'completed'): DrawExtended[] {
  return getDraws().filter(draw => draw.status === status);
}

// Mettre à jour les statuts des tirages (upcoming → pending si date/heure passée)
export function updateDrawStatuses(): void {
  const draws = getDraws();
  const now = new Date();
  let updated = false;
  
  draws.forEach(draw => {
    if (draw.status === 'upcoming') {
      const drawDateTime = new Date(`${draw.date}T${draw.time}:00`);
      if (now > drawDateTime) {
        draw.status = 'pending';
        updated = true;
      }
    }
  });
  
  if (updated) {
    saveDraws(draws);
  }
}

// ===== GESTION DES TICKETS (PARIS) =====

export function getTickets(): Ticket[] {
  const stored = localStorage.getItem(TICKETS_KEY);
  return stored ? JSON.parse(stored) : [];
}

export function saveTickets(tickets: Ticket[]): void {
  localStorage.setItem(TICKETS_KEY, JSON.stringify(tickets));
}

// Créer un nouveau ticket (pari)
export function createTicket(
  userId: string,
  username: string,
  drawId: string,
  numbers: string,
  betAmount: number,
  betType?: BetType,
  additionalData?: {
    baseNumber?: number;
    associatedNumbers?: number[];
    position?: 'first' | 'last';
    combinations?: number[][];
  }
): Ticket {
  const tickets = getTickets();
  
  const ticket: Ticket = {
    id: `ticket_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
    userId,
    username,
    drawId,
    numbers,
    betAmount,
    purchaseDate: new Date().toISOString(),
    status: 'pending',
    betType: betType || 'NAP2', // Par défaut NAP2
    ...additionalData
  };
  
  tickets.push(ticket);
  saveTickets(tickets);
  
  // Mettre à jour le nombre de participants du tirage
  updateDrawParticipants(drawId);
  
  return ticket;
}

// Récupérer les tickets pour un tirage
export function getTicketsForDraw(drawId: string): Ticket[] {
  return getTickets().filter(ticket => ticket.drawId === drawId);
}

// Récupérer l'historique des paris d'un joueur
export function getBetHistory(userId: string): BetHistoryItem[] {
  const tickets = getTickets().filter(t => t.userId === userId);
  const draws = getDraws();
  
  return tickets.map(ticket => {
    const draw = draws.find(d => d.id === ticket.drawId);
    if (!draw) return null;
    
    const operator = getOperatorById(draw.operatorId);
    const operatorName = operator ? operator.name : 'Opérateur inconnu';
    
    let status: 'upcoming' | 'pending' | 'won' | 'lost' = draw.status === 'completed' 
      ? (ticket.status === 'won' ? 'won' : 'lost')
      : draw.status;
    
    return {
      id: ticket.id,
      drawId: ticket.drawId,
      operatorName,
      numbers: ticket.numbers,
      betAmount: ticket.betAmount,
      purchaseDate: ticket.purchaseDate,
      drawDate: draw.date,
      drawTime: draw.time,
      status,
      winAmount: ticket.winAmount,
      winningNumbers: draw.winningNumbers,
      betType: ticket.betType
    };
  }).filter(item => item !== null) as BetHistoryItem[];
}

// Mettre à jour le nombre de participants d'un tirage
function updateDrawParticipants(drawId: string): void {
  const draws = getDraws();
  const drawIndex = draws.findIndex(d => d.id === drawId);
  
  if (drawIndex !== -1) {
    const tickets = getTicketsForDraw(drawId);
    draws[drawIndex].participants = tickets.length;
    saveDraws(draws);
  }
}

// ===== GESTION DES GAINS ET RÉSULTATS =====

// Comparer les numéros et compter les correspondances
function countMatches(playerNumbers: string, winningNumbers: number[]): number {
  const playerNums = playerNumbers.split(',').map(n => parseInt(n.trim()));
  return playerNums.filter(num => winningNumbers.includes(num)).length;
}

/**
 * Calculer les gains selon le type de pari avancé
 */
export function calculateAdvancedWinAmount(ticket: Ticket, draw: DrawExtended): number {
  const betType = ticket.betType || 'NAP2';
  const betConfig = BET_TYPES_CONFIG[betType];
  if (!betConfig) return 0;

  // Utiliser le multiplicateur du tirage si disponible, sinon celui par défaut
  const multiplier = draw.multipliers?.[betType] ?? betConfig.defaultMultiplier;

  const winningNums = draw.winningNumbers || [];

  switch (betType) {
    case 'NAP1':
    case 'NAP2':
    case 'NAP3':
    case 'NAP4':
    case 'NAP5': {
      // Paris NAP simples : compter les correspondances exactes
      const playerNums = ticket.numbers.split(',').map(n => parseInt(n.trim()));
      const matchCount = playerNums.filter(num => winningNums.includes(num)).length;
      
      // Pour gagner, il faut TOUS les numéros
      if (matchCount === playerNums.length) {
        return ticket.betAmount * multiplier;
      }
      return 0;
    }

    case 'PERMUTATION': {
      // Pour PERMUTATION, vérifier si au moins UNE combinaison NAP2 est gagnante
      const combinations = ticket.combinations || [];
      let winningCombos = 0;
      
      for (const combo of combinations) {
        if (combo.every(num => winningNums.includes(num))) {
          winningCombos++;
        }
      }
      
      if (winningCombos > 0) {
        // Gain = nombre de combos gagnantes × (mise par combo) × multiplicateur
        const betPerCombo = ticket.betAmount / combinations.length;
        return Math.floor(winningCombos * betPerCombo * multiplier);
      }
      return 0;
    }

    case 'BANKA': {
      // Pour BANKA, vérifier que le numéro de base ET au moins un autre sont sortis
      const baseNumber = ticket.baseNumber;
      const associatedNumbers = ticket.associatedNumbers || [];
      
      if (!baseNumber) return 0;
      
      // Le numéro de base doit sortir
      if (!winningNums.includes(baseNumber)) return 0;
      
      // Au moins un des numéros associés doit sortir
      const matchingAssociated = associatedNumbers.filter(num => winningNums.includes(num));
      
      if (matchingAssociated.length > 0) {
        // Gain proportionnel au nombre de numéros associés gagnants
        return Math.floor(ticket.betAmount * multiplier * matchingAssociated.length / associatedNumbers.length);
      }
      return 0;
    }

    case 'CHANCE_PLUS': {
      // Pour CHANCE_PLUS, vérifier la position exacte
      const playerNum = parseInt(ticket.numbers);
      const position = ticket.position;
      
      if (position === 'first' && winningNums[0] === playerNum) {
        return ticket.betAmount * multiplier;
      }
      if (position === 'last' && winningNums[winningNums.length - 1] === playerNum) {
        return ticket.betAmount * multiplier;
      }
      return 0;
    }

    case 'ANAGRAMME': {
      // Pour ANAGRAMME, vérifier si le numéro OU son inversé est sorti
      const playerNum = parseInt(ticket.numbers);
      const inverted = invertNumber(playerNum);
      
      if (winningNums.includes(playerNum) || (inverted && winningNums.includes(inverted))) {
        return ticket.betAmount * multiplier;
      }
      return 0;
    }

    default:
      return 0;
  }
}

// Récupérer tous les utilisateurs
function getUsers(): any[] {
  const stored = localStorage.getItem(USERS_KEY);
  return stored ? JSON.parse(stored) : [];
}

// Sauvegarder tous les utilisateurs
function saveUsers(users: any[]): void {
  localStorage.setItem(USERS_KEY, JSON.stringify(users));
}

// Créditer les gains au joueur
function creditWinningsToPlayer(userId: string, amount: number, operatorName: string): void {
  const users = getUsers();
  const userIndex = users.findIndex((u: any) => u.id === userId);
  
  if (userIndex !== -1) {
    // Ajouter au solde de gains
    users[userIndex].balanceWinnings = (users[userIndex].balanceWinnings || 0) + amount;
    
    // Ajouter une transaction dans l'historique
    if (!users[userIndex].playerTransactionHistory) {
      users[userIndex].playerTransactionHistory = [];
    }
    
    users[userIndex].playerTransactionHistory.unshift({
      id: `win_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
      type: 'WIN',
      description: `Gain au ${operatorName}`,
      amount: amount,
      balanceAfter: users[userIndex].balanceWinnings,
      date: new Date().toISOString(),
      metadata: {
        operatorName: operatorName
      }
    });
    
    saveUsers(users);
    
    // Mettre à jour aussi l'utilisateur connecté si c'est lui
    const currentUserStored = localStorage.getItem(CURRENT_USER_KEY);
    if (currentUserStored) {
      const currentUser = JSON.parse(currentUserStored);
      if (currentUser.id === userId) {
        currentUser.balanceWinnings = users[userIndex].balanceWinnings;
        currentUser.playerTransactionHistory = users[userIndex].playerTransactionHistory;
        localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
      }
    }
    
    // Synchroniser avec lottoHappyAllPlayers
    const allPlayersKey = 'lottoHappyAllPlayers';
    const playersStored = localStorage.getItem(allPlayersKey);
    if (playersStored) {
      const allPlayers = JSON.parse(playersStored);
      const playerIndex = allPlayers.findIndex((p: any) => p.id === userId);
      if (playerIndex !== -1) {
        allPlayers[playerIndex].balanceWinnings = users[userIndex].balanceWinnings;
        allPlayers[playerIndex].playerTransactionHistory = users[userIndex].playerTransactionHistory;
        localStorage.setItem(allPlayersKey, JSON.stringify(allPlayers));
      }
    }
  }
}

// Créer une notification de gain
function createWinNotification(data: Omit<WinNotification, 'id' | 'timestamp' | 'read'>): void {
  const notifications = getWinNotifications();
  const newNotification: WinNotification = {
    ...data,
    id: Math.max(...notifications.map(n => n.id), 0) + 1,
    timestamp: new Date().toISOString(),
    read: false
  };
  notifications.push(newNotification);
  localStorage.setItem(WIN_NOTIFICATIONS_KEY, JSON.stringify(notifications));
}

// Saisir les résultats d'un tirage et distribuer les gains
export function submitDrawResults(drawId: string, winningNumbers: number[]): void {
  const draws = getDraws();
  const drawIndex = draws.findIndex(d => d.id === drawId);
  
  if (drawIndex === -1) return;
  
  const draw = draws[drawIndex];
  const operator = getOperatorById(draw.operatorId);
  const operatorName = operator ? operator.name : 'Opérateur inconnu';
  
  // Mettre à jour le tirage avec les numéros gagnants
  draws[drawIndex].winningNumbers = winningNumbers;
  
  const tickets = getTicketsForDraw(drawId);
  
  let totalWinnings = 0;
  let winnersCount = 0;
  let totalBets = 0;
  
  // Mettre à jour tous les tickets
  const allTickets = getTickets();
  
  tickets.forEach(ticket => {
    totalBets += ticket.betAmount;
    
    // Calculer les gains
    const winAmount = calculateAdvancedWinAmount(ticket, draws[drawIndex]);
    
    // Calcul du matchCount pour les notifications
    const matchCount = countMatches(ticket.numbers, winningNumbers);
    
    if (winAmount > 0) {
      // Marquer le ticket comme gagnant
      const ticketIndex = allTickets.findIndex(t => t.id === ticket.id);
      if (ticketIndex !== -1) {
        allTickets[ticketIndex].status = 'won';
        allTickets[ticketIndex].winAmount = winAmount;
      }
      
      // Créer une notification de gain
      createWinNotification({
        userId: ticket.userId,
        drawId: draw.id,
        operatorName,
        drawDate: `${draw.date} ${draw.time}`,
        winningNumbers: winningNumbers,
        playerNumbers: ticket.numbers,
        matchCount: matchCount,
        winAmount: winAmount
      });
      
      // Créditer le solde de gains du joueur
      creditWinningsToPlayer(ticket.userId, winAmount, operatorName);
      
      totalWinnings += winAmount;
      winnersCount++;
    } else {
      // Marquer le ticket comme perdant
      const ticketIndex = allTickets.findIndex(t => t.id === ticket.id);
      if (ticketIndex !== -1) {
        allTickets[ticketIndex].status = 'lost';
      }
    }
  });
  
  // Sauvegarder les tickets mis à jour
  saveTickets(allTickets);
  
  const profit = totalBets - totalWinnings;
  
  // Mettre à jour le tirage et le marquer comme complété
  draws[drawIndex] = {
    ...draw,
    status: 'completed',
    winningNumbers: winningNumbers,
    winners: winnersCount,
    participants: tickets.length,
    totalBets: totalBets,
    totalWinnings: totalWinnings,
    profit: profit
  };
  
  saveDraws(draws);
}

// ===== GESTION DES NOTIFICATIONS =====

export function getWinNotifications(userId?: string): WinNotification[] {
  const stored = localStorage.getItem(WIN_NOTIFICATIONS_KEY);
  const notifications: WinNotification[] = stored ? JSON.parse(stored) : [];
  
  if (userId) {
    return notifications.filter(n => n.userId === userId);
  }
  
  return notifications;
}

export function getUnreadWinNotifications(userId: string): WinNotification[] {
  return getWinNotifications(userId).filter(n => !n.read);
}

export function markNotificationAsRead(notificationId: number): void {
  const notifications = getWinNotifications();
  const index = notifications.findIndex(n => n.id === notificationId);
  
  if (index !== -1) {
    notifications[index].read = true;
    localStorage.setItem(WIN_NOTIFICATIONS_KEY, JSON.stringify(notifications));
  }
}

export function markAllNotificationsAsRead(userId: string): void {
  const notifications = getWinNotifications();
  const updated = notifications.map(n => 
    n.userId === userId ? { ...n, read: true } : n
  );
  localStorage.setItem(WIN_NOTIFICATIONS_KEY, JSON.stringify(updated));
}

// ===== STATISTIQUES DES COMBINAISONS =====

export type TimePeriod = '1h' | 'today' | 'week' | 'all';
export type RiskLevel = 'low' | 'medium' | 'high' | 'critical';

export interface CombinationStat {
  combination: number[];
  combinationStr: string;
  count: number;
  totalAmount: number;
  operatorId: string;
  operatorName: string;
  riskLevel: RiskLevel;
  lastPlayed: string;
  potentialPayout: number;
}

// Calculer le niveau de risque
function calculateRiskLevel(potentialPayout: number): RiskLevel {
  if (potentialPayout > 5000000) return 'critical';
  if (potentialPayout > 2000000) return 'high';
  if (potentialPayout > 500000) return 'medium';
  return 'low';
}

// Filtrer les tickets par période
function filterTicketsByPeriod(tickets: Ticket[], period: TimePeriod): Ticket[] {
  if (period === 'all') return tickets;
  
  const now = new Date();
  const filterDate = new Date();
  
  switch (period) {
    case '1h':
      filterDate.setHours(now.getHours() - 1);
      break;
    case 'today':
      filterDate.setHours(0, 0, 0, 0);
      break;
    case 'week':
      filterDate.setDate(now.getDate() - 7);
      break;
  }
  
  return tickets.filter(ticket => {
    const ticketDate = new Date(ticket.purchaseDate);
    return ticketDate >= filterDate;
  });
}

// Analyser les combinaisons les plus jouées
export function getCombinationStats(period: TimePeriod = 'today'): CombinationStat[] {
  let tickets = getTickets();
  tickets = filterTicketsByPeriod(tickets, period);
  
  // Filtrer uniquement les tickets en attente
  const draws = getDraws();
  const upcomingDrawIds = draws
    .filter(d => d.status === 'upcoming' || d.status === 'pending')
    .map(d => d.id);
  
  tickets = tickets.filter(ticket => upcomingDrawIds.includes(ticket.drawId));
  
  // Grouper par combinaison
  const combinationMap = new Map<string, {
    combination: number[];
    count: number;
    totalAmount: number;
    drawId: string;
    lastPlayed: string;
  }>();
  
  tickets.forEach(ticket => {
    const numbers = ticket.numbers.split(',').map(n => parseInt(n.trim())).sort((a, b) => a - b);
    const key = `${ticket.drawId}_${numbers.join(',')}`;
    
    const existing = combinationMap.get(key);
    
    if (existing) {
      existing.count++;
      existing.totalAmount += ticket.betAmount;
      if (ticket.purchaseDate > existing.lastPlayed) {
        existing.lastPlayed = ticket.purchaseDate;
      }
    } else {
      combinationMap.set(key, {
        combination: numbers,
        count: 1,
        totalAmount: ticket.betAmount,
        drawId: ticket.drawId,
        lastPlayed: ticket.purchaseDate
      });
    }
  });
  
  // Convertir en tableau et calculer les statistiques
  const stats: CombinationStat[] = [];
  
  combinationMap.forEach((value) => {
    const draw = draws.find(d => d.id === value.drawId);
    if (!draw) return;
    
    const operator = getOperatorById(draw.operatorId);
    const operatorName = operator ? operator.name : 'Inconnu';
    
    // Estimation simple du gain potentiel : totalAmount * multiplicateur moyen
    const avgMultiplier = 500; // Valeur moyenne
    const potentialPayout = value.totalAmount * avgMultiplier;
    
    const riskLevel = calculateRiskLevel(potentialPayout);
    
    stats.push({
      combination: value.combination,
      combinationStr: value.combination.join(', '),
      count: value.count,
      totalAmount: value.totalAmount,
      operatorId: draw.operatorId,
      operatorName,
      riskLevel,
      lastPlayed: value.lastPlayed,
      potentialPayout
    });
  });
  
  // Trier par gain potentiel décroissant
  stats.sort((a, b) => b.potentialPayout - a.potentialPayout);
  
  return stats;
}

// Obtenir un résumé des risques
export function getRiskSummary(period: TimePeriod = 'today'): {
  totalCombinations: number;
  totalAtRisk: number;
  criticalRisk: number;
  highRisk: number;
  mediumRisk: number;
  lowRisk: number;
  maxPotentialPayout: number;
} {
  const stats = getCombinationStats(period);
  
  return {
    totalCombinations: stats.length,
    totalAtRisk: stats.reduce((sum, s) => sum + s.totalAmount, 0),
    criticalRisk: stats.filter(s => s.riskLevel === 'critical').length,
    highRisk: stats.filter(s => s.riskLevel === 'high').length,
    mediumRisk: stats.filter(s => s.riskLevel === 'medium').length,
    lowRisk: stats.filter(s => s.riskLevel === 'low').length,
    maxPotentialPayout: Math.max(...stats.map(s => s.potentialPayout), 0)
  };
}

// ===== STATISTIQUES POUR LE DASHBOARD ADMIN =====

// Filtrer les tickets par période
function filterTicketsByDate(tickets: Ticket[], period: 'today' | 'week' | 'all'): Ticket[] {
  if (period === 'all') return tickets;
  
  const now = new Date();
  const filterDate = new Date();
  
  if (period === 'today') {
    filterDate.setHours(0, 0, 0, 0);
  } else if (period === 'week') {
    filterDate.setDate(now.getDate() - 7);
  }
  
  return tickets.filter(ticket => {
    const ticketDate = new Date(ticket.purchaseDate);
    return ticketDate >= filterDate;
  });
}

// Obtenir les statistiques du dashboard
export function getDashboardStats(period: 'today' | 'week' | 'all' = 'today'): {
  totalRevenue: number;
  totalWinnings: number;
  totalProfit: number;
  newPlayers: number;
  totalPlayers: number;
  totalBets: number;
} {
  const tickets = filterTicketsByDate(getTickets(), period);
  const draws = getDraws();
  
  // Calculer le chiffre d'affaires (somme des mises)
  const totalRevenue = tickets.reduce((sum, ticket) => sum + ticket.betAmount, 0);
  
  // Calculer les gains payés (somme des gains)
  const totalWinnings = tickets
    .filter(ticket => ticket.status === 'won' && ticket.winAmount)
    .reduce((sum, ticket) => sum + (ticket.winAmount || 0), 0);
  
  // Calculer le bénéfice brut
  const totalProfit = totalRevenue - totalWinnings;
  
  // Compter les nouveaux joueurs (enregistrés dans la période)
  const USERS_KEY = 'loto_happy_users';
  const stored = localStorage.getItem(USERS_KEY);
  const allUsers = stored ? JSON.parse(stored) : [];
  
  const filterDate = new Date();
  if (period === 'today') {
    filterDate.setHours(0, 0, 0, 0);
  } else if (period === 'week') {
    filterDate.setDate(filterDate.getDate() - 7);
  }
  
  const newPlayers = period === 'all' ? allUsers.length : allUsers.filter((user: any) => {
    if (!user.createdAt) return false;
    const userDate = new Date(user.createdAt);
    return userDate >= filterDate;
  }).length;
  
  return {
    totalRevenue,
    totalWinnings,
    totalProfit,
    newPlayers,
    totalPlayers: allUsers.length,
    totalBets: tickets.length
  };
}

// Obtenir les revenus des 7 derniers jours
export function getLast7DaysRevenue(): { day: string; amount: number }[] {
  const tickets = getTickets();
  const result: { day: string; amount: number }[] = [];
  const now = new Date();
  
  // Jours de la semaine en français
  const dayNames = ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'];
  
  for (let i = 6; i >= 0; i--) {
    const date = new Date(now);
    date.setDate(date.getDate() - i);
    date.setHours(0, 0, 0, 0);
    
    const nextDate = new Date(date);
    nextDate.setDate(nextDate.getDate() + 1);
    
    const dayTickets = tickets.filter(ticket => {
      const ticketDate = new Date(ticket.purchaseDate);
      return ticketDate >= date && ticketDate < nextDate;
    });
    
    const amount = dayTickets.reduce((sum, ticket) => sum + ticket.betAmount, 0);
    
    result.push({
      day: dayNames[date.getDay()],
      amount
    });
  }
  
  return result;
}

// Obtenir les statistiques des opérateurs les plus populaires
export function getOperatorStats(): { name: string; value: number; color: string }[] {
  const tickets = getTickets();
  const draws = getDraws();
  const operators = getAllOperators();
  
  // Compter les paris par opérateur
  const operatorCounts: { [key: string]: number } = {};
  
  tickets.forEach(ticket => {
    const draw = draws.find(d => d.id === ticket.drawId);
    if (draw && draw.operatorId) {
      const operator = getOperatorById(draw.operatorId);
      if (operator) {
        operatorCounts[operator.name] = (operatorCounts[operator.name] || 0) + 1;
      }
    }
  });
  
  // Calculer le total des paris
  const totalBets = tickets.length;
  
  // Si aucune donnée, retourner les 5 opérateurs avec 0%
  if (totalBets === 0 || Object.keys(operatorCounts).length === 0) {
    return operators.map(op => ({
      name: op.name,
      value: 0,
      color: op.color
    }));
  }
  
  // Convertir en tableau avec pourcentages
  const stats = Object.entries(operatorCounts).map(([name, count]) => {
    const operator = operators.find(op => op.name === name);
    return {
      name,
      value: totalBets > 0 ? Math.round((count / totalBets) * 100) : 0,
      color: operator?.color || '#888888'
    };
  });
  
  // Trier par popularité décroissante
  stats.sort((a, b) => b.value - a.value);
  
  return stats;
}


================================================================================
--- FICHIER : ./src/utils/drawsAPI.ts ---
================================================================================

// src/utils/drawsAPI.ts

import apiClient from '../services/apiClient';

// ====================================================================
// ===== INTERFACES (Mises à jour avec le nouveau statut 'pending') ====
// ====================================================================

export type Multipliers = Record<string, number>;

export interface Draw {
  id: string;
  operatorName: string;
  operatorId: string;
  drawDate: string;
  // MISE À JOUR : Ajout du statut 'pending'
  status: 'upcoming' | 'pending' | 'completed' | 'archived' | 'cancelled';
  winningNumbers: number[] | null;
}

export interface PaginatedDraws {
  total: number;
  items: Draw[];
}

export interface Ticket {
  id: string;
  userId: string;
  username: string;
  drawId: string;
  betType: string;
  numbers: string;
  betAmount: number;
  purchaseDate: string;
  status: 'pending' | 'won' | 'lost';
  winAmount?: number | null;
}

export interface BetHistoryItem extends Ticket {
  operatorName: string;
  drawDate: string;
  winningNumbers?: number[] | null;
}

export interface WinNotification {
  id: string;
  userId: string;
  drawId: string;
  operatorName: string;
  drawDate: string;
  winningNumbers: number[];
  playerNumbers: string;
  winAmount: number;
  timestamp: string;
  read: boolean;
}


// ====================================================================
// ===== FONCTIONS POUR L'INTERFACE JOUEUR (Inchangées) =============
// ====================================================================

export const getUpcomingDraws = async (): Promise<Draw[]> => {
  const response = await apiClient.get<Draw[]>('/api/draws/upcoming');
  return response.data;
};
export const getCompletedDraws = async (): Promise<Draw[]> => {
  const response = await apiClient.get<Draw[]>('/api/draws/completed');
  return response.data;
};
export const getDrawById = async (drawId: string): Promise<Draw> => {
  const response = await apiClient.get<Draw>(`/api/draws/${drawId}`);
  return response.data;
};
export const createTicket = async (ticketData: { drawId: string; betType: string; numbers: string; betAmount: number; }): Promise<{ ticket: Ticket }> => {
  const response = await apiClient.post<{ ticket: Ticket }>('/api/tickets', ticketData);
  return { ticket: response.data.ticket };
};
export const getBetHistory = async (): Promise<BetHistoryItem[]> => {
  const response = await apiClient.get<BetHistoryItem[]>('/api/tickets/me');
  return response.data;
};
export const getUserNotifications = async (): Promise<WinNotification[]> => {
  console.warn("La fonction getUserNotifications n'est pas encore implémentée.");
  return [];
};
export const markNotificationAsRead = async (notificationId: string): Promise<void> => {
  await apiClient.put(`/api/notifications/${notificationId}/read`);
};


// =====================================================================
// ===== FONCTIONS POUR LE PANEL ADMIN (Finalisées et Corrigées) ====
// =====================================================================

// MISE À JOUR : Ajout du statut 'pending'
type AdminDrawStatus = 'upcoming' | 'pending' | 'completed' | 'archived' | 'cancelled';

/**
 * 1. [ADMIN] Récupère une liste de tirages filtrée par statut.
 */
export const getAdminDrawsByStatus = async (status: AdminDrawStatus): Promise<Draw[]> => {
  const response = await apiClient.get<PaginatedDraws>('/api/admin/draws', {
    params: { status },
  });
  return response.data.items;
};

/**
 * 2. [ADMIN] Crée un nouveau tirage.
 */
export const createAdminDraw = async (drawData: { operatorId: string; date: string; time: string; multipliers: Multipliers }): Promise<Draw> => {
  const response = await apiClient.post<Draw>('/api/draws', drawData);
  return response.data;
};

/**
 * 3. [ADMIN] Saisit les numéros gagnants pour un tirage.
 */
export const publishDrawResults = async (drawId: string, winningNumbers: number[]): Promise<any> => {
  const response = await apiClient.put(`/api/draws/${drawId}/results`, { winningNumbers });
  return response.data;
};

/**
 * 4. [ADMIN] Annule ou archive un tirage.
 */
export const updateAdminDrawStatus = async (drawId: string, status: 'cancelled' | 'archived'): Promise<Draw> => {
  const response = await apiClient.patch<Draw>(`/api/admin/draws/${drawId}/status`, { status });
  return response.data;
};

================================================================================
--- FICHIER : ./src/utils/games.ts ---
================================================================================

// ===== CONFIGURATION DES OPÉRATEURS DE LOTERIE =====
// Un opérateur = Une société de loterie (ex: Lotto Kadoo, Bénin Lotto)
// Les admins créent des TIRAGES pour ces opérateurs
// Les joueurs choisissent leur TYPE DE PARI (NAP2, NAP5, etc.) pour un tirage

export type BetType = 
  | 'NAP1'          // Simple numéro
  | 'NAP2'          // Deux numéros (Two Sure)
  | 'NAP3'          // Trois numéros
  | 'NAP4'          // Quatre numéros
  | 'NAP5'          // Cinq numéros
  | 'PERMUTATION'   // Combinaisons automatiques
  | 'BANKA'         // Numéro de base + autres
  | 'CHANCE_PLUS'   // Position exacte (premier/dernier)
  | 'ANAGRAMME';    // Numéros inversés (12/21)

export interface BetTypeConfig {
  id: BetType;
  name: string;
  description: string;
  minNumbers: number;
  maxNumbers: number;
  requiresPosition?: boolean; // Pour CHANCE_PLUS
  requiresBase?: boolean; // Pour BANKA
  autoGeneratesCombinations?: boolean; // Pour PERMUTATION
  defaultMultiplier: number; // Multiplicateur par défaut
  icon: string;
}

// ===== OPÉRATEUR =====
export interface Operator {
  id: string;
  name: string;
  country: string;
  countryCode: string;
  icon: string;
  color: string;
  // Configuration des tirages pour cet opérateur
  numbersPool: number; // Pool de numéros disponibles (ex: 1-90)
  numbersDrawn: number; // Combien de numéros sont tirés (toujours 5)
  minBet: number;
  maxBet: number;
}

// ===== TIRAGE (Draw) =====
// Créé par l'admin dans AdminGames
export interface Draw {
  id: string;
  operatorId: string; // Référence à l'opérateur
  date: string; // Format ISO: "2025-10-29"
  time: string; // Format: "10:39"
  
  // Multiplicateurs spécifiques à ce tirage (définis par l'admin)
  multipliers: {
    [K in BetType]?: number;
  };
  
  // Statut et résultats
  status: 'upcoming' | 'pending' | 'completed';
  winningNumbers: number[]; // Les 5 numéros tirés (vide jusqu'au tirage)
  
  // Métadonnées
  createdAt: string;
  createdBy: string; // ID de l'admin qui a créé le tirage
}

// ===== CONFIGURATION DES 5 OPÉRATEURS =====

export const OPERATORS_CONFIG: Operator[] = [
  {
    id: 'togo-kadoo',
    name: 'Lotto Kadoo',
    country: 'Togo',
    countryCode: '+228',
    icon: '🎯',
    color: '#FFD700',
    numbersPool: 90,
    numbersDrawn: 5,
    minBet: 100,
    maxBet: 50000
  },
  {
    id: 'benin-lotto',
    name: 'Bénin Lotto',
    country: 'Bénin',
    countryCode: '+229',
    icon: '🇧🇯',
    color: '#FF6B00',
    numbersPool: 90,
    numbersDrawn: 5,
    minBet: 100,
    maxBet: 50000
  },
  {
    id: 'ivoire-lonaci',
    name: 'Lonaci',
    country: 'Côte d\'Ivoire',
    countryCode: '+225',
    icon: '🇨🇮',
    color: '#4F00BC',
    numbersPool: 90,
    numbersDrawn: 5,
    minBet: 100,
    maxBet: 50000
  },
  {
    id: 'nigeria-greenlotto',
    name: 'Green Lotto',
    country: 'Nigeria',
    countryCode: '+234',
    icon: '🇳🇬',
    color: '#009DD9',
    numbersPool: 90,
    numbersDrawn: 5,
    minBet: 100,
    maxBet: 50000
  },
  {
    id: 'senegal-pmu',
    name: 'PMU Sénégal',
    country: 'Sénégal',
    countryCode: '+221',
    icon: '🇸🇳',
    color: '#00A651',
    numbersPool: 90,
    numbersDrawn: 5,
    minBet: 100,
    maxBet: 50000
  }
];

// ===== CONFIGURATIONS DES TYPES DE PARIS =====

export const BET_TYPES_CONFIG: { [key in BetType]: BetTypeConfig } = {
  NAP1: {
    id: 'NAP1',
    name: 'Simple Numéro (NAP1)',
    description: 'Trouvez 1 numéro parmi les 5 tirés',
    minNumbers: 1,
    maxNumbers: 1,
    defaultMultiplier: 10, // x10 la mise
    icon: '🎯'
  },
  NAP2: {
    id: 'NAP2',
    name: 'Deux Numéros (NAP2 / Two Sure)',
    description: 'Trouvez 2 numéros parmi les 5 tirés',
    minNumbers: 2,
    maxNumbers: 2,
    defaultMultiplier: 500, // x500 la mise
    icon: '🎲'
  },
  NAP3: {
    id: 'NAP3',
    name: 'Trois Numéros (NAP3)',
    description: 'Trouvez 3 numéros parmi les 5 tirés',
    minNumbers: 3,
    maxNumbers: 3,
    defaultMultiplier: 2500, // x2500 la mise
    icon: '🔮'
  },
  NAP4: {
    id: 'NAP4',
    name: 'Quatre Numéros (NAP4)',
    description: 'Trouvez 4 numéros parmi les 5 tirés',
    minNumbers: 4,
    maxNumbers: 4,
    defaultMultiplier: 10000, // x10000 la mise
    icon: '💎'
  },
  NAP5: {
    id: 'NAP5',
    name: 'Cinq Numéros (NAP5 / Perm Nap)',
    description: 'Trouvez les 5 numéros tirés',
    minNumbers: 5,
    maxNumbers: 5,
    defaultMultiplier: 100000, // x100000 la mise - JACKPOT !
    icon: '👑'
  },
  PERMUTATION: {
    id: 'PERMUTATION',
    name: 'Combinaison (Permutation)',
    description: 'Sélectionnez plusieurs numéros, on génère toutes les combinaisons NAP2',
    minNumbers: 3,
    maxNumbers: 10,
    autoGeneratesCombinations: true,
    defaultMultiplier: 500, // Chaque combinaison x500
    icon: '🔄'
  },
  BANKA: {
    id: 'BANKA',
    name: 'Numéro de Base (Against / Banka)',
    description: 'Un numéro de base + d\'autres numéros associés',
    minNumbers: 2, // 1 base + au moins 1 autre
    maxNumbers: 11, // 1 base + max 10 autres
    requiresBase: true,
    defaultMultiplier: 500,
    icon: '⭐'
  },
  CHANCE_PLUS: {
    id: 'CHANCE_PLUS',
    name: 'Position Exacte (Chance+)',
    description: 'Trouvez le numéro en première ou dernière position',
    minNumbers: 1,
    maxNumbers: 1,
    requiresPosition: true,
    defaultMultiplier: 90, // x90 la mise (1 chance sur 90)
    icon: '🎰'
  },
  ANAGRAMME: {
    id: 'ANAGRAMME',
    name: 'Numéros Inversés (Anagramme / WE dans WE)',
    description: 'Pariez sur un numéro ET son inversé (ex: 12 et 21)',
    minNumbers: 1,
    maxNumbers: 1,
    defaultMultiplier: 10, // x10 la mise (couvre 2 numéros)
    icon: '🔃'
  }
};

// ===== FONCTIONS UTILITAIRES - OPÉRATEURS =====

export function getOperatorById(operatorId: string): Operator | undefined {
  return OPERATORS_CONFIG.find(op => op.id === operatorId);
}

export function getAllOperators(): Operator[] {
  return OPERATORS_CONFIG;
}

export function getOperatorsByCountry(country: string): Operator[] {
  return OPERATORS_CONFIG.filter(op => op.country === country);
}

export function getAllCountries(): string[] {
  return Array.from(new Set(OPERATORS_CONFIG.map(op => op.country)));
}

// ===== FONCTIONS UTILITAIRES - TYPES DE PARIS =====

export function getAvailableBetTypes(): BetType[] {
  return Object.keys(BET_TYPES_CONFIG) as BetType[];
}

export function getBetTypeConfig(betType: BetType): BetTypeConfig {
  return BET_TYPES_CONFIG[betType];
}

// Calculer le nombre de combinaisons pour PERMUTATION
export function calculatePermutationCombinations(totalNumbers: number): number {
  // Combinaisons de 2 parmi N : C(n,2) = n! / (2! * (n-2)!)
  // Formule simplifiée : n * (n-1) / 2
  return (totalNumbers * (totalNumbers - 1)) / 2;
}

// Calculer le coût total d'un pari PERMUTATION
export function calculatePermutationCost(totalNumbers: number, betPerCombination: number): number {
  const combinations = calculatePermutationCombinations(totalNumbers);
  return combinations * betPerCombination;
}

// Générer toutes les combinaisons NAP2 pour PERMUTATION
export function generateNAP2Combinations(numbers: number[]): number[][] {
  const combinations: number[][] = [];
  for (let i = 0; i < numbers.length; i++) {
    for (let j = i + 1; j < numbers.length; j++) {
      combinations.push([numbers[i], numbers[j]]);
    }
  }
  return combinations;
}

// Inverser un numéro (pour ANAGRAMME)
export function invertNumber(num: number): number | null {
  const str = num.toString();
  if (str.length === 1) return null; // Pas d'inversé pour les nombres à 1 chiffre
  const inverted = parseInt(str.split('').reverse().join(''));
  return inverted <= 90 ? inverted : null; // Valide seulement si <= 90
}

// ===== FONCTIONS UTILITAIRES - TIRAGES =====

// Obtenir les tirages à venir pour un opérateur
export function getUpcomingDrawsForOperator(operatorId: string): Draw[] {
  const draws = getDrawsFromLocalStorage();
  const now = new Date();
  
  return draws.filter(draw => {
    if (draw.operatorId !== operatorId) return false;
    if (draw.status !== 'upcoming') return false;
    
    const drawDateTime = new Date(`${draw.date}T${draw.time}`);
    return drawDateTime > now;
  }).sort((a, b) => {
    const dateA = new Date(`${a.date}T${a.time}`);
    const dateB = new Date(`${b.date}T${b.time}`);
    return dateA.getTime() - dateB.getTime();
  });
}

// Obtenir tous les tirages à venir
export function getAllUpcomingDraws(): Draw[] {
  const draws = getDrawsFromLocalStorage();
  const now = new Date();
  
  return draws.filter(draw => {
    if (draw.status !== 'upcoming') return false;
    
    const drawDateTime = new Date(`${draw.date}T${draw.time}`);
    return drawDateTime > now;
  }).sort((a, b) => {
    const dateA = new Date(`${a.date}T${a.time}`);
    const dateB = new Date(`${b.date}T${b.time}`);
    return dateA.getTime() - dateB.getTime();
  });
}

// Obtenir un tirage par ID
export function getDrawById(drawId: string): Draw | undefined {
  const draws = getDrawsFromLocalStorage();
  // Gérer les deux cas: string et number (pour compatibilité avec anciens tirages)
  return draws.find(d => String(d.id) === String(drawId));
}

// Sauvegarder les tirages dans localStorage
export function saveDrawsToLocalStorage(draws: Draw[]): void {
  localStorage.setItem('loto_happy_draws', JSON.stringify(draws));
}

// Charger les tirages depuis localStorage
export function getDrawsFromLocalStorage(): Draw[] {
  try {
    const data = localStorage.getItem('loto_happy_draws');
    return data ? JSON.parse(data) : [];
  } catch (error) {
    console.error('Erreur lors du chargement des tirages:', error);
    return [];
  }
}

// Créer un nouveau tirage
export function createDraw(
  operatorId: string,
  date: string,
  time: string,
  multipliers: { [K in BetType]?: number },
  createdBy: string
): Draw {
  const draws = getDrawsFromLocalStorage();
  
  const newDraw: Draw = {
    id: `draw-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
    operatorId,
    date,
    time,
    multipliers,
    status: 'upcoming',
    winningNumbers: [],
    createdAt: new Date().toISOString(),
    createdBy
  };
  
  draws.push(newDraw);
  saveDrawsToLocalStorage(draws);
  
  return newDraw;
}

// Mettre à jour un tirage
export function updateDraw(drawId: string, updates: Partial<Draw>): Draw | null {
  const draws = getDrawsFromLocalStorage();
  const index = draws.findIndex(d => d.id === drawId);
  
  if (index === -1) return null;
  
  draws[index] = { ...draws[index], ...updates };
  saveDrawsToLocalStorage(draws);
  
  return draws[index];
}

// Supprimer un tirage
export function deleteDraw(drawId: string): boolean {
  const draws = getDrawsFromLocalStorage();
  const filtered = draws.filter(d => d.id !== drawId);
  
  if (filtered.length === draws.length) return false;
  
  saveDrawsToLocalStorage(filtered);
  return true;
}

// Formater l'affichage d'un tirage
export function formatDrawDisplay(draw: Draw): { 
  operatorName: string; 
  country: string;
  fullName: string;
  time: string; 
  countdown: string;
  icon: string;
  color: string;
} {
  const operator = getOperatorById(draw.operatorId);
  if (!operator) {
    return {
      operatorName: 'Opérateur inconnu',
      country: '',
      fullName: 'Opérateur inconnu',
      time: draw.time,
      countdown: '',
      icon: '🎯',
      color: '#FFD700'
    };
  }
  
  const drawDateTime = new Date(`${draw.date}T${draw.time}`);
  const now = new Date();
  const diff = drawDateTime.getTime() - now.getTime();
  
  // Calculer le countdown
  const hours = Math.floor(diff / (1000 * 60 * 60));
  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
  
  let countdown = '';
  if (diff < 0) {
    countdown = 'Terminé';
  } else if (hours >= 24) {
    const days = Math.floor(hours / 24);
    countdown = `Dans ${days}j ${hours % 24}h`;
  } else if (hours > 0) {
    countdown = `Dans ${hours}h ${minutes}min`;
  } else {
    countdown = `Dans ${minutes}min`;
  }
  
  return {
    operatorName: operator.name,
    country: operator.country,
    fullName: `${operator.name} (${operator.country})`,
    time: draw.time,
    countdown,
    icon: operator.icon,
    color: operator.color
  };
}

// ===== MULTIPLICATEURS PAR DÉFAUT =====
// Utilisés lors de la création d'un nouveau tirage
export function getDefaultMultipliers(): { [K in BetType]: number } {
  return {
    NAP1: BET_TYPES_CONFIG.NAP1.defaultMultiplier,
    NAP2: BET_TYPES_CONFIG.NAP2.defaultMultiplier,
    NAP3: BET_TYPES_CONFIG.NAP3.defaultMultiplier,
    NAP4: BET_TYPES_CONFIG.NAP4.defaultMultiplier,
    NAP5: BET_TYPES_CONFIG.NAP5.defaultMultiplier,
    PERMUTATION: BET_TYPES_CONFIG.PERMUTATION.defaultMultiplier,
    BANKA: BET_TYPES_CONFIG.BANKA.defaultMultiplier,
    CHANCE_PLUS: BET_TYPES_CONFIG.CHANCE_PLUS.defaultMultiplier,
    ANAGRAMME: BET_TYPES_CONFIG.ANAGRAMME.defaultMultiplier
  };
}


================================================================================
--- FICHIER : ./src/utils/migrateData.ts ---
================================================================================

// Script de migration pour corriger les numéros de téléphone existants

export function migratePhoneNumbers() {
  console.log('🔄 Migration des numéros de téléphone...');
  
  // Migrer l'utilisateur actuel
  const currentUserData = localStorage.getItem('lottoHappyUser');
  if (currentUserData) {
    try {
      const user = JSON.parse(currentUserData);
      if (user.phoneNumber && user.phoneNumber.includes('+')) {
        user.phoneNumber = user.phoneNumber.replace(/\+/g, '');
        localStorage.setItem('lottoHappyUser', JSON.stringify(user));
        console.log('✅ Utilisateur actuel migré:', user.phoneNumber);
      }
    } catch (e) {
      console.error('❌ Erreur migration utilisateur actuel:', e);
    }
  }
  
  // Migrer tous les joueurs
  const allPlayersData = localStorage.getItem('lottoHappyAllPlayers');
  if (allPlayersData) {
    try {
      const players = JSON.parse(allPlayersData);
      let migrated = 0;
      
      players.forEach((player: any) => {
        if (player.phoneNumber && player.phoneNumber.includes('+')) {
          player.phoneNumber = player.phoneNumber.replace(/\+/g, '');
          migrated++;
        }
      });
      
      if (migrated > 0) {
        localStorage.setItem('lottoHappyAllPlayers', JSON.stringify(players));
        console.log(`✅ ${migrated} joueur(s) migré(s)`);
      } else {
        console.log('✅ Joueurs : Aucune migration nécessaire');
      }
    } catch (e) {
      console.error('❌ Erreur migration joueurs:', e);
    }
  }
  
  // Migrer tous les revendeurs (au cas où)
  const allResellersData = localStorage.getItem('lottoHappyAllResellers');
  if (allResellersData) {
    try {
      const resellers = JSON.parse(allResellersData);
      let migrated = 0;
      
      resellers.forEach((reseller: any) => {
        if (reseller.phoneNumber && reseller.phoneNumber.includes('+')) {
          reseller.phoneNumber = reseller.phoneNumber.replace(/\+/g, '');
          migrated++;
        }
      });
      
      if (migrated > 0) {
        localStorage.setItem('lottoHappyAllResellers', JSON.stringify(resellers));
        console.log(`✅ ${migrated} revendeur(s) migré(s)`);
      } else {
        console.log('✅ Revendeurs : Aucune migration nécessaire');
      }
    } catch (e) {
      console.error('❌ Erreur migration revendeurs:', e);
    }
  } else {
    console.log('ℹ️  Revendeurs non initialisés (normal au premier chargement)');
  }
  
  console.log('🎉 Migration terminée !');
}

// Exécuter la migration au chargement
if (typeof window !== 'undefined') {
  migratePhoneNumbers();
  
  // Rendre disponible globalement
  (window as any).migratePhoneNumbers = migratePhoneNumbers;
  console.log('💡 Vous pouvez aussi lancer manuellement: window.migratePhoneNumbers()');
}

================================================================================
--- FICHIER : ./src/utils/playerAPI.ts ---
================================================================================

// src/utils/playerAPI.ts

import apiClient from '../services/apiClient';

// --- INTERFACES POUR LES JOUEURS ---

export interface Player {
  _id: string;
  username: string;
  email: string;
  phoneNumber: string;
  role: "player";
  status: "active" | "suspended";
  createdAt: string;
  lastLogin: string | null;
  balanceGame: number;
  balanceWinnings: number;
  tokenBalance: number | null;
}

// --- FONCTIONS POUR L'ADMIN ---

/**
 * Récupère une page de joueurs depuis l'API.
 * @returns Un tableau de joueurs.
 */
export const getPlayersPage = async (page: number = 1, size: number = 10): Promise<Player[]> => {
  try {
    const response = await apiClient.get<Player[]>('/api/players/', {
      params: { page, size }
    });
    return response.data;
  } catch (error) {
    console.error("Erreur lors de la récupération de la page de joueurs:", error);
    return []; // Retourne un tableau vide en cas d'erreur pour éviter un crash
  }
};

/**
 * Ajuste le solde d'un joueur (solde de jeu ou solde de gains).
 * @returns L'objet joueur mis à jour.
 */
export const adjustPlayerBalanceAPI = async (
  playerId: string, 
  amount: number, 
  balanceType: 'game' | 'winnings', 
  reason: string
): Promise<Player> => {
  const endpoint = `/api/admin/players/${playerId}/adjust-balance`;
  const payload = { amount, balanceType, reason };
  const response = await apiClient.post<Player>(endpoint, payload);
  return response.data;
};


// --- INTERFACES ET FONCTIONS POUR LE JOUEUR CONNECTÉ ---

export interface PlayerTransaction {
  id: string;
  userId: string;
  type: 'BET' | 'WIN' | 'RECHARGE' | 'WITHDRAWAL' | 'ADJUSTMENT' | 'REFUND';
  description: string;
  amount: number;
  balanceAfterGame: number;
  balanceAfterWinnings: number;
  date: string;
  metadata?: { [key: string]: any };
}

/**
 * Récupère l'historique des transactions du joueur actuellement connecté.
 * @returns Un tableau de transactions.
 */
export const getMyTransactionHistory = async (page: number = 1, size: number = 20): Promise<PlayerTransaction[]> => {
  try {
    const response = await apiClient.get<PlayerTransaction[]>('/api/players/me/transactions', {
      params: { page, size }
    });
    return response.data;
  } catch (error) {
    console.error("Erreur lors de la récupération de l'historique des transactions:", error);
    return [];
  }
};

================================================================================
--- FICHIER : ./src/utils/resellerAPI.ts ---
================================================================================

// src/utils/resellerAPI.ts

import apiClient from '../services/apiClient';

// --- INTERFACES BASÉES SUR L'API FINALE ---

export interface Reseller {
  id: string;
  _id?: string;
  username: string;
  email: string;
  phoneNumber: string;
  role: "reseller";
  status: "active" | "suspended";
  tokenBalance: number | null;
  createdAt?: string;
  lastLogin?: string | null;
}

export interface FoundPlayer {
    id: string;
    username: string;
    phoneNumber: string;
}

export interface RechargeHistoryItem {
    id: string;
    date: string;
    amount: number;
    playerCredited: FoundPlayer;
    resellerBalanceAfter: number;
}

export interface PaginatedRechargeHistory {
    total: number;
    items: RechargeHistoryItem[];
}

interface CreateResellerPayload {
  username: string;
  email: string;
  phoneNumber: string;
  password: string;
  initialTokenBalance?: number;
}


// --- FONCTIONS API FINALES POUR LE REVENDEUR CONNECTÉ ---

/**
 * 1. Crédite le compte d'un joueur.
 */
export const creditPlayerAccountAPI = async (playerPhoneNumber: string, amount: number) => {
  try {
    const response = await apiClient.post('/api/resellers/me/credit-player', {
      playerPhoneNumber,
      amount
    });
    return response.data;
  } catch (error) {
    console.error("Erreur lors du crédit du joueur:", error);
    throw error; // Propage l'erreur pour que le composant l'affiche
  }
};

/**
 * 2. Recherche un joueur par son numéro de téléphone.
 */
export const findPlayerByPhoneAPI = async (phoneNumber: string): Promise<FoundPlayer> => {
  try {
    const response = await apiClient.get<FoundPlayer>('/api/resellers/find-player-by-phone', {
      params: { phoneNumber }
    });
    return response.data;
  } catch (error) {
    console.error("Erreur lors de la recherche du joueur:", error);
    throw error;
  }
};

/**
 * 3. Récupère l'historique des recharges du revendeur connecté.
 */
export const getResellerHistoryAPI = async (skip: number = 0, limit: number = 20): Promise<PaginatedRechargeHistory> => {
  try {
    const response = await apiClient.get<PaginatedRechargeHistory>('/api/resellers/me/recharge-history', {
      params: { skip, limit }
    });
    return response.data;
  } catch (error) {
    console.error("Erreur lors de la récupération de l'historique:", error);
    // On retourne un objet vide par défaut pour ne pas planter l'UI
    return { total: 0, items: [] };
  }
};


// --- FONCTIONS POUR L'ADMIN ---

/**
 * Crée un nouveau revendeur (action d'admin).
 */
export const createResellerAPI = async (resellerData: CreateResellerPayload): Promise<Reseller> => {
    const response = await apiClient.post<Reseller>('/api/resellers/', resellerData);
    return response.data;
};

/**
 * Récupère une page de revendeurs (action d'admin).
 */
export const getResellersPage = async (page: number = 1, size: number = 10): Promise<Reseller[]> => {
    try {
        const response = await apiClient.get<Reseller[]>('/api/resellers/', { params: { page, size } });
        return response.data;
    } catch (error) {
        console.error("Erreur lors de la récupération de la page de revendeurs:", error);
        return [];
    }
};

/**
 * Met à jour le statut d'un utilisateur (action d'admin).
 */
export const updateUserStatusAPI = async (userId: string, status: 'active' | 'suspended'): Promise<void> => {
    await apiClient.put(`/api/admin/users/${userId}/status`, { status });
};

/**
 * Ajuste le solde de jetons d'un revendeur (action d'admin).
 */
export const adjustResellerBalanceAPI = async (resellerId: string, amount: number, reason: string): Promise<Reseller> => {
    const endpoint = `/api/admin/resellers/${resellerId}/adjust-balance`;
    const payload = { amount, reason };
    const response = await apiClient.post<Reseller>(endpoint, payload);
    return response.data;
};

================================================================================
--- FICHIER : ./src/utils/tokenStorage.ts ---
================================================================================

// src/utils/tokenStorage.ts

const TOKEN_KEY = 'authToken';

export const saveToken = (token: string): void => {
  localStorage.setItem(TOKEN_KEY, token);
};

export const getToken = (): string | null => {
  return localStorage.getItem(TOKEN_KEY);
};

export const removeToken = (): void => {
  localStorage.removeItem(TOKEN_KEY);
};

================================================================================
--- FICHIER : ./src/utils/transactionsAPI.ts ---
================================================================================

// src/utils/transactionsAPI.ts
// Ce fichier contiendra les interfaces partagées liées aux transactions.

export interface PlayerTransaction {
  id: string;
  type: 'RECHARGE' | 'BET' | 'CONVERSION' | 'WIN' | 'WITHDRAWAL' | 'REFUND';
  description: string;
  amount: number;
  balanceAfterGame: number;
  balanceAfterWinnings: number;
  date: string;
  metadata?: Record<string, any>;
}

================================================================================
--- FICHIER : ./src/utils/withdrawals.ts ---
================================================================================

// Gestion des demandes de retrait

import { WithdrawalRequest } from './auth';

const WITHDRAWAL_REQUESTS_KEY = 'loto_happy_withdrawal_requests';

// Récupérer toutes les demandes de retrait
export function getWithdrawalRequests(): WithdrawalRequest[] {
  const stored = localStorage.getItem(WITHDRAWAL_REQUESTS_KEY);
  return stored ? JSON.parse(stored) : [];
}

// Sauvegarder les demandes de retrait
function saveWithdrawalRequests(requests: WithdrawalRequest[]): void {
  localStorage.setItem(WITHDRAWAL_REQUESTS_KEY, JSON.stringify(requests));
}

// Créer une nouvelle demande de retrait
export function createWithdrawalRequest(
  userId: string,
  username: string,
  phoneNumber: string,
  amount: number,
  provider: string,
  withdrawalPhoneNumber: string
): WithdrawalRequest {
  const requests = getWithdrawalRequests();
  
  const request: WithdrawalRequest = {
    id: `withdrawal_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
    userId,
    username,
    phoneNumber,
    amount,
    provider,
    withdrawalPhoneNumber,
    status: 'pending',
    requestDate: new Date().toISOString(),
  };
  
  requests.unshift(request); // Ajouter au début (plus récent en premier)
  saveWithdrawalRequests(requests);
  
  return request;
}

// Approuver une demande de retrait
export function approveWithdrawalRequest(requestId: string): boolean {
  const requests = getWithdrawalRequests();
  const index = requests.findIndex(r => r.id === requestId);
  
  if (index !== -1) {
    requests[index].status = 'approved';
    requests[index].processedDate = new Date().toISOString();
    saveWithdrawalRequests(requests);
    return true;
  }
  
  return false;
}

// Rejeter une demande de retrait
export function rejectWithdrawalRequest(requestId: string): boolean {
  const requests = getWithdrawalRequests();
  const index = requests.findIndex(r => r.id === requestId);
  
  if (index !== -1) {
    requests[index].status = 'rejected';
    requests[index].processedDate = new Date().toISOString();
    saveWithdrawalRequests(requests);
    return true;
  }
  
  return false;
}

// Récupérer les demandes d'un utilisateur
export function getUserWithdrawalRequests(userId: string): WithdrawalRequest[] {
  return getWithdrawalRequests().filter(r => r.userId === userId);
}

// Récupérer les demandes en attente
export function getPendingWithdrawalRequests(): WithdrawalRequest[] {
  return getWithdrawalRequests().filter(r => r.status === 'pending');
}


================================================================================
--- FICHIER : ./src/utils/withdrawalsAPI.ts ---
================================================================================

// src/utils/withdrawalsAPI.ts

import apiClient from '../services/apiClient';
import { Withdrawal, FinancialStats } from '../types';

/**
 * Récupère les statistiques financières globales depuis l'API.
 */
export const getGlobalFinancialStats = async (): Promise<FinancialStats> => {
    const response = await apiClient.get<FinancialStats>('/api/admin/financial-stats/global');
    return response.data;
};

/**
 * Récupère la liste de toutes les demandes de retrait.
 * CORRECTION FINALE : La réponse de l'API est un objet { items: [...] }. Nous devons extraire le tableau 'items'.
 */
export const getWithdrawals = async (): Promise<Withdrawal[]> => {
    // On s'attend à recevoir une structure comme { items: Withdrawal[] }
    const response = await apiClient.get<{ items: Withdrawal[] }>('/api/admin/withdrawals/');
    return response.data.items; // On retourne seulement le tableau contenu dans la clé 'items'
};

/**
 * Met à jour le statut d'une demande de retrait (approuve ou rejette).
 */
export const updateWithdrawalStatus = async (
  withdrawalId: number | string,
  status: 'approved' | 'rejected'
): Promise<Withdrawal> => {
    const response = await apiClient.patch<Withdrawal>(
        `/api/admin/withdrawals/${withdrawalId}/`,
        { status }
    );
    return response.data;
};


// --- FONCTIONS JOUEUR (INCHANGÉES) ---
export interface WithdrawalRequest {
  id: string;
  amount: number;
  status: 'pending' | 'approved' | 'rejected';
  requestDate: string;
  provider: string;
  withdrawalPhoneNumber: string;
  playerInfo: {
    id: string;
    username: string;
    phoneNumber: string;
  };
}

export const createWithdrawalRequest = async (requestData: {
  amount: number;
  provider: string;
  withdrawalPhoneNumber: string;
}): Promise<WithdrawalRequest> => {
  const response = await apiClient.post<WithdrawalRequest>('/api/withdrawals/', requestData);
  return response.data;
};

export const getUserWithdrawalRequests = async (): Promise<WithdrawalRequest[]> => {
  const response = await apiClient.get<WithdrawalRequest[]>('/api/withdrawals/');
  return response.data;
};

